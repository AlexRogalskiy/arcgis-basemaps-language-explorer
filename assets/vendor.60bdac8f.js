function oc(){}function Zp(m){return m()}function Bp(){return Object.create(null)}function Su(m){m.forEach(Zp)}function Vp(m){return typeof m=="function"}function Rm(m,x){return m!=m?x==x:m!==x||m&&typeof m=="object"||typeof m=="function"}function jd(m){return Object.keys(m).length===0}function Om(m){return m&&Vp(m.destroy)?m.destroy:oc}function Fm(m,x){m.appendChild(x)}function Um(m,x,S){m.insertBefore(x,S||null)}function Gd(m){m.parentNode.removeChild(m)}function Nm(m,x){for(let S=0;S<m.length;S+=1)m[S]&&m[S].d(x)}function Zm(m){return document.createElement(m)}function qp(m){return document.createTextNode(m)}function Vm(){return qp(" ")}function qm(){return qp("")}function jm(m,x,S,M){return m.addEventListener(x,S,M),()=>m.removeEventListener(x,S,M)}function Gm(m,x,S){S==null?m.removeAttribute(x):m.getAttribute(x)!==S&&m.setAttribute(x,S)}function Wd(m){return Array.from(m.childNodes)}function Wm(m,x){x=""+x,m.wholeText!==x&&(m.data=x)}function Hm(m,x,S,M){S===null?m.style.removeProperty(x):m.style.setProperty(x,S,M?"important":"")}function Xm(m,x,S){m.classList[S?"add":"remove"](x)}let ac;function wu(m){ac=m}const xu=[],Rp=[],uh=[],$h=[],Hd=Promise.resolve();let Qh=!1;function Xd(){Qh||(Qh=!0,Hd.then(jp))}function tc(m){uh.push(m)}function Km(m){$h.push(m)}const Jh=new Set;let sh=0;function jp(){const m=ac;do{for(;sh<xu.length;){const x=xu[sh];sh++,wu(x),Kd(x.$$)}for(wu(null),xu.length=0,sh=0;Rp.length;)Rp.pop()();for(let x=0;x<uh.length;x+=1){const S=uh[x];Jh.has(S)||(Jh.add(S),S())}uh.length=0}while(xu.length);for(;$h.length;)$h.pop()();Qh=!1,Jh.clear(),wu(m)}function Kd(m){if(m.fragment!==null){m.update(),Su(m.before_update);const x=m.dirty;m.dirty=[-1],m.fragment&&m.fragment.p(m.ctx,x),m.after_update.forEach(tc)}}const hh=new Set;let Js;function Jm(){Js={r:0,c:[],p:Js}}function Ym(){Js.r||Su(Js.c),Js=Js.p}function Jd(m,x){m&&m.i&&(hh.delete(m),m.i(x))}function $m(m,x,S,M){if(m&&m.o){if(hh.has(m))return;hh.add(m),Js.c.push(()=>{hh.delete(m),M&&(S&&m.d(1),M())}),m.o(x)}}function Qm(m,x,S){const M=m.$$.props[x];M!==void 0&&(m.$$.bound[M]=S,S(m.$$.ctx[M]))}function t_(m){m&&m.c()}function Yd(m,x,S,M){const{fragment:R,on_mount:nt,on_destroy:u,after_update:Et}=m.$$;R&&R.m(x,S),M||tc(()=>{const st=nt.map(Zp).filter(Vp);u?u.push(...st):Su(st),m.$$.on_mount=[]}),Et.forEach(tc)}function $d(m,x){const S=m.$$;S.fragment!==null&&(Su(S.on_destroy),S.fragment&&S.fragment.d(x),S.on_destroy=S.fragment=null,S.ctx=[])}function Qd(m,x){m.$$.dirty[0]===-1&&(xu.push(m),Xd(),m.$$.dirty.fill(0)),m.$$.dirty[x/31|0]|=1<<x%31}function e_(m,x,S,M,R,nt,u,Et=[-1]){const st=ac;wu(m);const Kt=m.$$={fragment:null,ctx:null,props:nt,update:oc,not_equal:R,bound:Bp(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(x.context||(st?st.$$.context:[])),callbacks:Bp(),dirty:Et,skip_bound:!1,root:x.target||st.$$.root};u&&u(Kt.root);let Vt=!1;if(Kt.ctx=S?S(m,x.props||{},(fe,Ct,...sr)=>{const oi=sr.length?sr[0]:Ct;return Kt.ctx&&R(Kt.ctx[fe],Kt.ctx[fe]=oi)&&(!Kt.skip_bound&&Kt.bound[fe]&&Kt.bound[fe](oi),Vt&&Qd(m,fe)),Ct}):[],Kt.update(),Vt=!0,Su(Kt.before_update),Kt.fragment=M?M(Kt.ctx):!1,x.target){if(x.hydrate){const fe=Wd(x.target);Kt.fragment&&Kt.fragment.l(fe),fe.forEach(Gd)}else Kt.fragment&&Kt.fragment.c();x.intro&&Jd(m.$$.fragment),Yd(m,x.target,x.anchor,x.customElement),jp()}wu(st)}class i_{$destroy(){$d(this,1),this.$destroy=oc}$on(x,S){const M=this.$$.callbacks[x]||(this.$$.callbacks[x]=[]);return M.push(S),()=>{const R=M.indexOf(S);R!==-1&&M.splice(R,1)}}$set(x){this.$$set&&!jd(x)&&(this.$$.skip_bound=!0,this.$$set(x),this.$$.skip_bound=!1)}}var Gp=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},yt={exports:{}};/* @preserve
 * Leaflet 1.7.1, a JS library for interactive maps. http://leafletjs.com
 * (c) 2010-2019 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(m,x){(function(S,M){M(x)})(Gp,function(S){var M="1.7.1";function R(r){var h,_,b,E;for(_=1,b=arguments.length;_<b;_++){E=arguments[_];for(h in E)r[h]=E[h]}return r}var nt=Object.create||function(){function r(){}return function(h){return r.prototype=h,new r}}();function u(r,h){var _=Array.prototype.slice;if(r.bind)return r.bind.apply(r,_.call(arguments,1));var b=_.call(arguments,2);return function(){return r.apply(h,b.length?b.concat(_.call(arguments)):arguments)}}var Et=0;function st(r){return r._leaflet_id=r._leaflet_id||++Et,r._leaflet_id}function Kt(r,h,_){var b,E,N,rt;return rt=function(){b=!1,E&&(N.apply(_,E),E=!1)},N=function(){b?E=arguments:(r.apply(_,arguments),setTimeout(rt,h),b=!0)},N}function Vt(r,h,_){var b=h[1],E=h[0],N=b-E;return r===b&&_?r:((r-E)%N+N)%N+E}function fe(){return!1}function Ct(r,h){var _=Math.pow(10,h===void 0?6:h);return Math.round(r*_)/_}function sr(r){return r.trim?r.trim():r.replace(/^\s+|\s+$/g,"")}function oi(r){return sr(r).split(/\s+/)}function Je(r,h){Object.prototype.hasOwnProperty.call(r,"options")||(r.options=r.options?nt(r.options):{});for(var _ in h)r.options[_]=h[_];return r.options}function lr(r,h,_){var b=[];for(var E in r)b.push(encodeURIComponent(_?E.toUpperCase():E)+"="+encodeURIComponent(r[E]));return(!h||h.indexOf("?")===-1?"?":"&")+b.join("&")}var bo=/\{ *([\w_-]+) *\}/g;function ki(r,h){return r.replace(bo,function(_,b){var E=h[b];if(E===void 0)throw new Error("No value provided for variable "+_);return typeof E=="function"&&(E=E(h)),E})}var Gr=Array.isArray||function(r){return Object.prototype.toString.call(r)==="[object Array]"};function wo(r,h){for(var _=0;_<r.length;_++)if(r[_]===h)return _;return-1}var an="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Hn(r){return window["webkit"+r]||window["moz"+r]||window["ms"+r]}var To=0;function Xn(r){var h=+new Date,_=Math.max(0,16-(h-To));return To=h+_,window.setTimeout(r,_)}var Qi=window.requestAnimationFrame||Hn("RequestAnimationFrame")||Xn,Tn=window.cancelAnimationFrame||Hn("CancelAnimationFrame")||Hn("CancelRequestAnimationFrame")||function(r){window.clearTimeout(r)};function li(r,h,_){if(_&&Qi===Xn)r.call(h);else return Qi.call(window,u(r,h))}function ji(r){r&&Tn.call(window,r)}var _i={extend:R,create:nt,bind:u,lastId:Et,stamp:st,throttle:Kt,wrapNum:Vt,falseFn:fe,formatNum:Ct,trim:sr,splitWords:oi,setOptions:Je,getParamString:lr,template:ki,isArray:Gr,indexOf:wo,emptyImageUrl:an,requestFn:Qi,cancelFn:Tn,requestAnimFrame:li,cancelAnimFrame:ji};function Ei(){}Ei.extend=function(r){var h=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},_=h.__super__=this.prototype,b=nt(_);b.constructor=h,h.prototype=b;for(var E in this)Object.prototype.hasOwnProperty.call(this,E)&&E!=="prototype"&&E!=="__super__"&&(h[E]=this[E]);return r.statics&&(R(h,r.statics),delete r.statics),r.includes&&(ja(r.includes),R.apply(null,[b].concat(r.includes)),delete r.includes),b.options&&(r.options=R(nt(b.options),r.options)),R(b,r),b._initHooks=[],b.callInitHooks=function(){if(!this._initHooksCalled){_.callInitHooks&&_.callInitHooks.call(this),this._initHooksCalled=!0;for(var N=0,rt=b._initHooks.length;N<rt;N++)b._initHooks[N].call(this)}},h},Ei.include=function(r){return R(this.prototype,r),this},Ei.mergeOptions=function(r){return R(this.prototype.options,r),this},Ei.addInitHook=function(r){var h=Array.prototype.slice.call(arguments,1),_=typeof r=="function"?r:function(){this[r].apply(this,h)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(_),this};function ja(r){if(!(typeof L=="undefined"||!L||!L.Mixin)){r=Gr(r)?r:[r];for(var h=0;h<r.length;h++)r[h]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var Ti={on:function(r,h,_){if(typeof r=="object")for(var b in r)this._on(b,r[b],h);else{r=oi(r);for(var E=0,N=r.length;E<N;E++)this._on(r[E],h,_)}return this},off:function(r,h,_){if(!r)delete this._events;else if(typeof r=="object")for(var b in r)this._off(b,r[b],h);else{r=oi(r);for(var E=0,N=r.length;E<N;E++)this._off(r[E],h,_)}return this},_on:function(r,h,_){this._events=this._events||{};var b=this._events[r];b||(b=[],this._events[r]=b),_===this&&(_=void 0);for(var E={fn:h,ctx:_},N=b,rt=0,pt=N.length;rt<pt;rt++)if(N[rt].fn===h&&N[rt].ctx===_)return;N.push(E)},_off:function(r,h,_){var b,E,N;if(!!this._events&&(b=this._events[r],!!b)){if(!h){for(E=0,N=b.length;E<N;E++)b[E].fn=fe;delete this._events[r];return}if(_===this&&(_=void 0),b)for(E=0,N=b.length;E<N;E++){var rt=b[E];if(rt.ctx===_&&rt.fn===h){rt.fn=fe,this._firingCount&&(this._events[r]=b=b.slice()),b.splice(E,1);return}}}},fire:function(r,h,_){if(!this.listens(r,_))return this;var b=R({},h,{type:r,target:this,sourceTarget:h&&h.sourceTarget||this});if(this._events){var E=this._events[r];if(E){this._firingCount=this._firingCount+1||1;for(var N=0,rt=E.length;N<rt;N++){var pt=E[N];pt.fn.call(pt.ctx||this,b)}this._firingCount--}}return _&&this._propagateEvent(b),this},listens:function(r,h){var _=this._events&&this._events[r];if(_&&_.length)return!0;if(h){for(var b in this._eventParents)if(this._eventParents[b].listens(r,h))return!0}return!1},once:function(r,h,_){if(typeof r=="object"){for(var b in r)this.once(b,r[b],h);return this}var E=u(function(){this.off(r,h,_).off(r,E,_)},this);return this.on(r,h,_).on(r,E,_)},addEventParent:function(r){return this._eventParents=this._eventParents||{},this._eventParents[st(r)]=r,this},removeEventParent:function(r){return this._eventParents&&delete this._eventParents[st(r)],this},_propagateEvent:function(r){for(var h in this._eventParents)this._eventParents[h].fire(r.type,R({layer:r.target,propagatedFrom:r.target},r),!0)}};Ti.addEventListener=Ti.on,Ti.removeEventListener=Ti.clearAllEventListeners=Ti.off,Ti.addOneTimeEventListener=Ti.once,Ti.fireEvent=Ti.fire,Ti.hasEventListeners=Ti.listens;var Sn=Ei.extend(Ti);function de(r,h,_){this.x=_?Math.round(r):r,this.y=_?Math.round(h):h}var xa=Math.trunc||function(r){return r>0?Math.floor(r):Math.ceil(r)};de.prototype={clone:function(){return new de(this.x,this.y)},add:function(r){return this.clone()._add(Ce(r))},_add:function(r){return this.x+=r.x,this.y+=r.y,this},subtract:function(r){return this.clone()._subtract(Ce(r))},_subtract:function(r){return this.x-=r.x,this.y-=r.y,this},divideBy:function(r){return this.clone()._divideBy(r)},_divideBy:function(r){return this.x/=r,this.y/=r,this},multiplyBy:function(r){return this.clone()._multiplyBy(r)},_multiplyBy:function(r){return this.x*=r,this.y*=r,this},scaleBy:function(r){return new de(this.x*r.x,this.y*r.y)},unscaleBy:function(r){return new de(this.x/r.x,this.y/r.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=xa(this.x),this.y=xa(this.y),this},distanceTo:function(r){r=Ce(r);var h=r.x-this.x,_=r.y-this.y;return Math.sqrt(h*h+_*_)},equals:function(r){return r=Ce(r),r.x===this.x&&r.y===this.y},contains:function(r){return r=Ce(r),Math.abs(r.x)<=Math.abs(this.x)&&Math.abs(r.y)<=Math.abs(this.y)},toString:function(){return"Point("+Ct(this.x)+", "+Ct(this.y)+")"}};function Ce(r,h,_){return r instanceof de?r:Gr(r)?new de(r[0],r[1]):r==null?r:typeof r=="object"&&"x"in r&&"y"in r?new de(r.x,r.y):new de(r,h,_)}function We(r,h){if(!!r)for(var _=h?[r,h]:r,b=0,E=_.length;b<E;b++)this.extend(_[b])}We.prototype={extend:function(r){return r=Ce(r),!this.min&&!this.max?(this.min=r.clone(),this.max=r.clone()):(this.min.x=Math.min(r.x,this.min.x),this.max.x=Math.max(r.x,this.max.x),this.min.y=Math.min(r.y,this.min.y),this.max.y=Math.max(r.y,this.max.y)),this},getCenter:function(r){return new de((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,r)},getBottomLeft:function(){return new de(this.min.x,this.max.y)},getTopRight:function(){return new de(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(r){var h,_;return typeof r[0]=="number"||r instanceof de?r=Ce(r):r=Oi(r),r instanceof We?(h=r.min,_=r.max):h=_=r,h.x>=this.min.x&&_.x<=this.max.x&&h.y>=this.min.y&&_.y<=this.max.y},intersects:function(r){r=Oi(r);var h=this.min,_=this.max,b=r.min,E=r.max,N=E.x>=h.x&&b.x<=_.x,rt=E.y>=h.y&&b.y<=_.y;return N&&rt},overlaps:function(r){r=Oi(r);var h=this.min,_=this.max,b=r.min,E=r.max,N=E.x>h.x&&b.x<_.x,rt=E.y>h.y&&b.y<_.y;return N&&rt},isValid:function(){return!!(this.min&&this.max)}};function Oi(r,h){return!r||r instanceof We?r:new We(r,h)}function Fi(r,h){if(!!r)for(var _=h?[r,h]:r,b=0,E=_.length;b<E;b++)this.extend(_[b])}Fi.prototype={extend:function(r){var h=this._southWest,_=this._northEast,b,E;if(r instanceof Ve)b=r,E=r;else if(r instanceof Fi){if(b=r._southWest,E=r._northEast,!b||!E)return this}else return r?this.extend(gi(r)||yi(r)):this;return!h&&!_?(this._southWest=new Ve(b.lat,b.lng),this._northEast=new Ve(E.lat,E.lng)):(h.lat=Math.min(b.lat,h.lat),h.lng=Math.min(b.lng,h.lng),_.lat=Math.max(E.lat,_.lat),_.lng=Math.max(E.lng,_.lng)),this},pad:function(r){var h=this._southWest,_=this._northEast,b=Math.abs(h.lat-_.lat)*r,E=Math.abs(h.lng-_.lng)*r;return new Fi(new Ve(h.lat-b,h.lng-E),new Ve(_.lat+b,_.lng+E))},getCenter:function(){return new Ve((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Ve(this.getNorth(),this.getWest())},getSouthEast:function(){return new Ve(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(r){typeof r[0]=="number"||r instanceof Ve||"lat"in r?r=gi(r):r=yi(r);var h=this._southWest,_=this._northEast,b,E;return r instanceof Fi?(b=r.getSouthWest(),E=r.getNorthEast()):b=E=r,b.lat>=h.lat&&E.lat<=_.lat&&b.lng>=h.lng&&E.lng<=_.lng},intersects:function(r){r=yi(r);var h=this._southWest,_=this._northEast,b=r.getSouthWest(),E=r.getNorthEast(),N=E.lat>=h.lat&&b.lat<=_.lat,rt=E.lng>=h.lng&&b.lng<=_.lng;return N&&rt},overlaps:function(r){r=yi(r);var h=this._southWest,_=this._northEast,b=r.getSouthWest(),E=r.getNorthEast(),N=E.lat>h.lat&&b.lat<_.lat,rt=E.lng>h.lng&&b.lng<_.lng;return N&&rt},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(r,h){return r?(r=yi(r),this._southWest.equals(r.getSouthWest(),h)&&this._northEast.equals(r.getNorthEast(),h)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function yi(r,h){return r instanceof Fi?r:new Fi(r,h)}function Ve(r,h,_){if(isNaN(r)||isNaN(h))throw new Error("Invalid LatLng object: ("+r+", "+h+")");this.lat=+r,this.lng=+h,_!==void 0&&(this.alt=+_)}Ve.prototype={equals:function(r,h){if(!r)return!1;r=gi(r);var _=Math.max(Math.abs(this.lat-r.lat),Math.abs(this.lng-r.lng));return _<=(h===void 0?1e-9:h)},toString:function(r){return"LatLng("+Ct(this.lat,r)+", "+Ct(this.lng,r)+")"},distanceTo:function(r){return _r.distance(this,gi(r))},wrap:function(){return _r.wrapLatLng(this)},toBounds:function(r){var h=180*r/40075017,_=h/Math.cos(Math.PI/180*this.lat);return yi([this.lat-h,this.lng-_],[this.lat+h,this.lng+_])},clone:function(){return new Ve(this.lat,this.lng,this.alt)}};function gi(r,h,_){return r instanceof Ve?r:Gr(r)&&typeof r[0]!="object"?r.length===3?new Ve(r[0],r[1],r[2]):r.length===2?new Ve(r[0],r[1]):null:r==null?r:typeof r=="object"&&"lat"in r?new Ve(r.lat,"lng"in r?r.lng:r.lon,r.alt):h===void 0?null:new Ve(r,h,_)}var vi={latLngToPoint:function(r,h){var _=this.projection.project(r),b=this.scale(h);return this.transformation._transform(_,b)},pointToLatLng:function(r,h){var _=this.scale(h),b=this.transformation.untransform(r,_);return this.projection.unproject(b)},project:function(r){return this.projection.project(r)},unproject:function(r){return this.projection.unproject(r)},scale:function(r){return 256*Math.pow(2,r)},zoom:function(r){return Math.log(r/256)/Math.LN2},getProjectedBounds:function(r){if(this.infinite)return null;var h=this.projection.bounds,_=this.scale(r),b=this.transformation.transform(h.min,_),E=this.transformation.transform(h.max,_);return new We(b,E)},infinite:!1,wrapLatLng:function(r){var h=this.wrapLng?Vt(r.lng,this.wrapLng,!0):r.lng,_=this.wrapLat?Vt(r.lat,this.wrapLat,!0):r.lat,b=r.alt;return new Ve(_,h,b)},wrapLatLngBounds:function(r){var h=r.getCenter(),_=this.wrapLatLng(h),b=h.lat-_.lat,E=h.lng-_.lng;if(b===0&&E===0)return r;var N=r.getSouthWest(),rt=r.getNorthEast(),pt=new Ve(N.lat-b,N.lng-E),wt=new Ve(rt.lat-b,rt.lng-E);return new Fi(pt,wt)}},_r=R({},vi,{wrapLng:[-180,180],R:6371e3,distance:function(r,h){var _=Math.PI/180,b=r.lat*_,E=h.lat*_,N=Math.sin((h.lat-r.lat)*_/2),rt=Math.sin((h.lng-r.lng)*_/2),pt=N*N+Math.cos(b)*Math.cos(E)*rt*rt,wt=2*Math.atan2(Math.sqrt(pt),Math.sqrt(1-pt));return this.R*wt}}),Ke=6378137,sn={R:Ke,MAX_LATITUDE:85.0511287798,project:function(r){var h=Math.PI/180,_=this.MAX_LATITUDE,b=Math.max(Math.min(_,r.lat),-_),E=Math.sin(b*h);return new de(this.R*r.lng*h,this.R*Math.log((1+E)/(1-E))/2)},unproject:function(r){var h=180/Math.PI;return new Ve((2*Math.atan(Math.exp(r.y/this.R))-Math.PI/2)*h,r.x*h/this.R)},bounds:function(){var r=Ke*Math.PI;return new We([-r,-r],[r,r])}()};function Kn(r,h,_,b){if(Gr(r)){this._a=r[0],this._b=r[1],this._c=r[2],this._d=r[3];return}this._a=r,this._b=h,this._c=_,this._d=b}Kn.prototype={transform:function(r,h){return this._transform(r.clone(),h)},_transform:function(r,h){return h=h||1,r.x=h*(this._a*r.x+this._b),r.y=h*(this._c*r.y+this._d),r},untransform:function(r,h){return h=h||1,new de((r.x/h-this._b)/this._a,(r.y/h-this._d)/this._c)}};function Pr(r,h,_,b){return new Kn(r,h,_,b)}var Te=R({},_r,{code:"EPSG:3857",projection:sn,transformation:function(){var r=.5/(Math.PI*sn.R);return Pr(r,.5,-r,.5)}()}),Jn=R({},Te,{code:"EPSG:900913"});function yr(r){return document.createElementNS("http://www.w3.org/2000/svg",r)}function Wr(r,h){var _="",b,E,N,rt,pt,wt;for(b=0,N=r.length;b<N;b++){for(pt=r[b],E=0,rt=pt.length;E<rt;E++)wt=pt[E],_+=(E?"L":"M")+wt.x+" "+wt.y;_+=h?O?"z":"x":""}return _||"M0 0"}var ba=document.documentElement.style,Br="ActiveXObject"in window,Pn=Br&&!document.addEventListener,Ir="msLaunchUri"in navigator&&!("documentMode"in document),On=W("webkit"),In=W("android"),gr=W("android 2")||W("android 3"),ln=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Yn=In&&W("Google")&&ln<537&&!("AudioNode"in window),Hr=!!window.opera,qo=!Ir&&W("chrome"),jo=W("gecko")&&!On&&!Hr&&!Br,$n=!qo&&W("safari"),Go=W("phantom"),So="OTransition"in ba,wa=navigator.platform.indexOf("Win")===0,Qn=Br&&"transition"in ba,Po="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!gr,to="MozPerspective"in ba,vr=!window.L_DISABLE_3D&&(Qn||Po||to)&&!So&&!Go,En=typeof orientation!="undefined"||W("mobile"),Ga=En&&On,Wa=En&&Po,Rr=!window.PointerEvent&&window.MSPointerEvent,tr=!!(window.PointerEvent||Rr),er=!window.L_NO_TOUCH&&(tr||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),Io=En&&Hr,Ta=En&&jo,$e=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,C=function(){var r=!1;try{var h=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassiveEventSupport",fe,h),window.removeEventListener("testPassiveEventSupport",fe,h)}catch{}return r}(),D=function(){return!!document.createElement("canvas").getContext}(),O=!!(document.createElementNS&&yr("svg").createSVGRect),j=!O&&function(){try{var r=document.createElement("div");r.innerHTML='<v:shape adj="1"/>';var h=r.firstChild;return h.style.behavior="url(#default#VML)",h&&typeof h.adj=="object"}catch{return!1}}();function W(r){return navigator.userAgent.toLowerCase().indexOf(r)>=0}var it={ie:Br,ielt9:Pn,edge:Ir,webkit:On,android:In,android23:gr,androidStock:Yn,opera:Hr,chrome:qo,gecko:jo,safari:$n,phantom:Go,opera12:So,win:wa,ie3d:Qn,webkit3d:Po,gecko3d:to,any3d:vr,mobile:En,mobileWebkit:Ga,mobileWebkit3d:Wa,msPointer:Rr,pointer:tr,touch:er,mobileOpera:Io,mobileGecko:Ta,retina:$e,passiveEvents:C,canvas:D,svg:O,vml:j},at=Rr?"MSPointerDown":"pointerdown",V=Rr?"MSPointerMove":"pointermove",Y=Rr?"MSPointerUp":"pointerup",ut=Rr?"MSPointerCancel":"pointercancel",St={},At=!1;function gt(r,h,_,b){return h==="touchstart"?Ht(r,_,b):h==="touchmove"?Rt(r,_,b):h==="touchend"&&ge(r,_,b),this}function It(r,h,_){var b=r["_leaflet_"+h+_];return h==="touchstart"?r.removeEventListener(at,b,!1):h==="touchmove"?r.removeEventListener(V,b,!1):h==="touchend"&&(r.removeEventListener(Y,b,!1),r.removeEventListener(ut,b,!1)),this}function Ht(r,h,_){var b=u(function(E){E.MSPOINTER_TYPE_TOUCH&&E.pointerType===E.MSPOINTER_TYPE_TOUCH&&Hi(E),Mt(E,h)});r["_leaflet_touchstart"+_]=b,r.addEventListener(at,b,!1),At||(document.addEventListener(at,qt,!0),document.addEventListener(V,bt,!0),document.addEventListener(Y,Ft,!0),document.addEventListener(ut,Ft,!0),At=!0)}function qt(r){St[r.pointerId]=r}function bt(r){St[r.pointerId]&&(St[r.pointerId]=r)}function Ft(r){delete St[r.pointerId]}function Mt(r,h){r.touches=[];for(var _ in St)r.touches.push(St[_]);r.changedTouches=[r],h(r)}function Rt(r,h,_){var b=function(E){E.pointerType===(E.MSPOINTER_TYPE_MOUSE||"mouse")&&E.buttons===0||Mt(E,h)};r["_leaflet_touchmove"+_]=b,r.addEventListener(V,b,!1)}function ge(r,h,_){var b=function(E){Mt(E,h)};r["_leaflet_touchend"+_]=b,r.addEventListener(Y,b,!1),r.addEventListener(ut,b,!1)}var Ot=Rr?"MSPointerDown":tr?"pointerdown":"touchstart",be=Rr?"MSPointerUp":tr?"pointerup":"touchend",Be="_leaflet_";function we(r,h,_){var b,E,N=!1,rt=250;function pt(xt){if(tr){if(!xt.isPrimary||xt.pointerType==="mouse")return}else if(xt.touches.length>1)return;var Wt=Date.now(),ie=Wt-(b||Wt);E=xt.touches?xt.touches[0]:xt,N=ie>0&&ie<=rt,b=Wt}function wt(xt){if(N&&!E.cancelBubble){if(tr){if(xt.pointerType==="mouse")return;var Wt={},ie,me;for(me in E)ie=E[me],Wt[me]=ie&&ie.bind?ie.bind(E):ie;E=Wt}E.type="dblclick",E.button=0,h(E),b=null}}return r[Be+Ot+_]=pt,r[Be+be+_]=wt,r[Be+"dblclick"+_]=h,r.addEventListener(Ot,pt,C?{passive:!1}:!1),r.addEventListener(be,wt,C?{passive:!1}:!1),r.addEventListener("dblclick",h,!1),this}function Re(r,h){var _=r[Be+Ot+h],b=r[Be+be+h],E=r[Be+"dblclick"+h];return r.removeEventListener(Ot,_,C?{passive:!1}:!1),r.removeEventListener(be,b,C?{passive:!1}:!1),r.removeEventListener("dblclick",E,!1),this}var Ie=Er(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ui=Er(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Fe=Ui==="webkitTransition"||Ui==="OTransition"?Ui+"End":"transitionend";function xi(r){return typeof r=="string"?document.getElementById(r):r}function Oe(r,h){var _=r.style[h]||r.currentStyle&&r.currentStyle[h];if((!_||_==="auto")&&document.defaultView){var b=document.defaultView.getComputedStyle(r,null);_=b?b[h]:null}return _==="auto"?null:_}function Yt(r,h,_){var b=document.createElement(r);return b.className=h||"",_&&_.appendChild(b),b}function se(r){var h=r.parentNode;h&&h.removeChild(r)}function ir(r){for(;r.firstChild;)r.removeChild(r.firstChild)}function An(r){var h=r.parentNode;h&&h.lastChild!==r&&h.appendChild(r)}function bi(r){var h=r.parentNode;h&&h.firstChild!==r&&h.insertBefore(r,h.firstChild)}function ur(r,h){if(r.classList!==void 0)return r.classList.contains(h);var _=eo(r);return _.length>0&&new RegExp("(^|\\s)"+h+"(\\s|$)").test(_)}function Se(r,h){if(r.classList!==void 0)for(var _=oi(h),b=0,E=_.length;b<E;b++)r.classList.add(_[b]);else if(!ur(r,h)){var N=eo(r);pi(r,(N?N+" ":"")+h)}}function ui(r,h){r.classList!==void 0?r.classList.remove(h):pi(r,sr((" "+eo(r)+" ").replace(" "+h+" "," ")))}function pi(r,h){r.className.baseVal===void 0?r.className=h:r.className.baseVal=h}function eo(r){return r.correspondingElement&&(r=r.correspondingElement),r.className.baseVal===void 0?r.className:r.className.baseVal}function ai(r,h){"opacity"in r.style?r.style.opacity=h:"filter"in r.style&&Gi(r,h)}function Gi(r,h){var _=!1,b="DXImageTransform.Microsoft.Alpha";try{_=r.filters.item(b)}catch{if(h===1)return}h=Math.round(h*100),_?(_.Enabled=h!==100,_.Opacity=h):r.style.filter+=" progid:"+b+"(opacity="+h+")"}function Er(r){for(var h=document.documentElement.style,_=0;_<r.length;_++)if(r[_]in h)return r[_];return!1}function He(r,h,_){var b=h||new de(0,0);r.style[Ie]=(Qn?"translate("+b.x+"px,"+b.y+"px)":"translate3d("+b.x+"px,"+b.y+"px,0)")+(_?" scale("+_+")":"")}function Qe(r,h){r._leaflet_pos=h,vr?He(r,h):(r.style.left=h.x+"px",r.style.top=h.y+"px")}function Ni(r){return r._leaflet_pos||new de(0,0)}var Wo,xr,ws;if("onselectstart"in document)Wo=function(){ke(window,"selectstart",Hi)},xr=function(){Ai(window,"selectstart",Hi)};else{var Xr=Er(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Wo=function(){if(Xr){var r=document.documentElement.style;ws=r[Xr],r[Xr]="none"}},xr=function(){Xr&&(document.documentElement.style[Xr]=ws,ws=void 0)}}function Zi(){ke(window,"dragstart",Hi)}function un(){Ai(window,"dragstart",Hi)}var Wi,Fn;function Ts(r){for(;r.tabIndex===-1;)r=r.parentNode;!r.style||(Ha(),Wi=r,Fn=r.style.outline,r.style.outline="none",ke(window,"keydown",Ha))}function Ha(){!Wi||(Wi.style.outline=Fn,Wi=void 0,Fn=void 0,Ai(window,"keydown",Ha))}function Xa(r){do r=r.parentNode;while((!r.offsetWidth||!r.offsetHeight)&&r!==document.body);return r}function Ss(r){var h=r.getBoundingClientRect();return{x:h.width/r.offsetWidth||1,y:h.height/r.offsetHeight||1,boundingClientRect:h}}var Ys={TRANSFORM:Ie,TRANSITION:Ui,TRANSITION_END:Fe,get:xi,getStyle:Oe,create:Yt,remove:se,empty:ir,toFront:An,toBack:bi,hasClass:ur,addClass:Se,removeClass:ui,setClass:pi,getClass:eo,setOpacity:ai,testProp:Er,setTransform:He,setPosition:Qe,getPosition:Ni,disableTextSelection:Wo,enableTextSelection:xr,disableImageDrag:Zi,enableImageDrag:un,preventOutline:Ts,restoreOutline:Ha,getSizedParentNode:Xa,getScale:Ss};function ke(r,h,_,b){if(typeof h=="object")for(var E in h)io(r,E,h[E],_);else{h=oi(h);for(var N=0,rt=h.length;N<rt;N++)io(r,h[N],_,b)}return this}var hn="_leaflet_events";function Ai(r,h,_,b){if(typeof h=="object")for(var E in h)Ka(r,E,h[E],_);else if(h){h=oi(h);for(var N=0,rt=h.length;N<rt;N++)Ka(r,h[N],_,b)}else{for(var pt in r[hn])Ka(r,pt,r[hn][pt]);delete r[hn]}return this}function Eo(){if(tr)return!(Ir||$n)}var Sa={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function io(r,h,_,b){var E=h+st(_)+(b?"_"+st(b):"");if(r[hn]&&r[hn][E])return this;var N=function(pt){return _.call(b||r,pt||window.event)},rt=N;tr&&h.indexOf("touch")===0?gt(r,h,N,E):er&&h==="dblclick"&&!Eo()?we(r,N,E):"addEventListener"in r?h==="touchstart"||h==="touchmove"||h==="wheel"||h==="mousewheel"?r.addEventListener(Sa[h]||h,N,C?{passive:!1}:!1):h==="mouseenter"||h==="mouseleave"?(N=function(pt){pt=pt||window.event,Ia(r,pt)&&rt(pt)},r.addEventListener(Sa[h],N,!1)):r.addEventListener(h,rt,!1):"attachEvent"in r&&r.attachEvent("on"+h,N),r[hn]=r[hn]||{},r[hn][E]=N}function Ka(r,h,_,b){var E=h+st(_)+(b?"_"+st(b):""),N=r[hn]&&r[hn][E];if(!N)return this;tr&&h.indexOf("touch")===0?It(r,h,E):er&&h==="dblclick"&&!Eo()?Re(r,E):"removeEventListener"in r?r.removeEventListener(Sa[h]||h,N,!1):"detachEvent"in r&&r.detachEvent("on"+h,N),r[hn][E]=null}function Cn(r){return r.stopPropagation?r.stopPropagation():r.originalEvent?r.originalEvent._stopped=!0:r.cancelBubble=!0,no(r),this}function Or(r){return io(r,"wheel",Cn),this}function cn(r){return ke(r,"mousedown touchstart dblclick",Cn),io(r,"click",wi),this}function Hi(r){return r.preventDefault?r.preventDefault():r.returnValue=!1,this}function Ar(r){return Hi(r),Cn(r),this}function Un(r,h){if(!h)return new de(r.clientX,r.clientY);var _=Ss(h),b=_.boundingClientRect;return new de((r.clientX-b.left)/_.x-h.clientLeft,(r.clientY-b.top)/_.y-h.clientTop)}var ro=wa&&qo?2*window.devicePixelRatio:jo?window.devicePixelRatio:1;function Pa(r){return Ir?r.wheelDeltaY/2:r.deltaY&&r.deltaMode===0?-r.deltaY/ro:r.deltaY&&r.deltaMode===1?-r.deltaY*20:r.deltaY&&r.deltaMode===2?-r.deltaY*60:r.deltaX||r.deltaZ?0:r.wheelDelta?(r.wheelDeltaY||r.wheelDelta)/2:r.detail&&Math.abs(r.detail)<32765?-r.detail*20:r.detail?r.detail/-32765*60:0}var br={};function wi(r){br[r.type]=!0}function no(r){var h=br[r.type];return br[r.type]=!1,h}function Ia(r,h){var _=h.relatedTarget;if(!_)return!0;try{for(;_&&_!==r;)_=_.parentNode}catch{return!1}return _!==r}var Zl={on:ke,off:Ai,stopPropagation:Cn,disableScrollPropagation:Or,disableClickPropagation:cn,preventDefault:Hi,stop:Ar,getMousePosition:Un,getWheelDelta:Pa,fakeStop:wi,skipped:no,isExternalTarget:Ia,addListener:ke,removeListener:Ai},$s=Sn.extend({run:function(r,h,_,b){this.stop(),this._el=r,this._inProgress=!0,this._duration=_||.25,this._easeOutPower=1/Math.max(b||.5,.2),this._startPos=Ni(r),this._offset=h.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){!this._inProgress||(this._step(!0),this._complete())},_animate:function(){this._animId=li(this._animate,this),this._step()},_step:function(r){var h=+new Date-this._startTime,_=this._duration*1e3;h<_?this._runFrame(this._easeOut(h/_),r):(this._runFrame(1),this._complete())},_runFrame:function(r,h){var _=this._startPos.add(this._offset.multiplyBy(r));h&&_._round(),Qe(this._el,_),this.fire("step")},_complete:function(){ji(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(r){return 1-Math.pow(1-r,this._easeOutPower)}}),Ue=Sn.extend({options:{crs:Te,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(r,h){h=Je(this,h),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(r),this._initLayout(),this._onResize=u(this._onResize,this),this._initEvents(),h.maxBounds&&this.setMaxBounds(h.maxBounds),h.zoom!==void 0&&(this._zoom=this._limitZoom(h.zoom)),h.center&&h.zoom!==void 0&&this.setView(gi(h.center),h.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ui&&vr&&!Io&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ke(this._proxy,Fe,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(r,h,_){if(h=h===void 0?this._zoom:this._limitZoom(h),r=this._limitCenter(gi(r),h,this.options.maxBounds),_=_||{},this._stop(),this._loaded&&!_.reset&&_!==!0){_.animate!==void 0&&(_.zoom=R({animate:_.animate},_.zoom),_.pan=R({animate:_.animate,duration:_.duration},_.pan));var b=this._zoom!==h?this._tryAnimatedZoom&&this._tryAnimatedZoom(r,h,_.zoom):this._tryAnimatedPan(r,_.pan);if(b)return clearTimeout(this._sizeTimer),this}return this._resetView(r,h),this},setZoom:function(r,h){return this._loaded?this.setView(this.getCenter(),r,{zoom:h}):(this._zoom=r,this)},zoomIn:function(r,h){return r=r||(vr?this.options.zoomDelta:1),this.setZoom(this._zoom+r,h)},zoomOut:function(r,h){return r=r||(vr?this.options.zoomDelta:1),this.setZoom(this._zoom-r,h)},setZoomAround:function(r,h,_){var b=this.getZoomScale(h),E=this.getSize().divideBy(2),N=r instanceof de?r:this.latLngToContainerPoint(r),rt=N.subtract(E).multiplyBy(1-1/b),pt=this.containerPointToLatLng(E.add(rt));return this.setView(pt,h,{zoom:_})},_getBoundsCenterZoom:function(r,h){h=h||{},r=r.getBounds?r.getBounds():yi(r);var _=Ce(h.paddingTopLeft||h.padding||[0,0]),b=Ce(h.paddingBottomRight||h.padding||[0,0]),E=this.getBoundsZoom(r,!1,_.add(b));if(E=typeof h.maxZoom=="number"?Math.min(h.maxZoom,E):E,E===1/0)return{center:r.getCenter(),zoom:E};var N=b.subtract(_).divideBy(2),rt=this.project(r.getSouthWest(),E),pt=this.project(r.getNorthEast(),E),wt=this.unproject(rt.add(pt).divideBy(2).add(N),E);return{center:wt,zoom:E}},fitBounds:function(r,h){if(r=yi(r),!r.isValid())throw new Error("Bounds are not valid.");var _=this._getBoundsCenterZoom(r,h);return this.setView(_.center,_.zoom,h)},fitWorld:function(r){return this.fitBounds([[-90,-180],[90,180]],r)},panTo:function(r,h){return this.setView(r,this._zoom,{pan:h})},panBy:function(r,h){if(r=Ce(r).round(),h=h||{},!r.x&&!r.y)return this.fire("moveend");if(h.animate!==!0&&!this.getSize().contains(r))return this._resetView(this.unproject(this.project(this.getCenter()).add(r)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new $s,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),h.noMoveStart||this.fire("movestart"),h.animate!==!1){Se(this._mapPane,"leaflet-pan-anim");var _=this._getMapPanePos().subtract(r).round();this._panAnim.run(this._mapPane,_,h.duration||.25,h.easeLinearity)}else this._rawPanBy(r),this.fire("move").fire("moveend");return this},flyTo:function(r,h,_){if(_=_||{},_.animate===!1||!vr)return this.setView(r,h,_);this._stop();var b=this.project(this.getCenter()),E=this.project(r),N=this.getSize(),rt=this._zoom;r=gi(r),h=h===void 0?rt:h;var pt=Math.max(N.x,N.y),wt=pt*this.getZoomScale(rt,h),xt=E.distanceTo(b)||1,Wt=1.42,ie=Wt*Wt;function me(ii){var sa=ii?-1:1,ss=ii?wt:pt,je=wt*wt-pt*pt+sa*ie*ie*xt*xt,Ki=2*ss*ie*xt,ls=je/Ki,_o=Math.sqrt(ls*ls+1)-ls,Rs=_o<1e-9?-18:Math.log(_o);return Rs}function zr(ii){return(Math.exp(ii)-Math.exp(-ii))/2}function Ur(ii){return(Math.exp(ii)+Math.exp(-ii))/2}function Nr(ii){return zr(ii)/Ur(ii)}var Si=me(0);function Oo(ii){return pt*(Ur(Si)/Ur(Si+Wt*ii))}function Qt(ii){return pt*(Ur(Si)*Nr(Si+Wt*ii)-zr(Si))/ie}function Xt(ii){return 1-Math.pow(1-ii,1.5)}var as=Date.now(),cr=(me(1)-Si)/Wt,xn=_.duration?1e3*_.duration:1e3*cr*.8;function Xi(){var ii=(Date.now()-as)/xn,sa=Xt(ii)*cr;ii<=1?(this._flyToFrame=li(Xi,this),this._move(this.unproject(b.add(E.subtract(b).multiplyBy(Qt(sa)/xt)),rt),this.getScaleZoom(pt/Oo(sa),rt),{flyTo:!0})):this._move(r,h)._moveEnd(!0)}return this._moveStart(!0,_.noMoveStart),Xi.call(this),this},flyToBounds:function(r,h){var _=this._getBoundsCenterZoom(r,h);return this.flyTo(_.center,_.zoom,h)},setMaxBounds:function(r){if(r=yi(r),r.isValid())this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds);else return this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds);return this.options.maxBounds=r,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)},setMinZoom:function(r){var h=this.options.minZoom;return this.options.minZoom=r,this._loaded&&h!==r&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(r):this},setMaxZoom:function(r){var h=this.options.maxZoom;return this.options.maxZoom=r,this._loaded&&h!==r&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(r):this},panInsideBounds:function(r,h){this._enforcingBounds=!0;var _=this.getCenter(),b=this._limitCenter(_,this._zoom,yi(r));return _.equals(b)||this.panTo(b,h),this._enforcingBounds=!1,this},panInside:function(r,h){h=h||{};var _=Ce(h.paddingTopLeft||h.padding||[0,0]),b=Ce(h.paddingBottomRight||h.padding||[0,0]),E=this.getCenter(),N=this.project(E),rt=this.project(r),pt=this.getPixelBounds(),wt=pt.getSize().divideBy(2),xt=Oi([pt.min.add(_),pt.max.subtract(b)]);if(!xt.contains(rt)){this._enforcingBounds=!0;var Wt=N.subtract(rt),ie=Ce(rt.x+Wt.x,rt.y+Wt.y);(rt.x<xt.min.x||rt.x>xt.max.x)&&(ie.x=N.x-Wt.x,Wt.x>0?ie.x+=wt.x-_.x:ie.x-=wt.x-b.x),(rt.y<xt.min.y||rt.y>xt.max.y)&&(ie.y=N.y-Wt.y,Wt.y>0?ie.y+=wt.y-_.y:ie.y-=wt.y-b.y),this.panTo(this.unproject(ie),h),this._enforcingBounds=!1}return this},invalidateSize:function(r){if(!this._loaded)return this;r=R({animate:!1,pan:!0},r===!0?{animate:!0}:r);var h=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var _=this.getSize(),b=h.divideBy(2).round(),E=_.divideBy(2).round(),N=b.subtract(E);return!N.x&&!N.y?this:(r.animate&&r.pan?this.panBy(N):(r.pan&&this._rawPanBy(N),this.fire("move"),r.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(u(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:h,newSize:_}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(r){if(r=this._locateOptions=R({timeout:1e4,watch:!1},r),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var h=u(this._handleGeolocationResponse,this),_=u(this._handleGeolocationError,this);return r.watch?this._locationWatchId=navigator.geolocation.watchPosition(h,_,r):navigator.geolocation.getCurrentPosition(h,_,r),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(r){var h=r.code,_=r.message||(h===1?"permission denied":h===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:h,message:"Geolocation error: "+_+"."})},_handleGeolocationResponse:function(r){var h=r.coords.latitude,_=r.coords.longitude,b=new Ve(h,_),E=b.toBounds(r.coords.accuracy*2),N=this._locateOptions;if(N.setView){var rt=this.getBoundsZoom(E);this.setView(b,N.maxZoom?Math.min(rt,N.maxZoom):rt)}var pt={latlng:b,bounds:E,timestamp:r.timestamp};for(var wt in r.coords)typeof r.coords[wt]=="number"&&(pt[wt]=r.coords[wt]);this.fire("locationfound",pt)},addHandler:function(r,h){if(!h)return this;var _=this[r]=new h(this);return this._handlers.push(_),this.options[r]&&_.enable(),this},remove:function(){if(this._initEvents(!0),this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),se(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(ji(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var r;for(r in this._layers)this._layers[r].remove();for(r in this._panes)se(this._panes[r]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(r,h){var _="leaflet-pane"+(r?" leaflet-"+r.replace("Pane","")+"-pane":""),b=Yt("div",_,h||this._mapPane);return r&&(this._panes[r]=b),b},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var r=this.getPixelBounds(),h=this.unproject(r.getBottomLeft()),_=this.unproject(r.getTopRight());return new Fi(h,_)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(r,h,_){r=yi(r),_=Ce(_||[0,0]);var b=this.getZoom()||0,E=this.getMinZoom(),N=this.getMaxZoom(),rt=r.getNorthWest(),pt=r.getSouthEast(),wt=this.getSize().subtract(_),xt=Oi(this.project(pt,b),this.project(rt,b)).getSize(),Wt=vr?this.options.zoomSnap:1,ie=wt.x/xt.x,me=wt.y/xt.y,zr=h?Math.max(ie,me):Math.min(ie,me);return b=this.getScaleZoom(zr,b),Wt&&(b=Math.round(b/(Wt/100))*(Wt/100),b=h?Math.ceil(b/Wt)*Wt:Math.floor(b/Wt)*Wt),Math.max(E,Math.min(N,b))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new de(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(r,h){var _=this._getTopLeftPoint(r,h);return new We(_,_.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(r){return this.options.crs.getProjectedBounds(r===void 0?this.getZoom():r)},getPane:function(r){return typeof r=="string"?this._panes[r]:r},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(r,h){var _=this.options.crs;return h=h===void 0?this._zoom:h,_.scale(r)/_.scale(h)},getScaleZoom:function(r,h){var _=this.options.crs;h=h===void 0?this._zoom:h;var b=_.zoom(r*_.scale(h));return isNaN(b)?1/0:b},project:function(r,h){return h=h===void 0?this._zoom:h,this.options.crs.latLngToPoint(gi(r),h)},unproject:function(r,h){return h=h===void 0?this._zoom:h,this.options.crs.pointToLatLng(Ce(r),h)},layerPointToLatLng:function(r){var h=Ce(r).add(this.getPixelOrigin());return this.unproject(h)},latLngToLayerPoint:function(r){var h=this.project(gi(r))._round();return h._subtract(this.getPixelOrigin())},wrapLatLng:function(r){return this.options.crs.wrapLatLng(gi(r))},wrapLatLngBounds:function(r){return this.options.crs.wrapLatLngBounds(yi(r))},distance:function(r,h){return this.options.crs.distance(gi(r),gi(h))},containerPointToLayerPoint:function(r){return Ce(r).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(r){return Ce(r).add(this._getMapPanePos())},containerPointToLatLng:function(r){var h=this.containerPointToLayerPoint(Ce(r));return this.layerPointToLatLng(h)},latLngToContainerPoint:function(r){return this.layerPointToContainerPoint(this.latLngToLayerPoint(gi(r)))},mouseEventToContainerPoint:function(r){return Un(r,this._container)},mouseEventToLayerPoint:function(r){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(r))},mouseEventToLatLng:function(r){return this.layerPointToLatLng(this.mouseEventToLayerPoint(r))},_initContainer:function(r){var h=this._container=xi(r);if(h){if(h._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ke(h,"scroll",this._onScroll,this),this._containerId=st(h)},_initLayout:function(){var r=this._container;this._fadeAnimated=this.options.fadeAnimation&&vr,Se(r,"leaflet-container"+(er?" leaflet-touch":"")+($e?" leaflet-retina":"")+(Pn?" leaflet-oldie":"")+($n?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var h=Oe(r,"position");h!=="absolute"&&h!=="relative"&&h!=="fixed"&&(r.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var r=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Qe(this._mapPane,new de(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Se(r.markerPane,"leaflet-zoom-hide"),Se(r.shadowPane,"leaflet-zoom-hide"))},_resetView:function(r,h){Qe(this._mapPane,new de(0,0));var _=!this._loaded;this._loaded=!0,h=this._limitZoom(h),this.fire("viewprereset");var b=this._zoom!==h;this._moveStart(b,!1)._move(r,h)._moveEnd(b),this.fire("viewreset"),_&&this.fire("load")},_moveStart:function(r,h){return r&&this.fire("zoomstart"),h||this.fire("movestart"),this},_move:function(r,h,_){h===void 0&&(h=this._zoom);var b=this._zoom!==h;return this._zoom=h,this._lastCenter=r,this._pixelOrigin=this._getNewPixelOrigin(r),(b||_&&_.pinch)&&this.fire("zoom",_),this.fire("move",_)},_moveEnd:function(r){return r&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return ji(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(r){Qe(this._mapPane,this._getMapPanePos().subtract(r))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(r){this._targets={},this._targets[st(this._container)]=this;var h=r?Ai:ke;h(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&h(window,"resize",this._onResize,this),vr&&this.options.transform3DLimit&&(r?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){ji(this._resizeRequest),this._resizeRequest=li(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var r=this._getMapPanePos();Math.max(Math.abs(r.x),Math.abs(r.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(r,h){for(var _=[],b,E=h==="mouseout"||h==="mouseover",N=r.target||r.srcElement,rt=!1;N;){if(b=this._targets[st(N)],b&&(h==="click"||h==="preclick")&&!r._simulated&&this._draggableMoved(b)){rt=!0;break}if(b&&b.listens(h,!0)&&(E&&!Ia(N,r)||(_.push(b),E))||N===this._container)break;N=N.parentNode}return!_.length&&!rt&&!E&&Ia(N,r)&&(_=[this]),_},_handleDOMEvent:function(r){if(!(!this._loaded||no(r))){var h=r.type;(h==="mousedown"||h==="keypress"||h==="keyup"||h==="keydown")&&Ts(r.target||r.srcElement),this._fireDOMEvent(r,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(r,h,_){if(r.type==="click"){var b=R({},r);b.type="preclick",this._fireDOMEvent(b,b.type,_)}if(!r._stopped&&(_=(_||[]).concat(this._findEventTargets(r,h)),!!_.length)){var E=_[0];h==="contextmenu"&&E.listens(h,!0)&&Hi(r);var N={originalEvent:r};if(r.type!=="keypress"&&r.type!=="keydown"&&r.type!=="keyup"){var rt=E.getLatLng&&(!E._radius||E._radius<=10);N.containerPoint=rt?this.latLngToContainerPoint(E.getLatLng()):this.mouseEventToContainerPoint(r),N.layerPoint=this.containerPointToLayerPoint(N.containerPoint),N.latlng=rt?E.getLatLng():this.layerPointToLatLng(N.layerPoint)}for(var pt=0;pt<_.length;pt++)if(_[pt].fire(h,N,!0),N.originalEvent._stopped||_[pt].options.bubblingMouseEvents===!1&&wo(this._mouseEvents,h)!==-1)return}},_draggableMoved:function(r){return r=r.dragging&&r.dragging.enabled()?r:this,r.dragging&&r.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var r=0,h=this._handlers.length;r<h;r++)this._handlers[r].disable()},whenReady:function(r,h){return this._loaded?r.call(h||this,{target:this}):this.on("load",r,h),this},_getMapPanePos:function(){return Ni(this._mapPane)||new de(0,0)},_moved:function(){var r=this._getMapPanePos();return r&&!r.equals([0,0])},_getTopLeftPoint:function(r,h){var _=r&&h!==void 0?this._getNewPixelOrigin(r,h):this.getPixelOrigin();return _.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(r,h){var _=this.getSize()._divideBy(2);return this.project(r,h)._subtract(_)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(r,h,_){var b=this._getNewPixelOrigin(_,h);return this.project(r,h)._subtract(b)},_latLngBoundsToNewLayerBounds:function(r,h,_){var b=this._getNewPixelOrigin(_,h);return Oi([this.project(r.getSouthWest(),h)._subtract(b),this.project(r.getNorthWest(),h)._subtract(b),this.project(r.getSouthEast(),h)._subtract(b),this.project(r.getNorthEast(),h)._subtract(b)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(r){return this.latLngToLayerPoint(r).subtract(this._getCenterLayerPoint())},_limitCenter:function(r,h,_){if(!_)return r;var b=this.project(r,h),E=this.getSize().divideBy(2),N=new We(b.subtract(E),b.add(E)),rt=this._getBoundsOffset(N,_,h);return rt.round().equals([0,0])?r:this.unproject(b.add(rt),h)},_limitOffset:function(r,h){if(!h)return r;var _=this.getPixelBounds(),b=new We(_.min.add(r),_.max.add(r));return r.add(this._getBoundsOffset(b,h))},_getBoundsOffset:function(r,h,_){var b=Oi(this.project(h.getNorthEast(),_),this.project(h.getSouthWest(),_)),E=b.min.subtract(r.min),N=b.max.subtract(r.max),rt=this._rebound(E.x,-N.x),pt=this._rebound(E.y,-N.y);return new de(rt,pt)},_rebound:function(r,h){return r+h>0?Math.round(r-h)/2:Math.max(0,Math.ceil(r))-Math.max(0,Math.floor(h))},_limitZoom:function(r){var h=this.getMinZoom(),_=this.getMaxZoom(),b=vr?this.options.zoomSnap:1;return b&&(r=Math.round(r/b)*b),Math.max(h,Math.min(_,r))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ui(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(r,h){var _=this._getCenterOffset(r)._trunc();return(h&&h.animate)!==!0&&!this.getSize().contains(_)?!1:(this.panBy(_,h),!0)},_createAnimProxy:function(){var r=this._proxy=Yt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(r),this.on("zoomanim",function(h){var _=Ie,b=this._proxy.style[_];He(this._proxy,this.project(h.center,h.zoom),this.getZoomScale(h.zoom,1)),b===this._proxy.style[_]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){se(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var r=this.getCenter(),h=this.getZoom();He(this._proxy,this.project(r,h),this.getZoomScale(h,1))},_catchTransitionEnd:function(r){this._animatingZoom&&r.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(r,h,_){if(this._animatingZoom)return!0;if(_=_||{},!this._zoomAnimated||_.animate===!1||this._nothingToAnimate()||Math.abs(h-this._zoom)>this.options.zoomAnimationThreshold)return!1;var b=this.getZoomScale(h),E=this._getCenterOffset(r)._divideBy(1-1/b);return _.animate!==!0&&!this.getSize().contains(E)?!1:(li(function(){this._moveStart(!0,!1)._animateZoom(r,h,!0)},this),!0)},_animateZoom:function(r,h,_,b){!this._mapPane||(_&&(this._animatingZoom=!0,this._animateToCenter=r,this._animateToZoom=h,Se(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:r,zoom:h,noUpdate:b}),setTimeout(u(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){!this._animatingZoom||(this._mapPane&&ui(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),li(function(){this._moveEnd(!0)},this))}});function Ps(r,h){return new Ue(r,h)}var Kr=Ei.extend({options:{position:"topright"},initialize:function(r){Je(this,r)},getPosition:function(){return this.options.position},setPosition:function(r){var h=this._map;return h&&h.removeControl(this),this.options.position=r,h&&h.addControl(this),this},getContainer:function(){return this._container},addTo:function(r){this.remove(),this._map=r;var h=this._container=this.onAdd(r),_=this.getPosition(),b=r._controlCorners[_];return Se(h,"leaflet-control"),_.indexOf("bottom")!==-1?b.insertBefore(h,b.firstChild):b.appendChild(h),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(se(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(r){this._map&&r&&r.screenX>0&&r.screenY>0&&this._map.getContainer().focus()}}),Ao=function(r){return new Kr(r)};Ue.include({addControl:function(r){return r.addTo(this),this},removeControl:function(r){return r.remove(),this},_initControlPos:function(){var r=this._controlCorners={},h="leaflet-",_=this._controlContainer=Yt("div",h+"control-container",this._container);function b(E,N){var rt=h+E+" "+h+N;r[E+N]=Yt("div",rt,_)}b("top","left"),b("top","right"),b("bottom","left"),b("bottom","right")},_clearControlPos:function(){for(var r in this._controlCorners)se(this._controlCorners[r]);se(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Is=Kr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(r,h,_,b){return _<b?-1:b<_?1:0}},initialize:function(r,h,_){Je(this,_),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var b in r)this._addLayer(r[b],b);for(b in h)this._addLayer(h[b],b,!0)},onAdd:function(r){this._initLayout(),this._update(),this._map=r,r.on("zoomend",this._checkDisabledLayers,this);for(var h=0;h<this._layers.length;h++)this._layers[h].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(r){return Kr.prototype.addTo.call(this,r),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(r,h){return this._addLayer(r,h),this._map?this._update():this},addOverlay:function(r,h){return this._addLayer(r,h,!0),this._map?this._update():this},removeLayer:function(r){r.off("add remove",this._onLayerChange,this);var h=this._getLayer(st(r));return h&&this._layers.splice(this._layers.indexOf(h),1),this._map?this._update():this},expand:function(){Se(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var r=this._map.getSize().y-(this._container.offsetTop+50);return r<this._section.clientHeight?(Se(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=r+"px"):ui(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ui(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var r="leaflet-control-layers",h=this._container=Yt("div",r),_=this.options.collapsed;h.setAttribute("aria-haspopup",!0),cn(h),Or(h);var b=this._section=Yt("section",r+"-list");_&&(this._map.on("click",this.collapse,this),In||ke(h,{mouseenter:this.expand,mouseleave:this.collapse},this));var E=this._layersLink=Yt("a",r+"-toggle",h);E.href="#",E.title="Layers",er?(ke(E,"click",Ar),ke(E,"click",this.expand,this)):ke(E,"focus",this.expand,this),_||this.expand(),this._baseLayersList=Yt("div",r+"-base",b),this._separator=Yt("div",r+"-separator",b),this._overlaysList=Yt("div",r+"-overlays",b),h.appendChild(b)},_getLayer:function(r){for(var h=0;h<this._layers.length;h++)if(this._layers[h]&&st(this._layers[h].layer)===r)return this._layers[h]},_addLayer:function(r,h,_){this._map&&r.on("add remove",this._onLayerChange,this),this._layers.push({layer:r,name:h,overlay:_}),this.options.sortLayers&&this._layers.sort(u(function(b,E){return this.options.sortFunction(b.layer,E.layer,b.name,E.name)},this)),this.options.autoZIndex&&r.setZIndex&&(this._lastZIndex++,r.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;ir(this._baseLayersList),ir(this._overlaysList),this._layerControlInputs=[];var r,h,_,b,E=0;for(_=0;_<this._layers.length;_++)b=this._layers[_],this._addItem(b),h=h||b.overlay,r=r||!b.overlay,E+=b.overlay?0:1;return this.options.hideSingleBase&&(r=r&&E>1,this._baseLayersList.style.display=r?"":"none"),this._separator.style.display=h&&r?"":"none",this},_onLayerChange:function(r){this._handlingClick||this._update();var h=this._getLayer(st(r.target)),_=h.overlay?r.type==="add"?"overlayadd":"overlayremove":r.type==="add"?"baselayerchange":null;_&&this._map.fire(_,h)},_createRadioElement:function(r,h){var _='<input type="radio" class="leaflet-control-layers-selector" name="'+r+'"'+(h?' checked="checked"':"")+"/>",b=document.createElement("div");return b.innerHTML=_,b.firstChild},_addItem:function(r){var h=document.createElement("label"),_=this._map.hasLayer(r.layer),b;r.overlay?(b=document.createElement("input"),b.type="checkbox",b.className="leaflet-control-layers-selector",b.defaultChecked=_):b=this._createRadioElement("leaflet-base-layers_"+st(this),_),this._layerControlInputs.push(b),b.layerId=st(r.layer),ke(b,"click",this._onInputClick,this);var E=document.createElement("span");E.innerHTML=" "+r.name;var N=document.createElement("div");h.appendChild(N),N.appendChild(b),N.appendChild(E);var rt=r.overlay?this._overlaysList:this._baseLayersList;return rt.appendChild(h),this._checkDisabledLayers(),h},_onInputClick:function(){var r=this._layerControlInputs,h,_,b=[],E=[];this._handlingClick=!0;for(var N=r.length-1;N>=0;N--)h=r[N],_=this._getLayer(h.layerId).layer,h.checked?b.push(_):h.checked||E.push(_);for(N=0;N<E.length;N++)this._map.hasLayer(E[N])&&this._map.removeLayer(E[N]);for(N=0;N<b.length;N++)this._map.hasLayer(b[N])||this._map.addLayer(b[N]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var r=this._layerControlInputs,h,_,b=this._map.getZoom(),E=r.length-1;E>=0;E--)h=r[E],_=this._getLayer(h.layerId).layer,h.disabled=_.options.minZoom!==void 0&&b<_.options.minZoom||_.options.maxZoom!==void 0&&b>_.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),Qs=function(r,h,_){return new Is(r,h,_)},Es=Kr.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(r){var h="leaflet-control-zoom",_=Yt("div",h+" leaflet-bar"),b=this.options;return this._zoomInButton=this._createButton(b.zoomInText,b.zoomInTitle,h+"-in",_,this._zoomIn),this._zoomOutButton=this._createButton(b.zoomOutText,b.zoomOutTitle,h+"-out",_,this._zoomOut),this._updateDisabled(),r.on("zoomend zoomlevelschange",this._updateDisabled,this),_},onRemove:function(r){r.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(r){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(r.shiftKey?3:1))},_zoomOut:function(r){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(r.shiftKey?3:1))},_createButton:function(r,h,_,b,E){var N=Yt("a",_,b);return N.innerHTML=r,N.href="#",N.title=h,N.setAttribute("role","button"),N.setAttribute("aria-label",h),cn(N),ke(N,"click",Ar),ke(N,"click",E,this),ke(N,"click",this._refocusOnMap,this),N},_updateDisabled:function(){var r=this._map,h="leaflet-disabled";ui(this._zoomInButton,h),ui(this._zoomOutButton,h),(this._disabled||r._zoom===r.getMinZoom())&&Se(this._zoomOutButton,h),(this._disabled||r._zoom===r.getMaxZoom())&&Se(this._zoomInButton,h)}});Ue.mergeOptions({zoomControl:!0}),Ue.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Es,this.addControl(this.zoomControl))});var Ea=function(r){return new Es(r)},Ho=Kr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(r){var h="leaflet-control-scale",_=Yt("div",h),b=this.options;return this._addScales(b,h+"-line",_),r.on(b.updateWhenIdle?"moveend":"move",this._update,this),r.whenReady(this._update,this),_},onRemove:function(r){r.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(r,h,_){r.metric&&(this._mScale=Yt("div",h,_)),r.imperial&&(this._iScale=Yt("div",h,_))},_update:function(){var r=this._map,h=r.getSize().y/2,_=r.distance(r.containerPointToLatLng([0,h]),r.containerPointToLatLng([this.options.maxWidth,h]));this._updateScales(_)},_updateScales:function(r){this.options.metric&&r&&this._updateMetric(r),this.options.imperial&&r&&this._updateImperial(r)},_updateMetric:function(r){var h=this._getRoundNum(r),_=h<1e3?h+" m":h/1e3+" km";this._updateScale(this._mScale,_,h/r)},_updateImperial:function(r){var h=r*3.2808399,_,b,E;h>5280?(_=h/5280,b=this._getRoundNum(_),this._updateScale(this._iScale,b+" mi",b/_)):(E=this._getRoundNum(h),this._updateScale(this._iScale,E+" ft",E/h))},_updateScale:function(r,h,_){r.style.width=Math.round(this.options.maxWidth*_)+"px",r.innerHTML=h},_getRoundNum:function(r){var h=Math.pow(10,(Math.floor(r)+"").length-1),_=r/h;return _=_>=10?10:_>=5?5:_>=3?3:_>=2?2:1,h*_}}),tl=function(r){return new Ho(r)},Vi=Kr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(r){Je(this,r),this._attributions={}},onAdd:function(r){r.attributionControl=this,this._container=Yt("div","leaflet-control-attribution"),cn(this._container);for(var h in r._layers)r._layers[h].getAttribution&&this.addAttribution(r._layers[h].getAttribution());return this._update(),this._container},setPrefix:function(r){return this.options.prefix=r,this._update(),this},addAttribution:function(r){return r?(this._attributions[r]||(this._attributions[r]=0),this._attributions[r]++,this._update(),this):this},removeAttribution:function(r){return r?(this._attributions[r]&&(this._attributions[r]--,this._update()),this):this},_update:function(){if(!!this._map){var r=[];for(var h in this._attributions)this._attributions[h]&&r.push(h);var _=[];this.options.prefix&&_.push(this.options.prefix),r.length&&_.push(r.join(", ")),this._container.innerHTML=_.join(" | ")}}});Ue.mergeOptions({attributionControl:!0}),Ue.addInitHook(function(){this.options.attributionControl&&new Vi().addTo(this)});var As=function(r){return new Vi(r)};Kr.Layers=Is,Kr.Zoom=Es,Kr.Scale=Ho,Kr.Attribution=Vi,Ao.layers=Qs,Ao.zoom=Ea,Ao.scale=tl,Ao.attribution=As;var hr=Ei.extend({initialize:function(r){this._map=r},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});hr.addTo=function(r,h){return r.addHandler(h,this),this};var oo={Events:Ti},ao=er?"touchstart mousedown":"mousedown",so={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Ln={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},Jr=Sn.extend({options:{clickTolerance:3},initialize:function(r,h,_,b){Je(this,b),this._element=r,this._dragStartTarget=h||r,this._preventOutline=_},enable:function(){this._enabled||(ke(this._dragStartTarget,ao,this._onDown,this),this._enabled=!0)},disable:function(){!this._enabled||(Jr._dragging===this&&this.finishDrag(),Ai(this._dragStartTarget,ao,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(r){if(!(r._simulated||!this._enabled)&&(this._moved=!1,!ur(this._element,"leaflet-zoom-anim")&&!(Jr._dragging||r.shiftKey||r.which!==1&&r.button!==1&&!r.touches)&&(Jr._dragging=this,this._preventOutline&&Ts(this._element),Zi(),Wo(),!this._moving))){this.fire("down");var h=r.touches?r.touches[0]:r,_=Xa(this._element);this._startPoint=new de(h.clientX,h.clientY),this._parentScale=Ss(_),ke(document,Ln[r.type],this._onMove,this),ke(document,so[r.type],this._onUp,this)}},_onMove:function(r){if(!(r._simulated||!this._enabled)){if(r.touches&&r.touches.length>1){this._moved=!0;return}var h=r.touches&&r.touches.length===1?r.touches[0]:r,_=new de(h.clientX,h.clientY)._subtract(this._startPoint);!_.x&&!_.y||Math.abs(_.x)+Math.abs(_.y)<this.options.clickTolerance||(_.x/=this._parentScale.x,_.y/=this._parentScale.y,Hi(r),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=Ni(this._element).subtract(_),Se(document.body,"leaflet-dragging"),this._lastTarget=r.target||r.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Se(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(_),this._moving=!0,ji(this._animRequest),this._lastEvent=r,this._animRequest=li(this._updatePosition,this,!0))}},_updatePosition:function(){var r={originalEvent:this._lastEvent};this.fire("predrag",r),Qe(this._element,this._newPos),this.fire("drag",r)},_onUp:function(r){r._simulated||!this._enabled||this.finishDrag()},finishDrag:function(){ui(document.body,"leaflet-dragging"),this._lastTarget&&(ui(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var r in Ln)Ai(document,Ln[r],this._onMove,this),Ai(document,so[r],this._onUp,this);un(),xr(),this._moved&&this._moving&&(ji(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,Jr._dragging=!1}});function lo(r,h){if(!h||!r.length)return r.slice();var _=h*h;return r=Vl(r,_),r=il(r,_),r}function Nn(r,h,_){return Math.sqrt(yn(r,h,_,!0))}function el(r,h,_){return yn(r,h,_)}function il(r,h){var _=r.length,b=typeof Uint8Array!=void 0+""?Uint8Array:Array,E=new b(_);E[0]=E[_-1]=1,Xe(r,E,h,0,_-1);var N,rt=[];for(N=0;N<_;N++)E[N]&&rt.push(r[N]);return rt}function Xe(r,h,_,b,E){var N=0,rt,pt,wt;for(pt=b+1;pt<=E-1;pt++)wt=yn(r[pt],r[b],r[E],!0),wt>N&&(rt=pt,N=wt);N>_&&(h[rt]=1,Xe(r,h,_,b,rt),Xe(r,h,_,rt,E))}function Vl(r,h){for(var _=[r[0]],b=1,E=0,N=r.length;b<N;b++)rl(r[b],r[E])>h&&(_.push(r[b]),E=b);return E<N-1&&_.push(r[N-1]),_}var Aa;function Cs(r,h,_,b,E){var N=b?Aa:uo(r,_),rt=uo(h,_),pt,wt,xt;for(Aa=rt;;){if(!(N|rt))return[r,h];if(N&rt)return!1;pt=N||rt,wt=Ca(r,h,pt,_,E),xt=uo(wt,_),pt===N?(r=wt,N=xt):(h=wt,rt=xt)}}function Ca(r,h,_,b,E){var N=h.x-r.x,rt=h.y-r.y,pt=b.min,wt=b.max,xt,Wt;return _&8?(xt=r.x+N*(wt.y-r.y)/rt,Wt=wt.y):_&4?(xt=r.x+N*(pt.y-r.y)/rt,Wt=pt.y):_&2?(xt=wt.x,Wt=r.y+rt*(wt.x-r.x)/N):_&1&&(xt=pt.x,Wt=r.y+rt*(pt.x-r.x)/N),new de(xt,Wt,E)}function uo(r,h){var _=0;return r.x<h.min.x?_|=1:r.x>h.max.x&&(_|=2),r.y<h.min.y?_|=4:r.y>h.max.y&&(_|=8),_}function rl(r,h){var _=h.x-r.x,b=h.y-r.y;return _*_+b*b}function yn(r,h,_,b){var E=h.x,N=h.y,rt=_.x-E,pt=_.y-N,wt=rt*rt+pt*pt,xt;return wt>0&&(xt=((r.x-E)*rt+(r.y-N)*pt)/wt,xt>1?(E=_.x,N=_.y):xt>0&&(E+=rt*xt,N+=pt*xt)),rt=r.x-E,pt=r.y-N,b?rt*rt+pt*pt:new de(E,N)}function wr(r){return!Gr(r[0])||typeof r[0][0]!="object"&&typeof r[0][0]!="undefined"}function ho(r){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),wr(r)}var nl={simplify:lo,pointToSegmentDistance:Nn,closestPointOnSegment:el,clipSegment:Cs,_getEdgeIntersection:Ca,_getBitCode:uo,_sqClosestPointOnSegment:yn,isFlat:wr,_flat:ho};function Ls(r,h,_){var b,E=[1,4,2,8],N,rt,pt,wt,xt,Wt,ie,me;for(N=0,Wt=r.length;N<Wt;N++)r[N]._code=uo(r[N],h);for(pt=0;pt<4;pt++){for(ie=E[pt],b=[],N=0,Wt=r.length,rt=Wt-1;N<Wt;rt=N++)wt=r[N],xt=r[rt],wt._code&ie?xt._code&ie||(me=Ca(xt,wt,ie,h,_),me._code=uo(me,h),b.push(me)):(xt._code&ie&&(me=Ca(xt,wt,ie,h,_),me._code=uo(me,h),b.push(me)),b.push(wt));r=b}return r}var zs={clipPolygon:Ls},Zn={project:function(r){return new de(r.lng,r.lat)},unproject:function(r){return new Ve(r.y,r.x)},bounds:new We([-180,-90],[180,90])},Ja={R:6378137,R_MINOR:6356752314245179e-9,bounds:new We([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(r){var h=Math.PI/180,_=this.R,b=r.lat*h,E=this.R_MINOR/_,N=Math.sqrt(1-E*E),rt=N*Math.sin(b),pt=Math.tan(Math.PI/4-b/2)/Math.pow((1-rt)/(1+rt),N/2);return b=-_*Math.log(Math.max(pt,1e-10)),new de(r.lng*h*_,b)},unproject:function(r){for(var h=180/Math.PI,_=this.R,b=this.R_MINOR/_,E=Math.sqrt(1-b*b),N=Math.exp(-r.y/_),rt=Math.PI/2-2*Math.atan(N),pt=0,wt=.1,xt;pt<15&&Math.abs(wt)>1e-7;pt++)xt=E*Math.sin(rt),xt=Math.pow((1-xt)/(1+xt),E/2),wt=Math.PI/2-2*Math.atan(N*xt)-rt,rt+=wt;return new Ve(rt*h,r.x*h/_)}},Co={LonLat:Zn,Mercator:Ja,SphericalMercator:sn},Lo=R({},_r,{code:"EPSG:3395",projection:Ja,transformation:function(){var r=.5/(Math.PI*Ja.R);return Pr(r,.5,-r,.5)}()}),ks=R({},_r,{code:"EPSG:4326",projection:Zn,transformation:Pr(1/180,1,-1/180,.5)}),La=R({},vi,{projection:Zn,transformation:Pr(1,0,-1,0),scale:function(r){return Math.pow(2,r)},zoom:function(r){return Math.log(r)/Math.LN2},distance:function(r,h){var _=h.lng-r.lng,b=h.lat-r.lat;return Math.sqrt(_*_+b*b)},infinite:!0});vi.Earth=_r,vi.EPSG3395=Lo,vi.EPSG3857=Te,vi.EPSG900913=Jn,vi.EPSG4326=ks,vi.Simple=La;var Le=Sn.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(r){return r.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(r){return r&&r.removeLayer(this),this},getPane:function(r){return this._map.getPane(r?this.options[r]||r:this.options.pane)},addInteractiveTarget:function(r){return this._map._targets[st(r)]=this,this},removeInteractiveTarget:function(r){return delete this._map._targets[st(r)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(r){var h=r.target;if(!!h.hasLayer(this)){if(this._map=h,this._zoomAnimated=h._zoomAnimated,this.getEvents){var _=this.getEvents();h.on(_,this),this.once("remove",function(){h.off(_,this)},this)}this.onAdd(h),this.getAttribution&&h.attributionControl&&h.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),h.fire("layeradd",{layer:this})}}});Ue.include({addLayer:function(r){if(!r._layerAdd)throw new Error("The provided object is not a Layer.");var h=st(r);return this._layers[h]?this:(this._layers[h]=r,r._mapToAdd=this,r.beforeAdd&&r.beforeAdd(this),this.whenReady(r._layerAdd,r),this)},removeLayer:function(r){var h=st(r);return this._layers[h]?(this._loaded&&r.onRemove(this),r.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(r.getAttribution()),delete this._layers[h],this._loaded&&(this.fire("layerremove",{layer:r}),r.fire("remove")),r._map=r._mapToAdd=null,this):this},hasLayer:function(r){return!!r&&st(r)in this._layers},eachLayer:function(r,h){for(var _ in this._layers)r.call(h,this._layers[_]);return this},_addLayers:function(r){r=r?Gr(r)?r:[r]:[];for(var h=0,_=r.length;h<_;h++)this.addLayer(r[h])},_addZoomLimit:function(r){(isNaN(r.options.maxZoom)||!isNaN(r.options.minZoom))&&(this._zoomBoundLayers[st(r)]=r,this._updateZoomLevels())},_removeZoomLimit:function(r){var h=st(r);this._zoomBoundLayers[h]&&(delete this._zoomBoundLayers[h],this._updateZoomLevels())},_updateZoomLevels:function(){var r=1/0,h=-1/0,_=this._getZoomSpan();for(var b in this._zoomBoundLayers){var E=this._zoomBoundLayers[b].options;r=E.minZoom===void 0?r:Math.min(r,E.minZoom),h=E.maxZoom===void 0?h:Math.max(h,E.maxZoom)}this._layersMaxZoom=h===-1/0?void 0:h,this._layersMinZoom=r===1/0?void 0:r,_!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Vn=Le.extend({initialize:function(r,h){Je(this,h),this._layers={};var _,b;if(r)for(_=0,b=r.length;_<b;_++)this.addLayer(r[_])},addLayer:function(r){var h=this.getLayerId(r);return this._layers[h]=r,this._map&&this._map.addLayer(r),this},removeLayer:function(r){var h=r in this._layers?r:this.getLayerId(r);return this._map&&this._layers[h]&&this._map.removeLayer(this._layers[h]),delete this._layers[h],this},hasLayer:function(r){if(!r)return!1;var h=typeof r=="number"?r:this.getLayerId(r);return h in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(r){var h=Array.prototype.slice.call(arguments,1),_,b;for(_ in this._layers)b=this._layers[_],b[r]&&b[r].apply(b,h);return this},onAdd:function(r){this.eachLayer(r.addLayer,r)},onRemove:function(r){this.eachLayer(r.removeLayer,r)},eachLayer:function(r,h){for(var _ in this._layers)r.call(h,this._layers[_]);return this},getLayer:function(r){return this._layers[r]},getLayers:function(){var r=[];return this.eachLayer(r.push,r),r},setZIndex:function(r){return this.invoke("setZIndex",r)},getLayerId:function(r){return st(r)}}),ql=function(r,h){return new Vn(r,h)},gn=Vn.extend({addLayer:function(r){return this.hasLayer(r)?this:(r.addEventParent(this),Vn.prototype.addLayer.call(this,r),this.fire("layeradd",{layer:r}))},removeLayer:function(r){return this.hasLayer(r)?(r in this._layers&&(r=this._layers[r]),r.removeEventParent(this),Vn.prototype.removeLayer.call(this,r),this.fire("layerremove",{layer:r})):this},setStyle:function(r){return this.invoke("setStyle",r)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var r=new Fi;for(var h in this._layers){var _=this._layers[h];r.extend(_.getBounds?_.getBounds():_.getLatLng())}return r}}),ol=function(r,h){return new gn(r,h)},Xo=Ei.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(r){Je(this,r)},createIcon:function(r){return this._createIcon("icon",r)},createShadow:function(r){return this._createIcon("shadow",r)},_createIcon:function(r,h){var _=this._getIconUrl(r);if(!_){if(r==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var b=this._createImg(_,h&&h.tagName==="IMG"?h:null);return this._setIconStyles(b,r),b},_setIconStyles:function(r,h){var _=this.options,b=_[h+"Size"];typeof b=="number"&&(b=[b,b]);var E=Ce(b),N=Ce(h==="shadow"&&_.shadowAnchor||_.iconAnchor||E&&E.divideBy(2,!0));r.className="leaflet-marker-"+h+" "+(_.className||""),N&&(r.style.marginLeft=-N.x+"px",r.style.marginTop=-N.y+"px"),E&&(r.style.width=E.x+"px",r.style.height=E.y+"px")},_createImg:function(r,h){return h=h||document.createElement("img"),h.src=r,h},_getIconUrl:function(r){return $e&&this.options[r+"RetinaUrl"]||this.options[r+"Url"]}});function al(r){return new Xo(r)}var co=Xo.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(r){return co.imagePath||(co.imagePath=this._detectIconPath()),(this.options.imagePath||co.imagePath)+Xo.prototype._getIconUrl.call(this,r)},_detectIconPath:function(){var r=Yt("div","leaflet-default-icon-path",document.body),h=Oe(r,"background-image")||Oe(r,"backgroundImage");return document.body.removeChild(r),h===null||h.indexOf("url")!==0?h="":h=h.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,""),h}}),zo=hr.extend({initialize:function(r){this._marker=r},addHooks:function(){var r=this._marker._icon;this._draggable||(this._draggable=new Jr(r,r,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Se(r,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ui(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(r){var h=this._marker,_=h._map,b=this._marker.options.autoPanSpeed,E=this._marker.options.autoPanPadding,N=Ni(h._icon),rt=_.getPixelBounds(),pt=_.getPixelOrigin(),wt=Oi(rt.min._subtract(pt).add(E),rt.max._subtract(pt).subtract(E));if(!wt.contains(N)){var xt=Ce((Math.max(wt.max.x,N.x)-wt.max.x)/(rt.max.x-wt.max.x)-(Math.min(wt.min.x,N.x)-wt.min.x)/(rt.min.x-wt.min.x),(Math.max(wt.max.y,N.y)-wt.max.y)/(rt.max.y-wt.max.y)-(Math.min(wt.min.y,N.y)-wt.min.y)/(rt.min.y-wt.min.y)).multiplyBy(b);_.panBy(xt,{animate:!1}),this._draggable._newPos._add(xt),this._draggable._startPos._add(xt),Qe(h._icon,this._draggable._newPos),this._onDrag(r),this._panRequest=li(this._adjustPan.bind(this,r))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(r){this._marker.options.autoPan&&(ji(this._panRequest),this._panRequest=li(this._adjustPan.bind(this,r)))},_onDrag:function(r){var h=this._marker,_=h._shadow,b=Ni(h._icon),E=h._map.layerPointToLatLng(b);_&&Qe(_,b),h._latlng=E,r.latlng=E,r.oldLatLng=this._oldLatLng,h.fire("move",r).fire("drag",r)},_onDragEnd:function(r){ji(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",r)}}),po=Le.extend({options:{icon:new co,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(r,h){Je(this,h),this._latlng=gi(r)},onAdd:function(r){this._zoomAnimated=this._zoomAnimated&&r.options.markerZoomAnimation,this._zoomAnimated&&r.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(r){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&r.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(r){var h=this._latlng;return this._latlng=gi(r),this.update(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},setZIndexOffset:function(r){return this.options.zIndexOffset=r,this.update()},getIcon:function(){return this.options.icon},setIcon:function(r){return this.options.icon=r,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var r=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(r)}return this},_initIcon:function(){var r=this.options,h="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),_=r.icon.createIcon(this._icon),b=!1;_!==this._icon&&(this._icon&&this._removeIcon(),b=!0,r.title&&(_.title=r.title),_.tagName==="IMG"&&(_.alt=r.alt||"")),Se(_,h),r.keyboard&&(_.tabIndex="0"),this._icon=_,r.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var E=r.icon.createShadow(this._shadow),N=!1;E!==this._shadow&&(this._removeShadow(),N=!0),E&&(Se(E,h),E.alt=""),this._shadow=E,r.opacity<1&&this._updateOpacity(),b&&this.getPane().appendChild(this._icon),this._initInteraction(),E&&N&&this.getPane(r.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),se(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&se(this._shadow),this._shadow=null},_setPos:function(r){this._icon&&Qe(this._icon,r),this._shadow&&Qe(this._shadow,r),this._zIndex=r.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(r){this._icon&&(this._icon.style.zIndex=this._zIndex+r)},_animateZoom:function(r){var h=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center).round();this._setPos(h)},_initInteraction:function(){if(!!this.options.interactive&&(Se(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),zo)){var r=this.options.draggable;this.dragging&&(r=this.dragging.enabled(),this.dragging.disable()),this.dragging=new zo(this),r&&this.dragging.enable()}},setOpacity:function(r){return this.options.opacity=r,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var r=this.options.opacity;this._icon&&ai(this._icon,r),this._shadow&&ai(this._shadow,r)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Ya(r,h){return new po(r,h)}var pn=Le.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(r){this._renderer=r.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(r){return Je(this,r),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&r&&Object.prototype.hasOwnProperty.call(r,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+this._renderer.options.tolerance}}),qn=pn.extend({options:{fill:!0,radius:10},initialize:function(r,h){Je(this,h),this._latlng=gi(r),this._radius=this.options.radius},setLatLng:function(r){var h=this._latlng;return this._latlng=gi(r),this.redraw(),this.fire("move",{oldLatLng:h,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(r){return this.options.radius=this._radius=r,this.redraw()},getRadius:function(){return this._radius},setStyle:function(r){var h=r&&r.radius||this._radius;return pn.prototype.setStyle.call(this,r),this.setRadius(h),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var r=this._radius,h=this._radiusY||r,_=this._clickTolerance(),b=[r+_,h+_];this._pxBounds=new We(this._point.subtract(b),this._point.add(b))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(r){return r.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function sl(r,h){return new qn(r,h)}var fo=qn.extend({initialize:function(r,h,_){if(typeof h=="number"&&(h=R({},_,{radius:h})),Je(this,h),this._latlng=gi(r),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(r){return this._mRadius=r,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var r=[this._radius,this._radiusY||this._radius];return new Fi(this._map.layerPointToLatLng(this._point.subtract(r)),this._map.layerPointToLatLng(this._point.add(r)))},setStyle:pn.prototype.setStyle,_project:function(){var r=this._latlng.lng,h=this._latlng.lat,_=this._map,b=_.options.crs;if(b.distance===_r.distance){var E=Math.PI/180,N=this._mRadius/_r.R/E,rt=_.project([h+N,r]),pt=_.project([h-N,r]),wt=rt.add(pt).divideBy(2),xt=_.unproject(wt).lat,Wt=Math.acos((Math.cos(N*E)-Math.sin(h*E)*Math.sin(xt*E))/(Math.cos(h*E)*Math.cos(xt*E)))/E;(isNaN(Wt)||Wt===0)&&(Wt=N/Math.cos(Math.PI/180*h)),this._point=wt.subtract(_.getPixelOrigin()),this._radius=isNaN(Wt)?0:wt.x-_.project([xt,r-Wt]).x,this._radiusY=wt.y-rt.y}else{var ie=b.unproject(b.project(this._latlng).subtract([this._mRadius,0]));this._point=_.latLngToLayerPoint(this._latlng),this._radius=this._point.x-_.latLngToLayerPoint(ie).x}this._updateBounds()}});function vn(r,h,_){return new fo(r,h,_)}var zn=pn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(r,h){Je(this,h),this._setLatLngs(r)},getLatLngs:function(){return this._latlngs},setLatLngs:function(r){return this._setLatLngs(r),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(r){for(var h=1/0,_=null,b=yn,E,N,rt=0,pt=this._parts.length;rt<pt;rt++)for(var wt=this._parts[rt],xt=1,Wt=wt.length;xt<Wt;xt++){E=wt[xt-1],N=wt[xt];var ie=b(r,E,N,!0);ie<h&&(h=ie,_=b(r,E,N))}return _&&(_.distance=Math.sqrt(h)),_},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var r,h,_,b,E,N,rt,pt=this._rings[0],wt=pt.length;if(!wt)return null;for(r=0,h=0;r<wt-1;r++)h+=pt[r].distanceTo(pt[r+1])/2;if(h===0)return this._map.layerPointToLatLng(pt[0]);for(r=0,b=0;r<wt-1;r++)if(E=pt[r],N=pt[r+1],_=E.distanceTo(N),b+=_,b>h)return rt=(b-h)/_,this._map.layerPointToLatLng([N.x-rt*(N.x-E.x),N.y-rt*(N.y-E.y)])},getBounds:function(){return this._bounds},addLatLng:function(r,h){return h=h||this._defaultShape(),r=gi(r),h.push(r),this._bounds.extend(r),this.redraw()},_setLatLngs:function(r){this._bounds=new Fi,this._latlngs=this._convertLatLngs(r)},_defaultShape:function(){return wr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(r){for(var h=[],_=wr(r),b=0,E=r.length;b<E;b++)_?(h[b]=gi(r[b]),this._bounds.extend(h[b])):h[b]=this._convertLatLngs(r[b]);return h},_project:function(){var r=new We;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,r),this._bounds.isValid()&&r.isValid()&&(this._rawPxBounds=r,this._updateBounds())},_updateBounds:function(){var r=this._clickTolerance(),h=new de(r,r);this._pxBounds=new We([this._rawPxBounds.min.subtract(h),this._rawPxBounds.max.add(h)])},_projectLatlngs:function(r,h,_){var b=r[0]instanceof Ve,E=r.length,N,rt;if(b){for(rt=[],N=0;N<E;N++)rt[N]=this._map.latLngToLayerPoint(r[N]),_.extend(rt[N]);h.push(rt)}else for(N=0;N<E;N++)this._projectLatlngs(r[N],h,_)},_clipPoints:function(){var r=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}var h=this._parts,_,b,E,N,rt,pt,wt;for(_=0,E=0,N=this._rings.length;_<N;_++)for(wt=this._rings[_],b=0,rt=wt.length;b<rt-1;b++)pt=Cs(wt[b],wt[b+1],r,b,!0),!!pt&&(h[E]=h[E]||[],h[E].push(pt[0]),(pt[1]!==wt[b+1]||b===rt-2)&&(h[E].push(pt[1]),E++))}},_simplifyPoints:function(){for(var r=this._parts,h=this.options.smoothFactor,_=0,b=r.length;_<b;_++)r[_]=lo(r[_],h)},_update:function(){!this._map||(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(r,h){var _,b,E,N,rt,pt,wt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(_=0,N=this._parts.length;_<N;_++)for(pt=this._parts[_],b=0,rt=pt.length,E=rt-1;b<rt;E=b++)if(!(!h&&b===0)&&Nn(r,pt[E],pt[b])<=wt)return!0;return!1}});function ll(r,h){return new zn(r,h)}zn._flat=ho;var ko=zn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var r,h,_,b,E,N,rt,pt,wt,xt=this._rings[0],Wt=xt.length;if(!Wt)return null;for(N=rt=pt=0,r=0,h=Wt-1;r<Wt;h=r++)_=xt[r],b=xt[h],E=_.y*b.x-b.y*_.x,rt+=(_.x+b.x)*E,pt+=(_.y+b.y)*E,N+=E*3;return N===0?wt=xt[0]:wt=[rt/N,pt/N],this._map.layerPointToLatLng(wt)},_convertLatLngs:function(r){var h=zn.prototype._convertLatLngs.call(this,r),_=h.length;return _>=2&&h[0]instanceof Ve&&h[0].equals(h[_-1])&&h.pop(),h},_setLatLngs:function(r){zn.prototype._setLatLngs.call(this,r),wr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return wr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var r=this._renderer._bounds,h=this.options.weight,_=new de(h,h);if(r=new We(r.min.subtract(_),r.max.add(_)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(r))){if(this.options.noClip){this._parts=this._rings;return}for(var b=0,E=this._rings.length,N;b<E;b++)N=Ls(this._rings[b],r,!0),N.length&&this._parts.push(N)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(r){var h=!1,_,b,E,N,rt,pt,wt,xt;if(!this._pxBounds||!this._pxBounds.contains(r))return!1;for(N=0,wt=this._parts.length;N<wt;N++)for(_=this._parts[N],rt=0,xt=_.length,pt=xt-1;rt<xt;pt=rt++)b=_[rt],E=_[pt],b.y>r.y!=E.y>r.y&&r.x<(E.x-b.x)*(r.y-b.y)/(E.y-b.y)+b.x&&(h=!h);return h||zn.prototype._containsPoint.call(this,r,!0)}});function Mo(r,h){return new ko(r,h)}var Yr=gn.extend({initialize:function(r,h){Je(this,h),this._layers={},r&&this.addData(r)},addData:function(r){var h=Gr(r)?r:r.features,_,b,E;if(h){for(_=0,b=h.length;_<b;_++)E=h[_],(E.geometries||E.geometry||E.features||E.coordinates)&&this.addData(E);return this}var N=this.options;if(N.filter&&!N.filter(r))return this;var rt=Ko(r,N);return rt?(rt.feature=za(r),rt.defaultOptions=rt.options,this.resetStyle(rt),N.onEachFeature&&N.onEachFeature(r,rt),this.addLayer(rt)):this},resetStyle:function(r){return r===void 0?this.eachLayer(this.resetStyle,this):(r.options=R({},r.defaultOptions),this._setLayerStyle(r,this.options.style),this)},setStyle:function(r){return this.eachLayer(function(h){this._setLayerStyle(h,r)},this)},_setLayerStyle:function(r,h){r.setStyle&&(typeof h=="function"&&(h=h(r.feature)),r.setStyle(h))}});function Ko(r,h){var _=r.type==="Feature"?r.geometry:r,b=_?_.coordinates:null,E=[],N=h&&h.pointToLayer,rt=h&&h.coordsToLatLng||Jo,pt,wt,xt,Wt;if(!b&&!_)return null;switch(_.type){case"Point":return pt=rt(b),$a(N,r,pt,h);case"MultiPoint":for(xt=0,Wt=b.length;xt<Wt;xt++)pt=rt(b[xt]),E.push($a(N,r,pt,h));return new gn(E);case"LineString":case"MultiLineString":return wt=Qa(b,_.type==="LineString"?0:1,rt),new zn(wt,h);case"Polygon":case"MultiPolygon":return wt=Qa(b,_.type==="Polygon"?1:2,rt),new ko(wt,h);case"GeometryCollection":for(xt=0,Wt=_.geometries.length;xt<Wt;xt++){var ie=Ko({geometry:_.geometries[xt],type:"Feature",properties:r.properties},h);ie&&E.push(ie)}return new gn(E);default:throw new Error("Invalid GeoJSON object.")}}function $a(r,h,_,b){return r?r(h,_):new po(_,b&&b.markersInheritOptions&&b)}function Jo(r){return new Ve(r[1],r[0],r[2])}function Qa(r,h,_){for(var b=[],E=0,N=r.length,rt;E<N;E++)rt=h?Qa(r[E],h-1,_):(_||Jo)(r[E]),b.push(rt);return b}function Yo(r,h){return h=typeof h=="number"?h:6,r.alt!==void 0?[Ct(r.lng,h),Ct(r.lat,h),Ct(r.alt,h)]:[Ct(r.lng,h),Ct(r.lat,h)]}function $o(r,h,_,b){for(var E=[],N=0,rt=r.length;N<rt;N++)E.push(h?$o(r[N],h-1,_,b):Yo(r[N],b));return!h&&_&&E.push(E[0]),E}function Do(r,h){return r.feature?R({},r.feature,{geometry:h}):za(h)}function za(r){return r.type==="Feature"||r.type==="FeatureCollection"?r:{type:"Feature",properties:{},geometry:r}}var Qo={toGeoJSON:function(r){return Do(this,{type:"Point",coordinates:Yo(this.getLatLng(),r)})}};po.include(Qo),fo.include(Qo),qn.include(Qo),zn.include({toGeoJSON:function(r){var h=!wr(this._latlngs),_=$o(this._latlngs,h?1:0,!1,r);return Do(this,{type:(h?"Multi":"")+"LineString",coordinates:_})}}),ko.include({toGeoJSON:function(r){var h=!wr(this._latlngs),_=h&&!wr(this._latlngs[0]),b=$o(this._latlngs,_?2:h?1:0,!0,r);return h||(b=[b]),Do(this,{type:(_?"Multi":"")+"Polygon",coordinates:b})}}),Vn.include({toMultiPoint:function(r){var h=[];return this.eachLayer(function(_){h.push(_.toGeoJSON(r).geometry.coordinates)}),Do(this,{type:"MultiPoint",coordinates:h})},toGeoJSON:function(r){var h=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(h==="MultiPoint")return this.toMultiPoint(r);var _=h==="GeometryCollection",b=[];return this.eachLayer(function(E){if(E.toGeoJSON){var N=E.toGeoJSON(r);if(_)b.push(N.geometry);else{var rt=za(N);rt.type==="FeatureCollection"?b.push.apply(b,rt.features):b.push(rt)}}}),_?Do(this,{geometries:b,type:"GeometryCollection"}):{type:"FeatureCollection",features:b}}});function ts(r,h){return new Yr(r,h)}var Ms=ts,ta=Le.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(r,h,_){this._url=r,this._bounds=yi(h),Je(this,_)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Se(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){se(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(r){return this.options.opacity=r,this._image&&this._updateOpacity(),this},setStyle:function(r){return r.opacity&&this.setOpacity(r.opacity),this},bringToFront:function(){return this._map&&An(this._image),this},bringToBack:function(){return this._map&&bi(this._image),this},setUrl:function(r){return this._url=r,this._image&&(this._image.src=r),this},setBounds:function(r){return this._bounds=yi(r),this._map&&this._reset(),this},getEvents:function(){var r={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var r=this._url.tagName==="IMG",h=this._image=r?this._url:Yt("img");if(Se(h,"leaflet-image-layer"),this._zoomAnimated&&Se(h,"leaflet-zoom-animated"),this.options.className&&Se(h,this.options.className),h.onselectstart=fe,h.onmousemove=fe,h.onload=u(this.fire,this,"load"),h.onerror=u(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),r){this._url=h.src;return}h.src=this._url,h.alt=this.options.alt},_animateZoom:function(r){var h=this._map.getZoomScale(r.zoom),_=this._map._latLngBoundsToNewLayerBounds(this._bounds,r.zoom,r.center).min;He(this._image,_,h)},_reset:function(){var r=this._image,h=new We(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),_=h.getSize();Qe(r,h.min),r.style.width=_.x+"px",r.style.height=_.y+"px"},_updateOpacity:function(){ai(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var r=this.options.errorOverlayUrl;r&&this._url!==r&&(this._url=r,this._image.src=r)}}),ka=function(r,h,_){return new ta(r,h,_)},Ds=ta.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1},_initImage:function(){var r=this._url.tagName==="VIDEO",h=this._image=r?this._url:Yt("video");if(Se(h,"leaflet-image-layer"),this._zoomAnimated&&Se(h,"leaflet-zoom-animated"),this.options.className&&Se(h,this.options.className),h.onselectstart=fe,h.onmousemove=fe,h.onloadeddata=u(this.fire,this,"load"),r){for(var _=h.getElementsByTagName("source"),b=[],E=0;E<_.length;E++)b.push(_[E].src);this._url=_.length>0?b:[h.src];return}Gr(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(h.style,"objectFit")&&(h.style.objectFit="fill"),h.autoplay=!!this.options.autoplay,h.loop=!!this.options.loop,h.muted=!!this.options.muted;for(var N=0;N<this._url.length;N++){var rt=Yt("source");rt.src=this._url[N],h.appendChild(rt)}}});function Bo(r,h,_){return new Ds(r,h,_)}var ni=ta.extend({_initImage:function(){var r=this._image=this._url;Se(r,"leaflet-image-layer"),this._zoomAnimated&&Se(r,"leaflet-zoom-animated"),this.options.className&&Se(r,this.options.className),r.onselectstart=fe,r.onmousemove=fe}});function es(r,h,_){return new ni(r,h,_)}var Cr=Le.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(r,h){Je(this,r),this._source=h},onAdd:function(r){this._zoomAnimated=r._zoomAnimated,this._container||this._initLayout(),r._fadeAnimated&&ai(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),r._fadeAnimated&&ai(this._container,1),this.bringToFront()},onRemove:function(r){r._fadeAnimated?(ai(this._container,0),this._removeTimeout=setTimeout(u(se,void 0,this._container),200)):se(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(r){return this._latlng=gi(r),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(r){return this._content=r,this.update(),this},getElement:function(){return this._container},update:function(){!this._map||(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var r={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&An(this._container),this},bringToBack:function(){return this._map&&bi(this._container),this},_prepareOpen:function(r,h,_){if(h instanceof Le||(_=h,h=r),h instanceof gn)for(var b in r._layers){h=r._layers[b];break}if(!_)if(h.getCenter)_=h.getCenter();else if(h.getLatLng)_=h.getLatLng();else throw new Error("Unable to get source layer LatLng.");return this._source=h,this.update(),_},_updateContent:function(){if(!!this._content){var r=this._contentNode,h=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof h=="string")r.innerHTML=h;else{for(;r.hasChildNodes();)r.removeChild(r.firstChild);r.appendChild(h)}this.fire("contentupdate")}},_updatePosition:function(){if(!!this._map){var r=this._map.latLngToLayerPoint(this._latlng),h=Ce(this.options.offset),_=this._getAnchor();this._zoomAnimated?Qe(this._container,r.add(_)):h=h.add(r).add(_);var b=this._containerBottom=-h.y,E=this._containerLeft=-Math.round(this._containerWidth/2)+h.x;this._container.style.bottom=b+"px",this._container.style.left=E+"px"}},_getAnchor:function(){return[0,0]}}),$r=Cr.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(r){return r.openPopup(this),this},onAdd:function(r){Cr.prototype.onAdd.call(this,r),r.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof pn||this._source.on("preclick",Cn))},onRemove:function(r){Cr.prototype.onRemove.call(this,r),r.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof pn||this._source.off("preclick",Cn))},getEvents:function(){var r=Cr.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(r.preclick=this._close),this.options.keepInView&&(r.moveend=this._adjustPan),r},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var r="leaflet-popup",h=this._container=Yt("div",r+" "+(this.options.className||"")+" leaflet-zoom-animated"),_=this._wrapper=Yt("div",r+"-content-wrapper",h);if(this._contentNode=Yt("div",r+"-content",_),cn(h),Or(this._contentNode),ke(h,"contextmenu",Cn),this._tipContainer=Yt("div",r+"-tip-container",h),this._tip=Yt("div",r+"-tip",this._tipContainer),this.options.closeButton){var b=this._closeButton=Yt("a",r+"-close-button",h);b.href="#close",b.innerHTML="&#215;",ke(b,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var r=this._contentNode,h=r.style;h.width="",h.whiteSpace="nowrap";var _=r.offsetWidth;_=Math.min(_,this.options.maxWidth),_=Math.max(_,this.options.minWidth),h.width=_+1+"px",h.whiteSpace="",h.height="";var b=r.offsetHeight,E=this.options.maxHeight,N="leaflet-popup-scrolled";E&&b>E?(h.height=E+"px",Se(r,N)):ui(r,N),this._containerWidth=this._container.offsetWidth},_animateZoom:function(r){var h=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center),_=this._getAnchor();Qe(this._container,h.add(_))},_adjustPan:function(){if(!!this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var r=this._map,h=parseInt(Oe(this._container,"marginBottom"),10)||0,_=this._container.offsetHeight+h,b=this._containerWidth,E=new de(this._containerLeft,-_-this._containerBottom);E._add(Ni(this._container));var N=r.layerPointToContainerPoint(E),rt=Ce(this.options.autoPanPadding),pt=Ce(this.options.autoPanPaddingTopLeft||rt),wt=Ce(this.options.autoPanPaddingBottomRight||rt),xt=r.getSize(),Wt=0,ie=0;N.x+b+wt.x>xt.x&&(Wt=N.x+b-xt.x+wt.x),N.x-Wt-pt.x<0&&(Wt=N.x-pt.x),N.y+_+wt.y>xt.y&&(ie=N.y+_-xt.y+wt.y),N.y-ie-pt.y<0&&(ie=N.y-pt.y),(Wt||ie)&&r.fire("autopanstart").panBy([Wt,ie])}},_onCloseButtonClick:function(r){this._close(),Ar(r)},_getAnchor:function(){return Ce(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ee=function(r,h){return new $r(r,h)};Ue.mergeOptions({closePopupOnClick:!0}),Ue.include({openPopup:function(r,h,_){return r instanceof $r||(r=new $r(_).setContent(r)),h&&r.setLatLng(h),this.hasLayer(r)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=r,this.addLayer(r))},closePopup:function(r){return(!r||r===this._popup)&&(r=this._popup,this._popup=null),r&&this.removeLayer(r),this}}),Le.include({bindPopup:function(r,h){return r instanceof $r?(Je(r,h),this._popup=r,r._source=this):((!this._popup||h)&&(this._popup=new $r(h,this)),this._popup.setContent(r)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(r,h){return this._popup&&this._map&&(h=this._popup._prepareOpen(this,r,h),this._map.openPopup(this._popup,h)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(r){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(r)),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(r){return this._popup&&this._popup.setContent(r),this},getPopup:function(){return this._popup},_openPopup:function(r){var h=r.layer||r.target;if(!!this._popup&&!!this._map){if(Ar(r),h instanceof pn){this.openPopup(r.layer||r.target,r.latlng);return}this._map.hasLayer(this._popup)&&this._popup._source===h?this.closePopup():this.openPopup(h,r.latlng)}},_movePopup:function(r){this._popup.setLatLng(r.latlng)},_onKeyPress:function(r){r.originalEvent.keyCode===13&&this._openPopup(r)}});var qe=Cr.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(r){Cr.prototype.onAdd.call(this,r),this.setOpacity(this.options.opacity),r.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(r){Cr.prototype.onRemove.call(this,r),r.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var r=Cr.prototype.getEvents.call(this);return er&&!this.options.permanent&&(r.preclick=this._close),r},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var r="leaflet-tooltip",h=r+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Yt("div",h)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(r){var h,_,b=this._map,E=this._container,N=b.latLngToContainerPoint(b.getCenter()),rt=b.layerPointToContainerPoint(r),pt=this.options.direction,wt=E.offsetWidth,xt=E.offsetHeight,Wt=Ce(this.options.offset),ie=this._getAnchor();pt==="top"?(h=wt/2,_=xt):pt==="bottom"?(h=wt/2,_=0):pt==="center"?(h=wt/2,_=xt/2):pt==="right"?(h=0,_=xt/2):pt==="left"?(h=wt,_=xt/2):rt.x<N.x?(pt="right",h=0,_=xt/2):(pt="left",h=wt+(Wt.x+ie.x)*2,_=xt/2),r=r.subtract(Ce(h,_,!0)).add(Wt).add(ie),ui(E,"leaflet-tooltip-right"),ui(E,"leaflet-tooltip-left"),ui(E,"leaflet-tooltip-top"),ui(E,"leaflet-tooltip-bottom"),Se(E,"leaflet-tooltip-"+pt),Qe(E,r)},_updatePosition:function(){var r=this._map.latLngToLayerPoint(this._latlng);this._setPosition(r)},setOpacity:function(r){this.options.opacity=r,this._container&&ai(this._container,r)},_animateZoom:function(r){var h=this._map._latLngToNewLayerPoint(this._latlng,r.zoom,r.center);this._setPosition(h)},_getAnchor:function(){return Ce(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Qr=function(r,h){return new qe(r,h)};Ue.include({openTooltip:function(r,h,_){return r instanceof qe||(r=new qe(_).setContent(r)),h&&r.setLatLng(h),this.hasLayer(r)?this:this.addLayer(r)},closeTooltip:function(r){return r&&this.removeLayer(r),this}}),Le.include({bindTooltip:function(r,h){return r instanceof qe?(Je(r,h),this._tooltip=r,r._source=this):((!this._tooltip||h)&&(this._tooltip=new qe(h,this)),this._tooltip.setContent(r)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(r){if(!(!r&&this._tooltipHandlersAdded)){var h=r?"off":"on",_={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?_.add=this._openTooltip:(_.mouseover=this._openTooltip,_.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(_.mousemove=this._moveTooltip),er&&(_.click=this._openTooltip)),this[h](_),this._tooltipHandlersAdded=!r}},openTooltip:function(r,h){return this._tooltip&&this._map&&(h=this._tooltip._prepareOpen(this,r,h),this._map.openTooltip(this._tooltip,h),this._tooltip.options.interactive&&this._tooltip._container&&(Se(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(ui(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(r){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(r)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(r){return this._tooltip&&this._tooltip.setContent(r),this},getTooltip:function(){return this._tooltip},_openTooltip:function(r){var h=r.layer||r.target;!this._tooltip||!this._map||this.openTooltip(h,this._tooltip.options.sticky?r.latlng:void 0)},_moveTooltip:function(r){var h=r.latlng,_,b;this._tooltip.options.sticky&&r.originalEvent&&(_=this._map.mouseEventToContainerPoint(r.originalEvent),b=this._map.containerPointToLayerPoint(_),h=this._map.layerPointToLatLng(b)),this._tooltip.setLatLng(h)}});var ea=Xo.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(r){var h=r&&r.tagName==="DIV"?r:document.createElement("div"),_=this.options;if(_.html instanceof Element?(ir(h),h.appendChild(_.html)):h.innerHTML=_.html!==!1?_.html:"",_.bgPos){var b=Ce(_.bgPos);h.style.backgroundPosition=-b.x+"px "+-b.y+"px"}return this._setIconStyles(h,"icon"),h},createShadow:function(){return null}});function ia(r){return new ea(r)}Xo.Default=co;var jn=Le.extend({options:{tileSize:256,opacity:1,updateWhenIdle:En,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(r){Je(this,r)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(r){r._addZoomLimit(this)},onRemove:function(r){this._removeAllTiles(),se(this._container),r._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(An(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(bi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(r){return this.options.opacity=r,this._updateOpacity(),this},setZIndex:function(r){return this.options.zIndex=r,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var r={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=Kt(this._onMoveEnd,this.options.updateInterval,this)),r.move=this._onMove),this._zoomAnimated&&(r.zoomanim=this._animateZoom),r},createTile:function(){return document.createElement("div")},getTileSize:function(){var r=this.options.tileSize;return r instanceof de?r:new de(r,r)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(r){for(var h=this.getPane().children,_=-r(-1/0,1/0),b=0,E=h.length,N;b<E;b++)N=h[b].style.zIndex,h[b]!==this._container&&N&&(_=r(_,+N));isFinite(_)&&(this.options.zIndex=_+r(-1,1),this._updateZIndex())},_updateOpacity:function(){if(!!this._map&&!Pn){ai(this._container,this.options.opacity);var r=+new Date,h=!1,_=!1;for(var b in this._tiles){var E=this._tiles[b];if(!(!E.current||!E.loaded)){var N=Math.min(1,(r-E.loaded)/200);ai(E.el,N),N<1?h=!0:(E.active?_=!0:this._onOpaqueTile(E),E.active=!0)}}_&&!this._noPrune&&this._pruneTiles(),h&&(ji(this._fadeFrame),this._fadeFrame=li(this._updateOpacity,this))}},_onOpaqueTile:fe,_initContainer:function(){this._container||(this._container=Yt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var r=this._tileZoom,h=this.options.maxZoom;if(r!==void 0){for(var _ in this._levels)_=Number(_),this._levels[_].el.children.length||_===r?(this._levels[_].el.style.zIndex=h-Math.abs(r-_),this._onUpdateLevel(_)):(se(this._levels[_].el),this._removeTilesAtZoom(_),this._onRemoveLevel(_),delete this._levels[_]);var b=this._levels[r],E=this._map;return b||(b=this._levels[r]={},b.el=Yt("div","leaflet-tile-container leaflet-zoom-animated",this._container),b.el.style.zIndex=h,b.origin=E.project(E.unproject(E.getPixelOrigin()),r).round(),b.zoom=r,this._setZoomTransform(b,E.getCenter(),E.getZoom()),fe(b.el.offsetWidth),this._onCreateLevel(b)),this._level=b,b}},_onUpdateLevel:fe,_onRemoveLevel:fe,_onCreateLevel:fe,_pruneTiles:function(){if(!!this._map){var r,h,_=this._map.getZoom();if(_>this.options.maxZoom||_<this.options.minZoom){this._removeAllTiles();return}for(r in this._tiles)h=this._tiles[r],h.retain=h.current;for(r in this._tiles)if(h=this._tiles[r],h.current&&!h.active){var b=h.coords;this._retainParent(b.x,b.y,b.z,b.z-5)||this._retainChildren(b.x,b.y,b.z,b.z+2)}for(r in this._tiles)this._tiles[r].retain||this._removeTile(r)}},_removeTilesAtZoom:function(r){for(var h in this._tiles)this._tiles[h].coords.z===r&&this._removeTile(h)},_removeAllTiles:function(){for(var r in this._tiles)this._removeTile(r)},_invalidateAll:function(){for(var r in this._levels)se(this._levels[r].el),this._onRemoveLevel(Number(r)),delete this._levels[r];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(r,h,_,b){var E=Math.floor(r/2),N=Math.floor(h/2),rt=_-1,pt=new de(+E,+N);pt.z=+rt;var wt=this._tileCoordsToKey(pt),xt=this._tiles[wt];return xt&&xt.active?(xt.retain=!0,!0):(xt&&xt.loaded&&(xt.retain=!0),rt>b?this._retainParent(E,N,rt,b):!1)},_retainChildren:function(r,h,_,b){for(var E=2*r;E<2*r+2;E++)for(var N=2*h;N<2*h+2;N++){var rt=new de(E,N);rt.z=_+1;var pt=this._tileCoordsToKey(rt),wt=this._tiles[pt];if(wt&&wt.active){wt.retain=!0;continue}else wt&&wt.loaded&&(wt.retain=!0);_+1<b&&this._retainChildren(E,N,_+1,b)}},_resetView:function(r){var h=r&&(r.pinch||r.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),h,h)},_animateZoom:function(r){this._setView(r.center,r.zoom,!0,r.noUpdate)},_clampZoom:function(r){var h=this.options;return h.minNativeZoom!==void 0&&r<h.minNativeZoom?h.minNativeZoom:h.maxNativeZoom!==void 0&&h.maxNativeZoom<r?h.maxNativeZoom:r},_setView:function(r,h,_,b){var E=Math.round(h);this.options.maxZoom!==void 0&&E>this.options.maxZoom||this.options.minZoom!==void 0&&E<this.options.minZoom?E=void 0:E=this._clampZoom(E);var N=this.options.updateWhenZooming&&E!==this._tileZoom;(!b||N)&&(this._tileZoom=E,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),E!==void 0&&this._update(r),_||this._pruneTiles(),this._noPrune=!!_),this._setZoomTransforms(r,h)},_setZoomTransforms:function(r,h){for(var _ in this._levels)this._setZoomTransform(this._levels[_],r,h)},_setZoomTransform:function(r,h,_){var b=this._map.getZoomScale(_,r.zoom),E=r.origin.multiplyBy(b).subtract(this._map._getNewPixelOrigin(h,_)).round();vr?He(r.el,E,b):Qe(r.el,E)},_resetGrid:function(){var r=this._map,h=r.options.crs,_=this._tileSize=this.getTileSize(),b=this._tileZoom,E=this._map.getPixelWorldBounds(this._tileZoom);E&&(this._globalTileRange=this._pxBoundsToTileRange(E)),this._wrapX=h.wrapLng&&!this.options.noWrap&&[Math.floor(r.project([0,h.wrapLng[0]],b).x/_.x),Math.ceil(r.project([0,h.wrapLng[1]],b).x/_.y)],this._wrapY=h.wrapLat&&!this.options.noWrap&&[Math.floor(r.project([h.wrapLat[0],0],b).y/_.x),Math.ceil(r.project([h.wrapLat[1],0],b).y/_.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(r){var h=this._map,_=h._animatingZoom?Math.max(h._animateToZoom,h.getZoom()):h.getZoom(),b=h.getZoomScale(_,this._tileZoom),E=h.project(r,this._tileZoom).floor(),N=h.getSize().divideBy(b*2);return new We(E.subtract(N),E.add(N))},_update:function(r){var h=this._map;if(!!h){var _=this._clampZoom(h.getZoom());if(r===void 0&&(r=h.getCenter()),this._tileZoom!==void 0){var b=this._getTiledPixelBounds(r),E=this._pxBoundsToTileRange(b),N=E.getCenter(),rt=[],pt=this.options.keepBuffer,wt=new We(E.getBottomLeft().subtract([pt,-pt]),E.getTopRight().add([pt,-pt]));if(!(isFinite(E.min.x)&&isFinite(E.min.y)&&isFinite(E.max.x)&&isFinite(E.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var xt in this._tiles){var Wt=this._tiles[xt].coords;(Wt.z!==this._tileZoom||!wt.contains(new de(Wt.x,Wt.y)))&&(this._tiles[xt].current=!1)}if(Math.abs(_-this._tileZoom)>1){this._setView(r,_);return}for(var ie=E.min.y;ie<=E.max.y;ie++)for(var me=E.min.x;me<=E.max.x;me++){var zr=new de(me,ie);if(zr.z=this._tileZoom,!!this._isValidTile(zr)){var Ur=this._tiles[this._tileCoordsToKey(zr)];Ur?Ur.current=!0:rt.push(zr)}}if(rt.sort(function(Si,Oo){return Si.distanceTo(N)-Oo.distanceTo(N)}),rt.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Nr=document.createDocumentFragment();for(me=0;me<rt.length;me++)this._addTile(rt[me],Nr);this._level.el.appendChild(Nr)}}}},_isValidTile:function(r){var h=this._map.options.crs;if(!h.infinite){var _=this._globalTileRange;if(!h.wrapLng&&(r.x<_.min.x||r.x>_.max.x)||!h.wrapLat&&(r.y<_.min.y||r.y>_.max.y))return!1}if(!this.options.bounds)return!0;var b=this._tileCoordsToBounds(r);return yi(this.options.bounds).overlaps(b)},_keyToBounds:function(r){return this._tileCoordsToBounds(this._keyToTileCoords(r))},_tileCoordsToNwSe:function(r){var h=this._map,_=this.getTileSize(),b=r.scaleBy(_),E=b.add(_),N=h.unproject(b,r.z),rt=h.unproject(E,r.z);return[N,rt]},_tileCoordsToBounds:function(r){var h=this._tileCoordsToNwSe(r),_=new Fi(h[0],h[1]);return this.options.noWrap||(_=this._map.wrapLatLngBounds(_)),_},_tileCoordsToKey:function(r){return r.x+":"+r.y+":"+r.z},_keyToTileCoords:function(r){var h=r.split(":"),_=new de(+h[0],+h[1]);return _.z=+h[2],_},_removeTile:function(r){var h=this._tiles[r];!h||(se(h.el),delete this._tiles[r],this.fire("tileunload",{tile:h.el,coords:this._keyToTileCoords(r)}))},_initTile:function(r){Se(r,"leaflet-tile");var h=this.getTileSize();r.style.width=h.x+"px",r.style.height=h.y+"px",r.onselectstart=fe,r.onmousemove=fe,Pn&&this.options.opacity<1&&ai(r,this.options.opacity),In&&!gr&&(r.style.WebkitBackfaceVisibility="hidden")},_addTile:function(r,h){var _=this._getTilePos(r),b=this._tileCoordsToKey(r),E=this.createTile(this._wrapCoords(r),u(this._tileReady,this,r));this._initTile(E),this.createTile.length<2&&li(u(this._tileReady,this,r,null,E)),Qe(E,_),this._tiles[b]={el:E,coords:r,current:!0},h.appendChild(E),this.fire("tileloadstart",{tile:E,coords:r})},_tileReady:function(r,h,_){h&&this.fire("tileerror",{error:h,tile:_,coords:r});var b=this._tileCoordsToKey(r);_=this._tiles[b],!!_&&(_.loaded=+new Date,this._map._fadeAnimated?(ai(_.el,0),ji(this._fadeFrame),this._fadeFrame=li(this._updateOpacity,this)):(_.active=!0,this._pruneTiles()),h||(Se(_.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:_.el,coords:r})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Pn||!this._map._fadeAnimated?li(this._pruneTiles,this):setTimeout(u(this._pruneTiles,this),250)))},_getTilePos:function(r){return r.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(r){var h=new de(this._wrapX?Vt(r.x,this._wrapX):r.x,this._wrapY?Vt(r.y,this._wrapY):r.y);return h.z=r.z,h},_pxBoundsToTileRange:function(r){var h=this.getTileSize();return new We(r.min.unscaleBy(h).floor(),r.max.unscaleBy(h).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var r in this._tiles)if(!this._tiles[r].loaded)return!1;return!0}});function jl(r){return new jn(r)}var ra=jn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(r,h){this._url=r,h=Je(this,h),h.detectRetina&&$e&&h.maxZoom>0&&(h.tileSize=Math.floor(h.tileSize/2),h.zoomReverse?(h.zoomOffset--,h.minZoom++):(h.zoomOffset++,h.maxZoom--),h.minZoom=Math.max(0,h.minZoom)),typeof h.subdomains=="string"&&(h.subdomains=h.subdomains.split("")),In||this.on("tileunload",this._onTileRemove)},setUrl:function(r,h){return this._url===r&&h===void 0&&(h=!0),this._url=r,h||this.redraw(),this},createTile:function(r,h){var _=document.createElement("img");return ke(_,"load",u(this._tileOnLoad,this,h,_)),ke(_,"error",u(this._tileOnError,this,h,_)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(_.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),_.alt="",_.setAttribute("role","presentation"),_.src=this.getTileUrl(r),_},getTileUrl:function(r){var h={r:$e?"@2x":"",s:this._getSubdomain(r),x:r.x,y:r.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var _=this._globalTileRange.max.y-r.y;this.options.tms&&(h.y=_),h["-y"]=_}return ki(this._url,R(h,this.options))},_tileOnLoad:function(r,h){Pn?setTimeout(u(r,this,null,h),0):r(null,h)},_tileOnError:function(r,h,_){var b=this.options.errorTileUrl;b&&h.getAttribute("src")!==b&&(h.src=b),r(_,h)},_onTileRemove:function(r){r.tile.onload=null},_getZoomForUrl:function(){var r=this._tileZoom,h=this.options.maxZoom,_=this.options.zoomReverse,b=this.options.zoomOffset;return _&&(r=h-r),r+b},_getSubdomain:function(r){var h=Math.abs(r.x+r.y)%this.options.subdomains.length;return this.options.subdomains[h]},_abortLoading:function(){var r,h;for(r in this._tiles)this._tiles[r].coords.z!==this._tileZoom&&(h=this._tiles[r].el,h.onload=fe,h.onerror=fe,h.complete||(h.src=an,se(h),delete this._tiles[r]))},_removeTile:function(r){var h=this._tiles[r];if(!!h)return Yn||h.el.setAttribute("src",an),jn.prototype._removeTile.call(this,r)},_tileReady:function(r,h,_){if(!(!this._map||_&&_.getAttribute("src")===an))return jn.prototype._tileReady.call(this,r,h,_)}});function na(r,h){return new ra(r,h)}var oa=ra.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(r,h){this._url=r;var _=R({},this.defaultWmsParams);for(var b in h)b in this.options||(_[b]=h[b]);h=Je(this,h);var E=h.detectRetina&&$e?2:1,N=this.getTileSize();_.width=N.x*E,_.height=N.y*E,this.wmsParams=_},onAdd:function(r){this._crs=this.options.crs||r.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var h=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[h]=this._crs.code,ra.prototype.onAdd.call(this,r)},getTileUrl:function(r){var h=this._tileCoordsToNwSe(r),_=this._crs,b=Oi(_.project(h[0]),_.project(h[1])),E=b.min,N=b.max,rt=(this._wmsVersion>=1.3&&this._crs===ks?[E.y,E.x,N.y,N.x]:[E.x,E.y,N.x,N.y]).join(","),pt=ra.prototype.getTileUrl.call(this,r);return pt+lr(this.wmsParams,pt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+rt},setParams:function(r,h){return R(this.wmsParams,r),h||this.redraw(),this}});function Gn(r,h){return new oa(r,h)}ra.WMS=oa,na.wms=Gn;var ti=Le.extend({options:{padding:.1,tolerance:0},initialize:function(r){Je(this,r),st(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&Se(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var r={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(r.zoomanim=this._onAnimZoom),r},_onAnimZoom:function(r){this._updateTransform(r.center,r.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(r,h){var _=this._map.getZoomScale(h,this._zoom),b=Ni(this._container),E=this._map.getSize().multiplyBy(.5+this.options.padding),N=this._map.project(this._center,h),rt=this._map.project(r,h),pt=rt.subtract(N),wt=E.multiplyBy(-_).add(b).add(E).subtract(pt);vr?He(this._container,wt,_):Qe(this._container,wt)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var r in this._layers)this._layers[r]._reset()},_onZoomEnd:function(){for(var r in this._layers)this._layers[r]._project()},_updatePaths:function(){for(var r in this._layers)this._layers[r]._update()},_update:function(){var r=this.options.padding,h=this._map.getSize(),_=this._map.containerPointToLayerPoint(h.multiplyBy(-r)).round();this._bounds=new We(_,_.add(h.multiplyBy(1+r*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),aa=ti.extend({getEvents:function(){var r=ti.prototype.getEvents.call(this);return r.viewprereset=this._onViewPreReset,r},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ti.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var r=this._container=document.createElement("canvas");ke(r,"mousemove",this._onMouseMove,this),ke(r,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ke(r,"mouseout",this._handleMouseOut,this),this._ctx=r.getContext("2d")},_destroyContainer:function(){ji(this._redrawRequest),delete this._ctx,se(this._container),Ai(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var r;this._redrawBounds=null;for(var h in this._layers)r=this._layers[h],r._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ti.prototype._update.call(this);var r=this._bounds,h=this._container,_=r.getSize(),b=$e?2:1;Qe(h,r.min),h.width=b*_.x,h.height=b*_.y,h.style.width=_.x+"px",h.style.height=_.y+"px",$e&&this._ctx.scale(2,2),this._ctx.translate(-r.min.x,-r.min.y),this.fire("update")}},_reset:function(){ti.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(r){this._updateDashArray(r),this._layers[st(r)]=r;var h=r._order={layer:r,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=h),this._drawLast=h,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(r){this._requestRedraw(r)},_removePath:function(r){var h=r._order,_=h.next,b=h.prev;_?_.prev=b:this._drawLast=b,b?b.next=_:this._drawFirst=_,delete r._order,delete this._layers[st(r)],this._requestRedraw(r)},_updatePath:function(r){this._extendRedrawBounds(r),r._project(),r._update(),this._requestRedraw(r)},_updateStyle:function(r){this._updateDashArray(r),this._requestRedraw(r)},_updateDashArray:function(r){if(typeof r.options.dashArray=="string"){var h=r.options.dashArray.split(/[, ]+/),_=[],b,E;for(E=0;E<h.length;E++){if(b=Number(h[E]),isNaN(b))return;_.push(b)}r.options._dashArray=_}else r.options._dashArray=r.options.dashArray},_requestRedraw:function(r){!this._map||(this._extendRedrawBounds(r),this._redrawRequest=this._redrawRequest||li(this._redraw,this))},_extendRedrawBounds:function(r){if(r._pxBounds){var h=(r.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new We,this._redrawBounds.extend(r._pxBounds.min.subtract([h,h])),this._redrawBounds.extend(r._pxBounds.max.add([h,h]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var r=this._redrawBounds;if(r){var h=r.getSize();this._ctx.clearRect(r.min.x,r.min.y,h.x,h.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var r,h=this._redrawBounds;if(this._ctx.save(),h){var _=h.getSize();this._ctx.beginPath(),this._ctx.rect(h.min.x,h.min.y,_.x,_.y),this._ctx.clip()}this._drawing=!0;for(var b=this._drawFirst;b;b=b.next)r=b.layer,(!h||r._pxBounds&&r._pxBounds.intersects(h))&&r._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(r,h){if(!!this._drawing){var _,b,E,N,rt=r._parts,pt=rt.length,wt=this._ctx;if(!!pt){for(wt.beginPath(),_=0;_<pt;_++){for(b=0,E=rt[_].length;b<E;b++)N=rt[_][b],wt[b?"lineTo":"moveTo"](N.x,N.y);h&&wt.closePath()}this._fillStroke(wt,r)}}},_updateCircle:function(r){if(!(!this._drawing||r._empty())){var h=r._point,_=this._ctx,b=Math.max(Math.round(r._radius),1),E=(Math.max(Math.round(r._radiusY),1)||b)/b;E!==1&&(_.save(),_.scale(1,E)),_.beginPath(),_.arc(h.x,h.y/E,b,0,Math.PI*2,!1),E!==1&&_.restore(),this._fillStroke(_,r)}},_fillStroke:function(r,h){var _=h.options;_.fill&&(r.globalAlpha=_.fillOpacity,r.fillStyle=_.fillColor||_.color,r.fill(_.fillRule||"evenodd")),_.stroke&&_.weight!==0&&(r.setLineDash&&r.setLineDash(h.options&&h.options._dashArray||[]),r.globalAlpha=_.opacity,r.lineWidth=_.weight,r.strokeStyle=_.color,r.lineCap=_.lineCap,r.lineJoin=_.lineJoin,r.stroke())},_onClick:function(r){for(var h=this._map.mouseEventToLayerPoint(r),_,b,E=this._drawFirst;E;E=E.next)_=E.layer,_.options.interactive&&_._containsPoint(h)&&(!(r.type==="click"||r.type!=="preclick")||!this._map._draggableMoved(_))&&(b=_);b&&(wi(r),this._fireEvent([b],r))},_onMouseMove:function(r){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var h=this._map.mouseEventToLayerPoint(r);this._handleMouseHover(r,h)}},_handleMouseOut:function(r){var h=this._hoveredLayer;h&&(ui(this._container,"leaflet-interactive"),this._fireEvent([h],r,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(r,h){if(!this._mouseHoverThrottled){for(var _,b,E=this._drawFirst;E;E=E.next)_=E.layer,_.options.interactive&&_._containsPoint(h)&&(b=_);b!==this._hoveredLayer&&(this._handleMouseOut(r),b&&(Se(this._container,"leaflet-interactive"),this._fireEvent([b],r,"mouseover"),this._hoveredLayer=b)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],r),this._mouseHoverThrottled=!0,setTimeout(u(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(r,h,_){this._map._fireDOMEvent(h,_||h.type,r)},_bringToFront:function(r){var h=r._order;if(!!h){var _=h.next,b=h.prev;if(_)_.prev=b;else return;b?b.next=_:_&&(this._drawFirst=_),h.prev=this._drawLast,this._drawLast.next=h,h.next=null,this._drawLast=h,this._requestRedraw(r)}},_bringToBack:function(r){var h=r._order;if(!!h){var _=h.next,b=h.prev;if(b)b.next=_;else return;_?_.prev=b:b&&(this._drawLast=b),h.prev=null,h.next=this._drawFirst,this._drawFirst.prev=h,this._drawFirst=h,this._requestRedraw(r)}}});function Bs(r){return D?new aa(r):null}var hi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(r){return document.createElement("<lvml:"+r+' class="lvml">')}}catch{return function(h){return document.createElement("<"+h+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),jt={_initContainer:function(){this._container=Yt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ti.prototype._update.call(this),this.fire("update"))},_initPath:function(r){var h=r._container=hi("shape");Se(h,"leaflet-vml-shape "+(this.options.className||"")),h.coordsize="1 1",r._path=hi("path"),h.appendChild(r._path),this._updateStyle(r),this._layers[st(r)]=r},_addPath:function(r){var h=r._container;this._container.appendChild(h),r.options.interactive&&r.addInteractiveTarget(h)},_removePath:function(r){var h=r._container;se(h),r.removeInteractiveTarget(h),delete this._layers[st(r)]},_updateStyle:function(r){var h=r._stroke,_=r._fill,b=r.options,E=r._container;E.stroked=!!b.stroke,E.filled=!!b.fill,b.stroke?(h||(h=r._stroke=hi("stroke")),E.appendChild(h),h.weight=b.weight+"px",h.color=b.color,h.opacity=b.opacity,b.dashArray?h.dashStyle=Gr(b.dashArray)?b.dashArray.join(" "):b.dashArray.replace(/( *, *)/g," "):h.dashStyle="",h.endcap=b.lineCap.replace("butt","flat"),h.joinstyle=b.lineJoin):h&&(E.removeChild(h),r._stroke=null),b.fill?(_||(_=r._fill=hi("fill")),E.appendChild(_),_.color=b.fillColor||b.color,_.opacity=b.fillOpacity):_&&(E.removeChild(_),r._fill=null)},_updateCircle:function(r){var h=r._point.round(),_=Math.round(r._radius),b=Math.round(r._radiusY||_);this._setPath(r,r._empty()?"M0 0":"AL "+h.x+","+h.y+" "+_+","+b+" 0,"+65535*360)},_setPath:function(r,h){r._path.v=h},_bringToFront:function(r){An(r._container)},_bringToBack:function(r){bi(r._container)}},Tr=j?hi:yr,mo=ti.extend({getEvents:function(){var r=ti.prototype.getEvents.call(this);return r.zoomstart=this._onZoomStart,r},_initContainer:function(){this._container=Tr("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Tr("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){se(this._container),Ai(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ti.prototype._update.call(this);var r=this._bounds,h=r.getSize(),_=this._container;(!this._svgSize||!this._svgSize.equals(h))&&(this._svgSize=h,_.setAttribute("width",h.x),_.setAttribute("height",h.y)),Qe(_,r.min),_.setAttribute("viewBox",[r.min.x,r.min.y,h.x,h.y].join(" ")),this.fire("update")}},_initPath:function(r){var h=r._path=Tr("path");r.options.className&&Se(h,r.options.className),r.options.interactive&&Se(h,"leaflet-interactive"),this._updateStyle(r),this._layers[st(r)]=r},_addPath:function(r){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(r._path),r.addInteractiveTarget(r._path)},_removePath:function(r){se(r._path),r.removeInteractiveTarget(r._path),delete this._layers[st(r)]},_updatePath:function(r){r._project(),r._update()},_updateStyle:function(r){var h=r._path,_=r.options;!h||(_.stroke?(h.setAttribute("stroke",_.color),h.setAttribute("stroke-opacity",_.opacity),h.setAttribute("stroke-width",_.weight),h.setAttribute("stroke-linecap",_.lineCap),h.setAttribute("stroke-linejoin",_.lineJoin),_.dashArray?h.setAttribute("stroke-dasharray",_.dashArray):h.removeAttribute("stroke-dasharray"),_.dashOffset?h.setAttribute("stroke-dashoffset",_.dashOffset):h.removeAttribute("stroke-dashoffset")):h.setAttribute("stroke","none"),_.fill?(h.setAttribute("fill",_.fillColor||_.color),h.setAttribute("fill-opacity",_.fillOpacity),h.setAttribute("fill-rule",_.fillRule||"evenodd")):h.setAttribute("fill","none"))},_updatePoly:function(r,h){this._setPath(r,Wr(r._parts,h))},_updateCircle:function(r){var h=r._point,_=Math.max(Math.round(r._radius),1),b=Math.max(Math.round(r._radiusY),1)||_,E="a"+_+","+b+" 0 1,0 ",N=r._empty()?"M0 0":"M"+(h.x-_)+","+h.y+E+_*2+",0 "+E+-_*2+",0 ";this._setPath(r,N)},_setPath:function(r,h){r._path.setAttribute("d",h)},_bringToFront:function(r){An(r._path)},_bringToBack:function(r){bi(r._path)}});j&&mo.include(jt);function Ro(r){return O||j?new mo(r):null}Ue.include({getRenderer:function(r){var h=r.options.renderer||this._getPaneRenderer(r.options.pane)||this.options.renderer||this._renderer;return h||(h=this._renderer=this._createRenderer()),this.hasLayer(h)||this.addLayer(h),h},_getPaneRenderer:function(r){if(r==="overlayPane"||r===void 0)return!1;var h=this._paneRenderers[r];return h===void 0&&(h=this._createRenderer({pane:r}),this._paneRenderers[r]=h),h},_createRenderer:function(r){return this.options.preferCanvas&&Bs(r)||Ro(r)}});var fn=ko.extend({initialize:function(r,h){ko.prototype.initialize.call(this,this._boundsToLatLngs(r),h)},setBounds:function(r){return this.setLatLngs(this._boundsToLatLngs(r))},_boundsToLatLngs:function(r){return r=yi(r),[r.getSouthWest(),r.getNorthWest(),r.getNorthEast(),r.getSouthEast()]}});function Fr(r,h){return new fn(r,h)}mo.create=Tr,mo.pointsToPath=Wr,Yr.geometryToLayer=Ko,Yr.coordsToLatLng=Jo,Yr.coordsToLatLngs=Qa,Yr.latLngToCoords=Yo,Yr.latLngsToCoords=$o,Yr.getFeature=Do,Yr.asFeature=za,Ue.mergeOptions({boxZoom:!0});var is=hr.extend({initialize:function(r){this._map=r,this._container=r._container,this._pane=r._panes.overlayPane,this._resetStateTimeout=0,r.on("unload",this._destroy,this)},addHooks:function(){ke(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ai(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){se(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(r){if(!r.shiftKey||r.which!==1&&r.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Wo(),Zi(),this._startPoint=this._map.mouseEventToContainerPoint(r),ke(document,{contextmenu:Ar,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(r){this._moved||(this._moved=!0,this._box=Yt("div","leaflet-zoom-box",this._container),Se(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(r);var h=new We(this._point,this._startPoint),_=h.getSize();Qe(this._box,h.min),this._box.style.width=_.x+"px",this._box.style.height=_.y+"px"},_finish:function(){this._moved&&(se(this._box),ui(this._container,"leaflet-crosshair")),xr(),un(),Ai(document,{contextmenu:Ar,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(r){if(!(r.which!==1&&r.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(u(this._resetState,this),0);var h=new Fi(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(h).fire("boxzoomend",{boxZoomBounds:h})}},_onKeyDown:function(r){r.keyCode===27&&this._finish()}});Ue.addInitHook("addHandler","boxZoom",is),Ue.mergeOptions({doubleClickZoom:!0});var Bt=hr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(r){var h=this._map,_=h.getZoom(),b=h.options.zoomDelta,E=r.originalEvent.shiftKey?_-b:_+b;h.options.doubleClickZoom==="center"?h.setZoom(E):h.setZoomAround(r.containerPoint,E)}});Ue.addInitHook("addHandler","doubleClickZoom",Bt),Ue.mergeOptions({dragging:!0,inertia:!gr,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var rs=hr.extend({addHooks:function(){if(!this._draggable){var r=this._map;this._draggable=new Jr(r._mapPane,r._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),r.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),r.on("zoomend",this._onZoomEnd,this),r.whenReady(this._onZoomEnd,this))}Se(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ui(this._map._container,"leaflet-grab"),ui(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var r=this._map;if(r._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var h=yi(this._map.options.maxBounds);this._offsetLimit=Oi(this._map.latLngToContainerPoint(h.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(h.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;r.fire("movestart").fire("dragstart"),r.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(r){if(this._map.options.inertia){var h=this._lastTime=+new Date,_=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(_),this._times.push(h),this._prunePositions(h)}this._map.fire("move",r).fire("drag",r)},_prunePositions:function(r){for(;this._positions.length>1&&r-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var r=this._map.getSize().divideBy(2),h=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=h.subtract(r).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(r,h){return r-(r-h)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var r=this._draggable._newPos.subtract(this._draggable._startPos),h=this._offsetLimit;r.x<h.min.x&&(r.x=this._viscousLimit(r.x,h.min.x)),r.y<h.min.y&&(r.y=this._viscousLimit(r.y,h.min.y)),r.x>h.max.x&&(r.x=this._viscousLimit(r.x,h.max.x)),r.y>h.max.y&&(r.y=this._viscousLimit(r.y,h.max.y)),this._draggable._newPos=this._draggable._startPos.add(r)}},_onPreDragWrap:function(){var r=this._worldWidth,h=Math.round(r/2),_=this._initialWorldOffset,b=this._draggable._newPos.x,E=(b-h+_)%r+h-_,N=(b+h+_)%r-h-_,rt=Math.abs(E+_)<Math.abs(N+_)?E:N;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=rt},_onDragEnd:function(r){var h=this._map,_=h.options,b=!_.inertia||this._times.length<2;if(h.fire("dragend",r),b)h.fire("moveend");else{this._prunePositions(+new Date);var E=this._lastPos.subtract(this._positions[0]),N=(this._lastTime-this._times[0])/1e3,rt=_.easeLinearity,pt=E.multiplyBy(rt/N),wt=pt.distanceTo([0,0]),xt=Math.min(_.inertiaMaxSpeed,wt),Wt=pt.multiplyBy(xt/wt),ie=xt/(_.inertiaDeceleration*rt),me=Wt.multiplyBy(-ie/2).round();!me.x&&!me.y?h.fire("moveend"):(me=h._limitOffset(me,h.options.maxBounds),li(function(){h.panBy(me,{duration:ie,easeLinearity:rt,noMoveStart:!0,animate:!0})}))}}});Ue.addInitHook("addHandler","dragging",rs),Ue.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ma=hr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(r){this._map=r,this._setPanDelta(r.options.keyboardPanDelta),this._setZoomDelta(r.options.zoomDelta)},addHooks:function(){var r=this._map._container;r.tabIndex<=0&&(r.tabIndex="0"),ke(r,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ai(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var r=document.body,h=document.documentElement,_=r.scrollTop||h.scrollTop,b=r.scrollLeft||h.scrollLeft;this._map._container.focus(),window.scrollTo(b,_)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(r){var h=this._panKeys={},_=this.keyCodes,b,E;for(b=0,E=_.left.length;b<E;b++)h[_.left[b]]=[-1*r,0];for(b=0,E=_.right.length;b<E;b++)h[_.right[b]]=[r,0];for(b=0,E=_.down.length;b<E;b++)h[_.down[b]]=[0,r];for(b=0,E=_.up.length;b<E;b++)h[_.up[b]]=[0,-1*r]},_setZoomDelta:function(r){var h=this._zoomKeys={},_=this.keyCodes,b,E;for(b=0,E=_.zoomIn.length;b<E;b++)h[_.zoomIn[b]]=r;for(b=0,E=_.zoomOut.length;b<E;b++)h[_.zoomOut[b]]=-r},_addHooks:function(){ke(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ai(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(r){if(!(r.altKey||r.ctrlKey||r.metaKey)){var h=r.keyCode,_=this._map,b;if(h in this._panKeys)(!_._panAnim||!_._panAnim._inProgress)&&(b=this._panKeys[h],r.shiftKey&&(b=Ce(b).multiplyBy(3)),_.panBy(b),_.options.maxBounds&&_.panInsideBounds(_.options.maxBounds));else if(h in this._zoomKeys)_.setZoom(_.getZoom()+(r.shiftKey?3:1)*this._zoomKeys[h]);else if(h===27&&_._popup&&_._popup.options.closeOnEscapeKey)_.closePopup();else return;Ar(r)}}});Ue.addInitHook("addHandler","keyboard",Ma),Ue.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var ns=hr.extend({addHooks:function(){ke(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ai(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(r){var h=Pa(r),_=this._map.options.wheelDebounceTime;this._delta+=h,this._lastMousePos=this._map.mouseEventToContainerPoint(r),this._startTime||(this._startTime=+new Date);var b=Math.max(_-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(u(this._performZoom,this),b),Ar(r)},_performZoom:function(){var r=this._map,h=r.getZoom(),_=this._map.options.zoomSnap||0;r._stop();var b=this._delta/(this._map.options.wheelPxPerZoomLevel*4),E=4*Math.log(2/(1+Math.exp(-Math.abs(b))))/Math.LN2,N=_?Math.ceil(E/_)*_:E,rt=r._limitZoom(h+(this._delta>0?N:-N))-h;this._delta=0,this._startTime=null,!!rt&&(r.options.scrollWheelZoom==="center"?r.setZoom(h+rt):r.setZoomAround(this._lastMousePos,h+rt))}});Ue.addInitHook("addHandler","scrollWheelZoom",ns),Ue.mergeOptions({tap:!0,tapTolerance:15});var tn=hr.extend({addHooks:function(){ke(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ai(this._map._container,"touchstart",this._onDown,this)},_onDown:function(r){if(!!r.touches){if(Hi(r),this._fireClick=!0,r.touches.length>1){this._fireClick=!1,clearTimeout(this._holdTimeout);return}var h=r.touches[0],_=h.target;this._startPos=this._newPos=new de(h.clientX,h.clientY),_.tagName&&_.tagName.toLowerCase()==="a"&&Se(_,"leaflet-active"),this._holdTimeout=setTimeout(u(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",h))},this),1e3),this._simulateEvent("mousedown",h),ke(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(r){if(clearTimeout(this._holdTimeout),Ai(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&r&&r.changedTouches){var h=r.changedTouches[0],_=h.target;_&&_.tagName&&_.tagName.toLowerCase()==="a"&&ui(_,"leaflet-active"),this._simulateEvent("mouseup",h),this._isTapValid()&&this._simulateEvent("click",h)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(r){var h=r.touches[0];this._newPos=new de(h.clientX,h.clientY),this._simulateEvent("mousemove",h)},_simulateEvent:function(r,h){var _=document.createEvent("MouseEvents");_._simulated=!0,h.target._simulatedClick=!0,_.initMouseEvent(r,!0,!0,window,1,h.screenX,h.screenY,h.clientX,h.clientY,!1,!1,!1,!1,0,null),h.target.dispatchEvent(_)}});er&&(!tr||$n)&&Ue.addInitHook("addHandler","tap",tn),Ue.mergeOptions({touchZoom:er&&!gr,bounceAtZoomLimits:!0});var Lr=hr.extend({addHooks:function(){Se(this._map._container,"leaflet-touch-zoom"),ke(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ui(this._map._container,"leaflet-touch-zoom"),Ai(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(r){var h=this._map;if(!(!r.touches||r.touches.length!==2||h._animatingZoom||this._zooming)){var _=h.mouseEventToContainerPoint(r.touches[0]),b=h.mouseEventToContainerPoint(r.touches[1]);this._centerPoint=h.getSize()._divideBy(2),this._startLatLng=h.containerPointToLatLng(this._centerPoint),h.options.touchZoom!=="center"&&(this._pinchStartLatLng=h.containerPointToLatLng(_.add(b)._divideBy(2))),this._startDist=_.distanceTo(b),this._startZoom=h.getZoom(),this._moved=!1,this._zooming=!0,h._stop(),ke(document,"touchmove",this._onTouchMove,this),ke(document,"touchend",this._onTouchEnd,this),Hi(r)}},_onTouchMove:function(r){if(!(!r.touches||r.touches.length!==2||!this._zooming)){var h=this._map,_=h.mouseEventToContainerPoint(r.touches[0]),b=h.mouseEventToContainerPoint(r.touches[1]),E=_.distanceTo(b)/this._startDist;if(this._zoom=h.getScaleZoom(E,this._startZoom),!h.options.bounceAtZoomLimits&&(this._zoom<h.getMinZoom()&&E<1||this._zoom>h.getMaxZoom()&&E>1)&&(this._zoom=h._limitZoom(this._zoom)),h.options.touchZoom==="center"){if(this._center=this._startLatLng,E===1)return}else{var N=_._add(b)._divideBy(2)._subtract(this._centerPoint);if(E===1&&N.x===0&&N.y===0)return;this._center=h.unproject(h.project(this._pinchStartLatLng,this._zoom).subtract(N),this._zoom)}this._moved||(h._moveStart(!0,!1),this._moved=!0),ji(this._animRequest);var rt=u(h._move,h,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=li(rt,this,!0),Hi(r)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,ji(this._animRequest),Ai(document,"touchmove",this._onTouchMove,this),Ai(document,"touchend",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ue.addInitHook("addHandler","touchZoom",Lr),Ue.BoxZoom=is,Ue.DoubleClickZoom=Bt,Ue.Drag=rs,Ue.Keyboard=Ma,Ue.ScrollWheelZoom=ns,Ue.Tap=tn,Ue.TouchZoom=Lr,S.version=M,S.Control=Kr,S.control=Ao,S.Browser=it,S.Evented=Sn,S.Mixin=oo,S.Util=_i,S.Class=Ei,S.Handler=hr,S.extend=R,S.bind=u,S.stamp=st,S.setOptions=Je,S.DomEvent=Zl,S.DomUtil=Ys,S.PosAnimation=$s,S.Draggable=Jr,S.LineUtil=nl,S.PolyUtil=zs,S.Point=de,S.point=Ce,S.Bounds=We,S.bounds=Oi,S.Transformation=Kn,S.transformation=Pr,S.Projection=Co,S.LatLng=Ve,S.latLng=gi,S.LatLngBounds=Fi,S.latLngBounds=yi,S.CRS=vi,S.GeoJSON=Yr,S.geoJSON=ts,S.geoJson=Ms,S.Layer=Le,S.LayerGroup=Vn,S.layerGroup=ql,S.FeatureGroup=gn,S.featureGroup=ol,S.ImageOverlay=ta,S.imageOverlay=ka,S.VideoOverlay=Ds,S.videoOverlay=Bo,S.SVGOverlay=ni,S.svgOverlay=es,S.DivOverlay=Cr,S.Popup=$r,S.popup=Ee,S.Tooltip=qe,S.tooltip=Qr,S.Icon=Xo,S.icon=al,S.DivIcon=ea,S.divIcon=ia,S.Marker=po,S.marker=Ya,S.TileLayer=ra,S.tileLayer=na,S.GridLayer=jn,S.gridLayer=jl,S.SVG=mo,S.svg=Ro,S.Renderer=ti,S.Canvas=aa,S.canvas=Bs,S.Path=pn,S.CircleMarker=qn,S.circleMarker=sl,S.Circle=fo,S.circle=vn,S.Polyline=zn,S.polyline=ll,S.Polygon=ko,S.polygon=Mo,S.Rectangle=fn,S.rectangle=Fr,S.Map=Ue,S.map=Ps;var os=window.L;S.noConflict=function(){return window.L=os,this},window.L=S})})(yt,yt.exports);var dh=window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,vs=document.documentElement.style.pointerEvents==="",xs={cors:dh,pointerEvents:vs},tm={attributionWidthOffset:55},Op=0;function mh(m){var x="";m.f=m.f||"json";for(var S in m)if(m.hasOwnProperty(S)){var M=m[S],R=Object.prototype.toString.call(M),nt;x.length&&(x+="&"),R==="[object Array]"?nt=Object.prototype.toString.call(M[0])==="[object Object]"?JSON.stringify(M):M.join(","):R==="[object Object]"?nt=JSON.stringify(M):R==="[object Date]"?nt=M.valueOf():nt=M,x+=encodeURIComponent(S)+"="+encodeURIComponent(nt)}return x}function sc(m,x){var S=new window.XMLHttpRequest;return S.onerror=function(M){S.onreadystatechange=yt.exports.Util.falseFn,m.call(x,{error:{code:500,message:"XMLHttpRequest error"}},null)},S.onreadystatechange=function(){var M,R;if(S.readyState===4){try{M=JSON.parse(S.responseText)}catch{M=null,R={code:500,message:"Could not parse response as JSON. This could also be caused by a CORS or XMLHttpRequest error."}}!R&&M.error&&(R=M.error,M=null),S.onerror=yt.exports.Util.falseFn,m.call(x,R,M)}},S.ontimeout=function(){this.onerror()},S}function em(m,x,S,M){var R=sc(S,M);return R.open("POST",m),typeof M!="undefined"&&M!==null&&typeof M.options!="undefined"&&(R.timeout=M.options.timeout),R.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),R.send(mh(x)),R}function Wp(m,x,S,M){var R=sc(S,M);return R.open("GET",m+"?"+mh(x),!0),typeof M!="undefined"&&M!==null&&typeof M.options!="undefined"&&(R.timeout=M.options.timeout,M.options.withCredentials&&(R.withCredentials=!0)),R.send(null),R}function Nl(m,x,S,M){var R=mh(x),nt=sc(S,M),u=(m+"?"+R).length;if(u<=2e3&&xs.cors?nt.open("GET",m+"?"+R):u>2e3&&xs.cors&&(nt.open("POST",m),nt.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8")),typeof M!="undefined"&&M!==null&&typeof M.options!="undefined"&&(nt.timeout=M.options.timeout,M.options.withCredentials&&(nt.withCredentials=!0)),u<=2e3&&xs.cors)nt.send(null);else if(u>2e3&&xs.cors)nt.send(R);else{if(u<=2e3&&!xs.cors)return lc(m,x,S,M);bs("a request to "+m+" was longer then 2000 characters and this browser cannot make a cross-domain post request. Please use a proxy http://esri.github.io/esri-leaflet/api-reference/request.html");return}return nt}function lc(m,x,S,M){window._EsriLeafletCallbacks=window._EsriLeafletCallbacks||{};var R="c"+Op;x.callback="window._EsriLeafletCallbacks."+R,window._EsriLeafletCallbacks[R]=function(u){if(window._EsriLeafletCallbacks[R]!==!0){var Et,st=Object.prototype.toString.call(u);st==="[object Object]"||st==="[object Array]"||(Et={error:{code:500,message:"Expected array or object as JSONP response"}},u=null),!Et&&u.error&&(Et=u,u=null),S.call(M,Et,u),window._EsriLeafletCallbacks[R]=!0}};var nt=yt.exports.DomUtil.create("script",null,document.body);return nt.type="text/javascript",nt.src=m+"?"+mh(x),nt.id=R,nt.onerror=function(u){if(u&&window._EsriLeafletCallbacks[R]!==!0){var Et={error:{code:500,message:"An unknown error occurred"}};S.call(M,Et),window._EsriLeafletCallbacks[R]=!0}},yt.exports.DomUtil.addClass(nt,"esri-leaflet-jsonp"),Op++,{id:R,url:nt.src,abort:function(){window._EsriLeafletCallbacks._callback[R]({code:0,message:"Request aborted."})}}}var uc=xs.cors?Wp:lc;uc.CORS=Wp;uc.JSONP=lc;function bs(){console&&console.warn&&console.warn.apply(console,arguments)}var ch={request:Nl,get:uc,post:em};/* @preserve
* @terraformer/arcgis - v2.0.7 - MIT
* Copyright (c) 2012-2021 Environmental Systems Research Institute, Inc.
* Thu Jul 22 2021 13:58:30 GMT-0700 (Pacific Daylight Time)
*/var im=function(x,S,M,R){var nt=(R[0]-M[0])*(x[1]-M[1])-(R[1]-M[1])*(x[0]-M[0]),u=(S[0]-x[0])*(x[1]-M[1])-(S[1]-x[1])*(x[0]-M[0]),Et=(R[1]-M[1])*(S[0]-x[0])-(R[0]-M[0])*(S[1]-x[1]);if(Et!==0){var st=nt/Et,Kt=u/Et;if(st>=0&&st<=1&&Kt>=0&&Kt<=1)return!0}return!1},rm=function(x,S){for(var M=!1,R=-1,nt=x.length,u=nt-1;++R<nt;u=R)(x[R][1]<=S[1]&&S[1]<x[u][1]||x[u][1]<=S[1]&&S[1]<x[R][1])&&S[0]<(x[u][0]-x[R][0])*(S[1]-x[R][1])/(x[u][1]-x[R][1])+x[R][0]&&(M=!M);return M},nm=function(x,S){for(var M=0;M<x.length;M++)if(x[M]!==S[M])return!1;return!0},Hp=function(x,S){for(var M=0;M<x.length-1;M++)for(var R=0;R<S.length-1;R++)if(im(x[M],x[M+1],S[R],S[R+1]))return!0;return!1},ec=function(x){return nm(x[0],x[x.length-1])||x.push(x[0]),x},ic=function(x){var S=0,M=0,R=x.length,nt=x[M],u;for(M;M<R-1;M++)u=x[M+1],S+=(u[0]-nt[0])*(u[1]+nt[1]),nt=u;return S>=0},Xp=function(x){var S={};for(var M in x)x.hasOwnProperty(M)&&(S[M]=x[M]);return S},om=function(x,S){var M=Hp(x,S),R=rm(x,S[0]);return!!(!M&&R)},am=function(x){for(var S=[],M=[],R,nt,u,Et=0;Et<x.length;Et++){var st=ec(x[Et].slice(0));if(!(st.length<4))if(ic(st)){var Kt=[st.slice().reverse()];S.push(Kt)}else M.push(st.slice().reverse())}for(var Vt=[];M.length;){u=M.pop();var fe=!1;for(R=S.length-1;R>=0;R--)if(nt=S[R][0],om(nt,u)){S[R].push(u),fe=!0;break}fe||Vt.push(u)}for(;Vt.length;){u=Vt.pop();var Ct=!1;for(R=S.length-1;R>=0;R--)if(nt=S[R][0],Hp(nt,u)){S[R].push(u),Ct=!0;break}Ct||S.push([u.reverse()])}return S.length===1?{type:"Polygon",coordinates:S[0]}:{type:"MultiPolygon",coordinates:S}},sm=function(x,S){for(var M=S?[S,"OBJECTID","FID"]:["OBJECTID","FID"],R=0;R<M.length;R++){var nt=M[R];if(nt in x&&(typeof x[nt]=="string"||typeof x[nt]=="number"))return x[nt]}throw Error("No valid id attribute found")},lm=function m(x,S){var M={};if(x.features){M.type="FeatureCollection",M.features=[];for(var R=0;R<x.features.length;R++)M.features.push(m(x.features[R],S))}if(typeof x.x=="number"&&typeof x.y=="number"&&(M.type="Point",M.coordinates=[x.x,x.y],typeof x.z=="number"&&M.coordinates.push(x.z)),x.points&&(M.type="MultiPoint",M.coordinates=x.points.slice(0)),x.paths&&(x.paths.length===1?(M.type="LineString",M.coordinates=x.paths[0].slice(0)):(M.type="MultiLineString",M.coordinates=x.paths.slice(0))),x.rings&&(M=am(x.rings.slice(0))),typeof x.xmin=="number"&&typeof x.ymin=="number"&&typeof x.xmax=="number"&&typeof x.ymax=="number"&&(M.type="Polygon",M.coordinates=[[[x.xmax,x.ymax],[x.xmin,x.ymax],[x.xmin,x.ymin],[x.xmax,x.ymin],[x.xmax,x.ymax]]]),(x.geometry||x.attributes)&&(M.type="Feature",M.geometry=x.geometry?m(x.geometry):null,M.properties=x.attributes?Xp(x.attributes):null,x.attributes))try{M.id=sm(x.attributes,S)}catch{}return JSON.stringify(M.geometry)===JSON.stringify({})&&(M.geometry=null),x.spatialReference&&x.spatialReference.wkid&&x.spatialReference.wkid!==4326&&console.warn("Object converted in non-standard crs - "+JSON.stringify(x.spatialReference)),M},Kp=function(x){var S=[],M=x.slice(0),R=ec(M.shift().slice(0));if(R.length>=4){ic(R)||R.reverse(),S.push(R);for(var nt=0;nt<M.length;nt++){var u=ec(M[nt].slice(0));u.length>=4&&(ic(u)&&u.reverse(),S.push(u))}}return S},um=function(x){for(var S=[],M=0;M<x.length;M++)for(var R=Kp(x[M]),nt=R.length-1;nt>=0;nt--){var u=R[nt].slice(0);S.push(u)}return S},hm=function m(x,S){S=S||"OBJECTID";var M={wkid:4326},R={},nt;switch(x.type){case"Point":R.x=x.coordinates[0],R.y=x.coordinates[1],x.coordinates[2]&&(R.z=x.coordinates[2]),R.spatialReference=M;break;case"MultiPoint":R.points=x.coordinates.slice(0),x.coordinates[0][2]&&(R.hasZ=!0),R.spatialReference=M;break;case"LineString":R.paths=[x.coordinates.slice(0)],x.coordinates[0][2]&&(R.hasZ=!0),R.spatialReference=M;break;case"MultiLineString":R.paths=x.coordinates.slice(0),x.coordinates[0][0][2]&&(R.hasZ=!0),R.spatialReference=M;break;case"Polygon":R.rings=Kp(x.coordinates.slice(0)),x.coordinates[0][0][2]&&(R.hasZ=!0),R.spatialReference=M;break;case"MultiPolygon":R.rings=um(x.coordinates.slice(0)),x.coordinates[0][0][0][2]&&(R.hasZ=!0),R.spatialReference=M;break;case"Feature":x.geometry&&(R.geometry=m(x.geometry,S)),R.attributes=x.properties?Xp(x.properties):{},x.id&&(R.attributes[S]=x.id);break;case"FeatureCollection":for(R=[],nt=0;nt<x.features.length;nt++)R.push(m(x.features[nt],S));break;case"GeometryCollection":for(R=[],nt=0;nt<x.geometries.length;nt++)R.push(m(x.geometries[nt],S));break}return R},Jp='<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>',cm='Powered by <a href="https://www.esri.com">Esri</a>';function Tu(m,x){return hm(m,x)}function Yp(m,x){return lm(m,x)}function rc(m){if(m.xmin!=="NaN"&&m.ymin!=="NaN"&&m.xmax!=="NaN"&&m.ymax!=="NaN"){var x=yt.exports.latLng(m.ymin,m.xmin),S=yt.exports.latLng(m.ymax,m.xmax);return yt.exports.latLngBounds(x,S)}else return null}function hc(m){return m=yt.exports.latLngBounds(m),{xmin:m.getSouthWest().lng,ymin:m.getSouthWest().lat,xmax:m.getNorthEast().lng,ymax:m.getNorthEast().lat,spatialReference:{wkid:4326}}}var $p=/^(OBJECTID|FID|OID|ID)$/i;function Qp(m){var x;if(m.objectIdFieldName)x=m.objectIdFieldName;else if(m.fields){for(var S=0;S<=m.fields.length-1;S++)if(m.fields[S].type==="esriFieldTypeOID"){x=m.fields[S].name;break}if(!x){for(S=0;S<=m.fields.length-1;S++)if(m.fields[S].name.match($p)){x=m.fields[S].name;break}}}return x}function tf(m){for(var x in m.attributes)if(x.match($p))return x}function Pu(m,x){var S,M=m.features||m.results,R=M&&M.length;x?S=x:S=Qp(m);var nt={type:"FeatureCollection",features:[]};if(R)for(var u=M.length-1;u>=0;u--){var Et=Yp(M[u],S||tf(M[u]));nt.features.push(Et)}return nt}function _h(m){return m=yt.exports.Util.trim(m),m[m.length-1]!=="/"&&(m+="/"),m}function Iu(m){if(m.url.indexOf("?")!==-1){m.requestParams=m.requestParams||{};var x=m.url.substring(m.url.indexOf("?")+1);m.url=m.url.split("?")[0],m.requestParams=JSON.parse('{"'+decodeURI(x).replace(/"/g,'\\"').replace(/&/g,'","').replace(/=/g,'":"')+'"}')}return m.url=_h(m.url.split("?")[0]),m}function ef(m){return/^(?!.*utility\.arcgis\.com).*\.arcgis\.com.*FeatureServer/i.test(m)}function nc(m){var x;switch(m){case"Point":x="esriGeometryPoint";break;case"MultiPoint":x="esriGeometryMultipoint";break;case"LineString":x="esriGeometryPolyline";break;case"MultiLineString":x="esriGeometryPolyline";break;case"Polygon":x="esriGeometryPolygon";break;case"MultiPolygon":x="esriGeometryPolygon";break}return x}function ph(m){return m.getSize().x-tm.attributionWidthOffset+"px"}function Eu(m){if(!!m.attributionControl){if(m.attributionControl._esriAttributionLayerCount||(m.attributionControl._esriAttributionLayerCount=0),m.attributionControl._esriAttributionLayerCount===0){if(!m.attributionControl._esriAttributionAddedOnce){var x=document.createElement("style");x.type="text/css",x.innerHTML=".esri-truncated-attribution:hover {white-space: normal;}",document.getElementsByTagName("head")[0].appendChild(x);var S=document.createElement("style");S.type="text/css",S.innerHTML=".esri-truncated-attribution {vertical-align: -3px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;display: inline-block;transition: 0s white-space;transition-delay: 1s;max-width: "+ph(m)+";}",document.getElementsByTagName("head")[0].appendChild(S),m.on("resize",function(M){m.attributionControl&&(m.attributionControl._container.style.maxWidth=ph(M.target))}),m.attributionControl._esriAttributionAddedOnce=!0}m.attributionControl.setPrefix(Jp+" | "+cm),yt.exports.DomUtil.addClass(m.attributionControl._container,"esri-truncated-attribution:hover"),yt.exports.DomUtil.addClass(m.attributionControl._container,"esri-truncated-attribution")}m.attributionControl._esriAttributionLayerCount=m.attributionControl._esriAttributionLayerCount+1}}function yh(m){!m.attributionControl||(m.attributionControl._esriAttributionLayerCount&&m.attributionControl._esriAttributionLayerCount===1&&(m.attributionControl.setPrefix(Jp),yt.exports.DomUtil.removeClass(m.attributionControl._container,"esri-truncated-attribution:hover"),yt.exports.DomUtil.removeClass(m.attributionControl._container,"esri-truncated-attribution")),m.attributionControl._esriAttributionLayerCount=m.attributionControl._esriAttributionLayerCount-1)}function cc(m){var x={geometry:null,geometryType:null};if(m instanceof yt.exports.LatLngBounds)return x.geometry=hc(m),x.geometryType="esriGeometryEnvelope",x;if(m.getLatLng&&(m=m.getLatLng()),m instanceof yt.exports.LatLng&&(m={type:"Point",coordinates:[m.lng,m.lat]}),m instanceof yt.exports.GeoJSON&&(m=m.getLayers()[0].feature.geometry,x.geometry=Tu(m),x.geometryType=nc(m.type)),m.toGeoJSON&&(m=m.toGeoJSON()),m.type==="Feature"&&(m=m.geometry),m.type==="Point"||m.type==="LineString"||m.type==="Polygon"||m.type==="MultiPolygon")return x.geometry=Tu(m),x.geometryType=nc(m.type),x;bs("invalid geometry passed to spatial query. Should be L.LatLng, L.LatLngBounds, L.Marker or a GeoJSON Point, Line, Polygon or MultiPolygon object")}function rf(m,x){xs.cors&&Nl(m,{},yt.exports.Util.bind(function(S,M){if(!S){x._esriAttributions=[];for(var R=0;R<M.contributors.length;R++)for(var nt=M.contributors[R],u=0;u<nt.coverageAreas.length;u++){var Et=nt.coverageAreas[u],st=yt.exports.latLng(Et.bbox[0],Et.bbox[1]),Kt=yt.exports.latLng(Et.bbox[2],Et.bbox[3]);x._esriAttributions.push({attribution:nt.attribution,score:Et.score,bounds:yt.exports.latLngBounds(st,Kt),minZoom:Et.zoomMin,maxZoom:Et.zoomMax})}x._esriAttributions.sort(function(fe,Ct){return Ct.score-fe.score});var Vt={target:x};fh(Vt)}},this))}function fh(m){var x=m.target,S=x._esriAttributions;if(!(!x||!x.attributionControl)){var M=x.attributionControl._container.querySelector(".esri-dynamic-attribution");if(M&&S){for(var R="",nt=x.getBounds(),u=yt.exports.latLngBounds(nt.getSouthWest().wrap(),nt.getNorthEast().wrap()),Et=x.getZoom(),st=0;st<S.length;st++){var Kt=S[st],Vt=Kt.attribution;!R.match(Vt)&&Kt.bounds.intersects(u)&&Et>=Kt.minZoom&&Et<=Kt.maxZoom&&(R+=", "+Vt)}R=R.substr(2),M.innerHTML=R,M.style.maxWidth=ph(x),x.fire("attributionupdated",{attribution:R})}}}var bu={warn:bs,cleanUrl:_h,getUrlParams:Iu,isArcgisOnline:ef,geojsonTypeToArcGIS:nc,responseToFeatureCollection:Pu,geojsonToArcGIS:Tu,arcgisToGeoJSON:Yp,boundsToExtent:hc,extentToBounds:rc,calcAttributionWidth:ph,setEsriAttribution:Eu,_setGeometry:cc,_getAttributionData:rf,_updateMapAttribution:fh,_findIdAttributeFromFeature:tf,_findIdAttributeFromResponse:Qp},pc=yt.exports.Class.extend({options:{proxy:!1,useCors:dh},generateSetter:function(m,x){return yt.exports.Util.bind(function(S){return this.params[m]=S,this},x)},initialize:function(m){if(m.request&&m.options?(this._service=m,yt.exports.Util.setOptions(this,m.options)):(yt.exports.Util.setOptions(this,m),this.options.url=_h(m.url)),this.params=yt.exports.Util.extend({},this.params||{}),this.setters)for(var x in this.setters){var S=this.setters[x];this[x]=this.generateSetter(S,this)}},token:function(m){return this._service?this._service.authenticate(m):this.params.token=m,this},apikey:function(m){return this.token(m)},format:function(m){return this.params.returnUnformattedValues=!m,this},request:function(m,x){return this.options.requestParams&&yt.exports.Util.extend(this.params,this.options.requestParams),this._service?this._service.request(this.path,this.params,m,x):this._request("request",this.path,this.params,m,x)},_request:function(m,x,S,M,R){var nt=this.options.proxy?this.options.proxy+"?"+this.options.url+x:this.options.url+x;return(m==="get"||m==="request")&&!this.options.useCors?ch.get.JSONP(nt,S,M,R):ch[m](nt,S,M,R)}}),pm=pc.extend({setters:{offset:"resultOffset",limit:"resultRecordCount",fields:"outFields",precision:"geometryPrecision",featureIds:"objectIds",returnGeometry:"returnGeometry",returnM:"returnM",transform:"datumTransformation",token:"token"},path:"query",params:{returnGeometry:!0,where:"1=1",outSR:4326,outFields:"*"},within:function(m){return this._setGeometryParams(m),this.params.spatialRel="esriSpatialRelContains",this},intersects:function(m){return this._setGeometryParams(m),this.params.spatialRel="esriSpatialRelIntersects",this},contains:function(m){return this._setGeometryParams(m),this.params.spatialRel="esriSpatialRelWithin",this},crosses:function(m){return this._setGeometryParams(m),this.params.spatialRel="esriSpatialRelCrosses",this},touches:function(m){return this._setGeometryParams(m),this.params.spatialRel="esriSpatialRelTouches",this},overlaps:function(m){return this._setGeometryParams(m),this.params.spatialRel="esriSpatialRelOverlaps",this},bboxIntersects:function(m){return this._setGeometryParams(m),this.params.spatialRel="esriSpatialRelEnvelopeIntersects",this},indexIntersects:function(m){return this._setGeometryParams(m),this.params.spatialRel="esriSpatialRelIndexIntersects",this},nearby:function(m,x){return m=yt.exports.latLng(m),this.params.geometry=[m.lng,m.lat],this.params.geometryType="esriGeometryPoint",this.params.spatialRel="esriSpatialRelIntersects",this.params.units="esriSRUnit_Meter",this.params.distance=x,this.params.inSR=4326,this},where:function(m){return this.params.where=m,this},between:function(m,x){return this.params.time=[m.valueOf(),x.valueOf()],this},simplify:function(m,x){var S=Math.abs(m.getBounds().getWest()-m.getBounds().getEast());return this.params.maxAllowableOffset=S/m.getSize().y*x,this},orderBy:function(m,x){return x=x||"ASC",this.params.orderByFields=this.params.orderByFields?this.params.orderByFields+",":"",this.params.orderByFields+=[m,x].join(" "),this},run:function(m,x){return this._cleanParams(),this.options.isModern||ef(this.options.url)&&this.options.isModern===void 0?(this.params.f="geojson",this.request(function(S,M){this._trapSQLerrors(S),m.call(x,S,M,M)},this)):this.request(function(S,M){this._trapSQLerrors(S),m.call(x,S,M&&Pu(M),M)},this)},count:function(m,x){return this._cleanParams(),this.params.returnCountOnly=!0,this.request(function(S,M){m.call(this,S,M&&M.count,M)},x)},ids:function(m,x){return this._cleanParams(),this.params.returnIdsOnly=!0,this.request(function(S,M){m.call(this,S,M&&M.objectIds,M)},x)},bounds:function(m,x){return this._cleanParams(),this.params.returnExtentOnly=!0,this.request(function(S,M){M&&M.extent&&rc(M.extent)?m.call(x,S,rc(M.extent),M):(S={message:"Invalid Bounds"},m.call(x,S,null,M))},x)},distinct:function(){return this.params.returnGeometry=!1,this.params.returnDistinctValues=!0,this},pixelSize:function(m){var x=yt.exports.point(m);return this.params.pixelSize=[x.x,x.y],this},layer:function(m){return this.path=m+"/query",this},_trapSQLerrors:function(m){m&&m.code==="400"&&bs("one common syntax error in query requests is encasing string values in double quotes instead of single quotes")},_cleanParams:function(){delete this.params.returnIdsOnly,delete this.params.returnExtentOnly,delete this.params.returnCountOnly},_setGeometryParams:function(m){this.params.inSR=4326;var x=cc(m);this.params.geometry=x.geometry,this.params.geometryType=x.geometryType}});function fc(m){return new pm(m)}var fm=pc.extend({setters:{contains:"contains",text:"searchText",fields:"searchFields",spatialReference:"sr",sr:"sr",layers:"layers",returnGeometry:"returnGeometry",maxAllowableOffset:"maxAllowableOffset",precision:"geometryPrecision",dynamicLayers:"dynamicLayers",returnZ:"returnZ",returnM:"returnM",gdbVersion:"gdbVersion",token:"token"},path:"find",params:{sr:4326,contains:!0,returnGeometry:!0,returnZ:!0,returnM:!1},layerDefs:function(m,x){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[m,x].join(":"),this},simplify:function(m,x){var S=Math.abs(m.getBounds().getWest()-m.getBounds().getEast());return this.params.maxAllowableOffset=S/m.getSize().y*x,this},run:function(m,x){return this.request(function(S,M){m.call(x,S,M&&Pu(M),M)},x)}});function dm(m){return new fm(m)}var nf=pc.extend({path:"identify",between:function(m,x){return this.params.time=[m.valueOf(),x.valueOf()],this}}),mm=nf.extend({setters:{layers:"layers",precision:"geometryPrecision",tolerance:"tolerance",returnGeometry:"returnGeometry"},params:{sr:4326,layers:"all",tolerance:3,returnGeometry:!0},on:function(m){var x=hc(m.getBounds()),S=m.getSize();return this.params.imageDisplay=[S.x,S.y,96],this.params.mapExtent=[x.xmin,x.ymin,x.xmax,x.ymax],this},at:function(m){return m.length===2&&(m=yt.exports.latLng(m)),this._setGeometryParams(m),this},layerDef:function(m,x){return this.params.layerDefs=this.params.layerDefs?this.params.layerDefs+";":"",this.params.layerDefs+=[m,x].join(":"),this},simplify:function(m,x){var S=Math.abs(m.getBounds().getWest()-m.getBounds().getEast());return this.params.maxAllowableOffset=S/m.getSize().y*x,this},run:function(m,x){return this.request(function(S,M){if(S){m.call(x,S,void 0,M);return}else{var R=Pu(M);M.results=M.results.reverse();for(var nt=0;nt<R.features.length;nt++){var u=R.features[nt];u.layerId=M.results[nt].layerId}m.call(x,void 0,R,M)}})},_setGeometryParams:function(m){var x=cc(m);this.params.geometry=x.geometry,this.params.geometryType=x.geometryType}});function _m(m){return new mm(m)}var ym=nf.extend({setters:{setMosaicRule:"mosaicRule",setRenderingRule:"renderingRule",setPixelSize:"pixelSize",returnCatalogItems:"returnCatalogItems",returnGeometry:"returnGeometry"},params:{returnGeometry:!1},at:function(m){return m=yt.exports.latLng(m),this.params.geometry=JSON.stringify({x:m.lng,y:m.lat,spatialReference:{wkid:4326}}),this.params.geometryType="esriGeometryPoint",this},getMosaicRule:function(){return this.params.mosaicRule},getRenderingRule:function(){return this.params.renderingRule},getPixelSize:function(){return this.params.pixelSize},run:function(m,x){return this.request(function(S,M){m.call(x,S,M&&this._responseToGeoJSON(M),M)},this)},_responseToGeoJSON:function(m){var x=m.location,S=m.catalogItems,M=m.catalogItemVisibilities,R={pixel:{type:"Feature",geometry:{type:"Point",coordinates:[x.x,x.y]},crs:{type:"EPSG",properties:{code:x.spatialReference.wkid}},properties:{OBJECTID:m.objectId,name:m.name,value:m.value},id:m.objectId}};if(m.properties&&m.properties.Values&&(R.pixel.properties.values=m.properties.Values),S&&S.features&&(R.catalogItems=Pu(S),M&&M.length===R.catalogItems.features.length))for(var nt=M.length-1;nt>=0;nt--)R.catalogItems.features[nt].properties.catalogItemVisibility=M[nt];return R}});function gm(m){return new ym(m)}var dc=yt.exports.Evented.extend({options:{proxy:!1,useCors:dh,timeout:0},initialize:function(m){m=m||{},this._requestQueue=[],this._authenticating=!1,yt.exports.Util.setOptions(this,m),this.options.url=_h(this.options.url)},get:function(m,x,S,M){return this._request("get",m,x,S,M)},post:function(m,x,S,M){return this._request("post",m,x,S,M)},request:function(m,x,S,M){return this._request("request",m,x,S,M)},metadata:function(m,x){return this._request("get","",{},m,x)},authenticate:function(m){return this._authenticating=!1,this.options.token=m,this._runQueue(),this},getTimeout:function(){return this.options.timeout},setTimeout:function(m){this.options.timeout=m},_request:function(m,x,S,M,R){this.fire("requeststart",{url:this.options.url+x,params:S,method:m},!0);var nt=this._createServiceCallback(m,x,S,M,R);if(this.options.token&&(S.token=this.options.token),this.options.requestParams&&yt.exports.Util.extend(S,this.options.requestParams),this._authenticating){this._requestQueue.push([m,x,S,M,R]);return}else{var u=this.options.proxy?this.options.proxy+"?"+this.options.url+x:this.options.url+x;return(m==="get"||m==="request")&&!this.options.useCors?ch.get.JSONP(u,S,nt,R):ch[m](u,S,nt,R)}},_createServiceCallback:function(m,x,S,M,R){return yt.exports.Util.bind(function(nt,u){nt&&(nt.code===499||nt.code===498)&&(this._authenticating=!0,this._requestQueue.push([m,x,S,M,R]),this.fire("authenticationrequired",{authenticate:yt.exports.Util.bind(this.authenticate,this)},!0),nt.authenticate=yt.exports.Util.bind(this.authenticate,this)),M.call(R,nt,u),nt?this.fire("requesterror",{url:this.options.url+x,params:S,message:nt.message,code:nt.code,method:m},!0):this.fire("requestsuccess",{url:this.options.url+x,params:S,response:u,method:m},!0),this.fire("requestend",{url:this.options.url+x,params:S,method:m},!0)},this)},_runQueue:function(){for(var m=this._requestQueue.length-1;m>=0;m--){var x=this._requestQueue[m],S=x.shift();this[S].apply(this,x)}this._requestQueue=[]}}),vm=dc.extend({identify:function(){return _m(this)},find:function(){return dm(this)},query:function(){return fc(this)}});function of(m){return new vm(m)}var xm=dc.extend({query:function(){return fc(this)},identify:function(){return gm(this)}});function bm(m){return new xm(m)}var wm=dc.extend({options:{idAttribute:"OBJECTID"},query:function(){return fc(this)},addFeature:function(m,x,S){this.addFeatures(m,x,S)},addFeatures:function(m,x,S){for(var M=m.features?m.features:[m],R=M.length-1;R>=0;R--)delete M[R].id;return m=Tu(m),m=M.length>1?m:[m],this.post("addFeatures",{features:m},function(nt,u){var Et=u&&u.addResults?u.addResults.length>1?u.addResults:u.addResults[0]:void 0;x&&x.call(S,nt||u.addResults[0].error,Et)},S)},updateFeature:function(m,x,S){this.updateFeatures(m,x,S)},updateFeatures:function(m,x,S){var M=m.features?m.features:[m];return m=Tu(m,this.options.idAttribute),m=M.length>1?m:[m],this.post("updateFeatures",{features:m},function(R,nt){var u=nt&&nt.updateResults?nt.updateResults.length>1?nt.updateResults:nt.updateResults[0]:void 0;x&&x.call(S,R||nt.updateResults[0].error,u)},S)},deleteFeature:function(m,x,S){this.deleteFeatures(m,x,S)},deleteFeatures:function(m,x,S){return this.post("deleteFeatures",{objectIds:m},function(M,R){var nt=R&&R.deleteResults?R.deleteResults.length>1?R.deleteResults:R.deleteResults[0]:void 0;x&&x.call(S,M||R.deleteResults[0].error,nt)},S)}});function Tm(m){return new wm(m)}var Sr=window.location.protocol!=="https:"?"http:":"https:",Fp=yt.exports.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map"}},Topographic:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map"}},Oceans:{urlTemplate:Sr+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"USGS, NOAA",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap"}},OceansLabels:{urlTemplate:Sr+"//{s}.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:vs?"esri-labels":"tilePane",attribution:""}},NationalGeographic:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"National Geographic, DeLorme, HERE, UNEP-WCMC, USGS, NASA, ESA, METI, NRCAN, GEBCO, NOAA, increment P Corp."}},DarkGray:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},DarkGrayLabels:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:vs?"esri-labels":"tilePane",attribution:""}},Gray:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:"HERE, DeLorme, MapmyIndia, &copy; OpenStreetMap contributors"}},GrayLabels:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],pane:vs?"esri-labels":"tilePane",attribution:""}},Imagery:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:"DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}},ImageryLabels:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:vs?"esri-labels":"tilePane",attribution:""}},ImageryTransportation:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],pane:vs?"esri-labels":"tilePane",attribution:""}},ShadedRelief:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS"}},ShadedReliefLabels:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"],pane:vs?"esri-labels":"tilePane",attribution:""}},Terrain:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:"USGS, NOAA"}},TerrainLabels:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],pane:vs?"esri-labels":"tilePane",attribution:""}},USATopo:{urlTemplate:Sr+"//{s}.arcgisonline.com/ArcGIS/rest/services/USA_Topo_Maps/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:15,subdomains:["server","services"],attribution:"USGS, National Geographic Society, i-cubed"}},ImageryClarity:{urlTemplate:Sr+"//clarity.maptiles.arcgis.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community"}},Physical:{urlTemplate:Sr+"//{s}.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:8,subdomains:["server","services"],attribution:"U.S. National Park Service"}},ImageryFirefly:{urlTemplate:Sr+"//fly.maptiles.arcgis.com/arcgis/rest/services/World_Imagery_Firefly/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,attribution:"Esri, DigitalGlobe, GeoEye, Earthstar Geographics, CNES/Airbus DS, USDA, USGS, AeroGRID, IGN, and the GIS User Community",attributionUrl:"https://static.arcgis.com/attribution/World_Imagery"}}}},initialize:function(m,x){var S;if(typeof m=="object"&&m.urlTemplate&&m.options)S=m;else if(typeof m=="string"&&Fp.TILES[m])S=Fp.TILES[m];else throw new Error('L.esri.BasemapLayer: Invalid parameter. Use one of "Streets", "Topographic", "Oceans", "OceansLabels", "NationalGeographic", "Physical", "Gray", "GrayLabels", "DarkGray", "DarkGrayLabels", "Imagery", "ImageryLabels", "ImageryTransportation", "ImageryClarity", "ImageryFirefly", ShadedRelief", "ShadedReliefLabels", "Terrain", "TerrainLabels" or "USATopo"');var M=yt.exports.Util.extend(S.options,x);yt.exports.Util.setOptions(this,M),this.options.ignoreDeprecationWarning||console.warn("WARNING: L.esri.BasemapLayer uses data services that are in mature support and are not being updated. Please use L.esri.Vector.vectorBasemapLayer instead. More info: https://esriurl.com/esri-leaflet-basemap"),this.options.token&&S.urlTemplate.indexOf("token=")===-1&&(S.urlTemplate+="?token="+this.options.token),this.options.proxy&&(S.urlTemplate=this.options.proxy+"?"+S.urlTemplate),yt.exports.TileLayer.prototype.initialize.call(this,S.urlTemplate,M)},onAdd:function(m){Eu(m),this.options.pane==="esri-labels"&&this._initPane(),this.options.attributionUrl&&rf((this.options.proxy?this.options.proxy+"?":"")+this.options.attributionUrl,m),m.on("moveend",fh),yt.exports.TileLayer.prototype.onAdd.call(this,m)},onRemove:function(m){yh(m),m.off("moveend",fh),yt.exports.TileLayer.prototype.onRemove.call(this,m)},_initPane:function(){if(!this._map.getPane(this.options.pane)){var m=this._map.createPane(this.options.pane);m.style.pointerEvents="none",m.style.zIndex=500}},getAttribution:function(){if(this.options.attribution)var m='<span class="esri-dynamic-attribution">'+this.options.attribution+"</span>";return m}}),Sm=yt.exports.TileLayer.extend({options:{zoomOffsetAllowance:.1,errorTileUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEABAMAAACuXLVVAAAAA1BMVEUzNDVszlHHAAAAAXRSTlMAQObYZgAAAAlwSFlzAAAAAAAAAAAB6mUWpAAAADZJREFUeJztwQEBAAAAgiD/r25IQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA7waBAAABw08RwAAAAABJRU5ErkJggg=="},statics:{MercatorZoomLevels:{"0":156543.033928,"1":78271.5169639999,"2":39135.7584820001,"3":19567.8792409999,"4":9783.93962049996,"5":4891.96981024998,"6":2445.98490512499,"7":1222.99245256249,"8":611.49622628138,"9":305.748113140558,"10":152.874056570411,"11":76.4370282850732,"12":38.2185141425366,"13":19.1092570712683,"14":9.55462853563415,"15":4.77731426794937,"16":2.38865713397468,"17":1.19432856685505,"18":.597164283559817,"19":.298582141647617,"20":.14929107082381,"21":.07464553541191,"22":.0373227677059525,"23":.0186613838529763}},initialize:function(m){m=yt.exports.Util.setOptions(this,m),m=Iu(m),this.tileUrl=(m.proxy?m.proxy+"?":"")+m.url+"tile/{z}/{y}/{x}"+(m.requestParams&&Object.keys(m.requestParams).length>0?yt.exports.Util.getParamString(m.requestParams):""),m.url.indexOf("{s}")!==-1&&m.subdomains&&(m.url=m.url.replace("{s}",m.subdomains[0])),this.service=of(m),this.service.addEventParent(this);var x=new RegExp(/tiles.arcgis(online)?\.com/g);x.test(m.url)&&(this.tileUrl=this.tileUrl.replace("://tiles","://tiles{s}"),m.subdomains=["1","2","3","4"]),this.options.token&&(this.tileUrl+="?token="+this.options.token),yt.exports.TileLayer.prototype.initialize.call(this,this.tileUrl,m)},getTileUrl:function(m){var x=this._getZoomForUrl();return yt.exports.Util.template(this.tileUrl,yt.exports.Util.extend({s:this._getSubdomain(m),x:m.x,y:m.y,z:this._lodMap&&this._lodMap[x]?this._lodMap[x]:x},this.options))},createTile:function(m,x){var S=document.createElement("img");return yt.exports.DomEvent.on(S,"load",yt.exports.Util.bind(this._tileOnLoad,this,x,S)),yt.exports.DomEvent.on(S,"error",yt.exports.Util.bind(this._tileOnError,this,x,S)),this.options.crossOrigin&&(S.crossOrigin=""),S.alt="",!this._lodMap||this._lodMap&&this._lodMap[this._getZoomForUrl()]?S.src=this.getTileUrl(m):this.once("lodmap",function(){S.src=this.getTileUrl(m)},this),S},onAdd:function(m){Eu(m),this._lodMap||this.metadata(function(x,S){if(!x&&S.spatialReference){var M=S.spatialReference.latestWkid||S.spatialReference.wkid;if(!this.options.attribution&&m.attributionControl&&S.copyrightText&&(this.options.attribution=S.copyrightText,m.attributionControl.addAttribution(this.getAttribution())),m.options.crs===yt.exports.CRS.EPSG3857&&(M===102100||M===3857)){this._lodMap={};for(var R=S.tileInfo.lods,nt=Sm.MercatorZoomLevels,u=0;u<R.length;u++){var Et=R[u];for(var st in nt){var Kt=nt[st];if(this._withinPercentage(Et.resolution,Kt,this.options.zoomOffsetAllowance)){this._lodMap[st]=Et.level;break}}}this.fire("lodmap")}else m.options.crs&&m.options.crs.code&&m.options.crs.code.indexOf(M)>-1||bs("L.esri.TiledMapLayer is using a non-mercator spatial reference. Support may be available through Proj4Leaflet http://esri.github.io/esri-leaflet/examples/non-mercator-projection.html")}},this),yt.exports.TileLayer.prototype.onAdd.call(this,m)},onRemove:function(m){yh(m),yt.exports.TileLayer.prototype.onRemove.call(this,m)},metadata:function(m,x){return this.service.metadata(m,x),this},identify:function(){return this.service.identify()},find:function(){return this.service.find()},query:function(){return this.service.query()},authenticate:function(m){var x="?token="+m;return this.tileUrl=this.options.token?this.tileUrl.replace(/\?token=(.+)/g,x):this.tileUrl+x,this.options.token=m,this.service.authenticate(m),this},_withinPercentage:function(m,x,S){var M=Math.abs(m/x-1);return M<S}}),Pm=yt.exports.ImageOverlay.extend({onAdd:function(m){this._topLeft=m.getPixelBounds().min,yt.exports.ImageOverlay.prototype.onAdd.call(this,m)},_reset:function(){this._map.options.crs===yt.exports.CRS.EPSG3857?yt.exports.ImageOverlay.prototype._reset.call(this):yt.exports.DomUtil.setPosition(this._image,this._topLeft.subtract(this._map.getPixelOrigin()))}}),af=yt.exports.Layer.extend({options:{opacity:1,position:"front",f:"image",useCors:dh,attribution:null,interactive:!1,alt:""},onAdd:function(m){Eu(m),this.options.zIndex&&(this.options.position=null),this._update=yt.exports.Util.throttle(this._update,this.options.updateInterval,this),m.on("moveend",this._update,this),this._currentImage&&this._currentImage._bounds.equals(this._map.getBounds())?m.addLayer(this._currentImage):this._currentImage&&(this._map.removeLayer(this._currentImage),this._currentImage=null),this._update(),this._popup&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this.metadata(function(x,S){!x&&!this.options.attribution&&m.attributionControl&&S.copyrightText&&(this.options.attribution=S.copyrightText,m.attributionControl.addAttribution(this.getAttribution()))},this)},onRemove:function(m){yh(m),this._currentImage&&this._map.removeLayer(this._currentImage),this._popup&&(this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._map.off("moveend",this._update,this)},bindPopup:function(m,x){return this._shouldRenderPopup=!1,this._lastClick=!1,this._popup=yt.exports.popup(x),this._popupFunction=m,this._map&&(this._map.on("click",this._getPopupData,this),this._map.on("dblclick",this._resetPopupState,this)),this},unbindPopup:function(){return this._map&&(this._map.closePopup(this._popup),this._map.off("click",this._getPopupData,this),this._map.off("dblclick",this._resetPopupState,this)),this._popup=!1,this},bringToFront:function(){return this.options.position="front",this._currentImage&&(this._currentImage.bringToFront(),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this.options.position="back",this._currentImage&&(this._currentImage.bringToBack(),this._setAutoZIndex(Math.min)),this},setZIndex:function(m){return this.options.zIndex=m,this._currentImage&&this._currentImage.setZIndex(m),this},_setAutoZIndex:function(m){if(!!this._currentImage){for(var x=this._currentImage.getPane().children,S=-m(-1/0,1/0),M=0,R=x.length,nt;M<R;M++)nt=x[M].style.zIndex,x[M]!==this._currentImage._image&&nt&&(S=m(S,+nt));isFinite(S)&&(this.options.zIndex=S+m(-1,1),this.setZIndex(this.options.zIndex))}},getAttribution:function(){return this.options.attribution},getOpacity:function(){return this.options.opacity},setOpacity:function(m){return this.options.opacity=m,this._currentImage&&this._currentImage.setOpacity(m),this},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(m,x){return this.options.from=m,this.options.to=x,this._update(),this},metadata:function(m,x){return this.service.metadata(m,x),this},authenticate:function(m){return this.service.authenticate(m),this},redraw:function(){this._update()},_renderImage:function(m,x,S){if(this._map){if(S&&(m="data:"+S+";base64,"+m),!m)return;var M=new Pm(m,x,{opacity:0,crossOrigin:this.options.withCredentials?"use-credentials":this.options.useCors,alt:this.options.alt,pane:this.options.pane||this.getPane(),interactive:this.options.interactive}).addTo(this._map),R=function(){this._map.removeLayer(M),this.fire("error"),M.off("load",nt,this)},nt=function(u){if(M.off("error",nt,this),this._map){var Et=u.target,st=this._currentImage;Et._bounds.equals(x)&&Et._bounds.equals(this._map.getBounds())?(this._currentImage=Et,this.options.position==="front"?this.bringToFront():this.options.position==="back"&&this.bringToBack(),this.options.zIndex&&this.setZIndex(this.options.zIndex),this._map&&this._currentImage._map?this._currentImage.setOpacity(this.options.opacity):this._currentImage._map.removeLayer(this._currentImage),st&&this._map&&this._map.removeLayer(st),st&&st._map&&st._map.removeLayer(st)):this._map.removeLayer(Et)}this.fire("load",{bounds:x})};M.once("error",R,this),M.once("load",nt,this)}},_update:function(){if(!!this._map){var m=this._map.getZoom(),x=this._map.getBounds();if(!this._animatingZoom&&!(this._map._panTransition&&this._map._panTransition._inProgress)){if(m>this.options.maxZoom||m<this.options.minZoom){this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null);return}var S=this._buildExportParams();yt.exports.Util.extend(S,this.options.requestParams),S?(this._requestExport(S,x),this.fire("loading",{bounds:x})):this._currentImage&&(this._currentImage._map.removeLayer(this._currentImage),this._currentImage=null)}}},_renderPopup:function(m,x,S,M){if(m=yt.exports.latLng(m),this._shouldRenderPopup&&this._lastClick.equals(m)){var R=this._popupFunction(x,S,M);R&&this._popup.setLatLng(m).setContent(R).openOn(this._map)}},_resetPopupState:function(m){this._shouldRenderPopup=!1,this._lastClick=m.latlng},_calculateBbox:function(){var m=this._map.getPixelBounds(),x=this._map.unproject(m.getBottomLeft()),S=this._map.unproject(m.getTopRight()),M=this._map.options.crs.project(S),R=this._map.options.crs.project(x),nt=yt.exports.bounds(M,R);return[nt.getBottomLeft().x,nt.getBottomLeft().y,nt.getTopRight().x,nt.getTopRight().y].join(",")},_calculateImageSize:function(){var m=this._map.getPixelBounds(),x=this._map.getSize(),S=this._map.unproject(m.getBottomLeft()),M=this._map.unproject(m.getTopRight()),R=this._map.latLngToLayerPoint(M).y,nt=this._map.latLngToLayerPoint(S).y;return(R>0||nt<x.y)&&(x.y=nt-R),x.x+","+x.y}});af.extend({options:{updateInterval:150,format:"jpgpng",transparent:!0,f:"image"},query:function(){return this.service.query()},identify:function(){return this.service.identify()},initialize:function(m){m=Iu(m),this.service=bm(m),this.service.addEventParent(this),yt.exports.Util.setOptions(this,m)},setPixelType:function(m){return this.options.pixelType=m,this._update(),this},getPixelType:function(){return this.options.pixelType},setBandIds:function(m){return yt.exports.Util.isArray(m)?this.options.bandIds=m.join(","):this.options.bandIds=m.toString(),this._update(),this},getBandIds:function(){return this.options.bandIds},setNoData:function(m,x){return yt.exports.Util.isArray(m)?this.options.noData=m.join(","):this.options.noData=m.toString(),x&&(this.options.noDataInterpretation=x),this._update(),this},getNoData:function(){return this.options.noData},getNoDataInterpretation:function(){return this.options.noDataInterpretation},setRenderingRule:function(m){this.options.renderingRule=m,this._update()},getRenderingRule:function(){return this.options.renderingRule},setMosaicRule:function(m){this.options.mosaicRule=m,this._update()},getMosaicRule:function(){return this.options.mosaicRule},_getPopupData:function(m){var x=yt.exports.Util.bind(function(M,R,nt){M||setTimeout(yt.exports.Util.bind(function(){this._renderPopup(m.latlng,M,R,nt)},this),300)},this),S=this.identify().at(m.latlng);this.options.mosaicRule&&S.setMosaicRule(this.options.mosaicRule),S.run(x),this._shouldRenderPopup=!0,this._lastClick=m.latlng},_buildExportParams:function(){var m=parseInt(this._map.options.crs.code.split(":")[1],10),x={bbox:this._calculateBbox(),size:this._calculateImageSize(),format:this.options.format,transparent:this.options.transparent,bboxSR:m,imageSR:m};return this.options.from&&this.options.to&&(x.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.options.pixelType&&(x.pixelType=this.options.pixelType),this.options.interpolation&&(x.interpolation=this.options.interpolation),this.options.compressionQuality&&(x.compressionQuality=this.options.compressionQuality),this.options.bandIds&&(x.bandIds=this.options.bandIds),(this.options.noData===0||this.options.noData)&&(x.noData=this.options.noData),this.options.noDataInterpretation&&(x.noDataInterpretation=this.options.noDataInterpretation),this.service.options.token&&(x.token=this.service.options.token),this.options.renderingRule&&(x.renderingRule=JSON.stringify(this.options.renderingRule)),this.options.mosaicRule&&(x.mosaicRule=JSON.stringify(this.options.mosaicRule)),x},_requestExport:function(m,x){if(this.options.f==="json")this.service.request("exportImage",m,function(M,R){M||(this.options.token&&(R.href+="?token="+this.options.token),this.options.proxy&&(R.href=this.options.proxy+"?"+R.href),this._renderImage(R.href,x))},this);else{m.f="image";var S=this.options.url+"exportImage"+yt.exports.Util.getParamString(m);this.options.proxy&&(S=this.options.proxy+"?"+S),this._renderImage(S,x)}}});var Im=af.extend({options:{updateInterval:150,layers:!1,layerDefs:!1,timeOptions:!1,format:"png32",transparent:!0,f:"json"},initialize:function(m){m=Iu(m),this.service=of(m),this.service.addEventParent(this),yt.exports.Util.setOptions(this,m)},getDynamicLayers:function(){return this.options.dynamicLayers},setDynamicLayers:function(m){return this.options.dynamicLayers=m,this._update(),this},getLayers:function(){return this.options.layers},setLayers:function(m){return this.options.layers=m,this._update(),this},getLayerDefs:function(){return this.options.layerDefs},setLayerDefs:function(m){return this.options.layerDefs=m,this._update(),this},getTimeOptions:function(){return this.options.timeOptions},setTimeOptions:function(m){return this.options.timeOptions=m,this._update(),this},query:function(){return this.service.query()},identify:function(){return this.service.identify()},find:function(){return this.service.find()},_getPopupData:function(m){var x=yt.exports.Util.bind(function(R,nt,u){R||setTimeout(yt.exports.Util.bind(function(){this._renderPopup(m.latlng,R,nt,u)},this),300)},this),S;if(this.options.popup?S=this.options.popup.on(this._map).at(m.latlng):S=this.identify().on(this._map).at(m.latlng),S.params.maxAllowableOffset||S.simplify(this._map,.5),this.options.popup&&this.options.popup.params&&this.options.popup.params.layers||(this.options.layers?S.layers("visible:"+this.options.layers.join(",")):S.layers("visible")),this.options.layerDefs&&typeof this.options.layerDefs!="string"&&!S.params.layerDefs)for(var M in this.options.layerDefs)this.options.layerDefs.hasOwnProperty(M)&&S.layerDef(M,this.options.layerDefs[M]);S.run(x),this._shouldRenderPopup=!0,this._lastClick=m.latlng},_buildExportParams:function(){var m=parseInt(this._map.options.crs.code.split(":")[1],10),x={bbox:this._calculateBbox(),size:this._calculateImageSize(),dpi:96,format:this.options.format,transparent:this.options.transparent,bboxSR:m,imageSR:m};if(this.options.dynamicLayers&&(x.dynamicLayers=this.options.dynamicLayers),this.options.layers){if(this.options.layers.length===0)return;x.layers="show:"+this.options.layers.join(",")}return this.options.layerDefs&&(x.layerDefs=typeof this.options.layerDefs=="string"?this.options.layerDefs:JSON.stringify(this.options.layerDefs)),this.options.timeOptions&&(x.timeOptions=JSON.stringify(this.options.timeOptions)),this.options.from&&this.options.to&&(x.time=this.options.from.valueOf()+","+this.options.to.valueOf()),this.service.options.token&&(x.token=this.service.options.token),this.options.proxy&&(x.proxy=this.options.proxy),this.options.disableCache&&(x._ts=Date.now()),x},_requestExport:function(m,x){if(this.options.f==="json")this.service.request("export",m,function(M,R){M||(this.options.token&&R.href&&(R.href+="?token="+this.options.token),this.options.proxy&&R.href&&(R.href=this.options.proxy+"?"+R.href),R.href?this._renderImage(R.href,x):this._renderImage(R.imageData,x,R.contentType))},this);else{m.f="image";var S=this.options.url+"export"+yt.exports.Util.getParamString(m);this.options.proxy&&(S=this.options.proxy+"?"+S),this._renderImage(S,x)}}});function r_(m,x){return new Im(m,x)}var lh=yt.exports.Layer.extend({options:{cellSize:512,updateWhenIdle:yt.exports.Browser.mobile,updateInterval:150,noWrap:!1,keepBuffer:1.5},initialize:function(m){yt.exports.Util.setOptions(this,m)},onAdd:function(m){this._cells={},this._activeCells={},this._resetView(),this._update()},onRemove:function(m){this._removeAllCells(),this._cellZoom=void 0},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllCells(),this._update()),this},getEvents:function(){var m={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=yt.exports.Util.throttle(this._onMoveEnd,this.options.updateInterval,this)),m.move=this._onMove),m},createCell:function(){return document.createElement("div")},removeCell:function(){},reuseCell:function(){},cellLeave:function(){},cellEnter:function(){},getCellSize:function(){var m=this.options.cellSize;return m instanceof yt.exports.Point?m:new yt.exports.Point(m,m)},_pruneCells:function(){if(!!this._map){var m,x;for(m in this._cells)x=this._cells[m],x.retain=x.current;for(m in this._cells)if(x=this._cells[m],x.current&&!x.active){var S=x.coords;this._retainParent(S.x,S.y,S.z,S.z-5)||this._retainChildren(S.x,S.y,S.z,S.z+2)}for(m in this._cells)this._cells[m].retain||this._removeCell(m)}},_removeAllCells:function(){for(var m in this._cells)this._removeCell(m)},_invalidateAll:function(){this._removeAllCells(),this._cellZoom=void 0},_retainParent:function(m,x,S,M){var R=Math.floor(m/2),nt=Math.floor(x/2),u=S-1,Et=new yt.exports.Point(+R,+nt);Et.z=+u;var st=this._cellCoordsToKey(Et),Kt=this._cells[st];return Kt&&Kt.active?(Kt.retain=!0,!0):(Kt&&Kt.loaded&&(Kt.retain=!0),u>M?this._retainParent(R,nt,u,M):!1)},_retainChildren:function(m,x,S,M){for(var R=2*m;R<2*m+2;R++)for(var nt=2*x;nt<2*x+2;nt++){var u=new yt.exports.Point(R,nt);u.z=S+1;var Et=this._cellCoordsToKey(u),st=this._cells[Et];if(st&&st.active){st.retain=!0;continue}else st&&st.loaded&&(st.retain=!0);S+1<M&&this._retainChildren(R,nt,S+1,M)}},_resetView:function(m){var x=m&&(m.pinch||m.flyTo);x||this._setView(this._map.getCenter(),this._map.getZoom(),x,x)},_setView:function(m,x,S,M){var R=Math.round(x);M||(this._cellZoom=R,this._abortLoading&&this._abortLoading(),this._resetGrid(),R!==void 0&&this._update(m),S||this._pruneCells(),this._noPrune=!!S)},_resetGrid:function(){var m=this._map,x=m.options.crs,S=this._cellSize=this.getCellSize(),M=this._cellZoom,R=this._map.getPixelWorldBounds(this._cellZoom);R&&(this._globalCellRange=this._pxBoundsToCellRange(R)),this._wrapX=x.wrapLng&&!this.options.noWrap&&[Math.floor(m.project([0,x.wrapLng[0]],M).x/S.x),Math.ceil(m.project([0,x.wrapLng[1]],M).x/S.y)],this._wrapY=x.wrapLat&&!this.options.noWrap&&[Math.floor(m.project([x.wrapLat[0],0],M).y/S.x),Math.ceil(m.project([x.wrapLat[1],0],M).y/S.y)]},_onMoveEnd:function(m){var x=m&&(m.pinch||m.flyTo);x||!this._map||this._map._animatingZoom||this._update()},_getCelldPixelBounds:function(m){var x=this._map,S=x._animatingZoom?Math.max(x._animateToZoom,x.getZoom()):x.getZoom(),M=x.getZoomScale(S,this._cellZoom),R=x.project(m,this._cellZoom).floor(),nt=x.getSize().divideBy(M*2);return new yt.exports.Bounds(R.subtract(nt),R.add(nt))},_update:function(m){var x=this._map;if(!!x){var S=Math.round(x.getZoom());m===void 0&&(m=x.getCenter());var M=this._getCelldPixelBounds(m),R=this._pxBoundsToCellRange(M),nt=R.getCenter(),u=[],Et=this.options.keepBuffer,st=new yt.exports.Bounds(R.getBottomLeft().subtract([Et,-Et]),R.getTopRight().add([Et,-Et]));if(!(isFinite(R.min.x)&&isFinite(R.min.y)&&isFinite(R.max.x)&&isFinite(R.max.y)))throw new Error("Attempted to load an infinite number of cells");for(var Kt in this._cells){var Vt=this._cells[Kt].coords;(Vt.z!==this._cellZoom||!st.contains(new yt.exports.Point(Vt.x,Vt.y)))&&(this._cells[Kt].current=!1)}if(Math.abs(S-this._cellZoom)>1){this._setView(m,S);return}for(var fe=R.min.y;fe<=R.max.y;fe++)for(var Ct=R.min.x;Ct<=R.max.x;Ct++){var sr=new yt.exports.Point(Ct,fe);if(sr.z=this._cellZoom,!!this._isValidCell(sr)){var oi=this._cells[this._cellCoordsToKey(sr)];oi?oi.current=!0:u.push(sr)}}if(u.sort(function(bo,ki){return bo.distanceTo(nt)-ki.distanceTo(nt)}),u.length!==0)for(this._loading||(this._loading=!0),Ct=0;Ct<u.length;Ct++){var Je=this._cellCoordsToKey(u[Ct]),lr=this._keyToCellCoords(Je);this._activeCells[lr]?this._reuseCell(u[Ct]):this._createCell(u[Ct])}}},_isValidCell:function(m){var x=this._map.options.crs;if(!x.infinite){var S=this._globalCellRange;if(!x.wrapLng&&(m.x<S.min.x||m.x>S.max.x)||!x.wrapLat&&(m.y<S.min.y||m.y>S.max.y))return!1}if(!this.options.bounds)return!0;var M=this._cellCoordsToBounds(m);return yt.exports.toLatLngBounds(this.options.bounds).overlaps(M)},_keyToBounds:function(m){return this._cellCoordsToBounds(this._keyToCellCoords(m))},_cellCoordsToNwSe:function(m){var x=this._map,S=this.getCellSize(),M=m.scaleBy(S),R=M.add(S),nt=x.unproject(M,m.z),u=x.unproject(R,m.z);return[nt,u]},_cellCoordsToBounds:function(m){var x=this._cellCoordsToNwSe(m),S=new yt.exports.LatLngBounds(x[0],x[1]);return this.options.noWrap||(S=this._map.wrapLatLngBounds(S)),S},_cellCoordsToKey:function(m){return m.x+":"+m.y+":"+m.z},_keyToCellCoords:function(m){var x=m.split(":"),S=new yt.exports.Point(+x[0],+x[1]);return S.z=+x[2],S},_removeCell:function(m){var x=this._cells[m];if(!!x){var S=this._keyToCellCoords(m),M=this._wrapCoords(S),R=this._cellCoordsToBounds(this._wrapCoords(S));x.current=!1,delete this._cells[m],this._activeCells[m]=x,this.cellLeave(R,M,m),this.fire("cellleave",{key:m,coords:M,bounds:R})}},_reuseCell:function(m){var x=this._cellCoordsToKey(m);this._cells[x]=this._activeCells[x],this._cells[x].current=!0;var S=this._wrapCoords(m),M=this._cellCoordsToBounds(this._wrapCoords(m));this.cellEnter(M,S,x),this.fire("cellenter",{key:x,coords:S,bounds:M})},_createCell:function(m){var x=this._cellCoordsToKey(m),S=this._wrapCoords(m),M=this._cellCoordsToBounds(this._wrapCoords(m));this.createCell(M,S,x),this.fire("cellcreate",{key:x,coords:S,bounds:M}),this._cells[x]={coords:m,current:!0},yt.exports.Util.requestAnimFrame(this._pruneCells,this)},_cellReady:function(m,x,S){var M=this._cellCoordsToKey(m);S=this._cells[M],!!S&&(S.loaded=+new Date,S.active=!0)},_getCellPos:function(m){return m.scaleBy(this.getCellSize())},_wrapCoords:function(m){var x=new yt.exports.Point(this._wrapX?yt.exports.Util.wrapNum(m.x,this._wrapX):m.x,this._wrapY?yt.exports.Util.wrapNum(m.y,this._wrapY):m.y);return x.z=m.z,x},_pxBoundsToCellRange:function(m){var x=this.getCellSize();return new yt.exports.Bounds(m.min.unscaleBy(x).floor(),m.max.unscaleBy(x).ceil().subtract([1,1]))}});function qa(m){this.values=[].concat(m||[])}qa.prototype.query=function(m){var x=this.getIndex(m);return this.values[x]};qa.prototype.getIndex=function(x){this.dirty&&this.sort();for(var S=0,M=this.values.length-1,R,nt;S<=M;)if(R=(S+M)/2|0,nt=this.values[Math.round(R)],+nt.value<+x)S=R+1;else if(+nt.value>+x)M=R-1;else return R;return Math.abs(~M)};qa.prototype.between=function(x,S){var M=this.getIndex(x),R=this.getIndex(S);if(M===0&&R===0)return[];for(;this.values[M-1]&&this.values[M-1].value===x;)M--;for(;this.values[R+1]&&this.values[R+1].value===S;)R++;return this.values[R]&&this.values[R].value===S&&this.values[R+1]&&R++,this.values.slice(M,R)};qa.prototype.insert=function(x){return this.values.splice(this.getIndex(x.value),0,x),this};qa.prototype.bulkAdd=function(x,S){return this.values=this.values.concat([].concat(x||[])),S?this.sort():this.dirty=!0,this};qa.prototype.sort=function(){return this.values.sort(function(x,S){return+S.value-+x.value}).reverse(),this.dirty=!1,this};var Yh=lh.extend({options:{attribution:null,where:"1=1",fields:["*"],from:!1,to:!1,timeField:!1,timeFilterMode:"server",simplifyFactor:0,precision:6,fetchAllFeatures:!1},initialize:function(m){if(lh.prototype.initialize.call(this,m),m=Iu(m),m=yt.exports.Util.setOptions(this,m),this.service=Tm(m),this.service.addEventParent(this),this.options.fields[0]!=="*"){for(var x=!1,S=0;S<this.options.fields.length;S++)this.options.fields[S].match(/^(OBJECTID|FID|OID|ID)$/i)&&(x=!0);x===!1&&bs("no known esriFieldTypeOID field detected in fields Array.  Please add an attribute field containing unique IDs to ensure the layer can be drawn correctly.")}this.options.timeField.start&&this.options.timeField.end?(this._startTimeIndex=new qa,this._endTimeIndex=new qa):this.options.timeField&&(this._timeIndex=new qa),this._cache={},this._currentSnapshot=[],this._activeRequests=0},onAdd:function(m){return Eu(m),this.service.metadata(function(x,S){if(!x){var M=S.supportedQueryFormats,R=!1;(this.service.options.isModern===!1||this.options.fetchAllFeatures)&&(R=!0),!R&&M&&M.indexOf("geoJSON")!==-1&&(this.service.options.isModern=!0),S.objectIdField&&(this.service.options.idAttribute=S.objectIdField),!this.options.attribution&&m.attributionControl&&S.copyrightText&&(this.options.attribution=S.copyrightText,m.attributionControl.addAttribution(this.getAttribution()))}},this),m.on("zoomend",this._handleZoomChange,this),lh.prototype.onAdd.call(this,m)},onRemove:function(m){return yh(m),m.off("zoomend",this._handleZoomChange,this),lh.prototype.onRemove.call(this,m)},getAttribution:function(){return this.options.attribution},createCell:function(m,x){this._visibleZoom()&&this._requestFeatures(m,x)},_requestFeatures:function(m,x,S,M){this._activeRequests++,M=M||0;var R=this.options.where;return this._activeRequests===1&&this.fire("loading",{bounds:m},!0),this._buildQuery(m,M).run(function(nt,u,Et){Et&&Et.exceededTransferLimit&&this.fire("drawlimitexceeded"),this.options.where===R&&(!nt&&u&&u.features.length&&yt.exports.Util.requestAnimFrame(yt.exports.Util.bind(function(){this._addFeatures(u.features,x),this._postProcessFeatures(m)},this)),!nt&&u&&!u.features.length&&this._postProcessFeatures(m),nt&&this._postProcessFeatures(m),S&&S.call(this,nt,u),Et&&(Et.exceededTransferLimit||Et.properties&&Et.properties.exceededTransferLimit)&&this.options.fetchAllFeatures&&this._requestFeatures(m,x,S,M+u.features.length))},this)},_postProcessFeatures:function(m){this._activeRequests--,this._activeRequests<=0&&this.fire("load",{bounds:m})},_cacheKey:function(m){return m.z+":"+m.x+":"+m.y},_addFeatures:function(m,x){if(x){var S=this._cacheKey(x);this._cache[S]=this._cache[S]||[]}for(var M=m.length-1;M>=0;M--){var R=m[M].id;this._currentSnapshot.indexOf(R)===-1&&this._currentSnapshot.push(R),typeof S!="undefined"&&this._cache[S].indexOf(R)===-1&&this._cache[S].push(R)}this.options.timeField&&this._buildTimeIndexes(m),this.createLayers(m)},_buildQuery:function(m,x){var S=this.service.query().intersects(m).where(this.options.where).fields(this.options.fields).precision(this.options.precision);return this.options.fetchAllFeatures&&!isNaN(parseInt(x))&&(S=S.offset(x)),S.params.resultType="tile",this.options.requestParams&&yt.exports.Util.extend(S.params,this.options.requestParams),this.options.simplifyFactor&&S.simplify(this._map,this.options.simplifyFactor),this.options.timeFilterMode==="server"&&this.options.from&&this.options.to&&S.between(this.options.from,this.options.to),S},setWhere:function(m,x,S){this.options.where=m&&m.length?m:"1=1";for(var M=[],R=[],nt=0,u=null,Et=yt.exports.Util.bind(function(Ct,sr){if(Ct&&(u=Ct),sr)for(var oi=sr.features.length-1;oi>=0;oi--)R.push(sr.features[oi].id);nt--,nt<=0&&this._visibleZoom()&&m===this.options.where&&(this._currentSnapshot=R,yt.exports.Util.requestAnimFrame(yt.exports.Util.bind(function(){this.removeLayers(M),this.addLayers(R),x&&x.call(S,u)},this)))},this),st=this._currentSnapshot.length-1;st>=0;st--)M.push(this._currentSnapshot[st]);this._cache={};for(var Kt in this._cells){nt++;var Vt=this._keyToCellCoords(Kt),fe=this._cellCoordsToBounds(Vt);this._requestFeatures(fe,Vt,Et)}return this},getWhere:function(){return this.options.where},getTimeRange:function(){return[this.options.from,this.options.to]},setTimeRange:function(m,x,S,M){var R=this.options.from,nt=this.options.to,u=0,Et=null,st=yt.exports.Util.bind(function(Ct){Ct&&(Et=Ct),this._filterExistingFeatures(R,nt,m,x),u--,S&&u<=0&&S.call(M,Et)},this);if(this.options.from=m,this.options.to=x,this._filterExistingFeatures(R,nt,m,x),this.options.timeFilterMode==="server")for(var Kt in this._cells){u++;var Vt=this._keyToCellCoords(Kt),fe=this._cellCoordsToBounds(Vt);this._requestFeatures(fe,Vt,st)}return this},refresh:function(){this.setWhere(this.options.where)},_filterExistingFeatures:function(m,x,S,M){var R=m&&x?this._getFeaturesInTimeRange(m,x):this._currentSnapshot,nt=this._getFeaturesInTimeRange(S,M);if(nt.indexOf)for(var u=0;u<nt.length;u++){var Et=R.indexOf(nt[u]);Et>=0&&R.splice(Et,1)}yt.exports.Util.requestAnimFrame(yt.exports.Util.bind(function(){this.removeLayers(R),this.addLayers(nt)},this))},_getFeaturesInTimeRange:function(m,x){var S=[],M;if(this.options.timeField.start&&this.options.timeField.end){var R=this._startTimeIndex.between(m,x),nt=this._endTimeIndex.between(m,x);M=R.concat(nt)}else if(this._timeIndex)M=this._timeIndex.between(m,x);else return bs("You must set timeField in the layer constructor in order to manipulate the start and end time filter."),[];for(var u=M.length-1;u>=0;u--)S.push(M[u].id);return S},_buildTimeIndexes:function(m){var x,S;if(this.options.timeField.start&&this.options.timeField.end){var M=[],R=[];for(x=m.length-1;x>=0;x--)S=m[x],M.push({id:S.id,value:new Date(S.properties[this.options.timeField.start])}),R.push({id:S.id,value:new Date(S.properties[this.options.timeField.end])});this._startTimeIndex.bulkAdd(M),this._endTimeIndex.bulkAdd(R)}else{var nt=[];for(x=m.length-1;x>=0;x--)S=m[x],nt.push({id:S.id,value:new Date(S.properties[this.options.timeField])});this._timeIndex.bulkAdd(nt)}},_featureWithinTimeRange:function(m){if(!this.options.from||!this.options.to)return!0;var x=+this.options.from.valueOf(),S=+this.options.to.valueOf();if(typeof this.options.timeField=="string"){var M=+m.properties[this.options.timeField];return M>=x&&M<=S}if(this.options.timeField.start&&this.options.timeField.end){var R=+m.properties[this.options.timeField.start],nt=+m.properties[this.options.timeField.end];return R>=x&&R<=S||nt>=x&&nt<=S||R<=x&&nt>=S}},_visibleZoom:function(){if(!this._map)return!1;var m=this._map.getZoom();return!(m>this.options.maxZoom||m<this.options.minZoom)},_handleZoomChange:function(){if(!this._visibleZoom())this.removeLayers(this._currentSnapshot),this._currentSnapshot=[];else for(var m in this._cells){var x=this._cells[m].coords,S=this._cacheKey(x);this._cache[S]&&this.addLayers(this._cache[S])}},authenticate:function(m){return this.service.authenticate(m),this},metadata:function(m,x){return this.service.metadata(m,x),this},query:function(){return this.service.query()},_getMetadata:function(m){if(this._metadata){var x;m(x,this._metadata)}else this.metadata(yt.exports.Util.bind(function(S,M){this._metadata=M,m(S,this._metadata)},this))},addFeature:function(m,x,S){this.addFeatures(m,x,S)},addFeatures:function(m,x,S){this._getMetadata(yt.exports.Util.bind(function(M,R){if(M){x&&x.call(this,M,null);return}var nt=m.features?m.features:[m];this.service.addFeatures(m,yt.exports.Util.bind(function(u,Et){if(!u){for(var st=nt.length-1;st>=0;st--)nt[st].properties[R.objectIdField]=nt.length>1?Et[st].objectId:Et.objectId,nt[st].id=nt.length>1?Et[st].objectId:Et.objectId;this._addFeatures(nt)}x&&x.call(S,u,Et)},this))},this))},updateFeature:function(m,x,S){this.updateFeatures(m,x,S)},updateFeatures:function(m,x,S){var M=m.features?m.features:[m];this.service.updateFeatures(m,function(R,nt){if(!R){for(var u=M.length-1;u>=0;u--)this.removeLayers([M[u].id],!0);this._addFeatures(M)}x&&x.call(S,R,nt)},this)},deleteFeature:function(m,x,S){this.deleteFeatures(m,x,S)},deleteFeatures:function(m,x,S){return this.service.deleteFeatures(m,function(M,R){var nt=R.length?R:[R];if(!M&&nt.length>0)for(var u=nt.length-1;u>=0;u--)this.removeLayers([nt[u].objectId],!0);x&&x.call(S,M,R)},this)}});Yh.extend({options:{cacheLayers:!0},initialize:function(m){m.apikey&&(m.token=m.apikey),Yh.prototype.initialize.call(this,m),this._originalStyle=this.options.style,this._layers={}},onRemove:function(m){for(var x in this._layers)m.removeLayer(this._layers[x]),this.fire("removefeature",{feature:this._layers[x].feature,permanent:!1},!0);return Yh.prototype.onRemove.call(this,m)},createNewLayer:function(m){var x=yt.exports.GeoJSON.geometryToLayer(m,this.options);return x&&(x.defaultOptions=x.options),x},_updateLayer:function(m,x){var S=[],M=this.options.coordsToLatLng||yt.exports.GeoJSON.coordsToLatLng;switch(x.properties&&(m.feature.properties=x.properties),x.geometry.type){case"Point":S=yt.exports.GeoJSON.coordsToLatLng(x.geometry.coordinates),m.setLatLng(S);break;case"LineString":S=yt.exports.GeoJSON.coordsToLatLngs(x.geometry.coordinates,0,M),m.setLatLngs(S);break;case"MultiLineString":S=yt.exports.GeoJSON.coordsToLatLngs(x.geometry.coordinates,1,M),m.setLatLngs(S);break;case"Polygon":S=yt.exports.GeoJSON.coordsToLatLngs(x.geometry.coordinates,1,M),m.setLatLngs(S);break;case"MultiPolygon":S=yt.exports.GeoJSON.coordsToLatLngs(x.geometry.coordinates,2,M),m.setLatLngs(S);break}},createLayers:function(m){for(var x=m.length-1;x>=0;x--){var S=m[x],M=this._layers[S.id],R;this._visibleZoom()&&M&&!this._map.hasLayer(M)&&(!this.options.timeField||this._featureWithinTimeRange(S))&&(this._map.addLayer(M),this.fire("addfeature",{feature:M.feature},!0)),M&&this.options.simplifyFactor>0&&(M.setLatLngs||M.setLatLng)&&this._updateLayer(M,S),M||(R=this.createNewLayer(S),R?(R.feature=S,R.addEventParent(this),this.options.onEachFeature&&this.options.onEachFeature(R.feature,R),this._layers[R.feature.id]=R,this.setFeatureStyle(R.feature.id,this.options.style),this.fire("createfeature",{feature:R.feature},!0),this._visibleZoom()&&(!this.options.timeField||this.options.timeField&&this._featureWithinTimeRange(S))&&this._map.addLayer(R)):bs("invalid GeoJSON encountered"))}},addLayers:function(m){for(var x=m.length-1;x>=0;x--){var S=this._layers[m[x]];S&&(!this.options.timeField||this._featureWithinTimeRange(S.feature))&&(this._map.addLayer(S),this.fire("addfeature",{feature:S.feature},!0))}},removeLayers:function(m,x){for(var S=m.length-1;S>=0;S--){var M=m[S],R=this._layers[M];R&&(this.fire("removefeature",{feature:R.feature,permanent:x},!0),this._map.removeLayer(R)),R&&x&&delete this._layers[M]}},cellEnter:function(m,x){this._visibleZoom()&&!this._zooming&&this._map&&yt.exports.Util.requestAnimFrame(yt.exports.Util.bind(function(){var S=this._cacheKey(x),M=this._cellCoordsToKey(x),R=this._cache[S];this._activeCells[M]&&R&&this.addLayers(R)},this))},cellLeave:function(m,x){this._zooming||yt.exports.Util.requestAnimFrame(yt.exports.Util.bind(function(){if(this._map){var S=this._cacheKey(x),M=this._cellCoordsToKey(x),R=this._cache[S],nt=this._map.getBounds();if(!this._activeCells[M]&&R){for(var u=!0,Et=0;Et<R.length;Et++){var st=this._layers[R[Et]];st&&st.getBounds&&nt.intersects(st.getBounds())&&(u=!1)}u&&this.removeLayers(R,!this.options.cacheLayers),!this.options.cacheLayers&&u&&(delete this._cache[S],delete this._cells[M],delete this._activeCells[M])}}},this))},resetStyle:function(){return this.options.style=this._originalStyle,this.eachFeature(function(m){this.resetFeatureStyle(m.feature.id)},this),this},setStyle:function(m){return this.options.style=m,this.eachFeature(function(x){this.setFeatureStyle(x.feature.id,m)},this),this},resetFeatureStyle:function(m){var x=this._layers[m],S=this._originalStyle||yt.exports.Path.prototype.options;return x&&(yt.exports.Util.extend(x.options,x.defaultOptions),this.setFeatureStyle(m,S)),this},setFeatureStyle:function(m,x){var S=this._layers[m];return typeof x=="function"&&(x=x(S.feature)),S.setStyle&&S.setStyle(x),this},eachActiveFeature:function(m,x){if(this._map){var S=this._map.getBounds();for(var M in this._layers)this._currentSnapshot.indexOf(this._layers[M].feature.id)!==-1&&(typeof this._layers[M].getLatLng=="function"&&S.contains(this._layers[M].getLatLng())?m.call(x,this._layers[M]):typeof this._layers[M].getBounds=="function"&&S.intersects(this._layers[M].getBounds())&&m.call(x,this._layers[M]))}return this},eachFeature:function(m,x){for(var S in this._layers)m.call(x,this._layers[S]);return this},getFeature:function(m){return this._layers[m]},bringToBack:function(){this.eachFeature(function(m){m.bringToBack&&m.bringToBack()})},bringToFront:function(){this.eachFeature(function(m){m.bringToFront&&m.bringToFront()})},redraw:function(m){return m&&this._redraw(m),this},_redraw:function(m){var x=this._layers[m],S=x.feature;if(x&&x.setIcon&&this.options.pointToLayer&&this.options.pointToLayer){var M=this.options.pointToLayer(S,yt.exports.latLng(S.geometry.coordinates[1],S.geometry.coordinates[0])),R=M.options.icon;x.setIcon(R)}if(x&&x.setStyle&&this.options.pointToLayer){var nt=this.options.pointToLayer(S,yt.exports.latLng(S.geometry.coordinates[1],S.geometry.coordinates[0])),u=nt.options;this.setFeatureStyle(S.id,u)}x&&x.setStyle&&this.options.style&&this.resetStyle(S.id)}});function Em(m,x){var S="https://basemaps-api.arcgis.com/arcgis/rest/services/styles/"+m+"?type=style";return x&&(S=S+"&apiKey="+x),S}function Am(m,x,S){var M=/^https?:\/\//,R=/\/VectorTileServer\/?$/;if(M.test(m)&&R.test(m)){var nt=m;lf(nt,x,S)}else{var u=m;Cm(u,x,S)}}function sf(m,x,S){var M=x.token?{token:x.token}:{};Nl(m,M,S)}function Up(m,x,S){var M=x.token?{token:x.token}:{},R=x.portalUrl+"/sharing/rest/content/items/"+m;Nl(R,M,S)}function Cm(m,x,S){var M=x.portalUrl+"/sharing/rest/content/items/"+m+"/resources/styles/root.json";uf(M,x,function(R,nt){R?Up(m,x,function(u,Et){u&&console.error(u),lf(Et.url,x,S)}):Up(m,x,function(u,Et){u&&console.error(u),sf(Et.url,x,function(st,Kt){S(st,nt,M,Kt,Et.url)})})})}function lf(m,x,S){sf(m,x,function(M,R){M&&console.error(M);var nt=m;m.charAt(m.length-1)==="/"&&(nt=m.slice(0,m.length-1));var u;R.defaultStyles.charAt(0)==="/"?u=nt+R.defaultStyles+"/root.json":u=nt+"/"+R.defaultStyles+"/root.json",uf(u,x,function(Et,st){Et&&console.error(Et),S(null,st,u,R,m)})})}function uf(m,x,S){var M=x.token?{token:x.token}:{};Nl(m,M,S)}function Lm(m,x,S,M){for(var R=Object.keys(m.sources),nt=0;nt<R.length;nt++){var u=m.sources[R[nt]];u.url.indexOf("http")===-1&&(u.url=x.replace("/resources/styles/root.json","")),u.url.charAt(u.url.length-1)==="/"&&(u.url=u.url.slice(0,u.url.length-1)),u.tiles||(S.tiles&&S.tiles[0].charAt(0)!=="/"&&(S.tiles[0]="/"+S.tiles[0]),u.tiles=[u.url+S.tiles[0]]),u.url+="?f=json",u.url+=M?"&token="+M:"",u.tiles[0]+=M?"?token="+M:"",u.minzoom=S.tileInfo.lods[0].level,u.maxzoom=S.tileInfo.lods[S.tileInfo.lods.length-1].level}var Et=m.sources[R[R.length-1]];Et.attribution=S.copyrightText||"",Et.copyrightText=S.copyrightText||"";for(var st=0;st<m.layers.length;st++){var Kt=m.layers[st];Kt.layout&&Kt.layout["text-font"]&&Kt.layout["text-font"].length>1&&(Kt.layout["text-font"]=[Kt.layout["text-font"][0]])}return m.sprite&&m.sprite.indexOf("http")===-1&&(m.sprite=x.replace("styles/root.json",m.sprite.replace("../","")),m.sprite+=M?"?token="+M:""),m.glyphs&&m.glyphs.indexOf("http")===-1&&(m.glyphs=x.replace("styles/root.json",m.glyphs.replace("../","")),m.glyphs+=M?"?token="+M:""),m}function zm(m,x){xs.cors&&Nl(m,{},function(S,M){if(!S){x._esriAttributions=x._esriAttributions||[];for(var R=0;R<M.contributors.length;R++)for(var nt=M.contributors[R],u=0;u<nt.coverageAreas.length;u++){var Et=nt.coverageAreas[u],st=yt.exports.latLng(Et.bbox[0],Et.bbox[1]),Kt=yt.exports.latLng(Et.bbox[2],Et.bbox[3]);x._esriAttributions.push({attribution:nt.attribution,score:Et.score,bounds:yt.exports.latLngBounds(st,Kt),minZoom:Et.zoomMin,maxZoom:Et.zoomMax})}x._esriAttributions.sort(function(fe,Ct){return Ct.score-fe.score});var Vt={target:x};bu._updateMapAttribution(Vt)}})}const km=[3857,102100,102113];function Mm(m){return km.indexOf(m)>=0}var hf={exports:{}};(function(m,x){(function(S,M){m.exports=M()})(Gp,function(){var S,M,R;function nt(u,Et){if(!S)S=Et;else if(!M)M=Et;else{var st="var sharedChunk = {}; ("+S+")(sharedChunk); ("+M+")(sharedChunk);",Kt={};S(Kt),R=Et(Kt),typeof window!="undefined"&&(R.workerUrl=window.URL.createObjectURL(new Blob([st],{type:"text/javascript"})))}}return nt(["exports"],function(u){function Et(t,e){return t(e={exports:{}},e.exports),e.exports}var st=Kt;function Kt(t,e,i,s){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=s,this.p2x=i,this.p2y=s}Kt.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},Kt.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},Kt.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},Kt.prototype.solveCurveX=function(t,e){var i,s,c,p,d;for(e===void 0&&(e=1e-6),c=t,d=0;d<8;d++){if(p=this.sampleCurveX(c)-t,Math.abs(p)<e)return c;var v=this.sampleCurveDerivativeX(c);if(Math.abs(v)<1e-6)break;c-=p/v}if((c=t)<(i=0))return i;if(c>(s=1))return s;for(;i<s;){if(p=this.sampleCurveX(c),Math.abs(p-t)<e)return c;t>p?i=c:s=c,c=.5*(s-i)+i}return c},Kt.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var Vt=fe;function fe(t,e){this.x=t,this.y=e}fe.prototype={clone:function(){return new fe(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),s=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=s,this},_rotateAround:function(t,e){var i=Math.cos(t),s=Math.sin(t),c=e.y+s*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-s*(this.y-e.y),this.y=c,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},fe.convert=function(t){return t instanceof fe?t:Array.isArray(t)?new fe(t[0],t[1]):t};var Ct=typeof self!="undefined"?self:{},sr=Math.pow(2,53)-1;function oi(t,e,i,s){var c=new st(t,e,i,s);return function(p){return c.solve(p)}}var Je=oi(.25,.1,.25,1);function lr(t,e,i){return Math.min(i,Math.max(e,t))}function bo(t,e,i){var s=i-e,c=((t-e)%s+s)%s+e;return c===e?i:c}function ki(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];for(var s=0,c=e;s<c.length;s+=1){var p=c[s];for(var d in p)t[d]=p[d]}return t}var Gr=1;function wo(){return Gr++}function an(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Hn(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function To(t,e){t.forEach(function(i){e[i]&&(e[i]=e[i].bind(e))})}function Xn(t,e){return t.indexOf(e,t.length-e.length)!==-1}function Qi(t,e,i){var s={};for(var c in t)s[c]=e.call(i||this,t[c],c,t);return s}function Tn(t,e,i){var s={};for(var c in t)e.call(i||this,t[c],c,t)&&(s[c]=t[c]);return s}function li(t){return Array.isArray(t)?t.map(li):typeof t=="object"&&t?Qi(t,li):t}var ji={};function _i(t){ji[t]||(typeof console!="undefined"&&console.warn(t),ji[t]=!0)}function Ei(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function ja(t){for(var e=0,i=0,s=t.length,c=s-1,p=void 0,d=void 0;i<s;c=i++)e+=((d=t[c]).x-(p=t[i]).x)*(p.y+d.y);return e}function Ti(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Sn(t){var e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(s,c,p,d){var v=p||d;return e[c]=!v||v.toLowerCase(),""}),e["max-age"]){var i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}var de=null;function xa(t){if(de==null){var e=t.navigator?t.navigator.userAgent:null;de=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return de}function Ce(t){try{var e=Ct[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}var We,Oi,Fi,yi,Ve=Ct.performance&&Ct.performance.now?Ct.performance.now.bind(Ct.performance):Date.now.bind(Date),gi=Ct.requestAnimationFrame||Ct.mozRequestAnimationFrame||Ct.webkitRequestAnimationFrame||Ct.msRequestAnimationFrame,vi=Ct.cancelAnimationFrame||Ct.mozCancelAnimationFrame||Ct.webkitCancelAnimationFrame||Ct.msCancelAnimationFrame,_r={now:Ve,frame:function(t){var e=gi(t);return{cancel:function(){return vi(e)}}},getImageData:function(t,e){e===void 0&&(e=0);var i=Ct.document.createElement("canvas"),s=i.getContext("2d");if(!s)throw new Error("failed to create canvas 2d context");return i.width=t.width,i.height=t.height,s.drawImage(t,0,0,t.width,t.height),s.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:function(t){return We||(We=Ct.document.createElement("a")),We.href=t,We.href},hardwareConcurrency:Ct.navigator&&Ct.navigator.hardwareConcurrency||4,get devicePixelRatio(){return Ct.devicePixelRatio},get prefersReducedMotion(){return!!Ct.matchMedia&&(Oi==null&&(Oi=Ct.matchMedia("(prefers-reduced-motion: reduce)")),Oi.matches)}},Ke={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},sn={supported:!1,testSupport:function(t){!Kn&&yi&&(Pr?Te(t):Fi=t)}},Kn=!1,Pr=!1;function Te(t){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,yi),t.isContextLost())return;sn.supported=!0}catch{}t.deleteTexture(e),Kn=!0}Ct.document&&((yi=Ct.document.createElement("img")).onload=function(){Fi&&Te(Fi),Fi=null,Pr=!0},yi.onerror=function(){Kn=!0,Fi=null},yi.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var Jn="01",yr=function(t,e){this._transformRequestFn=t,this._customAccessToken=e,this._createSkuToken()};function Wr(t){return t.indexOf("mapbox:")===0}yr.prototype._createSkuToken=function(){var t=function(){for(var e="",i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Jn,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt},yr.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},yr.prototype.transformRequest=function(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}},yr.prototype.normalizeStyleURL=function(t,e){if(!Wr(t))return t;var i=Ir(t);return i.path="/styles/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||e)},yr.prototype.normalizeGlyphsURL=function(t,e){if(!Wr(t))return t;var i=Ir(t);return i.path="/fonts/v1"+i.path,this._makeAPIURL(i,this._customAccessToken||e)},yr.prototype.normalizeSourceURL=function(t,e){if(!Wr(t))return t;var i=Ir(t);return i.path="/v4/"+i.authority+".json",i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||e)},yr.prototype.normalizeSpriteURL=function(t,e,i,s){var c=Ir(t);return Wr(t)?(c.path="/styles/v1"+c.path+"/sprite"+e+i,this._makeAPIURL(c,this._customAccessToken||s)):(c.path+=""+e+i,On(c))},yr.prototype.normalizeTileURL=function(t,e){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Wr(t))return t;var i=Ir(t);i.path=i.path.replace(/(\.(png|jpg)\d*)(?=$)/,(_r.devicePixelRatio>=2||e===512?"@2x":"")+(sn.supported?".webp":"$1")),i.path=i.path.replace(/^.+\/v4\//,"/"),i.path="/v4"+i.path;var s=this._customAccessToken||function(c){for(var p=0,d=c;p<d.length;p+=1){var v=d[p].match(/^access_token=(.*)$/);if(v)return v[1]}return null}(i.params)||Ke.ACCESS_TOKEN;return Ke.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&i.params.push("sku="+this._skuToken),this._makeAPIURL(i,s)},yr.prototype.canonicalizeTileURL=function(t,e){var i=Ir(t);if(!i.path.match(/(^\/v4\/)/)||!i.path.match(/\.[\w]+$/))return t;var s="mapbox://tiles/";s+=i.path.replace("/v4/","");var c=i.params;return e&&(c=c.filter(function(p){return!p.match(/^access_token=/)})),c.length&&(s+="?"+c.join("&")),s},yr.prototype.canonicalizeTileset=function(t,e){for(var i=!!e&&Wr(e),s=[],c=0,p=t.tiles||[];c<p.length;c+=1){var d=p[c];Br(d)?s.push(this.canonicalizeTileURL(d,i)):s.push(d)}return s},yr.prototype._makeAPIURL=function(t,e){var i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",s=Ir(Ke.API_URL);if(t.protocol=s.protocol,t.authority=s.authority,t.protocol==="http"){var c=t.params.indexOf("secure");c>=0&&t.params.splice(c,1)}if(s.path!=="/"&&(t.path=""+s.path+t.path),!Ke.REQUIRE_ACCESS_TOKEN)return On(t);if(!(e=e||Ke.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+i);if(e[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+i);return t.params=t.params.filter(function(p){return p.indexOf("access_token")===-1}),t.params.push("access_token="+e),On(t)};var ba=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Br(t){return ba.test(t)}var Pn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ir(t){var e=t.match(Pn);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function On(t){var e=t.params.length?"?"+t.params.join("&"):"";return t.protocol+"://"+t.authority+t.path+e}function In(t){if(!t)return null;var e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(Ct.atob(e[1]).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch{return null}}var gr=function(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};gr.prototype.getStorageKey=function(t){var e,i=In(Ke.ACCESS_TOKEN);return e=i&&i.u?Ct.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,function(s,c){return String.fromCharCode(Number("0x"+c))})):Ke.ACCESS_TOKEN||"",t?"mapbox.eventData."+t+":"+e:"mapbox.eventData:"+e},gr.prototype.fetchEventData=function(){var t=Ce("localStorage"),e=this.getStorageKey(),i=this.getStorageKey("uuid");if(t)try{var s=Ct.localStorage.getItem(e);s&&(this.eventData=JSON.parse(s));var c=Ct.localStorage.getItem(i);c&&(this.anonId=c)}catch{_i("Unable to read from LocalStorage")}},gr.prototype.saveEventData=function(){var t=Ce("localStorage"),e=this.getStorageKey(),i=this.getStorageKey("uuid");if(t)try{Ct.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&Ct.localStorage.setItem(e,JSON.stringify(this.eventData))}catch{_i("Unable to write to LocalStorage")}},gr.prototype.processRequests=function(t){},gr.prototype.postEvent=function(t,e,i,s){var c=this;if(Ke.EVENTS_URL){var p=Ir(Ke.EVENTS_URL);p.params.push("access_token="+(s||Ke.ACCESS_TOKEN||""));var d={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.13.1",skuId:Jn,userId:this.anonId},v=e?ki(d,e):d,T={url:On(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([v])};this.pendingRequest=$e(T,function(P){c.pendingRequest=null,i(P),c.saveEventData(),c.processRequests(s)})}},gr.prototype.queueRequest=function(t,e){this.queue.push(t),this.processRequests(e)};var ln,Yn,Hr=function(t){function e(){t.call(this,"map.load"),this.success={},this.skuToken=""}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postMapLoadEvent=function(i,s,c,p){this.skuToken=c,(Ke.EVENTS_URL&&p||Ke.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(d){return Wr(d)||Br(d)}))&&this.queueRequest({id:s,timestamp:Date.now()},p)},e.prototype.processRequests=function(i){var s=this;if(!this.pendingRequest&&this.queue.length!==0){var c=this.queue.shift(),p=c.id,d=c.timestamp;p&&this.success[p]||(this.anonId||this.fetchEventData(),Hn(this.anonId)||(this.anonId=an()),this.postEvent(d,{skuToken:this.skuToken},function(v){v||p&&(s.success[p]=!0)},i))}},e}(gr),qo=new(function(t){function e(i){t.call(this,"appUserTurnstile"),this._customAccessToken=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.postTurnstileEvent=function(i,s){Ke.EVENTS_URL&&Ke.ACCESS_TOKEN&&Array.isArray(i)&&i.some(function(c){return Wr(c)||Br(c)})&&this.queueRequest(Date.now(),s)},e.prototype.processRequests=function(i){var s=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var c=In(Ke.ACCESS_TOKEN),p=c?c.u:Ke.ACCESS_TOKEN,d=p!==this.eventData.tokenU;Hn(this.anonId)||(this.anonId=an(),d=!0);var v=this.queue.shift();if(this.eventData.lastSuccess){var T=new Date(this.eventData.lastSuccess),P=new Date(v),A=(v-this.eventData.lastSuccess)/864e5;d=d||A>=1||A<-1||T.getDate()!==P.getDate()}else d=!0;if(!d)return this.processRequests();this.postEvent(v,{"enabled.telemetry":!1},function(z){z||(s.eventData.lastSuccess=v,s.eventData.tokenU=p)},i)}},e}(gr)),jo=qo.postTurnstileEvent.bind(qo),$n=new Hr,Go=$n.postMapLoadEvent.bind($n),So=500,wa=50;function Qn(){Ct.caches&&!ln&&(ln=Ct.caches.open("mapbox-tiles"))}function Po(t){var e=t.indexOf("?");return e<0?t:t.slice(0,e)}var to,vr=1/0;function En(){return to==null&&(to=Ct.OffscreenCanvas&&new Ct.OffscreenCanvas(1,1).getContext("2d")&&typeof Ct.createImageBitmap=="function"),to}var Ga={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ga);var Wa=function(t){function e(i,s,c){s===401&&Br(c)&&(i+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),t.call(this,i),this.status=s,this.url=c,this.name=this.constructor.name,this.message=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),Rr=Ti()?function(){return self.worker&&self.worker.referrer}:function(){return(Ct.location.protocol==="blob:"?Ct.parent:Ct).location.href},tr,er,Io=function(t,e){if(!(/^file:/.test(i=t.url)||/^file:/.test(Rr())&&!/^\w+:/.test(i))){if(Ct.fetch&&Ct.Request&&Ct.AbortController&&Ct.Request.prototype.hasOwnProperty("signal"))return function(s,c){var p,d=new Ct.AbortController,v=new Ct.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:Rr(),signal:d.signal}),T=!1,P=!1,A=(p=v.url).indexOf("sku=")>0&&Br(p);s.type==="json"&&v.headers.set("Accept","application/json");var z=function(F,H,X){if(!P){if(F&&F.message!=="SecurityError"&&_i(F),H&&X)return B(H);var et=Date.now();Ct.fetch(v).then(function($){if($.ok){var lt=A?$.clone():null;return B($,lt,et)}return c(new Wa($.statusText,$.status,s.url))}).catch(function($){$.code!==20&&c(new Error($.message))})}},B=function(F,H,X){(s.type==="arrayBuffer"?F.arrayBuffer():s.type==="json"?F.json():F.text()).then(function(et){P||(H&&X&&function($,lt,ct){if(Qn(),ln){var ft={status:lt.status,statusText:lt.statusText,headers:new Ct.Headers};lt.headers.forEach(function(Tt,Lt){return ft.headers.set(Lt,Tt)});var mt=Sn(lt.headers.get("Cache-Control")||"");mt["no-store"]||(mt["max-age"]&&ft.headers.set("Expires",new Date(ct+1e3*mt["max-age"]).toUTCString()),new Date(ft.headers.get("Expires")).getTime()-ct<42e4||function(Tt,Lt){if(Yn===void 0)try{new Response(new ReadableStream),Yn=!0}catch{Yn=!1}Yn?Lt(Tt.body):Tt.blob().then(Lt)}(lt,function(Tt){var Lt=new Ct.Response(Tt,ft);Qn(),ln&&ln.then(function(Dt){return Dt.put(Po($.url),Lt)}).catch(function(Dt){return _i(Dt.message)})}))}}(v,H,X),T=!0,c(null,et,F.headers.get("Cache-Control"),F.headers.get("Expires")))}).catch(function(et){P||c(new Error(et.message))})};return A?function(F,H){if(Qn(),!ln)return H(null);var X=Po(F.url);ln.then(function(et){et.match(X).then(function($){var lt=function(ct){if(!ct)return!1;var ft=new Date(ct.headers.get("Expires")||0),mt=Sn(ct.headers.get("Cache-Control")||"");return ft>Date.now()&&!mt["no-cache"]}($);et.delete(X),lt&&et.put(X,$.clone()),H(null,$,lt)}).catch(H)}).catch(H)}(v,z):z(null,null),{cancel:function(){P=!0,T||d.abort()}}}(t,e);if(Ti()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(s,c){var p=new Ct.XMLHttpRequest;for(var d in p.open(s.method||"GET",s.url,!0),s.type==="arrayBuffer"&&(p.responseType="arraybuffer"),s.headers)p.setRequestHeader(d,s.headers[d]);return s.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=s.credentials==="include",p.onerror=function(){c(new Error(p.statusText))},p.onload=function(){if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){var v=p.response;if(s.type==="json")try{v=JSON.parse(p.response)}catch(T){return c(T)}c(null,v,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else c(new Wa(p.statusText,p.status,s.url))},p.send(s.body),{cancel:function(){return p.abort()}}}(t,e)},Ta=function(t,e){return Io(ki(t,{type:"arrayBuffer"}),e)},$e=function(t,e){return Io(ki(t,{method:"POST"}),e)},C="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";tr=[],er=0;var D=function(t,e){if(sn.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),er>=Ke.MAX_PARALLEL_IMAGE_REQUESTS){var i={requestParameters:t,callback:e,cancelled:!1,cancel:function(){this.cancelled=!0}};return tr.push(i),i}er++;var s=!1,c=function(){if(!s)for(s=!0,er--;tr.length&&er<Ke.MAX_PARALLEL_IMAGE_REQUESTS;){var d=tr.shift();d.cancelled||(d.cancel=D(d.requestParameters,d.callback).cancel)}},p=Ta(t,function(d,v,T,P){c(),d?e(d):v&&(En()?function(A,z){var B=new Ct.Blob([new Uint8Array(A)],{type:"image/png"});Ct.createImageBitmap(B).then(function(F){z(null,F)}).catch(function(F){z(new Error("Could not load image because of "+F.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(v,e):function(A,z,B,F){var H=new Ct.Image,X=Ct.URL;H.onload=function(){z(null,H),X.revokeObjectURL(H.src),H.onload=null,Ct.requestAnimationFrame(function(){H.src=C})},H.onerror=function(){return z(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var et=new Ct.Blob([new Uint8Array(A)],{type:"image/png"});H.cacheControl=B,H.expires=F,H.src=A.byteLength?X.createObjectURL(et):C}(v,e,T,P))});return{cancel:function(){p.cancel(),c()}}};function O(t,e,i){i[t]&&i[t].indexOf(e)!==-1||(i[t]=i[t]||[],i[t].push(e))}function j(t,e,i){if(i&&i[t]){var s=i[t].indexOf(e);s!==-1&&i[t].splice(s,1)}}var W=function(t,e){e===void 0&&(e={}),ki(this,e),this.type=t},it=function(t){function e(i,s){s===void 0&&(s={}),t.call(this,"error",ki({error:i},s))}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(W),at=function(){};at.prototype.on=function(t,e){return this._listeners=this._listeners||{},O(t,e,this._listeners),this},at.prototype.off=function(t,e){return j(t,e,this._listeners),j(t,e,this._oneTimeListeners),this},at.prototype.once=function(t,e){return this._oneTimeListeners=this._oneTimeListeners||{},O(t,e,this._oneTimeListeners),this},at.prototype.fire=function(t,e){typeof t=="string"&&(t=new W(t,e||{}));var i=t.type;if(this.listens(i)){t.target=this;for(var s=0,c=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];s<c.length;s+=1)c[s].call(this,t);for(var p=0,d=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];p<d.length;p+=1){var v=d[p];j(i,v,this._oneTimeListeners),v.call(this,t)}var T=this._eventedParent;T&&(ki(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),T.fire(t))}else t instanceof it&&console.error(t.error);return this},at.prototype.listens=function(t){return this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t)},at.prototype.setEventedParent=function(t,e){return this._eventedParent=t,this._eventedParentData=e,this};var V={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Y=function(t,e,i,s){this.message=(t?t+": ":"")+i,s&&(this.identifier=s),e!=null&&e.__line__&&(this.line=e.__line__)};function ut(t){var e=t.value;return e?[new Y(t.key,e,"constants have been deprecated as of v8")]:[]}function St(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];for(var s=0,c=e;s<c.length;s+=1){var p=c[s];for(var d in p)t[d]=p[d]}return t}function At(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function gt(t){if(Array.isArray(t))return t.map(gt);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){var e={};for(var i in t)e[i]=gt(t[i]);return e}return At(t)}var It=function(t){function e(i,s){t.call(this,s),this.message=s,this.key=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Error),Ht=function(t,e){e===void 0&&(e=[]),this.parent=t,this.bindings={};for(var i=0,s=e;i<s.length;i+=1){var c=s[i];this.bindings[c[0]]=c[1]}};Ht.prototype.concat=function(t){return new Ht(this,t)},Ht.prototype.get=function(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(t+" not found in scope.")},Ht.prototype.has=function(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)};var qt={kind:"null"},bt={kind:"number"},Ft={kind:"string"},Mt={kind:"boolean"},Rt={kind:"color"},ge={kind:"object"},Ot={kind:"value"},be={kind:"collator"},Be={kind:"formatted"},we={kind:"resolvedImage"};function Re(t,e){return{kind:"array",itemType:t,N:e}}function Ie(t){if(t.kind==="array"){var e=Ie(t.itemType);return typeof t.N=="number"?"array<"+e+", "+t.N+">":t.itemType.kind==="value"?"array":"array<"+e+">"}return t.kind}var Ui=[qt,bt,Ft,Mt,Rt,Be,ge,Re(Ot),we];function Fe(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!Fe(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(var i=0,s=Ui;i<s.length;i+=1)if(!Fe(s[i],e))return null}}return"Expected "+Ie(t)+" but found "+Ie(e)+" instead."}function xi(t,e){return e.some(function(i){return i.kind===t.kind})}function Oe(t,e){return e.some(function(i){return i==="null"?t===null:i==="array"?Array.isArray(t):i==="object"?t&&!Array.isArray(t)&&typeof t=="object":i===typeof t})}var Yt=Et(function(t,e){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(v){return(v=Math.round(v))<0?0:v>255?255:v}function c(v){return s(v[v.length-1]==="%"?parseFloat(v)/100*255:parseInt(v))}function p(v){return(T=v[v.length-1]==="%"?parseFloat(v)/100:parseFloat(v))<0?0:T>1?1:T;var T}function d(v,T,P){return P<0?P+=1:P>1&&(P-=1),6*P<1?v+(T-v)*P*6:2*P<1?T:3*P<2?v+(T-v)*(2/3-P)*6:v}try{e.parseCSSColor=function(v){var T,P=v.replace(/ /g,"").toLowerCase();if(P in i)return i[P].slice();if(P[0]==="#")return P.length===4?(T=parseInt(P.substr(1),16))>=0&&T<=4095?[(3840&T)>>4|(3840&T)>>8,240&T|(240&T)>>4,15&T|(15&T)<<4,1]:null:P.length===7&&(T=parseInt(P.substr(1),16))>=0&&T<=16777215?[(16711680&T)>>16,(65280&T)>>8,255&T,1]:null;var A=P.indexOf("("),z=P.indexOf(")");if(A!==-1&&z+1===P.length){var B=P.substr(0,A),F=P.substr(A+1,z-(A+1)).split(","),H=1;switch(B){case"rgba":if(F.length!==4)return null;H=p(F.pop());case"rgb":return F.length!==3?null:[c(F[0]),c(F[1]),c(F[2]),H];case"hsla":if(F.length!==4)return null;H=p(F.pop());case"hsl":if(F.length!==3)return null;var X=(parseFloat(F[0])%360+360)%360/360,et=p(F[1]),$=p(F[2]),lt=$<=.5?$*(et+1):$+et-$*et,ct=2*$-lt;return[s(255*d(ct,lt,X+1/3)),s(255*d(ct,lt,X)),s(255*d(ct,lt,X-1/3)),H];default:return null}}return null}}catch{}}).parseCSSColor,se=function(t,e,i,s){s===void 0&&(s=1),this.r=t,this.g=e,this.b=i,this.a=s};se.parse=function(t){if(t){if(t instanceof se)return t;if(typeof t=="string"){var e=Yt(t);if(e)return new se(e[0]/255*e[3],e[1]/255*e[3],e[2]/255*e[3],e[3])}}},se.prototype.toString=function(){var t=this.toArray(),e=t[1],i=t[2],s=t[3];return"rgba("+Math.round(t[0])+","+Math.round(e)+","+Math.round(i)+","+s+")"},se.prototype.toArray=function(){var t=this.a;return t===0?[0,0,0,0]:[255*this.r/t,255*this.g/t,255*this.b/t,t]},se.black=new se(0,0,0,1),se.white=new se(1,1,1,1),se.transparent=new se(0,0,0,0),se.red=new se(1,0,0,1);var ir=function(t,e,i){this.sensitivity=t?e?"variant":"case":e?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};ir.prototype.compare=function(t,e){return this.collator.compare(t,e)},ir.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var An=function(t,e,i,s,c){this.text=t,this.image=e,this.scale=i,this.fontStack=s,this.textColor=c},bi=function(t){this.sections=t};bi.fromString=function(t){return new bi([new An(t,null,null,null,null)])},bi.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(t){return t.text.length!==0||t.image&&t.image.name.length!==0})},bi.factory=function(t){return t instanceof bi?t:bi.fromString(t)},bi.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(t){return t.text}).join("")},bi.prototype.serialize=function(){for(var t=["format"],e=0,i=this.sections;e<i.length;e+=1){var s=i[e];if(s.image)t.push(["image",s.image.name]);else{t.push(s.text);var c={};s.fontStack&&(c["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(c["font-scale"]=s.scale),s.textColor&&(c["text-color"]=["rgba"].concat(s.textColor.toArray())),t.push(c)}}return t};var ur=function(t){this.name=t.name,this.available=t.available};function Se(t,e,i,s){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof i=="number"&&i>=0&&i<=255?s===void 0||typeof s=="number"&&s>=0&&s<=1?null:"Invalid rgba value ["+[t,e,i,s].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof s=="number"?[t,e,i,s]:[t,e,i]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ui(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof se||t instanceof ir||t instanceof bi||t instanceof ur)return!0;if(Array.isArray(t)){for(var e=0,i=t;e<i.length;e+=1)if(!ui(i[e]))return!1;return!0}if(typeof t=="object"){for(var s in t)if(!ui(t[s]))return!1;return!0}return!1}function pi(t){if(t===null)return qt;if(typeof t=="string")return Ft;if(typeof t=="boolean")return Mt;if(typeof t=="number")return bt;if(t instanceof se)return Rt;if(t instanceof ir)return be;if(t instanceof bi)return Be;if(t instanceof ur)return we;if(Array.isArray(t)){for(var e,i=t.length,s=0,c=t;s<c.length;s+=1){var p=pi(c[s]);if(e){if(e===p)continue;e=Ot;break}e=p}return Re(e||Ot,i)}return ge}function eo(t){var e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof se||t instanceof bi||t instanceof ur?t.toString():JSON.stringify(t)}ur.prototype.toString=function(){return this.name},ur.fromString=function(t){return t?new ur({name:t,available:!1}):null},ur.prototype.serialize=function(){return["image",this.name]};var ai=function(t,e){this.type=t,this.value=e};ai.parse=function(t,e){if(t.length!==2)return e.error("'literal' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(!ui(t[1]))return e.error("invalid value");var i=t[1],s=pi(i),c=e.expectedType;return s.kind!=="array"||s.N!==0||!c||c.kind!=="array"||typeof c.N=="number"&&c.N!==0||(s=c),new ai(s,i)},ai.prototype.evaluate=function(){return this.value},ai.prototype.eachChild=function(){},ai.prototype.outputDefined=function(){return!0},ai.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof se?["rgba"].concat(this.value.toArray()):this.value instanceof bi?this.value.serialize():this.value};var Gi=function(t){this.name="ExpressionEvaluationError",this.message=t};Gi.prototype.toJSON=function(){return this.message};var Er={string:Ft,number:bt,boolean:Mt,object:ge},He=function(t,e){this.type=t,this.args=e};He.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i,s=1,c=t[0];if(c==="array"){var p,d;if(t.length>2){var v=t[1];if(typeof v!="string"||!(v in Er)||v==="object")return e.error('The item type argument of "array" must be one of string, number, boolean',1);p=Er[v],s++}else p=Ot;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return e.error('The length argument to "array" must be a positive integer literal',2);d=t[2],s++}i=Re(p,d)}else i=Er[c];for(var T=[];s<t.length;s++){var P=e.parse(t[s],s,Ot);if(!P)return null;T.push(P)}return new He(i,T)},He.prototype.evaluate=function(t){for(var e=0;e<this.args.length;e++){var i=this.args[e].evaluate(t);if(!Fe(this.type,pi(i)))return i;if(e===this.args.length-1)throw new Gi("Expected value to be of type "+Ie(this.type)+", but found "+Ie(pi(i))+" instead.")}return null},He.prototype.eachChild=function(t){this.args.forEach(t)},He.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},He.prototype.serialize=function(){var t=this.type,e=[t.kind];if(t.kind==="array"){var i=t.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){e.push(i.kind);var s=t.N;(typeof s=="number"||this.args.length>1)&&e.push(s)}}return e.concat(this.args.map(function(c){return c.serialize()}))};var Qe=function(t){this.type=Be,this.sections=t};Qe.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i=t[1];if(!Array.isArray(i)&&typeof i=="object")return e.error("First argument must be an image or text section.");for(var s=[],c=!1,p=1;p<=t.length-1;++p){var d=t[p];if(c&&typeof d=="object"&&!Array.isArray(d)){c=!1;var v=null;if(d["font-scale"]&&!(v=e.parse(d["font-scale"],1,bt)))return null;var T=null;if(d["text-font"]&&!(T=e.parse(d["text-font"],1,Re(Ft))))return null;var P=null;if(d["text-color"]&&!(P=e.parse(d["text-color"],1,Rt)))return null;var A=s[s.length-1];A.scale=v,A.font=T,A.textColor=P}else{var z=e.parse(t[p],1,Ot);if(!z)return null;var B=z.type.kind;if(B!=="string"&&B!=="value"&&B!=="null"&&B!=="resolvedImage")return e.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");c=!0,s.push({content:z,scale:null,font:null,textColor:null})}}return new Qe(s)},Qe.prototype.evaluate=function(t){return new bi(this.sections.map(function(e){var i=e.content.evaluate(t);return pi(i)===we?new An("",i,null,null,null):new An(eo(i),null,e.scale?e.scale.evaluate(t):null,e.font?e.font.evaluate(t).join(","):null,e.textColor?e.textColor.evaluate(t):null)}))},Qe.prototype.eachChild=function(t){for(var e=0,i=this.sections;e<i.length;e+=1){var s=i[e];t(s.content),s.scale&&t(s.scale),s.font&&t(s.font),s.textColor&&t(s.textColor)}},Qe.prototype.outputDefined=function(){return!1},Qe.prototype.serialize=function(){for(var t=["format"],e=0,i=this.sections;e<i.length;e+=1){var s=i[e];t.push(s.content.serialize());var c={};s.scale&&(c["font-scale"]=s.scale.serialize()),s.font&&(c["text-font"]=s.font.serialize()),s.textColor&&(c["text-color"]=s.textColor.serialize()),t.push(c)}return t};var Ni=function(t){this.type=we,this.input=t};Ni.parse=function(t,e){if(t.length!==2)return e.error("Expected two arguments.");var i=e.parse(t[1],1,Ft);return i?new Ni(i):e.error("No image name provided.")},Ni.prototype.evaluate=function(t){var e=this.input.evaluate(t),i=ur.fromString(e);return i&&t.availableImages&&(i.available=t.availableImages.indexOf(e)>-1),i},Ni.prototype.eachChild=function(t){t(this.input)},Ni.prototype.outputDefined=function(){return!1},Ni.prototype.serialize=function(){return["image",this.input.serialize()]};var Wo={"to-boolean":Mt,"to-color":Rt,"to-number":bt,"to-string":Ft},xr=function(t,e){this.type=t,this.args=e};xr.parse=function(t,e){if(t.length<2)return e.error("Expected at least one argument.");var i=t[0];if((i==="to-boolean"||i==="to-string")&&t.length!==2)return e.error("Expected one argument.");for(var s=Wo[i],c=[],p=1;p<t.length;p++){var d=e.parse(t[p],p,Ot);if(!d)return null;c.push(d)}return new xr(s,c)},xr.prototype.evaluate=function(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){for(var e,i,s=0,c=this.args;s<c.length;s+=1){if(i=null,(e=c[s].evaluate(t))instanceof se)return e;if(typeof e=="string"){var p=t.parseColor(e);if(p)return p}else if(Array.isArray(e)&&!(i=e.length<3||e.length>4?"Invalid rbga value "+JSON.stringify(e)+": expected an array containing either three or four numeric values.":Se(e[0],e[1],e[2],e[3])))return new se(e[0]/255,e[1]/255,e[2]/255,e[3])}throw new Gi(i||"Could not parse color from value '"+(typeof e=="string"?e:String(JSON.stringify(e)))+"'")}if(this.type.kind==="number"){for(var d=null,v=0,T=this.args;v<T.length;v+=1){if((d=T[v].evaluate(t))===null)return 0;var P=Number(d);if(!isNaN(P))return P}throw new Gi("Could not convert "+JSON.stringify(d)+" to number.")}return this.type.kind==="formatted"?bi.fromString(eo(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?ur.fromString(eo(this.args[0].evaluate(t))):eo(this.args[0].evaluate(t))},xr.prototype.eachChild=function(t){this.args.forEach(t)},xr.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},xr.prototype.serialize=function(){if(this.type.kind==="formatted")return new Qe([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Ni(this.args[0]).serialize();var t=["to-"+this.type.kind];return this.eachChild(function(e){t.push(e.serialize())}),t};var ws=["Unknown","Point","LineString","Polygon"],Xr=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Xr.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Xr.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?ws[this.feature.type]:this.feature.type:null},Xr.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Xr.prototype.canonicalID=function(){return this.canonical},Xr.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Xr.prototype.parseColor=function(t){var e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=se.parse(t)),e};var Zi=function(t,e,i,s){this.name=t,this.type=e,this._evaluate=i,this.args=s};Zi.prototype.evaluate=function(t){return this._evaluate(t,this.args)},Zi.prototype.eachChild=function(t){this.args.forEach(t)},Zi.prototype.outputDefined=function(){return!1},Zi.prototype.serialize=function(){return[this.name].concat(this.args.map(function(t){return t.serialize()}))},Zi.parse=function(t,e){var i,s=t[0],c=Zi.definitions[s];if(!c)return e.error('Unknown expression "'+s+'". If you wanted a literal array, use ["literal", [...]].',0);for(var p=Array.isArray(c)?c[0]:c.type,d=Array.isArray(c)?[[c[1],c[2]]]:c.overloads,v=d.filter(function(ee){var Nt=ee[0];return!Array.isArray(Nt)||Nt.length===t.length-1}),T=null,P=0,A=v;P<A.length;P+=1){var z=A[P],B=z[0],F=z[1];T=new ro(e.registry,e.path,null,e.scope);for(var H=[],X=!1,et=1;et<t.length;et++){var $=t[et],lt=Array.isArray(B)?B[et-1]:B.type,ct=T.parse($,1+H.length,lt);if(!ct){X=!0;break}H.push(ct)}if(!X)if(Array.isArray(B)&&B.length!==H.length)T.error("Expected "+B.length+" arguments, but found "+H.length+" instead.");else{for(var ft=0;ft<H.length;ft++){var mt=Array.isArray(B)?B[ft]:B.type,Tt=H[ft];T.concat(ft+1).checkSubtype(mt,Tt.type)}if(T.errors.length===0)return new Zi(s,p,F,H)}}if(v.length===1)(i=e.errors).push.apply(i,T.errors);else{for(var Lt=(v.length?v:d).map(function(ee){var Nt;return Nt=ee[0],Array.isArray(Nt)?"("+Nt.map(Ie).join(", ")+")":"("+Ie(Nt.type)+"...)"}).join(" | "),Dt=[],$t=1;$t<t.length;$t++){var Ut=e.parse(t[$t],1+Dt.length);if(!Ut)return null;Dt.push(Ie(Ut.type))}e.error("Expected arguments of type "+Lt+", but found ("+Dt.join(", ")+") instead.")}return null},Zi.register=function(t,e){for(var i in Zi.definitions=e,e)t[i]=Zi};var un=function(t,e,i){this.type=be,this.locale=i,this.caseSensitive=t,this.diacriticSensitive=e};function Wi(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Fn(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Ts(t,e){var i=(180+t[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,c=Math.pow(2,e.z);return[Math.round(i*c*8192),Math.round(s*c*8192)]}function Ha(t,e,i){return e[1]>t[1]!=i[1]>t[1]&&t[0]<(i[0]-e[0])*(t[1]-e[1])/(i[1]-e[1])+e[0]}function Xa(t,e){for(var i,s,c,p,d,v,T,P=!1,A=0,z=e.length;A<z;A++)for(var B=e[A],F=0,H=B.length;F<H-1;F++){if((p=(i=t)[0]-(s=B[F])[0])*(T=i[1]-(c=B[F+1])[1])-(v=i[0]-c[0])*(d=i[1]-s[1])==0&&p*v<=0&&d*T<=0)return!1;Ha(t,B[F],B[F+1])&&(P=!P)}return P}function Ss(t,e){for(var i=0;i<e.length;i++)if(Xa(t,e[i]))return!0;return!1}function Ys(t,e,i,s){var c=s[0]-i[0],p=s[1]-i[1],d=(t[0]-i[0])*p-c*(t[1]-i[1]),v=(e[0]-i[0])*p-c*(e[1]-i[1]);return d>0&&v<0||d<0&&v>0}function ke(t,e,i){for(var s=0,c=i;s<c.length;s+=1)for(var p=c[s],d=0;d<p.length-1;++d)if((z=[(A=p[d+1])[0]-(P=p[d])[0],A[1]-P[1]])[0]*(B=[(T=e)[0]-(v=t)[0],T[1]-v[1]])[1]-z[1]*B[0]!=0&&Ys(v,T,P,A)&&Ys(P,A,v,T))return!0;var v,T,P,A,z,B;return!1}function hn(t,e){for(var i=0;i<t.length;++i)if(!Xa(t[i],e))return!1;for(var s=0;s<t.length-1;++s)if(ke(t[s],t[s+1],e))return!1;return!0}function Ai(t,e){for(var i=0;i<e.length;i++)if(hn(t,e[i]))return!0;return!1}function Eo(t,e,i){for(var s=[],c=0;c<t.length;c++){for(var p=[],d=0;d<t[c].length;d++){var v=Ts(t[c][d],i);Wi(e,v),p.push(v)}s.push(p)}return s}function Sa(t,e,i){for(var s=[],c=0;c<t.length;c++){var p=Eo(t[c],e,i);s.push(p)}return s}function io(t,e,i,s){if(t[0]<i[0]||t[0]>i[2]){var c=.5*s,p=t[0]-i[0]>c?-s:i[0]-t[0]>c?s:0;p===0&&(p=t[0]-i[2]>c?-s:i[2]-t[0]>c?s:0),t[0]+=p}Wi(e,t)}function Ka(t,e,i,s){for(var c=8192*Math.pow(2,s.z),p=[8192*s.x,8192*s.y],d=[],v=0,T=t;v<T.length;v+=1)for(var P=0,A=T[v];P<A.length;P+=1){var z=A[P],B=[z.x+p[0],z.y+p[1]];io(B,e,i,c),d.push(B)}return d}function Cn(t,e,i,s){for(var c,p=8192*Math.pow(2,s.z),d=[8192*s.x,8192*s.y],v=[],T=0,P=t;T<P.length;T+=1){for(var A=[],z=0,B=P[T];z<B.length;z+=1){var F=B[z],H=[F.x+d[0],F.y+d[1]];Wi(e,H),A.push(H)}v.push(A)}if(e[2]-e[0]<=p/2){(c=e)[0]=c[1]=1/0,c[2]=c[3]=-1/0;for(var X=0,et=v;X<et.length;X+=1)for(var $=0,lt=et[X];$<lt.length;$+=1)io(lt[$],e,i,p)}return v}un.parse=function(t,e){if(t.length!==2)return e.error("Expected one argument.");var i=t[1];if(typeof i!="object"||Array.isArray(i))return e.error("Collator options argument must be an object.");var s=e.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Mt);if(!s)return null;var c=e.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Mt);if(!c)return null;var p=null;return i.locale&&!(p=e.parse(i.locale,1,Ft))?null:new un(s,c,p)},un.prototype.evaluate=function(t){return new ir(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)},un.prototype.eachChild=function(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)},un.prototype.outputDefined=function(){return!1},un.prototype.serialize=function(){var t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]};var Or=function(t,e){this.type=Mt,this.geojson=t,this.geometries=e};function cn(t){if(t instanceof Zi&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof Or)return!1;var e=!0;return t.eachChild(function(i){e&&!cn(i)&&(e=!1)}),e}function Hi(t){if(t instanceof Zi&&t.name==="feature-state")return!1;var e=!0;return t.eachChild(function(i){e&&!Hi(i)&&(e=!1)}),e}function Ar(t,e){if(t instanceof Zi&&e.indexOf(t.name)>=0)return!1;var i=!0;return t.eachChild(function(s){i&&!Ar(s,e)&&(i=!1)}),i}Or.parse=function(t,e){if(t.length!==2)return e.error("'within' expression requires exactly one argument, but found "+(t.length-1)+" instead.");if(ui(t[1])){var i=t[1];if(i.type==="FeatureCollection")for(var s=0;s<i.features.length;++s){var c=i.features[s].geometry.type;if(c==="Polygon"||c==="MultiPolygon")return new Or(i,i.features[s].geometry)}else if(i.type==="Feature"){var p=i.geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Or(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new Or(i,i)}return e.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Or.prototype.evaluate=function(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(e,i){var s=[1/0,1/0,-1/0,-1/0],c=[1/0,1/0,-1/0,-1/0],p=e.canonicalID();if(i.type==="Polygon"){var d=Eo(i.coordinates,c,p),v=Ka(e.geometry(),s,c,p);if(!Fn(s,c))return!1;for(var T=0,P=v;T<P.length;T+=1)if(!Xa(P[T],d))return!1}if(i.type==="MultiPolygon"){var A=Sa(i.coordinates,c,p),z=Ka(e.geometry(),s,c,p);if(!Fn(s,c))return!1;for(var B=0,F=z;B<F.length;B+=1)if(!Ss(F[B],A))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(e,i){var s=[1/0,1/0,-1/0,-1/0],c=[1/0,1/0,-1/0,-1/0],p=e.canonicalID();if(i.type==="Polygon"){var d=Eo(i.coordinates,c,p),v=Cn(e.geometry(),s,c,p);if(!Fn(s,c))return!1;for(var T=0,P=v;T<P.length;T+=1)if(!hn(P[T],d))return!1}if(i.type==="MultiPolygon"){var A=Sa(i.coordinates,c,p),z=Cn(e.geometry(),s,c,p);if(!Fn(s,c))return!1;for(var B=0,F=z;B<F.length;B+=1)if(!Ai(F[B],A))return!1}return!0}(t,this.geometries)}return!1},Or.prototype.eachChild=function(){},Or.prototype.outputDefined=function(){return!0},Or.prototype.serialize=function(){return["within",this.geojson]};var Un=function(t,e){this.type=e.type,this.name=t,this.boundExpression=e};Un.parse=function(t,e){if(t.length!==2||typeof t[1]!="string")return e.error("'var' expression requires exactly one string literal argument.");var i=t[1];return e.scope.has(i)?new Un(i,e.scope.get(i)):e.error('Unknown variable "'+i+'". Make sure "'+i+'" has been bound in an enclosing "let" expression before using it.',1)},Un.prototype.evaluate=function(t){return this.boundExpression.evaluate(t)},Un.prototype.eachChild=function(){},Un.prototype.outputDefined=function(){return!1},Un.prototype.serialize=function(){return["var",this.name]};var ro=function(t,e,i,s,c){e===void 0&&(e=[]),s===void 0&&(s=new Ht),c===void 0&&(c=[]),this.registry=t,this.path=e,this.key=e.map(function(p){return"["+p+"]"}).join(""),this.scope=s,this.errors=c,this.expectedType=i};function Pa(t,e){for(var i,s=t.length-1,c=0,p=s,d=0;c<=p;)if((i=t[d=Math.floor((c+p)/2)])<=e){if(d===s||e<t[d+1])return d;c=d+1}else{if(!(i>e))throw new Gi("Input is not a number.");p=d-1}return 0}ro.prototype.parse=function(t,e,i,s,c){return c===void 0&&(c={}),e?this.concat(e,i,s)._parse(t,c):this._parse(t,c)},ro.prototype._parse=function(t,e){function i(P,A,z){return z==="assert"?new He(A,[P]):z==="coerce"?new xr(A,[P]):P}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var s=t[0];if(typeof s!="string")return this.error("Expression name must be a string, but found "+typeof s+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var c=this.registry[s];if(c){var p=c.parse(t,this);if(!p)return null;if(this.expectedType){var d=this.expectedType,v=p.type;if(d.kind!=="string"&&d.kind!=="number"&&d.kind!=="boolean"&&d.kind!=="object"&&d.kind!=="array"||v.kind!=="value")if(d.kind!=="color"&&d.kind!=="formatted"&&d.kind!=="resolvedImage"||v.kind!=="value"&&v.kind!=="string"){if(this.checkSubtype(d,v))return null}else p=i(p,d,e.typeAnnotation||"coerce");else p=i(p,d,e.typeAnnotation||"assert")}if(!(p instanceof ai)&&p.type.kind!=="resolvedImage"&&function P(A){if(A instanceof Un)return P(A.boundExpression);if(A instanceof Zi&&A.name==="error"||A instanceof un||A instanceof Or)return!1;var z=A instanceof xr||A instanceof He,B=!0;return A.eachChild(function(F){B=z?B&&P(F):B&&F instanceof ai}),!!B&&cn(A)&&Ar(A,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(p)){var T=new Xr;try{p=new ai(p.type,p.evaluate(T))}catch(P){return this.error(P.message),null}}return p}return this.error('Unknown expression "'+s+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof t+" instead.")},ro.prototype.concat=function(t,e,i){var s=typeof t=="number"?this.path.concat(t):this.path,c=i?this.scope.concat(i):this.scope;return new ro(this.registry,s,e||null,c,this.errors)},ro.prototype.error=function(t){for(var e=[],i=arguments.length-1;i-- >0;)e[i]=arguments[i+1];var s=""+this.key+e.map(function(c){return"["+c+"]"}).join("");this.errors.push(new It(s,t))},ro.prototype.checkSubtype=function(t,e){var i=Fe(t,e);return i&&this.error(i),i};var br=function(t,e,i){this.type=t,this.input=e,this.labels=[],this.outputs=[];for(var s=0,c=i;s<c.length;s+=1){var p=c[s],d=p[1];this.labels.push(p[0]),this.outputs.push(d)}};function wi(t,e,i){return t*(1-i)+e*i}br.parse=function(t,e){if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");var i=e.parse(t[1],1,bt);if(!i)return null;var s=[],c=null;e.expectedType&&e.expectedType.kind!=="value"&&(c=e.expectedType);for(var p=1;p<t.length;p+=2){var d=p===1?-1/0:t[p],v=t[p+1],T=p,P=p+1;if(typeof d!="number")return e.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(s.length&&s[s.length-1][0]>=d)return e.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);var A=e.parse(v,P,c);if(!A)return null;c=c||A.type,s.push([d,A])}return new br(c,i,s)},br.prototype.evaluate=function(t){var e=this.labels,i=this.outputs;if(e.length===1)return i[0].evaluate(t);var s=this.input.evaluate(t);if(s<=e[0])return i[0].evaluate(t);var c=e.length;return s>=e[c-1]?i[c-1].evaluate(t):i[Pa(e,s)].evaluate(t)},br.prototype.eachChild=function(t){t(this.input);for(var e=0,i=this.outputs;e<i.length;e+=1)t(i[e])},br.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},br.prototype.serialize=function(){for(var t=["step",this.input.serialize()],e=0;e<this.labels.length;e++)e>0&&t.push(this.labels[e]),t.push(this.outputs[e].serialize());return t};var no=Object.freeze({__proto__:null,number:wi,color:function(t,e,i){return new se(wi(t.r,e.r,i),wi(t.g,e.g,i),wi(t.b,e.b,i),wi(t.a,e.a,i))},array:function(t,e,i){return t.map(function(s,c){return wi(s,e[c],i)})}}),Ia=6/29*3*(6/29),Zl=Math.PI/180,$s=180/Math.PI;function Ue(t){return t>.008856451679035631?Math.pow(t,1/3):t/Ia+4/29}function Ps(t){return t>6/29?t*t*t:Ia*(t-4/29)}function Kr(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Ao(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Is(t){var e=Ao(t.r),i=Ao(t.g),s=Ao(t.b),c=Ue((.4124564*e+.3575761*i+.1804375*s)/.95047),p=Ue((.2126729*e+.7151522*i+.072175*s)/1);return{l:116*p-16,a:500*(c-p),b:200*(p-Ue((.0193339*e+.119192*i+.9503041*s)/1.08883)),alpha:t.a}}function Qs(t){var e=(t.l+16)/116,i=isNaN(t.a)?e:e+t.a/500,s=isNaN(t.b)?e:e-t.b/200;return e=1*Ps(e),i=.95047*Ps(i),s=1.08883*Ps(s),new se(Kr(3.2404542*i-1.5371385*e-.4985314*s),Kr(-.969266*i+1.8760108*e+.041556*s),Kr(.0556434*i-.2040259*e+1.0572252*s),t.alpha)}function Es(t,e,i){var s=e-t;return t+i*(s>180||s<-180?s-360*Math.round(s/360):s)}var Ea={forward:Is,reverse:Qs,interpolate:function(t,e,i){return{l:wi(t.l,e.l,i),a:wi(t.a,e.a,i),b:wi(t.b,e.b,i),alpha:wi(t.alpha,e.alpha,i)}}},Ho={forward:function(t){var e=Is(t),i=e.l,s=e.a,c=e.b,p=Math.atan2(c,s)*$s;return{h:p<0?p+360:p,c:Math.sqrt(s*s+c*c),l:i,alpha:t.a}},reverse:function(t){var e=t.h*Zl,i=t.c;return Qs({l:t.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:t.alpha})},interpolate:function(t,e,i){return{h:Es(t.h,e.h,i),c:wi(t.c,e.c,i),l:wi(t.l,e.l,i),alpha:wi(t.alpha,e.alpha,i)}}},tl=Object.freeze({__proto__:null,lab:Ea,hcl:Ho}),Vi=function(t,e,i,s,c){this.type=t,this.operator=e,this.interpolation=i,this.input=s,this.labels=[],this.outputs=[];for(var p=0,d=c;p<d.length;p+=1){var v=d[p],T=v[1];this.labels.push(v[0]),this.outputs.push(T)}};function As(t,e,i,s){var c=s-i,p=t-i;return c===0?0:e===1?p/c:(Math.pow(e,p)-1)/(Math.pow(e,c)-1)}Vi.interpolationFactor=function(t,e,i,s){var c=0;if(t.name==="exponential")c=As(e,t.base,i,s);else if(t.name==="linear")c=As(e,1,i,s);else if(t.name==="cubic-bezier"){var p=t.controlPoints;c=new st(p[0],p[1],p[2],p[3]).solve(As(e,1,i,s))}return c},Vi.parse=function(t,e){var i=t[0],s=t[1],c=t[2],p=t.slice(3);if(!Array.isArray(s)||s.length===0)return e.error("Expected an interpolation type expression.",1);if(s[0]==="linear")s={name:"linear"};else if(s[0]==="exponential"){var d=s[1];if(typeof d!="number")return e.error("Exponential interpolation requires a numeric base.",1,1);s={name:"exponential",base:d}}else{if(s[0]!=="cubic-bezier")return e.error("Unknown interpolation type "+String(s[0]),1,0);var v=s.slice(1);if(v.length!==4||v.some(function(et){return typeof et!="number"||et<0||et>1}))return e.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);s={name:"cubic-bezier",controlPoints:v}}if(t.length-1<4)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if((t.length-1)%2!=0)return e.error("Expected an even number of arguments.");if(!(c=e.parse(c,2,bt)))return null;var T=[],P=null;i==="interpolate-hcl"||i==="interpolate-lab"?P=Rt:e.expectedType&&e.expectedType.kind!=="value"&&(P=e.expectedType);for(var A=0;A<p.length;A+=2){var z=p[A],B=p[A+1],F=A+3,H=A+4;if(typeof z!="number")return e.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',F);if(T.length&&T[T.length-1][0]>=z)return e.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',F);var X=e.parse(B,H,P);if(!X)return null;P=P||X.type,T.push([z,X])}return P.kind==="number"||P.kind==="color"||P.kind==="array"&&P.itemType.kind==="number"&&typeof P.N=="number"?new Vi(P,i,s,c,T):e.error("Type "+Ie(P)+" is not interpolatable.")},Vi.prototype.evaluate=function(t){var e=this.labels,i=this.outputs;if(e.length===1)return i[0].evaluate(t);var s=this.input.evaluate(t);if(s<=e[0])return i[0].evaluate(t);var c=e.length;if(s>=e[c-1])return i[c-1].evaluate(t);var p=Pa(e,s),d=Vi.interpolationFactor(this.interpolation,s,e[p],e[p+1]),v=i[p].evaluate(t),T=i[p+1].evaluate(t);return this.operator==="interpolate"?no[this.type.kind.toLowerCase()](v,T,d):this.operator==="interpolate-hcl"?Ho.reverse(Ho.interpolate(Ho.forward(v),Ho.forward(T),d)):Ea.reverse(Ea.interpolate(Ea.forward(v),Ea.forward(T),d))},Vi.prototype.eachChild=function(t){t(this.input);for(var e=0,i=this.outputs;e<i.length;e+=1)t(i[e])},Vi.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})},Vi.prototype.serialize=function(){var t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var e=[this.operator,t,this.input.serialize()],i=0;i<this.labels.length;i++)e.push(this.labels[i],this.outputs[i].serialize());return e};var hr=function(t,e){this.type=t,this.args=e};hr.parse=function(t,e){if(t.length<2)return e.error("Expectected at least one argument.");var i=null,s=e.expectedType;s&&s.kind!=="value"&&(i=s);for(var c=[],p=0,d=t.slice(1);p<d.length;p+=1){var v=e.parse(d[p],1+c.length,i,void 0,{typeAnnotation:"omit"});if(!v)return null;i=i||v.type,c.push(v)}var T=s&&c.some(function(P){return Fe(s,P.type)});return new hr(T?Ot:i,c)},hr.prototype.evaluate=function(t){for(var e,i=null,s=0,c=0,p=this.args;c<p.length&&(s++,(i=p[c].evaluate(t))&&i instanceof ur&&!i.available&&(e||(e=i.name),i=null,s===this.args.length&&(i=e)),i===null);c+=1);return i},hr.prototype.eachChild=function(t){this.args.forEach(t)},hr.prototype.outputDefined=function(){return this.args.every(function(t){return t.outputDefined()})},hr.prototype.serialize=function(){var t=["coalesce"];return this.eachChild(function(e){t.push(e.serialize())}),t};var oo=function(t,e){this.type=e.type,this.bindings=[].concat(t),this.result=e};oo.prototype.evaluate=function(t){return this.result.evaluate(t)},oo.prototype.eachChild=function(t){for(var e=0,i=this.bindings;e<i.length;e+=1)t(i[e][1]);t(this.result)},oo.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found "+(t.length-1)+" instead.");for(var i=[],s=1;s<t.length-1;s+=2){var c=t[s];if(typeof c!="string")return e.error("Expected string, but found "+typeof c+" instead.",s);if(/[^a-zA-Z0-9_]/.test(c))return e.error("Variable names must contain only alphanumeric characters or '_'.",s);var p=e.parse(t[s+1],s+1);if(!p)return null;i.push([c,p])}var d=e.parse(t[t.length-1],t.length-1,e.expectedType,i);return d?new oo(i,d):null},oo.prototype.outputDefined=function(){return this.result.outputDefined()},oo.prototype.serialize=function(){for(var t=["let"],e=0,i=this.bindings;e<i.length;e+=1){var s=i[e];t.push(s[0],s[1].serialize())}return t.push(this.result.serialize()),t};var ao=function(t,e,i){this.type=t,this.index=e,this.input=i};ao.parse=function(t,e){if(t.length!==3)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,bt),s=e.parse(t[2],2,Re(e.expectedType||Ot));return i&&s?new ao(s.type.itemType,i,s):null},ao.prototype.evaluate=function(t){var e=this.index.evaluate(t),i=this.input.evaluate(t);if(e<0)throw new Gi("Array index out of bounds: "+e+" < 0.");if(e>=i.length)throw new Gi("Array index out of bounds: "+e+" > "+(i.length-1)+".");if(e!==Math.floor(e))throw new Gi("Array index must be an integer, but found "+e+" instead.");return i[e]},ao.prototype.eachChild=function(t){t(this.index),t(this.input)},ao.prototype.outputDefined=function(){return!1},ao.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var so=function(t,e){this.type=Mt,this.needle=t,this.haystack=e};so.parse=function(t,e){if(t.length!==3)return e.error("Expected 2 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Ot),s=e.parse(t[2],2,Ot);return i&&s?xi(i.type,[Mt,Ft,bt,qt,Ot])?new so(i,s):e.error("Expected first argument to be of type boolean, string, number or null, but found "+Ie(i.type)+" instead"):null},so.prototype.evaluate=function(t){var e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!i)return!1;if(!Oe(e,["boolean","string","number","null"]))throw new Gi("Expected first argument to be of type boolean, string, number or null, but found "+Ie(pi(e))+" instead.");if(!Oe(i,["string","array"]))throw new Gi("Expected second argument to be of type array or string, but found "+Ie(pi(i))+" instead.");return i.indexOf(e)>=0},so.prototype.eachChild=function(t){t(this.needle),t(this.haystack)},so.prototype.outputDefined=function(){return!0},so.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var Ln=function(t,e,i){this.type=bt,this.needle=t,this.haystack=e,this.fromIndex=i};Ln.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Ot),s=e.parse(t[2],2,Ot);if(!i||!s)return null;if(!xi(i.type,[Mt,Ft,bt,qt,Ot]))return e.error("Expected first argument to be of type boolean, string, number or null, but found "+Ie(i.type)+" instead");if(t.length===4){var c=e.parse(t[3],3,bt);return c?new Ln(i,s,c):null}return new Ln(i,s)},Ln.prototype.evaluate=function(t){var e=this.needle.evaluate(t),i=this.haystack.evaluate(t);if(!Oe(e,["boolean","string","number","null"]))throw new Gi("Expected first argument to be of type boolean, string, number or null, but found "+Ie(pi(e))+" instead.");if(!Oe(i,["string","array"]))throw new Gi("Expected second argument to be of type array or string, but found "+Ie(pi(i))+" instead.");if(this.fromIndex){var s=this.fromIndex.evaluate(t);return i.indexOf(e,s)}return i.indexOf(e)},Ln.prototype.eachChild=function(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)},Ln.prototype.outputDefined=function(){return!1},Ln.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Jr=function(t,e,i,s,c,p){this.inputType=t,this.type=e,this.input=i,this.cases=s,this.outputs=c,this.otherwise=p};Jr.parse=function(t,e){if(t.length<5)return e.error("Expected at least 4 arguments, but found only "+(t.length-1)+".");if(t.length%2!=1)return e.error("Expected an even number of arguments.");var i,s;e.expectedType&&e.expectedType.kind!=="value"&&(s=e.expectedType);for(var c={},p=[],d=2;d<t.length-1;d+=2){var v=t[d],T=t[d+1];Array.isArray(v)||(v=[v]);var P=e.concat(d);if(v.length===0)return P.error("Expected at least one branch label.");for(var A=0,z=v;A<z.length;A+=1){var B=z[A];if(typeof B!="number"&&typeof B!="string")return P.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return P.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof B=="number"&&Math.floor(B)!==B)return P.error("Numeric branch labels must be integer values.");if(i){if(P.checkSubtype(i,pi(B)))return null}else i=pi(B);if(c[String(B)]!==void 0)return P.error("Branch labels must be unique.");c[String(B)]=p.length}var F=e.parse(T,d,s);if(!F)return null;s=s||F.type,p.push(F)}var H=e.parse(t[1],1,Ot);if(!H)return null;var X=e.parse(t[t.length-1],t.length-1,s);return X?H.type.kind!=="value"&&e.concat(1).checkSubtype(i,H.type)?null:new Jr(i,s,H,c,p,X):null},Jr.prototype.evaluate=function(t){var e=this.input.evaluate(t);return(pi(e)===this.inputType&&this.outputs[this.cases[e]]||this.otherwise).evaluate(t)},Jr.prototype.eachChild=function(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)},Jr.prototype.outputDefined=function(){return this.outputs.every(function(t){return t.outputDefined()})&&this.otherwise.outputDefined()},Jr.prototype.serialize=function(){for(var t=this,e=["match",this.input.serialize()],i=[],s={},c=0,p=Object.keys(this.cases).sort();c<p.length;c+=1){var d=p[c];(z=s[this.cases[d]])===void 0?(s[this.cases[d]]=i.length,i.push([this.cases[d],[d]])):i[z][1].push(d)}for(var v=function(F){return t.inputType.kind==="number"?Number(F):F},T=0,P=i;T<P.length;T+=1){var A=P[T],z=A[0],B=A[1];e.push(B.length===1?v(B[0]):B.map(v)),e.push(this.outputs[outputIndex$1].serialize())}return e.push(this.otherwise.serialize()),e};var lo=function(t,e,i){this.type=t,this.branches=e,this.otherwise=i};lo.parse=function(t,e){if(t.length<4)return e.error("Expected at least 3 arguments, but found only "+(t.length-1)+".");if(t.length%2!=0)return e.error("Expected an odd number of arguments.");var i;e.expectedType&&e.expectedType.kind!=="value"&&(i=e.expectedType);for(var s=[],c=1;c<t.length-1;c+=2){var p=e.parse(t[c],c,Mt);if(!p)return null;var d=e.parse(t[c+1],c+1,i);if(!d)return null;s.push([p,d]),i=i||d.type}var v=e.parse(t[t.length-1],t.length-1,i);return v?new lo(i,s,v):null},lo.prototype.evaluate=function(t){for(var e=0,i=this.branches;e<i.length;e+=1){var s=i[e],c=s[1];if(s[0].evaluate(t))return c.evaluate(t)}return this.otherwise.evaluate(t)},lo.prototype.eachChild=function(t){for(var e=0,i=this.branches;e<i.length;e+=1){var s=i[e],c=s[1];t(s[0]),t(c)}t(this.otherwise)},lo.prototype.outputDefined=function(){return this.branches.every(function(t){return t[1].outputDefined()})&&this.otherwise.outputDefined()},lo.prototype.serialize=function(){var t=["case"];return this.eachChild(function(e){t.push(e.serialize())}),t};var Nn=function(t,e,i,s){this.type=t,this.input=e,this.beginIndex=i,this.endIndex=s};function el(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function il(t,e,i,s){return s.compare(e,i)===0}function Xe(t,e,i){var s=t!=="=="&&t!=="!=";return function(){function c(p,d,v){this.type=Mt,this.lhs=p,this.rhs=d,this.collator=v,this.hasUntypedArgument=p.type.kind==="value"||d.type.kind==="value"}return c.parse=function(p,d){if(p.length!==3&&p.length!==4)return d.error("Expected two or three arguments.");var v=p[0],T=d.parse(p[1],1,Ot);if(!T)return null;if(!el(v,T.type))return d.concat(1).error('"'+v+`" comparisons are not supported for type '`+Ie(T.type)+"'.");var P=d.parse(p[2],2,Ot);if(!P)return null;if(!el(v,P.type))return d.concat(2).error('"'+v+`" comparisons are not supported for type '`+Ie(P.type)+"'.");if(T.type.kind!==P.type.kind&&T.type.kind!=="value"&&P.type.kind!=="value")return d.error("Cannot compare types '"+Ie(T.type)+"' and '"+Ie(P.type)+"'.");s&&(T.type.kind==="value"&&P.type.kind!=="value"?T=new He(P.type,[T]):T.type.kind!=="value"&&P.type.kind==="value"&&(P=new He(T.type,[P])));var A=null;if(p.length===4){if(T.type.kind!=="string"&&P.type.kind!=="string"&&T.type.kind!=="value"&&P.type.kind!=="value")return d.error("Cannot use collator to compare non-string types.");if(!(A=d.parse(p[3],3,be)))return null}return new c(T,P,A)},c.prototype.evaluate=function(p){var d=this.lhs.evaluate(p),v=this.rhs.evaluate(p);if(s&&this.hasUntypedArgument){var T=pi(d),P=pi(v);if(T.kind!==P.kind||T.kind!=="string"&&T.kind!=="number")throw new Gi('Expected arguments for "'+t+'" to be (string, string) or (number, number), but found ('+T.kind+", "+P.kind+") instead.")}if(this.collator&&!s&&this.hasUntypedArgument){var A=pi(d),z=pi(v);if(A.kind!=="string"||z.kind!=="string")return e(p,d,v)}return this.collator?i(p,d,v,this.collator.evaluate(p)):e(p,d,v)},c.prototype.eachChild=function(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)},c.prototype.outputDefined=function(){return!0},c.prototype.serialize=function(){var p=[t];return this.eachChild(function(d){p.push(d.serialize())}),p},c}()}Nn.parse=function(t,e){if(t.length<=2||t.length>=5)return e.error("Expected 3 or 4 arguments, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1,Ot),s=e.parse(t[2],2,bt);if(!i||!s)return null;if(!xi(i.type,[Re(Ot),Ft,Ot]))return e.error("Expected first argument to be of type array or string, but found "+Ie(i.type)+" instead");if(t.length===4){var c=e.parse(t[3],3,bt);return c?new Nn(i.type,i,s,c):null}return new Nn(i.type,i,s)},Nn.prototype.evaluate=function(t){var e=this.input.evaluate(t),i=this.beginIndex.evaluate(t);if(!Oe(e,["string","array"]))throw new Gi("Expected first argument to be of type array or string, but found "+Ie(pi(e))+" instead.");if(this.endIndex){var s=this.endIndex.evaluate(t);return e.slice(i,s)}return e.slice(i)},Nn.prototype.eachChild=function(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)},Nn.prototype.outputDefined=function(){return!1},Nn.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var Vl=Xe("==",function(t,e,i){return e===i},il),Aa=Xe("!=",function(t,e,i){return e!==i},function(t,e,i,s){return!il(0,e,i,s)}),Cs=Xe("<",function(t,e,i){return e<i},function(t,e,i,s){return s.compare(e,i)<0}),Ca=Xe(">",function(t,e,i){return e>i},function(t,e,i,s){return s.compare(e,i)>0}),uo=Xe("<=",function(t,e,i){return e<=i},function(t,e,i,s){return s.compare(e,i)<=0}),rl=Xe(">=",function(t,e,i){return e>=i},function(t,e,i,s){return s.compare(e,i)>=0}),yn=function(t,e,i,s,c){this.type=Ft,this.number=t,this.locale=e,this.currency=i,this.minFractionDigits=s,this.maxFractionDigits=c};yn.parse=function(t,e){if(t.length!==3)return e.error("Expected two arguments.");var i=e.parse(t[1],1,bt);if(!i)return null;var s=t[2];if(typeof s!="object"||Array.isArray(s))return e.error("NumberFormat options argument must be an object.");var c=null;if(s.locale&&!(c=e.parse(s.locale,1,Ft)))return null;var p=null;if(s.currency&&!(p=e.parse(s.currency,1,Ft)))return null;var d=null;if(s["min-fraction-digits"]&&!(d=e.parse(s["min-fraction-digits"],1,bt)))return null;var v=null;return s["max-fraction-digits"]&&!(v=e.parse(s["max-fraction-digits"],1,bt))?null:new yn(i,c,p,d,v)},yn.prototype.evaluate=function(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))},yn.prototype.eachChild=function(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)},yn.prototype.outputDefined=function(){return!1},yn.prototype.serialize=function(){var t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]};var wr=function(t){this.type=bt,this.input=t};wr.parse=function(t,e){if(t.length!==2)return e.error("Expected 1 argument, but found "+(t.length-1)+" instead.");var i=e.parse(t[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?e.error("Expected argument of type string or array, but found "+Ie(i.type)+" instead."):new wr(i):null},wr.prototype.evaluate=function(t){var e=this.input.evaluate(t);if(typeof e=="string"||Array.isArray(e))return e.length;throw new Gi("Expected value to be of type string or array, but found "+Ie(pi(e))+" instead.")},wr.prototype.eachChild=function(t){t(this.input)},wr.prototype.outputDefined=function(){return!1},wr.prototype.serialize=function(){var t=["length"];return this.eachChild(function(e){t.push(e.serialize())}),t};var ho={"==":Vl,"!=":Aa,">":Ca,"<":Cs,">=":rl,"<=":uo,array:He,at:ao,boolean:He,case:lo,coalesce:hr,collator:un,format:Qe,image:Ni,in:so,"index-of":Ln,interpolate:Vi,"interpolate-hcl":Vi,"interpolate-lab":Vi,length:wr,let:oo,literal:ai,match:Jr,number:He,"number-format":yn,object:He,slice:Nn,step:br,string:He,"to-boolean":xr,"to-color":xr,"to-number":xr,"to-string":xr,var:Un,within:Or};function nl(t,e){var i=e[0],s=e[1],c=e[2],p=e[3];i=i.evaluate(t),s=s.evaluate(t),c=c.evaluate(t);var d=p?p.evaluate(t):1,v=Se(i,s,c,d);if(v)throw new Gi(v);return new se(i/255*d,s/255*d,c/255*d,d)}function Ls(t,e){return t in e}function zs(t,e){var i=e[t];return i===void 0?null:i}function Zn(t){return{type:t}}function Ja(t){return{result:"success",value:t}}function Co(t){return{result:"error",value:t}}function Lo(t){return t["property-type"]==="data-driven"||t["property-type"]==="cross-faded-data-driven"}function ks(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function La(t){return!!t.expression&&t.expression.interpolated}function Le(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}function Vn(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function ql(t){return t}function gn(t,e,i){return t!==void 0?t:e!==void 0?e:i!==void 0?i:void 0}function ol(t,e,i,s,c){return gn(typeof i===c?s[i]:void 0,t.default,e.default)}function Xo(t,e,i){if(Le(i)!=="number")return gn(t.default,e.default);var s=t.stops.length;if(s===1||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[s-1][0])return t.stops[s-1][1];var c=Pa(t.stops.map(function(p){return p[0]}),i);return t.stops[c][1]}function al(t,e,i){var s=t.base!==void 0?t.base:1;if(Le(i)!=="number")return gn(t.default,e.default);var c=t.stops.length;if(c===1||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[c-1][0])return t.stops[c-1][1];var p=Pa(t.stops.map(function(z){return z[0]}),i),d=function(z,B,F,H){var X=H-F,et=z-F;return X===0?0:B===1?et/X:(Math.pow(B,et)-1)/(Math.pow(B,X)-1)}(i,s,t.stops[p][0],t.stops[p+1][0]),v=t.stops[p][1],T=t.stops[p+1][1],P=no[e.type]||ql;if(t.colorSpace&&t.colorSpace!=="rgb"){var A=tl[t.colorSpace];P=function(z,B){return A.reverse(A.interpolate(A.forward(z),A.forward(B),d))}}return typeof v.evaluate=="function"?{evaluate:function(){for(var z=[],B=arguments.length;B--;)z[B]=arguments[B];var F=v.evaluate.apply(void 0,z),H=T.evaluate.apply(void 0,z);if(F!==void 0&&H!==void 0)return P(F,H,d)}}:P(v,T,d)}function co(t,e,i){return e.type==="color"?i=se.parse(i):e.type==="formatted"?i=bi.fromString(i.toString()):e.type==="resolvedImage"?i=ur.fromString(i.toString()):Le(i)===e.type||e.type==="enum"&&e.values[i]||(i=void 0),gn(i,t.default,e.default)}Zi.register(ho,{error:[{kind:"error"},[Ft],function(t,e){throw new Gi(e[0].evaluate(t))}],typeof:[Ft,[Ot],function(t,e){return Ie(pi(e[0].evaluate(t)))}],"to-rgba":[Re(bt,4),[Rt],function(t,e){return e[0].evaluate(t).toArray()}],rgb:[Rt,[bt,bt,bt],nl],rgba:[Rt,[bt,bt,bt,bt],nl],has:{type:Mt,overloads:[[[Ft],function(t,e){return Ls(e[0].evaluate(t),t.properties())}],[[Ft,ge],function(t,e){var i=e[1];return Ls(e[0].evaluate(t),i.evaluate(t))}]]},get:{type:Ot,overloads:[[[Ft],function(t,e){return zs(e[0].evaluate(t),t.properties())}],[[Ft,ge],function(t,e){var i=e[1];return zs(e[0].evaluate(t),i.evaluate(t))}]]},"feature-state":[Ot,[Ft],function(t,e){return zs(e[0].evaluate(t),t.featureState||{})}],properties:[ge,[],function(t){return t.properties()}],"geometry-type":[Ft,[],function(t){return t.geometryType()}],id:[Ot,[],function(t){return t.id()}],zoom:[bt,[],function(t){return t.globals.zoom}],"heatmap-density":[bt,[],function(t){return t.globals.heatmapDensity||0}],"line-progress":[bt,[],function(t){return t.globals.lineProgress||0}],accumulated:[Ot,[],function(t){return t.globals.accumulated===void 0?null:t.globals.accumulated}],"+":[bt,Zn(bt),function(t,e){for(var i=0,s=0,c=e;s<c.length;s+=1)i+=c[s].evaluate(t);return i}],"*":[bt,Zn(bt),function(t,e){for(var i=1,s=0,c=e;s<c.length;s+=1)i*=c[s].evaluate(t);return i}],"-":{type:bt,overloads:[[[bt,bt],function(t,e){var i=e[1];return e[0].evaluate(t)-i.evaluate(t)}],[[bt],function(t,e){return-e[0].evaluate(t)}]]},"/":[bt,[bt,bt],function(t,e){var i=e[1];return e[0].evaluate(t)/i.evaluate(t)}],"%":[bt,[bt,bt],function(t,e){var i=e[1];return e[0].evaluate(t)%i.evaluate(t)}],ln2:[bt,[],function(){return Math.LN2}],pi:[bt,[],function(){return Math.PI}],e:[bt,[],function(){return Math.E}],"^":[bt,[bt,bt],function(t,e){var i=e[1];return Math.pow(e[0].evaluate(t),i.evaluate(t))}],sqrt:[bt,[bt],function(t,e){return Math.sqrt(e[0].evaluate(t))}],log10:[bt,[bt],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN10}],ln:[bt,[bt],function(t,e){return Math.log(e[0].evaluate(t))}],log2:[bt,[bt],function(t,e){return Math.log(e[0].evaluate(t))/Math.LN2}],sin:[bt,[bt],function(t,e){return Math.sin(e[0].evaluate(t))}],cos:[bt,[bt],function(t,e){return Math.cos(e[0].evaluate(t))}],tan:[bt,[bt],function(t,e){return Math.tan(e[0].evaluate(t))}],asin:[bt,[bt],function(t,e){return Math.asin(e[0].evaluate(t))}],acos:[bt,[bt],function(t,e){return Math.acos(e[0].evaluate(t))}],atan:[bt,[bt],function(t,e){return Math.atan(e[0].evaluate(t))}],min:[bt,Zn(bt),function(t,e){return Math.min.apply(Math,e.map(function(i){return i.evaluate(t)}))}],max:[bt,Zn(bt),function(t,e){return Math.max.apply(Math,e.map(function(i){return i.evaluate(t)}))}],abs:[bt,[bt],function(t,e){return Math.abs(e[0].evaluate(t))}],round:[bt,[bt],function(t,e){var i=e[0].evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[bt,[bt],function(t,e){return Math.floor(e[0].evaluate(t))}],ceil:[bt,[bt],function(t,e){return Math.ceil(e[0].evaluate(t))}],"filter-==":[Mt,[Ft,Ot],function(t,e){var i=e[0],s=e[1];return t.properties()[i.value]===s.value}],"filter-id-==":[Mt,[Ot],function(t,e){var i=e[0];return t.id()===i.value}],"filter-type-==":[Mt,[Ft],function(t,e){var i=e[0];return t.geometryType()===i.value}],"filter-<":[Mt,[Ft,Ot],function(t,e){var i=e[0],s=e[1],c=t.properties()[i.value],p=s.value;return typeof c==typeof p&&c<p}],"filter-id-<":[Mt,[Ot],function(t,e){var i=e[0],s=t.id(),c=i.value;return typeof s==typeof c&&s<c}],"filter->":[Mt,[Ft,Ot],function(t,e){var i=e[0],s=e[1],c=t.properties()[i.value],p=s.value;return typeof c==typeof p&&c>p}],"filter-id->":[Mt,[Ot],function(t,e){var i=e[0],s=t.id(),c=i.value;return typeof s==typeof c&&s>c}],"filter-<=":[Mt,[Ft,Ot],function(t,e){var i=e[0],s=e[1],c=t.properties()[i.value],p=s.value;return typeof c==typeof p&&c<=p}],"filter-id-<=":[Mt,[Ot],function(t,e){var i=e[0],s=t.id(),c=i.value;return typeof s==typeof c&&s<=c}],"filter->=":[Mt,[Ft,Ot],function(t,e){var i=e[0],s=e[1],c=t.properties()[i.value],p=s.value;return typeof c==typeof p&&c>=p}],"filter-id->=":[Mt,[Ot],function(t,e){var i=e[0],s=t.id(),c=i.value;return typeof s==typeof c&&s>=c}],"filter-has":[Mt,[Ot],function(t,e){return e[0].value in t.properties()}],"filter-has-id":[Mt,[],function(t){return t.id()!==null&&t.id()!==void 0}],"filter-type-in":[Mt,[Re(Ft)],function(t,e){return e[0].value.indexOf(t.geometryType())>=0}],"filter-id-in":[Mt,[Re(Ot)],function(t,e){return e[0].value.indexOf(t.id())>=0}],"filter-in-small":[Mt,[Ft,Re(Ot)],function(t,e){var i=e[0];return e[1].value.indexOf(t.properties()[i.value])>=0}],"filter-in-large":[Mt,[Ft,Re(Ot)],function(t,e){var i=e[0],s=e[1];return function(c,p,d,v){for(;d<=v;){var T=d+v>>1;if(p[T]===c)return!0;p[T]>c?v=T-1:d=T+1}return!1}(t.properties()[i.value],s.value,0,s.value.length-1)}],all:{type:Mt,overloads:[[[Mt,Mt],function(t,e){var i=e[1];return e[0].evaluate(t)&&i.evaluate(t)}],[Zn(Mt),function(t,e){for(var i=0,s=e;i<s.length;i+=1)if(!s[i].evaluate(t))return!1;return!0}]]},any:{type:Mt,overloads:[[[Mt,Mt],function(t,e){var i=e[1];return e[0].evaluate(t)||i.evaluate(t)}],[Zn(Mt),function(t,e){for(var i=0,s=e;i<s.length;i+=1)if(s[i].evaluate(t))return!0;return!1}]]},"!":[Mt,[Mt],function(t,e){return!e[0].evaluate(t)}],"is-supported-script":[Mt,[Ft],function(t,e){var i=t.globals&&t.globals.isSupportedScript;return!i||i(e[0].evaluate(t))}],upcase:[Ft,[Ft],function(t,e){return e[0].evaluate(t).toUpperCase()}],downcase:[Ft,[Ft],function(t,e){return e[0].evaluate(t).toLowerCase()}],concat:[Ft,Zn(Ot),function(t,e){return e.map(function(i){return eo(i.evaluate(t))}).join("")}],"resolved-locale":[Ft,[be],function(t,e){return e[0].evaluate(t).resolvedLocale()}]});var zo=function(t,e){this.expression=t,this._warningHistory={},this._evaluator=new Xr,this._defaultValue=e?function(i){return i.type==="color"&&Vn(i.default)?new se(0,0,0,0):i.type==="color"?se.parse(i.default)||null:i.default===void 0?null:i.default}(e):null,this._enumValues=e&&e.type==="enum"?e.values:null};function po(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in ho}function Ya(t,e){var i=new ro(ho,[],e?function(c){var p={color:Rt,string:Ft,number:bt,enum:Ft,boolean:Mt,formatted:Be,resolvedImage:we};return c.type==="array"?Re(p[c.value]||Ot,c.length):p[c.type]}(e):void 0),s=i.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return s?Ja(new zo(s,e)):Co(i.errors)}zo.prototype.evaluateWithoutErrorHandling=function(t,e,i,s,c,p){return this._evaluator.globals=t,this._evaluator.feature=e,this._evaluator.featureState=i,this._evaluator.canonical=s,this._evaluator.availableImages=c||null,this._evaluator.formattedSection=p,this.expression.evaluate(this._evaluator)},zo.prototype.evaluate=function(t,e,i,s,c,p){this._evaluator.globals=t,this._evaluator.feature=e||null,this._evaluator.featureState=i||null,this._evaluator.canonical=s,this._evaluator.availableImages=c||null,this._evaluator.formattedSection=p||null;try{var d=this.expression.evaluate(this._evaluator);if(d==null||typeof d=="number"&&d!=d)return this._defaultValue;if(this._enumValues&&!(d in this._enumValues))throw new Gi("Expected value to be one of "+Object.keys(this._enumValues).map(function(v){return JSON.stringify(v)}).join(", ")+", but found "+JSON.stringify(d)+" instead.");return d}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console!="undefined"&&console.warn(v.message)),this._defaultValue}};var pn=function(t,e){this.kind=t,this._styleExpression=e,this.isStateDependent=t!=="constant"&&!Hi(e.expression)};pn.prototype.evaluateWithoutErrorHandling=function(t,e,i,s,c,p){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,s,c,p)},pn.prototype.evaluate=function(t,e,i,s,c,p){return this._styleExpression.evaluate(t,e,i,s,c,p)};var qn=function(t,e,i,s){this.kind=t,this.zoomStops=i,this._styleExpression=e,this.isStateDependent=t!=="camera"&&!Hi(e.expression),this.interpolationType=s};function sl(t,e){if((t=Ya(t,e)).result==="error")return t;var i=t.value.expression,s=cn(i);if(!s&&!Lo(e))return Co([new It("","data expressions not supported")]);var c=Ar(i,["zoom"]);if(!c&&!ks(e))return Co([new It("","zoom expressions not supported")]);var p=function d(v){var T=null;if(v instanceof oo)T=d(v.result);else if(v instanceof hr)for(var P=0,A=v.args;P<A.length&&!(T=d(A[P]));P+=1);else(v instanceof br||v instanceof Vi)&&v.input instanceof Zi&&v.input.name==="zoom"&&(T=v);return T instanceof It||v.eachChild(function(z){var B=d(z);B instanceof It?T=B:!T&&B?T=new It("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):T&&B&&T!==B&&(T=new It("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),T}(i);return p||c?p instanceof It?Co([p]):p instanceof Vi&&!La(e)?Co([new It("",'"interpolate" expressions cannot be used with this property')]):Ja(p?new qn(s?"camera":"composite",t.value,p.labels,p instanceof Vi?p.interpolation:void 0):new pn(s?"constant":"source",t.value)):Co([new It("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}qn.prototype.evaluateWithoutErrorHandling=function(t,e,i,s,c,p){return this._styleExpression.evaluateWithoutErrorHandling(t,e,i,s,c,p)},qn.prototype.evaluate=function(t,e,i,s,c,p){return this._styleExpression.evaluate(t,e,i,s,c,p)},qn.prototype.interpolationFactor=function(t,e,i){return this.interpolationType?Vi.interpolationFactor(this.interpolationType,t,e,i):0};var fo=function(t,e){this._parameters=t,this._specification=e,St(this,function i(s,c){var p,d,v,T=c.type==="color",P=s.stops&&typeof s.stops[0][0]=="object",A=P||!(P||s.property!==void 0),z=s.type||(La(c)?"exponential":"interval");if(T&&((s=St({},s)).stops&&(s.stops=s.stops.map(function(Ut){return[Ut[0],se.parse(Ut[1])]})),s.default=se.parse(s.default?s.default:c.default)),s.colorSpace&&s.colorSpace!=="rgb"&&!tl[s.colorSpace])throw new Error("Unknown color space: "+s.colorSpace);if(z==="exponential")p=al;else if(z==="interval")p=Xo;else if(z==="categorical"){p=ol,d=Object.create(null);for(var B=0,F=s.stops;B<F.length;B+=1){var H=F[B];d[H[0]]=H[1]}v=typeof s.stops[0][0]}else{if(z!=="identity")throw new Error('Unknown function type "'+z+'"');p=co}if(P){for(var X={},et=[],$=0;$<s.stops.length;$++){var lt=s.stops[$],ct=lt[0].zoom;X[ct]===void 0&&(X[ct]={zoom:ct,type:s.type,property:s.property,default:s.default,stops:[]},et.push(ct)),X[ct].stops.push([lt[0].value,lt[1]])}for(var ft=[],mt=0,Tt=et;mt<Tt.length;mt+=1){var Lt=Tt[mt];ft.push([X[Lt].zoom,i(X[Lt],c)])}var Dt={name:"linear"};return{kind:"composite",interpolationType:Dt,interpolationFactor:Vi.interpolationFactor.bind(void 0,Dt),zoomStops:ft.map(function(Ut){return Ut[0]}),evaluate:function(Ut,ee){var Nt=Ut.zoom;return al({stops:ft,base:s.base},c,Nt).evaluate(Nt,ee)}}}if(A){var $t=z==="exponential"?{name:"exponential",base:s.base!==void 0?s.base:1}:null;return{kind:"camera",interpolationType:$t,interpolationFactor:Vi.interpolationFactor.bind(void 0,$t),zoomStops:s.stops.map(function(Ut){return Ut[0]}),evaluate:function(Ut){return p(s,c,Ut.zoom,d,v)}}}return{kind:"source",evaluate:function(Ut,ee){var Nt=ee&&ee.properties?ee.properties[s.property]:void 0;return Nt===void 0?gn(s.default,c.default):p(s,c,Nt,d,v)}}}(this._parameters,this._specification))};function vn(t){var e=t.key,i=t.value,s=t.valueSpec||{},c=t.objectElementValidators||{},p=t.style,d=t.styleSpec,v=[],T=Le(i);if(T!=="object")return[new Y(e,i,"object expected, "+T+" found")];for(var P in i){var A=P.split(".")[0],z=s[A]||s["*"],B=void 0;if(c[A])B=c[A];else if(s[A])B=Ee;else if(c["*"])B=c["*"];else{if(!s["*"]){v.push(new Y(e,i[P],'unknown property "'+P+'"'));continue}B=Ee}v=v.concat(B({key:(e&&e+".")+P,value:i[P],valueSpec:z,style:p,styleSpec:d,object:i,objectKey:P},i))}for(var F in s)c[F]||s[F].required&&s[F].default===void 0&&i[F]===void 0&&v.push(new Y(e,i,'missing required property "'+F+'"'));return v}function zn(t){var e=t.value,i=t.valueSpec,s=t.style,c=t.styleSpec,p=t.key,d=t.arrayElementValidator||Ee;if(Le(e)!=="array")return[new Y(p,e,"array expected, "+Le(e)+" found")];if(i.length&&e.length!==i.length)return[new Y(p,e,"array length "+i.length+" expected, length "+e.length+" found")];if(i["min-length"]&&e.length<i["min-length"])return[new Y(p,e,"array length at least "+i["min-length"]+" expected, length "+e.length+" found")];var v={type:i.value,values:i.values};c.$version<7&&(v.function=i.function),Le(i.value)==="object"&&(v=i.value);for(var T=[],P=0;P<e.length;P++)T=T.concat(d({array:e,arrayIndex:P,value:e[P],valueSpec:v,style:s,styleSpec:c,key:p+"["+P+"]"}));return T}function ll(t){var e=t.key,i=t.value,s=t.valueSpec,c=Le(i);return c==="number"&&i!=i&&(c="NaN"),c!=="number"?[new Y(e,i,"number expected, "+c+" found")]:"minimum"in s&&i<s.minimum?[new Y(e,i,i+" is less than the minimum value "+s.minimum)]:"maximum"in s&&i>s.maximum?[new Y(e,i,i+" is greater than the maximum value "+s.maximum)]:[]}function ko(t){var e,i,s,c=t.valueSpec,p=At(t.value.type),d={},v=p!=="categorical"&&t.value.property===void 0,T=!v,P=Le(t.value.stops)==="array"&&Le(t.value.stops[0])==="array"&&Le(t.value.stops[0][0])==="object",A=vn({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(F){if(p==="identity")return[new Y(F.key,F.value,'identity function may not have a "stops" property')];var H=[],X=F.value;return H=H.concat(zn({key:F.key,value:X,valueSpec:F.valueSpec,style:F.style,styleSpec:F.styleSpec,arrayElementValidator:z})),Le(X)==="array"&&X.length===0&&H.push(new Y(F.key,X,"array must have at least one stop")),H},default:function(F){return Ee({key:F.key,value:F.value,valueSpec:c,style:F.style,styleSpec:F.styleSpec})}}});return p==="identity"&&v&&A.push(new Y(t.key,t.value,'missing required property "property"')),p==="identity"||t.value.stops||A.push(new Y(t.key,t.value,'missing required property "stops"')),p==="exponential"&&t.valueSpec.expression&&!La(t.valueSpec)&&A.push(new Y(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(T&&!Lo(t.valueSpec)?A.push(new Y(t.key,t.value,"property functions not supported")):v&&!ks(t.valueSpec)&&A.push(new Y(t.key,t.value,"zoom functions not supported"))),p!=="categorical"&&!P||t.value.property!==void 0||A.push(new Y(t.key,t.value,'"property" property is required')),A;function z(F){var H=[],X=F.value,et=F.key;if(Le(X)!=="array")return[new Y(et,X,"array expected, "+Le(X)+" found")];if(X.length!==2)return[new Y(et,X,"array length 2 expected, length "+X.length+" found")];if(P){if(Le(X[0])!=="object")return[new Y(et,X,"object expected, "+Le(X[0])+" found")];if(X[0].zoom===void 0)return[new Y(et,X,"object stop key must have zoom")];if(X[0].value===void 0)return[new Y(et,X,"object stop key must have value")];if(s&&s>At(X[0].zoom))return[new Y(et,X[0].zoom,"stop zoom values must appear in ascending order")];At(X[0].zoom)!==s&&(s=At(X[0].zoom),i=void 0,d={}),H=H.concat(vn({key:et+"[0]",value:X[0],valueSpec:{zoom:{}},style:F.style,styleSpec:F.styleSpec,objectElementValidators:{zoom:ll,value:B}}))}else H=H.concat(B({key:et+"[0]",value:X[0],valueSpec:{},style:F.style,styleSpec:F.styleSpec},X));return po(gt(X[1]))?H.concat([new Y(et+"[1]",X[1],"expressions are not allowed in function stops.")]):H.concat(Ee({key:et+"[1]",value:X[1],valueSpec:c,style:F.style,styleSpec:F.styleSpec}))}function B(F,H){var X=Le(F.value),et=At(F.value),$=F.value!==null?F.value:H;if(e){if(X!==e)return[new Y(F.key,$,X+" stop domain type must match previous stop domain type "+e)]}else e=X;if(X!=="number"&&X!=="string"&&X!=="boolean")return[new Y(F.key,$,"stop domain value must be a number, string, or boolean")];if(X!=="number"&&p!=="categorical"){var lt="number expected, "+X+" found";return Lo(c)&&p===void 0&&(lt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Y(F.key,$,lt)]}return p!=="categorical"||X!=="number"||isFinite(et)&&Math.floor(et)===et?p!=="categorical"&&X==="number"&&i!==void 0&&et<i?[new Y(F.key,$,"stop domain values must appear in ascending order")]:(i=et,p==="categorical"&&et in d?[new Y(F.key,$,"stop domain values must be unique")]:(d[et]=!0,[])):[new Y(F.key,$,"integer expected, found "+et)]}}function Mo(t){var e=(t.expressionContext==="property"?sl:Ya)(gt(t.value),t.valueSpec);if(e.result==="error")return e.value.map(function(s){return new Y(""+t.key+s.key,t.value,s.message)});var i=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!i.outputDefined())return[new Y(t.key,t.value,'Invalid data expression for "'+t.propertyKey+'". Output values must be contained as literals within the expression.')];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!Hi(i))return[new Y(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter"&&!Hi(i))return[new Y(t.key,t.value,'"feature-state" data expressions are not supported with filters.')];if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!Ar(i,["zoom","feature-state"]))return[new Y(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!cn(i))return[new Y(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Yr(t){var e=t.key,i=t.value,s=t.valueSpec,c=[];return Array.isArray(s.values)?s.values.indexOf(At(i))===-1&&c.push(new Y(e,i,"expected one of ["+s.values.join(", ")+"], "+JSON.stringify(i)+" found")):Object.keys(s.values).indexOf(At(i))===-1&&c.push(new Y(e,i,"expected one of ["+Object.keys(s.values).join(", ")+"], "+JSON.stringify(i)+" found")),c}function Ko(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(var e=0,i=t.slice(1);e<i.length;e+=1){var s=i[e];if(!Ko(s)&&typeof s!="boolean")return!1}return!0;default:return!0}}fo.deserialize=function(t){return new fo(t._parameters,t._specification)},fo.serialize=function(t){return{_parameters:t._parameters,_specification:t._specification}};var $a={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Jo(t){if(t==null)return{filter:function(){return!0},needGeometry:!1};Ko(t)||(t=Yo(t));var e=Ya(t,$a);if(e.result==="error")throw new Error(e.value.map(function(i){return i.key+": "+i.message}).join(", "));return{filter:function(i,s,c){return e.value.evaluate(i,s,{},c)},needGeometry:function i(s){if(!Array.isArray(s))return!1;if(s[0]==="within")return!0;for(var c=1;c<s.length;c++)if(i(s[c]))return!0;return!1}(t)}}function Qa(t,e){return t<e?-1:t>e?1:0}function Yo(t){if(!t)return!0;var e,i=t[0];return t.length<=1?i!=="any":i==="=="?$o(t[1],t[2],"=="):i==="!="?Qo($o(t[1],t[2],"==")):i==="<"||i===">"||i==="<="||i===">="?$o(t[1],t[2],i):i==="any"?(e=t.slice(1),["any"].concat(e.map(Yo))):i==="all"?["all"].concat(t.slice(1).map(Yo)):i==="none"?["all"].concat(t.slice(1).map(Yo).map(Qo)):i==="in"?Do(t[1],t.slice(2)):i==="!in"?Qo(Do(t[1],t.slice(2))):i==="has"?za(t[1]):i==="!has"?Qo(za(t[1])):i!=="within"||t}function $o(t,e,i){switch(t){case"$type":return["filter-type-"+i,e];case"$id":return["filter-id-"+i,e];default:return["filter-"+i,t,e]}}function Do(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(function(i){return typeof i!=typeof e[0]})?["filter-in-large",t,["literal",e.sort(Qa)]]:["filter-in-small",t,["literal",e]]}}function za(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Qo(t){return["!",t]}function ts(t){return Ko(gt(t.value))?Mo(St({},t,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function e(i){var s=i.value,c=i.key;if(Le(s)!=="array")return[new Y(c,s,"array expected, "+Le(s)+" found")];var p,d=i.styleSpec,v=[];if(s.length<1)return[new Y(c,s,"filter array must have at least 1 element")];switch(v=v.concat(Yr({key:c+"[0]",value:s[0],valueSpec:d.filter_operator,style:i.style,styleSpec:i.styleSpec})),At(s[0])){case"<":case"<=":case">":case">=":s.length>=2&&At(s[1])==="$type"&&v.push(new Y(c,s,'"$type" cannot be use with operator "'+s[0]+'"'));case"==":case"!=":s.length!==3&&v.push(new Y(c,s,'filter array for operator "'+s[0]+'" must have 3 elements'));case"in":case"!in":s.length>=2&&(p=Le(s[1]))!=="string"&&v.push(new Y(c+"[1]",s[1],"string expected, "+p+" found"));for(var T=2;T<s.length;T++)p=Le(s[T]),At(s[1])==="$type"?v=v.concat(Yr({key:c+"["+T+"]",value:s[T],valueSpec:d.geometry_type,style:i.style,styleSpec:i.styleSpec})):p!=="string"&&p!=="number"&&p!=="boolean"&&v.push(new Y(c+"["+T+"]",s[T],"string, number, or boolean expected, "+p+" found"));break;case"any":case"all":case"none":for(var P=1;P<s.length;P++)v=v.concat(e({key:c+"["+P+"]",value:s[P],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":p=Le(s[1]),s.length!==2?v.push(new Y(c,s,'filter array for "'+s[0]+'" operator must have 2 elements')):p!=="string"&&v.push(new Y(c+"[1]",s[1],"string expected, "+p+" found"));break;case"within":p=Le(s[1]),s.length!==2?v.push(new Y(c,s,'filter array for "'+s[0]+'" operator must have 2 elements')):p!=="object"&&v.push(new Y(c+"[1]",s[1],"object expected, "+p+" found"))}return v}(t)}function Ms(t,e){var i=t.key,s=t.style,c=t.styleSpec,p=t.value,d=t.objectKey,v=c[e+"_"+t.layerType];if(!v)return[];var T=d.match(/^(.*)-transition$/);if(e==="paint"&&T&&v[T[1]]&&v[T[1]].transition)return Ee({key:i,value:p,valueSpec:c.transition,style:s,styleSpec:c});var P,A=t.valueSpec||v[d];if(!A)return[new Y(i,p,'unknown property "'+d+'"')];if(Le(p)==="string"&&Lo(A)&&!A.tokens&&(P=/^{([^}]+)}$/.exec(p)))return[new Y(i,p,'"'+d+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(P[1])+" }`.")];var z=[];return t.layerType==="symbol"&&(d==="text-field"&&s&&!s.glyphs&&z.push(new Y(i,p,'use of "text-field" requires a style "glyphs" property')),d==="text-font"&&Vn(gt(p))&&At(p.type)==="identity"&&z.push(new Y(i,p,'"text-font" does not support identity functions'))),z.concat(Ee({key:t.key,value:p,valueSpec:A,style:s,styleSpec:c,expressionContext:"property",propertyType:e,propertyKey:d}))}function ta(t){return Ms(t,"paint")}function ka(t){return Ms(t,"layout")}function Ds(t){var e=[],i=t.value,s=t.key,c=t.style,p=t.styleSpec;i.type||i.ref||e.push(new Y(s,i,'either "type" or "ref" is required'));var d,v=At(i.type),T=At(i.ref);if(i.id)for(var P=At(i.id),A=0;A<t.arrayIndex;A++){var z=c.layers[A];At(z.id)===P&&e.push(new Y(s,i.id,'duplicate layer id "'+i.id+'", previously used at line '+z.id.__line__))}if("ref"in i)["type","source","source-layer","filter","layout"].forEach(function(H){H in i&&e.push(new Y(s,i[H],'"'+H+'" is prohibited for ref layers'))}),c.layers.forEach(function(H){At(H.id)===T&&(d=H)}),d?d.ref?e.push(new Y(s,i.ref,"ref cannot reference another ref layer")):v=At(d.type):e.push(new Y(s,i.ref,'ref layer "'+T+'" not found'));else if(v!=="background")if(i.source){var B=c.sources&&c.sources[i.source],F=B&&At(B.type);B?F==="vector"&&v==="raster"?e.push(new Y(s,i.source,'layer "'+i.id+'" requires a raster source')):F==="raster"&&v!=="raster"?e.push(new Y(s,i.source,'layer "'+i.id+'" requires a vector source')):F!=="vector"||i["source-layer"]?F==="raster-dem"&&v!=="hillshade"?e.push(new Y(s,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):v!=="line"||!i.paint||!i.paint["line-gradient"]||F==="geojson"&&B.lineMetrics||e.push(new Y(s,i,'layer "'+i.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):e.push(new Y(s,i,'layer "'+i.id+'" must specify a "source-layer"')):e.push(new Y(s,i.source,'source "'+i.source+'" not found'))}else e.push(new Y(s,i,'missing required property "source"'));return e=e.concat(vn({key:s,value:i,valueSpec:p.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return Ee({key:s+".type",value:i.type,valueSpec:p.layer.type,style:t.style,styleSpec:t.styleSpec,object:i,objectKey:"type"})},filter:ts,layout:function(H){return vn({layer:i,key:H.key,value:H.value,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{"*":function(X){return ka(St({layerType:v},X))}}})},paint:function(H){return vn({layer:i,key:H.key,value:H.value,style:H.style,styleSpec:H.styleSpec,objectElementValidators:{"*":function(X){return ta(St({layerType:v},X))}}})}}}))}function Bo(t){var e=t.value,i=t.key,s=Le(e);return s!=="string"?[new Y(i,e,"string expected, "+s+" found")]:[]}var ni={promoteId:function(t){var e=t.key,i=t.value;if(Le(i)==="string")return Bo({key:e,value:i});var s=[];for(var c in i)s.push.apply(s,Bo({key:e+"."+c,value:i[c]}));return s}};function es(t){var e=t.value,i=t.key,s=t.styleSpec,c=t.style;if(!e.type)return[new Y(i,e,'"type" is required')];var p,d=At(e.type);switch(d){case"vector":case"raster":case"raster-dem":return vn({key:i,value:e,valueSpec:s["source_"+d.replace("-","_")],style:t.style,styleSpec:s,objectElementValidators:ni});case"geojson":if(p=vn({key:i,value:e,valueSpec:s.source_geojson,style:c,styleSpec:s,objectElementValidators:ni}),e.cluster)for(var v in e.clusterProperties){var T=e.clusterProperties[v],P=T[0],A=typeof P=="string"?[P,["accumulated"],["get",v]]:P;p.push.apply(p,Mo({key:i+"."+v+".map",value:T[1],expressionContext:"cluster-map"})),p.push.apply(p,Mo({key:i+"."+v+".reduce",value:A,expressionContext:"cluster-reduce"}))}return p;case"video":return vn({key:i,value:e,valueSpec:s.source_video,style:c,styleSpec:s});case"image":return vn({key:i,value:e,valueSpec:s.source_image,style:c,styleSpec:s});case"canvas":return[new Y(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Yr({key:i+".type",value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:c,styleSpec:s})}}function Cr(t){var e=t.value,i=t.styleSpec,s=i.light,c=t.style,p=[],d=Le(e);if(e===void 0)return p;if(d!=="object")return p.concat([new Y("light",e,"object expected, "+d+" found")]);for(var v in e){var T=v.match(/^(.*)-transition$/);p=p.concat(T&&s[T[1]]&&s[T[1]].transition?Ee({key:v,value:e[v],valueSpec:i.transition,style:c,styleSpec:i}):s[v]?Ee({key:v,value:e[v],valueSpec:s[v],style:c,styleSpec:i}):[new Y(v,e[v],'unknown property "'+v+'"')])}return p}var $r={"*":function(){return[]},array:zn,boolean:function(t){var e=t.value,i=t.key,s=Le(e);return s!=="boolean"?[new Y(i,e,"boolean expected, "+s+" found")]:[]},number:ll,color:function(t){var e=t.key,i=t.value,s=Le(i);return s!=="string"?[new Y(e,i,"color expected, "+s+" found")]:Yt(i)===null?[new Y(e,i,'color expected, "'+i+'" found')]:[]},constants:ut,enum:Yr,filter:ts,function:ko,layer:Ds,object:vn,source:es,light:Cr,string:Bo,formatted:function(t){return Bo(t).length===0?[]:Mo(t)},resolvedImage:function(t){return Bo(t).length===0?[]:Mo(t)}};function Ee(t){var e=t.value,i=t.valueSpec,s=t.styleSpec;return i.expression&&Vn(At(e))?ko(t):i.expression&&po(gt(e))?Mo(t):i.type&&$r[i.type]?$r[i.type](t):vn(St({},t,{valueSpec:i.type?s[i.type]:i}))}function qe(t){var e=t.value,i=t.key,s=Bo(t);return s.length||(e.indexOf("{fontstack}")===-1&&s.push(new Y(i,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&s.push(new Y(i,e,'"glyphs" url must include a "{range}" token'))),s}function Qr(t,e){e===void 0&&(e=V);var i=[];return i=i.concat(Ee({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:qe,"*":function(){return[]}}})),t.constants&&(i=i.concat(ut({key:"constants",value:t.constants,style:t,styleSpec:e}))),ea(i)}function ea(t){return[].concat(t).sort(function(e,i){return e.line-i.line})}function ia(t){return function(){for(var e=[],i=arguments.length;i--;)e[i]=arguments[i];return ea(t.apply(this,e))}}Qr.source=ia(es),Qr.light=ia(Cr),Qr.layer=ia(Ds),Qr.filter=ia(ts),Qr.paintProperty=ia(ta),Qr.layoutProperty=ia(ka);var jn=Qr,jl=jn.light,ra=jn.paintProperty,na=jn.layoutProperty;function oa(t,e){var i=!1;if(e&&e.length)for(var s=0,c=e;s<c.length;s+=1)t.fire(new it(new Error(c[s].message))),i=!0;return i}var Gn=ti;function ti(t,e,i){var s=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var c=new Int32Array(this.arrayBuffer);t=c[0],this.d=(e=c[1])+2*(i=c[2]);for(var p=0;p<this.d*this.d;p++){var d=c[3+p],v=c[3+p+1];s.push(d===v?null:c.subarray(d,v))}var T=c[3+s.length+1];this.keys=c.subarray(c[3+s.length],T),this.bboxes=c.subarray(T),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var P=0;P<this.d*this.d;P++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;var A=i/e*t;this.min=-A,this.max=t+A}ti.prototype.insert=function(t,e,i,s,c){this._forEachCell(e,i,s,c,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(c)},ti.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},ti.prototype._insertCell=function(t,e,i,s,c,p){this.cells[c].push(p)},ti.prototype.query=function(t,e,i,s,c){var p=this.min,d=this.max;if(t<=p&&e<=p&&d<=i&&d<=s&&!c)return Array.prototype.slice.call(this.keys);var v=[];return this._forEachCell(t,e,i,s,this._queryCell,v,{},c),v},ti.prototype._queryCell=function(t,e,i,s,c,p,d,v){var T=this.cells[c];if(T!==null)for(var P=this.keys,A=this.bboxes,z=0;z<T.length;z++){var B=T[z];if(d[B]===void 0){var F=4*B;(v?v(A[F+0],A[F+1],A[F+2],A[F+3]):t<=A[F+2]&&e<=A[F+3]&&i>=A[F+0]&&s>=A[F+1])?(d[B]=!0,p.push(P[B])):d[B]=!1}}},ti.prototype._forEachCell=function(t,e,i,s,c,p,d,v){for(var T=this._convertToCellCoord(t),P=this._convertToCellCoord(e),A=this._convertToCellCoord(i),z=this._convertToCellCoord(s),B=T;B<=A;B++)for(var F=P;F<=z;F++){var H=this.d*F+B;if((!v||v(this._convertFromCellCoord(B),this._convertFromCellCoord(F),this._convertFromCellCoord(B+1),this._convertFromCellCoord(F+1)))&&c.call(this,t,e,i,s,H,p,d,v))return}},ti.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},ti.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},ti.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,i=0,s=0;s<this.cells.length;s++)i+=this.cells[s].length;var c=new Int32Array(e+i+this.keys.length+this.bboxes.length);c[0]=this.extent,c[1]=this.n,c[2]=this.padding;for(var p=e,d=0;d<t.length;d++){var v=t[d];c[3+d]=p,c.set(v,p),p+=v.length}return c[3+t.length]=p,c.set(this.keys,p),c[3+t.length+1]=p+=this.keys.length,c.set(this.bboxes,p),p+=this.bboxes.length,c.buffer};var aa=Ct.ImageData,Bs=Ct.ImageBitmap,hi={};function jt(t,e,i){i===void 0&&(i={}),Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),hi[t]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}for(var Tr in jt("Object",Object),Gn.serialize=function(t,e){var i=t.toArrayBuffer();return e&&e.push(i),{buffer:i}},Gn.deserialize=function(t){return new Gn(t.buffer)},jt("Grid",Gn),jt("Color",se),jt("Error",Error),jt("ResolvedImage",ur),jt("StylePropertyFunction",fo),jt("StyleExpression",zo,{omit:["_evaluator"]}),jt("ZoomDependentExpression",qn),jt("ZoomConstantExpression",pn),jt("CompoundExpression",Zi,{omit:["_evaluate"]}),ho)ho[Tr]._classRegistryKey||jt("Expression_"+Tr,ho[Tr]);function mo(t){return t&&typeof ArrayBuffer!="undefined"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function Ro(t){return Bs&&t instanceof Bs}function fn(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(mo(t)||Ro(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){var i=t;return e&&e.push(i.buffer),i}if(t instanceof aa)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){for(var s=[],c=0,p=t;c<p.length;c+=1)s.push(fn(p[c],e));return s}if(typeof t=="object"){var d=t.constructor,v=d._classRegistryKey;if(!v)throw new Error("can't serialize object of unregistered class");var T=d.serialize?d.serialize(t,e):{};if(!d.serialize){for(var P in t)if(t.hasOwnProperty(P)&&!(hi[v].omit.indexOf(P)>=0)){var A=t[P];T[P]=hi[v].shallow.indexOf(P)>=0?A:fn(A,e)}t instanceof Error&&(T.message=t.message)}if(T.$name)throw new Error("$name property is reserved for worker serialization logic.");return v!=="Object"&&(T.$name=v),T}throw new Error("can't serialize object of type "+typeof t)}function Fr(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||mo(t)||Ro(t)||ArrayBuffer.isView(t)||t instanceof aa)return t;if(Array.isArray(t))return t.map(Fr);if(typeof t=="object"){var e=t.$name||"Object",i=hi[e].klass;if(!i)throw new Error("can't deserialize unregistered class "+e);if(i.deserialize)return i.deserialize(t);for(var s=Object.create(i.prototype),c=0,p=Object.keys(t);c<p.length;c+=1){var d=p[c];if(d!=="$name"){var v=t[d];s[d]=hi[e].shallow.indexOf(d)>=0?v:Fr(v)}}return s}throw new Error("can't deserialize object of type "+typeof t)}var is=function(){this.first=!0};is.prototype.update=function(t,e){var i=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=i,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=i,!0):(this.lastFloorZoom>i?(this.lastIntegerZoom=i+1,this.lastIntegerZoomTime=e):this.lastFloorZoom<i&&(this.lastIntegerZoom=i,this.lastIntegerZoomTime=e),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=i,!0))};var Bt={"Latin-1 Supplement":function(t){return t>=128&&t<=255},Arabic:function(t){return t>=1536&&t<=1791},"Arabic Supplement":function(t){return t>=1872&&t<=1919},"Arabic Extended-A":function(t){return t>=2208&&t<=2303},"Hangul Jamo":function(t){return t>=4352&&t<=4607},"Unified Canadian Aboriginal Syllabics":function(t){return t>=5120&&t<=5759},Khmer:function(t){return t>=6016&&t<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(t){return t>=6320&&t<=6399},"General Punctuation":function(t){return t>=8192&&t<=8303},"Letterlike Symbols":function(t){return t>=8448&&t<=8527},"Number Forms":function(t){return t>=8528&&t<=8591},"Miscellaneous Technical":function(t){return t>=8960&&t<=9215},"Control Pictures":function(t){return t>=9216&&t<=9279},"Optical Character Recognition":function(t){return t>=9280&&t<=9311},"Enclosed Alphanumerics":function(t){return t>=9312&&t<=9471},"Geometric Shapes":function(t){return t>=9632&&t<=9727},"Miscellaneous Symbols":function(t){return t>=9728&&t<=9983},"Miscellaneous Symbols and Arrows":function(t){return t>=11008&&t<=11263},"CJK Radicals Supplement":function(t){return t>=11904&&t<=12031},"Kangxi Radicals":function(t){return t>=12032&&t<=12255},"Ideographic Description Characters":function(t){return t>=12272&&t<=12287},"CJK Symbols and Punctuation":function(t){return t>=12288&&t<=12351},Hiragana:function(t){return t>=12352&&t<=12447},Katakana:function(t){return t>=12448&&t<=12543},Bopomofo:function(t){return t>=12544&&t<=12591},"Hangul Compatibility Jamo":function(t){return t>=12592&&t<=12687},Kanbun:function(t){return t>=12688&&t<=12703},"Bopomofo Extended":function(t){return t>=12704&&t<=12735},"CJK Strokes":function(t){return t>=12736&&t<=12783},"Katakana Phonetic Extensions":function(t){return t>=12784&&t<=12799},"Enclosed CJK Letters and Months":function(t){return t>=12800&&t<=13055},"CJK Compatibility":function(t){return t>=13056&&t<=13311},"CJK Unified Ideographs Extension A":function(t){return t>=13312&&t<=19903},"Yijing Hexagram Symbols":function(t){return t>=19904&&t<=19967},"CJK Unified Ideographs":function(t){return t>=19968&&t<=40959},"Yi Syllables":function(t){return t>=40960&&t<=42127},"Yi Radicals":function(t){return t>=42128&&t<=42191},"Hangul Jamo Extended-A":function(t){return t>=43360&&t<=43391},"Hangul Syllables":function(t){return t>=44032&&t<=55215},"Hangul Jamo Extended-B":function(t){return t>=55216&&t<=55295},"Private Use Area":function(t){return t>=57344&&t<=63743},"CJK Compatibility Ideographs":function(t){return t>=63744&&t<=64255},"Arabic Presentation Forms-A":function(t){return t>=64336&&t<=65023},"Vertical Forms":function(t){return t>=65040&&t<=65055},"CJK Compatibility Forms":function(t){return t>=65072&&t<=65103},"Small Form Variants":function(t){return t>=65104&&t<=65135},"Arabic Presentation Forms-B":function(t){return t>=65136&&t<=65279},"Halfwidth and Fullwidth Forms":function(t){return t>=65280&&t<=65519}};function rs(t){for(var e=0,i=t;e<i.length;e+=1)if(Ma(i[e].charCodeAt(0)))return!0;return!1}function Ma(t){return!(t!==746&&t!==747&&(t<4352||!(Bt["Bopomofo Extended"](t)||Bt.Bopomofo(t)||Bt["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||Bt["CJK Compatibility Ideographs"](t)||Bt["CJK Compatibility"](t)||Bt["CJK Radicals Supplement"](t)||Bt["CJK Strokes"](t)||!(!Bt["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||Bt["CJK Unified Ideographs Extension A"](t)||Bt["CJK Unified Ideographs"](t)||Bt["Enclosed CJK Letters and Months"](t)||Bt["Hangul Compatibility Jamo"](t)||Bt["Hangul Jamo Extended-A"](t)||Bt["Hangul Jamo Extended-B"](t)||Bt["Hangul Jamo"](t)||Bt["Hangul Syllables"](t)||Bt.Hiragana(t)||Bt["Ideographic Description Characters"](t)||Bt.Kanbun(t)||Bt["Kangxi Radicals"](t)||Bt["Katakana Phonetic Extensions"](t)||Bt.Katakana(t)&&t!==12540||!(!Bt["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!Bt["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||Bt["Unified Canadian Aboriginal Syllabics"](t)||Bt["Unified Canadian Aboriginal Syllabics Extended"](t)||Bt["Vertical Forms"](t)||Bt["Yijing Hexagram Symbols"](t)||Bt["Yi Syllables"](t)||Bt["Yi Radicals"](t))))}function ns(t){return!(Ma(t)||function(e){return!!(Bt["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Bt["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Bt["Letterlike Symbols"](e)||Bt["Number Forms"](e)||Bt["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Bt["Control Pictures"](e)&&e!==9251||Bt["Optical Character Recognition"](e)||Bt["Enclosed Alphanumerics"](e)||Bt["Geometric Shapes"](e)||Bt["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Bt["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Bt["CJK Symbols and Punctuation"](e)||Bt.Katakana(e)||Bt["Private Use Area"](e)||Bt["CJK Compatibility Forms"](e)||Bt["Small Form Variants"](e)||Bt["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function tn(t){return t>=1424&&t<=2303||Bt["Arabic Presentation Forms-A"](t)||Bt["Arabic Presentation Forms-B"](t)}function Lr(t,e){return!(!e&&tn(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||Bt.Khmer(t))}function os(t){for(var e=0,i=t;e<i.length;e+=1)if(tn(i[e].charCodeAt(0)))return!0;return!1}var r=null,h="unavailable",_=null,b=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(h="error"),r&&r(t)};function E(){N.fire(new W("pluginStateChange",{pluginStatus:h,pluginURL:_}))}var N=new at,rt=function(){return h},pt=function(){if(h!=="deferred"||!_)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");h="loading",E(),_&&Ta({url:_},function(t){t?b(t):(h="loaded",E())})},wt={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return h==="loaded"||wt.applyArabicShaping!=null},isLoading:function(){return h==="loading"},setState:function(t){h=t.pluginStatus,_=t.pluginURL},isParsed:function(){return wt.applyArabicShaping!=null&&wt.processBidirectionalText!=null&&wt.processStyledBidirectionalText!=null},getPluginURL:function(){return _}},xt=function(t,e){this.zoom=t,e?(this.now=e.now,this.fadeDuration=e.fadeDuration,this.zoomHistory=e.zoomHistory,this.transition=e.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new is,this.transition={})};xt.prototype.isSupportedScript=function(t){return function(e,i){for(var s=0,c=e;s<c.length;s+=1)if(!Lr(c[s].charCodeAt(0),i))return!1;return!0}(t,wt.isLoaded())},xt.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},xt.prototype.getCrossfadeParameters=function(){var t=this.zoom,e=t-Math.floor(t),i=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:e+(1-e)*i}:{fromScale:.5,toScale:1,t:1-(1-i)*e}};var Wt=function(t,e){this.property=t,this.value=e,this.expression=function(i,s){if(Vn(i))return new fo(i,s);if(po(i)){var c=sl(i,s);if(c.result==="error")throw new Error(c.value.map(function(d){return d.key+": "+d.message}).join(", "));return c.value}var p=i;return typeof i=="string"&&s.type==="color"&&(p=se.parse(i)),{kind:"constant",evaluate:function(){return p}}}(e===void 0?t.specification.default:e,t.specification)};Wt.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},Wt.prototype.possiblyEvaluate=function(t,e,i){return this.property.possiblyEvaluate(this,t,e,i)};var ie=function(t){this.property=t,this.value=new Wt(t,void 0)};ie.prototype.transitioned=function(t,e){return new zr(this.property,this.value,e,ki({},t.transition,this.transition),t.now)},ie.prototype.untransitioned=function(){return new zr(this.property,this.value,null,{},0)};var me=function(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)};me.prototype.getValue=function(t){return li(this._values[t].value.value)},me.prototype.setValue=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new ie(this._values[t].property)),this._values[t].value=new Wt(this._values[t].property,e===null?void 0:li(e))},me.prototype.getTransition=function(t){return li(this._values[t].transition)},me.prototype.setTransition=function(t,e){this._values.hasOwnProperty(t)||(this._values[t]=new ie(this._values[t].property)),this._values[t].transition=li(e)||void 0},me.prototype.serialize=function(){for(var t={},e=0,i=Object.keys(this._values);e<i.length;e+=1){var s=i[e],c=this.getValue(s);c!==void 0&&(t[s]=c);var p=this.getTransition(s);p!==void 0&&(t[s+"-transition"]=p)}return t},me.prototype.transitioned=function(t,e){for(var i=new Ur(this._properties),s=0,c=Object.keys(this._values);s<c.length;s+=1){var p=c[s];i._values[p]=this._values[p].transitioned(t,e._values[p])}return i},me.prototype.untransitioned=function(){for(var t=new Ur(this._properties),e=0,i=Object.keys(this._values);e<i.length;e+=1){var s=i[e];t._values[s]=this._values[s].untransitioned()}return t};var zr=function(t,e,i,s,c){this.property=t,this.value=e,this.begin=c+s.delay||0,this.end=this.begin+s.duration||0,t.specification.transition&&(s.delay||s.duration)&&(this.prior=i)};zr.prototype.possiblyEvaluate=function(t,e,i){var s=t.now||0,c=this.value.possiblyEvaluate(t,e,i),p=this.prior;if(p){if(s>this.end)return this.prior=null,c;if(this.value.isDataDriven())return this.prior=null,c;if(s<this.begin)return p.possiblyEvaluate(t,e,i);var d=(s-this.begin)/(this.end-this.begin);return this.property.interpolate(p.possiblyEvaluate(t,e,i),c,function(v){if(v<=0)return 0;if(v>=1)return 1;var T=v*v,P=T*v;return 4*(v<.5?P:3*(v-T)+P-.75)}(d))}return c};var Ur=function(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)};Ur.prototype.possiblyEvaluate=function(t,e,i){for(var s=new Oo(this._properties),c=0,p=Object.keys(this._values);c<p.length;c+=1){var d=p[c];s._values[d]=this._values[d].possiblyEvaluate(t,e,i)}return s},Ur.prototype.hasTransition=function(){for(var t=0,e=Object.keys(this._values);t<e.length;t+=1)if(this._values[e[t]].prior)return!0;return!1};var Nr=function(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)};Nr.prototype.getValue=function(t){return li(this._values[t].value)},Nr.prototype.setValue=function(t,e){this._values[t]=new Wt(this._values[t].property,e===null?void 0:li(e))},Nr.prototype.serialize=function(){for(var t={},e=0,i=Object.keys(this._values);e<i.length;e+=1){var s=i[e],c=this.getValue(s);c!==void 0&&(t[s]=c)}return t},Nr.prototype.possiblyEvaluate=function(t,e,i){for(var s=new Oo(this._properties),c=0,p=Object.keys(this._values);c<p.length;c+=1){var d=p[c];s._values[d]=this._values[d].possiblyEvaluate(t,e,i)}return s};var Si=function(t,e,i){this.property=t,this.value=e,this.parameters=i};Si.prototype.isConstant=function(){return this.value.kind==="constant"},Si.prototype.constantOr=function(t){return this.value.kind==="constant"?this.value.value:t},Si.prototype.evaluate=function(t,e,i,s){return this.property.evaluate(this.value,this.parameters,t,e,i,s)};var Oo=function(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)};Oo.prototype.get=function(t){return this._values[t]};var Qt=function(t){this.specification=t};Qt.prototype.possiblyEvaluate=function(t,e){return t.expression.evaluate(e)},Qt.prototype.interpolate=function(t,e,i){var s=no[this.specification.type];return s?s(t,e,i):t};var Xt=function(t,e){this.specification=t,this.overrides=e};Xt.prototype.possiblyEvaluate=function(t,e,i,s){return new Si(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(e,null,{},i,s)}:t.expression,e)},Xt.prototype.interpolate=function(t,e,i){if(t.value.kind!=="constant"||e.value.kind!=="constant")return t;if(t.value.value===void 0||e.value.value===void 0)return new Si(this,{kind:"constant",value:void 0},t.parameters);var s=no[this.specification.type];return s?new Si(this,{kind:"constant",value:s(t.value.value,e.value.value,i)},t.parameters):t},Xt.prototype.evaluate=function(t,e,i,s,c,p){return t.kind==="constant"?t.value:t.evaluate(e,i,s,c,p)};var as=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(i,s,c,p){if(i.value===void 0)return new Si(this,{kind:"constant",value:void 0},s);if(i.expression.kind==="constant"){var d=i.expression.evaluate(s,null,{},c,p),v=i.property.specification.type==="resolvedImage"&&typeof d!="string"?d.name:d,T=this._calculate(v,v,v,s);return new Si(this,{kind:"constant",value:T},s)}if(i.expression.kind==="camera"){var P=this._calculate(i.expression.evaluate({zoom:s.zoom-1}),i.expression.evaluate({zoom:s.zoom}),i.expression.evaluate({zoom:s.zoom+1}),s);return new Si(this,{kind:"constant",value:P},s)}return new Si(this,i.expression,s)},e.prototype.evaluate=function(i,s,c,p,d,v){if(i.kind==="source"){var T=i.evaluate(s,c,p,d,v);return this._calculate(T,T,T,s)}return i.kind==="composite"?this._calculate(i.evaluate({zoom:Math.floor(s.zoom)-1},c,p),i.evaluate({zoom:Math.floor(s.zoom)},c,p),i.evaluate({zoom:Math.floor(s.zoom)+1},c,p),s):i.value},e.prototype._calculate=function(i,s,c,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:i,to:s}:{from:c,to:s}},e.prototype.interpolate=function(i){return i},e}(Xt),cr=function(t){this.specification=t};cr.prototype.possiblyEvaluate=function(t,e,i,s){if(t.value!==void 0){if(t.expression.kind==="constant"){var c=t.expression.evaluate(e,null,{},i,s);return this._calculate(c,c,c,e)}return this._calculate(t.expression.evaluate(new xt(Math.floor(e.zoom-1),e)),t.expression.evaluate(new xt(Math.floor(e.zoom),e)),t.expression.evaluate(new xt(Math.floor(e.zoom+1),e)),e)}},cr.prototype._calculate=function(t,e,i,s){return s.zoom>s.zoomHistory.lastIntegerZoom?{from:t,to:e}:{from:i,to:e}},cr.prototype.interpolate=function(t){return t};var xn=function(t){this.specification=t};xn.prototype.possiblyEvaluate=function(t,e,i,s){return!!t.expression.evaluate(e,null,{},i,s)},xn.prototype.interpolate=function(){return!1};var Xi=function(t){for(var e in this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],t){var i=t[e];i.specification.overridable&&this.overridableProperties.push(e);var s=this.defaultPropertyValues[e]=new Wt(i,void 0),c=this.defaultTransitionablePropertyValues[e]=new ie(i);this.defaultTransitioningPropertyValues[e]=c.untransitioned(),this.defaultPossiblyEvaluatedValues[e]=s.possiblyEvaluate({})}};jt("DataDrivenProperty",Xt),jt("DataConstantProperty",Qt),jt("CrossFadedDataDrivenProperty",as),jt("CrossFadedProperty",cr),jt("ColorRampProperty",xn);var ii=function(t){function e(i,s){if(t.call(this),this.id=i.id,this.type=i.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},i.type!=="custom"&&(this.metadata=(i=i).metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type!=="background"&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),s.layout&&(this._unevaluatedLayout=new Nr(s.layout)),s.paint)){for(var c in this._transitionablePaint=new me(s.paint),i.paint)this.setPaintProperty(c,i.paint[c],{validate:!1});for(var p in i.layout)this.setLayoutProperty(p,i.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Oo(s.paint)}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)},e.prototype.setLayoutProperty=function(i,s,c){c===void 0&&(c={}),s!=null&&this._validate(na,"layers."+this.id+".layout."+i,i,s,c)||(i!=="visibility"?this._unevaluatedLayout.setValue(i,s):this.visibility=s)},e.prototype.getPaintProperty=function(i){return Xn(i,"-transition")?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)},e.prototype.setPaintProperty=function(i,s,c){if(c===void 0&&(c={}),s!=null&&this._validate(ra,"layers."+this.id+".paint."+i,i,s,c))return!1;if(Xn(i,"-transition"))return this._transitionablePaint.setTransition(i.slice(0,-11),s||void 0),!1;var p=this._transitionablePaint._values[i],d=p.property.specification["property-type"]==="cross-faded-data-driven",v=p.value.isDataDriven(),T=p.value;this._transitionablePaint.setValue(i,s),this._handleSpecialPaintPropertyUpdate(i);var P=this._transitionablePaint._values[i].value;return P.isDataDriven()||v||d||this._handleOverridablePaintPropertyUpdate(i,T,P)},e.prototype._handleSpecialPaintPropertyUpdate=function(i){},e.prototype._handleOverridablePaintPropertyUpdate=function(i,s,c){return!1},e.prototype.isHidden=function(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"},e.prototype.updateTransitions=function(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(i,s){i.getCrossfadeParameters&&(this._crossfadeParameters=i.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,s)},e.prototype.serialize=function(){var i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),Tn(i,function(s,c){return!(s===void 0||c==="layout"&&!Object.keys(s).length||c==="paint"&&!Object.keys(s).length)})},e.prototype._validate=function(i,s,c,p,d){return d===void 0&&(d={}),(!d||d.validate!==!1)&&oa(this,i.call(jn,{key:s,layerType:this.type,objectKey:c,value:p,styleSpec:V,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var i in this.paint._values){var s=this.paint.get(i);if(s instanceof Si&&Lo(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1},e}(at),sa={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},ss=function(t,e){this._structArray=t,this._pos1=e*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},je=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Ki(t,e){e===void 0&&(e=1);var i=0,s=0;return{members:t.map(function(c){var p=sa[c.type].BYTES_PER_ELEMENT,d=i=ls(i,Math.max(e,p)),v=c.components||1;return s=Math.max(s,p),i+=p*v,{name:c.name,type:c.type,components:v,offset:d}}),size:ls(i,Math.max(s,e)),alignment:e}}function ls(t,e){return Math.ceil(t/e)*e}je.serialize=function(t,e){return t._trim(),e&&(t.isTransferred=!0,e.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}},je.deserialize=function(t){var e=Object.create(this.prototype);return e.arrayBuffer=t.arrayBuffer,e.length=t.length,e.capacity=t.arrayBuffer.byteLength/e.bytesPerElement,e._refreshViews(),e},je.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},je.prototype.clear=function(){this.length=0},je.prototype.resize=function(t){this.reserve(t),this.length=t},je.prototype.reserve=function(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var e=this.uint8;this._refreshViews(),e&&this.uint8.set(e)}},je.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var _o=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s){var c=this.length;return this.resize(c+1),this.emplace(c,i,s)},e.prototype.emplace=function(i,s,c){var p=2*i;return this.int16[p+0]=s,this.int16[p+1]=c,i},e}(je);_o.prototype.bytesPerElement=4,jt("StructArrayLayout2i4",_o);var Rs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,s,c,p)},e.prototype.emplace=function(i,s,c,p,d){var v=4*i;return this.int16[v+0]=s,this.int16[v+1]=c,this.int16[v+2]=p,this.int16[v+3]=d,i},e}(je);Rs.prototype.bytesPerElement=8,jt("StructArrayLayout4i8",Rs);var Fo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c,p,d,v){var T=this.length;return this.resize(T+1),this.emplace(T,i,s,c,p,d,v)},e.prototype.emplace=function(i,s,c,p,d,v,T){var P=6*i;return this.int16[P+0]=s,this.int16[P+1]=c,this.int16[P+2]=p,this.int16[P+3]=d,this.int16[P+4]=v,this.int16[P+5]=T,i},e}(je);Fo.prototype.bytesPerElement=12,jt("StructArrayLayout2i4i12",Fo);var dn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c,p,d,v){var T=this.length;return this.resize(T+1),this.emplace(T,i,s,c,p,d,v)},e.prototype.emplace=function(i,s,c,p,d,v,T){var P=4*i,A=8*i;return this.int16[P+0]=s,this.int16[P+1]=c,this.uint8[A+4]=p,this.uint8[A+5]=d,this.uint8[A+6]=v,this.uint8[A+7]=T,i},e}(je);dn.prototype.bytesPerElement=8,jt("StructArrayLayout2i4ub8",dn);var us=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s){var c=this.length;return this.resize(c+1),this.emplace(c,i,s)},e.prototype.emplace=function(i,s,c){var p=2*i;return this.float32[p+0]=s,this.float32[p+1]=c,i},e}(je);us.prototype.bytesPerElement=8,jt("StructArrayLayout2f8",us);var yo=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c,p,d,v,T,P,A,z){var B=this.length;return this.resize(B+1),this.emplace(B,i,s,c,p,d,v,T,P,A,z)},e.prototype.emplace=function(i,s,c,p,d,v,T,P,A,z,B){var F=10*i;return this.uint16[F+0]=s,this.uint16[F+1]=c,this.uint16[F+2]=p,this.uint16[F+3]=d,this.uint16[F+4]=v,this.uint16[F+5]=T,this.uint16[F+6]=P,this.uint16[F+7]=A,this.uint16[F+8]=z,this.uint16[F+9]=B,i},e}(je);yo.prototype.bytesPerElement=20,jt("StructArrayLayout10ui20",yo);var ul=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c,p,d,v,T,P,A,z,B,F){var H=this.length;return this.resize(H+1),this.emplace(H,i,s,c,p,d,v,T,P,A,z,B,F)},e.prototype.emplace=function(i,s,c,p,d,v,T,P,A,z,B,F,H){var X=12*i;return this.int16[X+0]=s,this.int16[X+1]=c,this.int16[X+2]=p,this.int16[X+3]=d,this.uint16[X+4]=v,this.uint16[X+5]=T,this.uint16[X+6]=P,this.uint16[X+7]=A,this.int16[X+8]=z,this.int16[X+9]=B,this.int16[X+10]=F,this.int16[X+11]=H,i},e}(je);ul.prototype.bytesPerElement=24,jt("StructArrayLayout4i4ui4i24",ul);var hs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c){var p=this.length;return this.resize(p+1),this.emplace(p,i,s,c)},e.prototype.emplace=function(i,s,c,p){var d=3*i;return this.float32[d+0]=s,this.float32[d+1]=c,this.float32[d+2]=p,i},e}(je);hs.prototype.bytesPerElement=12,jt("StructArrayLayout3f12",hs);var Os=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i){var s=this.length;return this.resize(s+1),this.emplace(s,i)},e.prototype.emplace=function(i,s){return this.uint32[1*i+0]=s,i},e}(je);Os.prototype.bytesPerElement=4,jt("StructArrayLayout1ul4",Os);var Gl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c,p,d,v,T,P,A){var z=this.length;return this.resize(z+1),this.emplace(z,i,s,c,p,d,v,T,P,A)},e.prototype.emplace=function(i,s,c,p,d,v,T,P,A,z){var B=10*i,F=5*i;return this.int16[B+0]=s,this.int16[B+1]=c,this.int16[B+2]=p,this.int16[B+3]=d,this.int16[B+4]=v,this.int16[B+5]=T,this.uint32[F+3]=P,this.uint16[B+8]=A,this.uint16[B+9]=z,i},e}(je);Gl.prototype.bytesPerElement=20,jt("StructArrayLayout6i1ul2ui20",Gl);var cs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c,p,d,v){var T=this.length;return this.resize(T+1),this.emplace(T,i,s,c,p,d,v)},e.prototype.emplace=function(i,s,c,p,d,v,T){var P=6*i;return this.int16[P+0]=s,this.int16[P+1]=c,this.int16[P+2]=p,this.int16[P+3]=d,this.int16[P+4]=v,this.int16[P+5]=T,i},e}(je);cs.prototype.bytesPerElement=12,jt("StructArrayLayout2i2i2i12",cs);var Da=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c,p,d){var v=this.length;return this.resize(v+1),this.emplace(v,i,s,c,p,d)},e.prototype.emplace=function(i,s,c,p,d,v){var T=4*i,P=8*i;return this.float32[T+0]=s,this.float32[T+1]=c,this.float32[T+2]=p,this.int16[P+6]=d,this.int16[P+7]=v,i},e}(je);Da.prototype.bytesPerElement=16,jt("StructArrayLayout2f1f2i16",Da);var Wl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,s,c,p)},e.prototype.emplace=function(i,s,c,p,d){var v=12*i,T=3*i;return this.uint8[v+0]=s,this.uint8[v+1]=c,this.float32[T+1]=p,this.float32[T+2]=d,i},e}(je);Wl.prototype.bytesPerElement=12,jt("StructArrayLayout2ub2f12",Wl);var la=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c){var p=this.length;return this.resize(p+1),this.emplace(p,i,s,c)},e.prototype.emplace=function(i,s,c,p){var d=3*i;return this.uint16[d+0]=s,this.uint16[d+1]=c,this.uint16[d+2]=p,i},e}(je);la.prototype.bytesPerElement=6,jt("StructArrayLayout3ui6",la);var ua=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c,p,d,v,T,P,A,z,B,F,H,X,et,$,lt){var ct=this.length;return this.resize(ct+1),this.emplace(ct,i,s,c,p,d,v,T,P,A,z,B,F,H,X,et,$,lt)},e.prototype.emplace=function(i,s,c,p,d,v,T,P,A,z,B,F,H,X,et,$,lt,ct){var ft=24*i,mt=12*i,Tt=48*i;return this.int16[ft+0]=s,this.int16[ft+1]=c,this.uint16[ft+2]=p,this.uint16[ft+3]=d,this.uint32[mt+2]=v,this.uint32[mt+3]=T,this.uint32[mt+4]=P,this.uint16[ft+10]=A,this.uint16[ft+11]=z,this.uint16[ft+12]=B,this.float32[mt+7]=F,this.float32[mt+8]=H,this.uint8[Tt+36]=X,this.uint8[Tt+37]=et,this.uint8[Tt+38]=$,this.uint32[mt+10]=lt,this.int16[ft+22]=ct,i},e}(je);ua.prototype.bytesPerElement=48,jt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ua);var hl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c,p,d,v,T,P,A,z,B,F,H,X,et,$,lt,ct,ft,mt,Tt,Lt,Dt,$t,Ut,ee,Nt,xe){var le=this.length;return this.resize(le+1),this.emplace(le,i,s,c,p,d,v,T,P,A,z,B,F,H,X,et,$,lt,ct,ft,mt,Tt,Lt,Dt,$t,Ut,ee,Nt,xe)},e.prototype.emplace=function(i,s,c,p,d,v,T,P,A,z,B,F,H,X,et,$,lt,ct,ft,mt,Tt,Lt,Dt,$t,Ut,ee,Nt,xe,le){var Jt=34*i,Pe=17*i;return this.int16[Jt+0]=s,this.int16[Jt+1]=c,this.int16[Jt+2]=p,this.int16[Jt+3]=d,this.int16[Jt+4]=v,this.int16[Jt+5]=T,this.int16[Jt+6]=P,this.int16[Jt+7]=A,this.uint16[Jt+8]=z,this.uint16[Jt+9]=B,this.uint16[Jt+10]=F,this.uint16[Jt+11]=H,this.uint16[Jt+12]=X,this.uint16[Jt+13]=et,this.uint16[Jt+14]=$,this.uint16[Jt+15]=lt,this.uint16[Jt+16]=ct,this.uint16[Jt+17]=ft,this.uint16[Jt+18]=mt,this.uint16[Jt+19]=Tt,this.uint16[Jt+20]=Lt,this.uint16[Jt+21]=Dt,this.uint16[Jt+22]=$t,this.uint32[Pe+12]=Ut,this.float32[Pe+13]=ee,this.float32[Pe+14]=Nt,this.float32[Pe+15]=xe,this.float32[Pe+16]=le,i},e}(je);hl.prototype.bytesPerElement=68,jt("StructArrayLayout8i15ui1ul4f68",hl);var ha=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i){var s=this.length;return this.resize(s+1),this.emplace(s,i)},e.prototype.emplace=function(i,s){return this.float32[1*i+0]=s,i},e}(je);ha.prototype.bytesPerElement=4,jt("StructArrayLayout1f4",ha);var kn=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c){var p=this.length;return this.resize(p+1),this.emplace(p,i,s,c)},e.prototype.emplace=function(i,s,c,p){var d=3*i;return this.int16[d+0]=s,this.int16[d+1]=c,this.int16[d+2]=p,i},e}(je);kn.prototype.bytesPerElement=6,jt("StructArrayLayout3i6",kn);var Hl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c){var p=this.length;return this.resize(p+1),this.emplace(p,i,s,c)},e.prototype.emplace=function(i,s,c,p){var d=4*i;return this.uint32[2*i+0]=s,this.uint16[d+2]=c,this.uint16[d+3]=p,i},e}(je);Hl.prototype.bytesPerElement=8,jt("StructArrayLayout1ul2ui8",Hl);var Fs=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s){var c=this.length;return this.resize(c+1),this.emplace(c,i,s)},e.prototype.emplace=function(i,s,c){var p=2*i;return this.uint16[p+0]=s,this.uint16[p+1]=c,i},e}(je);Fs.prototype.bytesPerElement=4,jt("StructArrayLayout2ui4",Fs);var Xl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i){var s=this.length;return this.resize(s+1),this.emplace(s,i)},e.prototype.emplace=function(i,s){return this.uint16[1*i+0]=s,i},e}(je);Xl.prototype.bytesPerElement=2,jt("StructArrayLayout1ui2",Xl);var cl=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(i,s,c,p){var d=this.length;return this.resize(d+1),this.emplace(d,i,s,c,p)},e.prototype.emplace=function(i,s,c,p,d){var v=4*i;return this.float32[v+0]=s,this.float32[v+1]=c,this.float32[v+2]=p,this.float32[v+3]=d,i},e}(je);cl.prototype.bytesPerElement=16,jt("StructArrayLayout4f16",cl);var n=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return i.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},i.x1.get=function(){return this._structArray.int16[this._pos2+2]},i.y1.get=function(){return this._structArray.int16[this._pos2+3]},i.x2.get=function(){return this._structArray.int16[this._pos2+4]},i.y2.get=function(){return this._structArray.int16[this._pos2+5]},i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.anchorPoint.get=function(){return new Vt(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,i),e}(ss);n.prototype.size=20;var a=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new n(this,i)},e}(Gl);jt("CollisionBoxArray",a);var o=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},i.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},i.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},i.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},i.segment.get=function(){return this._structArray.uint16[this._pos2+10]},i.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},i.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},i.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},i.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},i.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},i.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},i.placedOrientation.set=function(s){this._structArray.uint8[this._pos1+37]=s},i.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},i.hidden.set=function(s){this._structArray.uint8[this._pos1+38]=s},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},i.crossTileID.set=function(s){this._structArray.uint32[this._pos4+10]=s},i.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,i),e}(ss);o.prototype.size=48;var l=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new o(this,i)},e}(ua);jt("PlacedSymbolArray",l);var f=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return i.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},i.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},i.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},i.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},i.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},i.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},i.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},i.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},i.key.get=function(){return this._structArray.uint16[this._pos2+8]},i.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},i.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},i.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},i.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},i.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},i.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},i.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},i.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},i.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},i.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},i.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},i.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},i.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},i.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},i.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},i.crossTileID.set=function(s){this._structArray.uint32[this._pos4+12]=s},i.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},i.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},i.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},i.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,i),e}(ss);f.prototype.size=68;var y=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new f(this,i)},e}(hl);jt("SymbolInstanceArray",y);var g=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getoffsetX=function(i){return this.float32[1*i+0]},e}(ha);jt("GlyphOffsetArray",g);var w=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.getx=function(i){return this.int16[3*i+0]},e.prototype.gety=function(i){return this.int16[3*i+1]},e.prototype.gettileUnitDistanceFromAnchor=function(i){return this.int16[3*i+2]},e}(kn);jt("SymbolLineVertexArray",w);var I=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var i={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return i.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},i.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},i.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,i),e}(ss);I.prototype.size=8;var k=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.get=function(i){return new I(this,i)},e}(Hl);jt("FeatureIndexArray",k);var U=Ki([{name:"a_pos",components:2,type:"Int16"}],4).members,Z=function(t){t===void 0&&(t=[]),this.segments=t};function q(t,e){return 256*(t=lr(Math.floor(t),0,255))+lr(Math.floor(e),0,255)}Z.prototype.prepareSegment=function(t,e,i,s){var c=this.segments[this.segments.length-1];return t>Z.MAX_VERTEX_ARRAY_LENGTH&&_i("Max vertices per segment is "+Z.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+t),(!c||c.vertexLength+t>Z.MAX_VERTEX_ARRAY_LENGTH||c.sortKey!==s)&&(c={vertexOffset:e.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},s!==void 0&&(c.sortKey=s),this.segments.push(c)),c},Z.prototype.get=function(){return this.segments},Z.prototype.destroy=function(){for(var t=0,e=this.segments;t<e.length;t+=1){var i=e[t];for(var s in i.vaos)i.vaos[s].destroy()}},Z.simpleSegment=function(t,e,i,s){return new Z([{vertexOffset:t,primitiveOffset:e,vertexLength:i,primitiveLength:s,vaos:{},sortKey:0}])},Z.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,jt("SegmentVector",Z);var J=Ki([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),K=Et(function(t){t.exports=function(e,i){var s,c,p,d,v,T,P,A;for(c=e.length-(s=3&e.length),p=i,v=3432918353,T=461845907,A=0;A<c;)P=255&e.charCodeAt(A)|(255&e.charCodeAt(++A))<<8|(255&e.charCodeAt(++A))<<16|(255&e.charCodeAt(++A))<<24,++A,p=27492+(65535&(d=5*(65535&(p=(p^=P=(65535&(P=(P=(65535&P)*v+(((P>>>16)*v&65535)<<16)&4294967295)<<15|P>>>17))*T+(((P>>>16)*T&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(d>>>16)&65535)<<16);switch(P=0,s){case 3:P^=(255&e.charCodeAt(A+2))<<16;case 2:P^=(255&e.charCodeAt(A+1))<<8;case 1:p^=P=(65535&(P=(P=(65535&(P^=255&e.charCodeAt(A)))*v+(((P>>>16)*v&65535)<<16)&4294967295)<<15|P>>>17))*T+(((P>>>16)*T&65535)<<16)&4294967295}return p^=e.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0}}),tt=Et(function(t){t.exports=function(e,i){for(var s,c=e.length,p=i^c,d=0;c>=4;)s=1540483477*(65535&(s=255&e.charCodeAt(d)|(255&e.charCodeAt(++d))<<8|(255&e.charCodeAt(++d))<<16|(255&e.charCodeAt(++d))<<24))+((1540483477*(s>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),c-=4,++d;switch(c){case 3:p^=(255&e.charCodeAt(d+2))<<16;case 2:p^=(255&e.charCodeAt(d+1))<<8;case 1:p=1540483477*(65535&(p^=255&e.charCodeAt(d)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0}}),G=K,Q=tt;G.murmur3=K,G.murmur2=Q;var ot=function(){this.ids=[],this.positions=[],this.indexed=!1};ot.prototype.add=function(t,e,i,s){this.ids.push(_t(t)),this.positions.push(e,i,s)},ot.prototype.getPositions=function(t){for(var e=_t(t),i=0,s=this.ids.length-1;i<s;){var c=i+s>>1;this.ids[c]>=e?s=c:i=c+1}for(var p=[];this.ids[i]===e;)p.push({index:this.positions[3*i],start:this.positions[3*i+1],end:this.positions[3*i+2]}),i++;return p},ot.serialize=function(t,e){var i=new Float64Array(t.ids),s=new Uint32Array(t.positions);return function c(p,d,v,T){for(;v<T;){for(var P=p[v+T>>1],A=v-1,z=T+1;;){do A++;while(p[A]<P);do z--;while(p[z]>P);if(A>=z)break;dt(p,A,z),dt(d,3*A,3*z),dt(d,3*A+1,3*z+1),dt(d,3*A+2,3*z+2)}z-v<T-z?(c(p,d,v,z),v=z+1):(c(p,d,z+1,T),T=z)}}(i,s,0,i.length-1),e&&e.push(i.buffer,s.buffer),{ids:i,positions:s}},ot.deserialize=function(t){var e=new ot;return e.ids=t.ids,e.positions=t.positions,e.indexed=!0,e};var ht=Math.pow(2,53)-1;function _t(t){var e=+t;return!isNaN(e)&&e<=ht?e:G(String(t))}function dt(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}jt("FeaturePositionMap",ot);var vt=function(t,e){this.gl=t.gl,this.location=e},Pt=function(t){function e(i,s){t.call(this,i,s),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))},e}(vt),kt=function(t){function e(i,s){t.call(this,i,s),this.current=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))},e}(vt),zt=function(t){function e(i,s){t.call(this,i,s),this.current=[0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))},e}(vt),Zt=function(t){function e(i,s){t.call(this,i,s),this.current=[0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))},e}(vt),te=function(t){function e(i,s){t.call(this,i,s),this.current=[0,0,0,0]}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3]))},e}(vt),oe=function(t){function e(i,s){t.call(this,i,s),this.current=se.transparent}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a))},e}(vt),ne=new Float32Array(16),Me=function(t){function e(i,s){t.call(this,i,s),this.current=ne}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.set=function(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(var s=1;s<16;s++)if(i[s]!==this.current[s]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}},e}(vt);function Gt(t){return[q(255*t.r,255*t.g),q(255*t.b,255*t.a)]}var pe=function(t,e,i){this.value=t,this.uniformNames=e.map(function(s){return"u_"+s}),this.type=i};pe.prototype.setUniform=function(t,e,i){t.set(i.constantOr(this.value))},pe.prototype.getBinding=function(t,e,i){return this.type==="color"?new oe(t,e):new kt(t,e)};var ve=function(t,e){this.uniformNames=e.map(function(i){return"u_"+i}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};ve.prototype.setConstantPatternPositions=function(t,e){this.pixelRatioFrom=e.pixelRatio,this.pixelRatioTo=t.pixelRatio,this.patternFrom=e.tlbr,this.patternTo=t.tlbr},ve.prototype.setUniform=function(t,e,i,s){var c=s==="u_pattern_to"?this.patternTo:s==="u_pattern_from"?this.patternFrom:s==="u_pixel_ratio_to"?this.pixelRatioTo:s==="u_pixel_ratio_from"?this.pixelRatioFrom:null;c&&t.set(c)},ve.prototype.getBinding=function(t,e,i){return i.substr(0,9)==="u_pattern"?new te(t,e):new kt(t,e)};var ce=function(t,e,i,s){this.expression=t,this.type=i,this.maxValue=0,this.paintVertexAttributes=e.map(function(c){return{name:"a_"+c,type:"Float32",components:i==="color"?2:1,offset:0}}),this.paintVertexArray=new s};ce.prototype.populatePaintArray=function(t,e,i,s,c){var p=this.paintVertexArray.length,d=this.expression.evaluate(new xt(0),e,{},s,[],c);this.paintVertexArray.resize(t),this._setPaintValue(p,t,d)},ce.prototype.updatePaintArray=function(t,e,i,s){var c=this.expression.evaluate({zoom:0},i,s);this._setPaintValue(t,e,c)},ce.prototype._setPaintValue=function(t,e,i){if(this.type==="color")for(var s=Gt(i),c=t;c<e;c++)this.paintVertexArray.emplace(c,s[0],s[1]);else{for(var p=t;p<e;p++)this.paintVertexArray.emplace(p,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}},ce.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},ce.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var he=function(t,e,i,s,c,p){this.expression=t,this.uniformNames=e.map(function(d){return"u_"+d+"_t"}),this.type=i,this.useIntegerZoom=s,this.zoom=c,this.maxValue=0,this.paintVertexAttributes=e.map(function(d){return{name:"a_"+d,type:"Float32",components:i==="color"?4:2,offset:0}}),this.paintVertexArray=new p};he.prototype.populatePaintArray=function(t,e,i,s,c){var p=this.expression.evaluate(new xt(this.zoom),e,{},s,[],c),d=this.expression.evaluate(new xt(this.zoom+1),e,{},s,[],c),v=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(v,t,p,d)},he.prototype.updatePaintArray=function(t,e,i,s){var c=this.expression.evaluate({zoom:this.zoom},i,s),p=this.expression.evaluate({zoom:this.zoom+1},i,s);this._setPaintValue(t,e,c,p)},he.prototype._setPaintValue=function(t,e,i,s){if(this.type==="color")for(var c=Gt(i),p=Gt(s),d=t;d<e;d++)this.paintVertexArray.emplace(d,c[0],c[1],p[0],p[1]);else{for(var v=t;v<e;v++)this.paintVertexArray.emplace(v,i,s);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(s))}},he.prototype.upload=function(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},he.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},he.prototype.setUniform=function(t,e){var i=this.useIntegerZoom?Math.floor(e.zoom):e.zoom,s=lr(this.expression.interpolationFactor(i,this.zoom,this.zoom+1),0,1);t.set(s)},he.prototype.getBinding=function(t,e,i){return new kt(t,e)};var ye=function(t,e,i,s,c,p){this.expression=t,this.type=e,this.useIntegerZoom=i,this.zoom=s,this.layerId=p,this.zoomInPaintVertexArray=new c,this.zoomOutPaintVertexArray=new c};ye.prototype.populatePaintArray=function(t,e,i){var s=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(s,t,e.patterns&&e.patterns[this.layerId],i)},ye.prototype.updatePaintArray=function(t,e,i,s,c){this._setPaintValues(t,e,i.patterns&&i.patterns[this.layerId],c)},ye.prototype._setPaintValues=function(t,e,i,s){if(s&&i){var c=s[i.min],p=s[i.mid],d=s[i.max];if(c&&p&&d)for(var v=t;v<e;v++)this.zoomInPaintVertexArray.emplace(v,p.tl[0],p.tl[1],p.br[0],p.br[1],c.tl[0],c.tl[1],c.br[0],c.br[1],p.pixelRatio,c.pixelRatio),this.zoomOutPaintVertexArray.emplace(v,p.tl[0],p.tl[1],p.br[0],p.br[1],d.tl[0],d.tl[1],d.br[0],d.br[1],p.pixelRatio,d.pixelRatio)}},ye.prototype.upload=function(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,J.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,J.members,this.expression.isStateDependent))},ye.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var ue=function(t,e,i){this.binders={},this._buffers=[];var s=[];for(var c in t.paint._values)if(i(c)){var p=t.paint.get(c);if(p instanceof Si&&Lo(p.property.specification)){var d=rr(c,t.type),v=p.value,T=p.property.specification.type,P=p.property.useIntegerZoom,A=p.property.specification["property-type"],z=A==="cross-faded"||A==="cross-faded-data-driven";if(v.kind==="constant")this.binders[c]=z?new ve(v.value,d):new pe(v.value,d,T),s.push("/u_"+c);else if(v.kind==="source"||z){var B=Ci(c,T,"source");this.binders[c]=z?new ye(v,T,P,e,B,t.id):new ce(v,d,T,B),s.push("/a_"+c)}else{var F=Ci(c,T,"composite");this.binders[c]=new he(v,d,T,P,e,F),s.push("/z_"+c)}}}this.cacheKey=s.sort().join("")};ue.prototype.getMaxValue=function(t){var e=this.binders[t];return e instanceof ce||e instanceof he?e.maxValue:0},ue.prototype.populatePaintArrays=function(t,e,i,s,c){for(var p in this.binders){var d=this.binders[p];(d instanceof ce||d instanceof he||d instanceof ye)&&d.populatePaintArray(t,e,i,s,c)}},ue.prototype.setConstantPatternPositions=function(t,e){for(var i in this.binders){var s=this.binders[i];s instanceof ve&&s.setConstantPatternPositions(t,e)}},ue.prototype.updatePaintArrays=function(t,e,i,s,c){var p=!1;for(var d in t)for(var v=0,T=e.getPositions(d);v<T.length;v+=1){var P=T[v],A=i.feature(P.index);for(var z in this.binders){var B=this.binders[z];if((B instanceof ce||B instanceof he||B instanceof ye)&&B.expression.isStateDependent===!0){var F=s.paint.get(z);B.expression=F.value,B.updatePaintArray(P.start,P.end,A,t[d],c),p=!0}}}return p},ue.prototype.defines=function(){var t=[];for(var e in this.binders){var i=this.binders[e];(i instanceof pe||i instanceof ve)&&t.push.apply(t,i.uniformNames.map(function(s){return"#define HAS_UNIFORM_"+s}))}return t},ue.prototype.getBinderAttributes=function(){var t=[];for(var e in this.binders){var i=this.binders[e];if(i instanceof ce||i instanceof he)for(var s=0;s<i.paintVertexAttributes.length;s++)t.push(i.paintVertexAttributes[s].name);else if(i instanceof ye)for(var c=0;c<J.members.length;c++)t.push(J.members[c].name)}return t},ue.prototype.getBinderUniforms=function(){var t=[];for(var e in this.binders){var i=this.binders[e];if(i instanceof pe||i instanceof ve||i instanceof he)for(var s=0,c=i.uniformNames;s<c.length;s+=1)t.push(c[s])}return t},ue.prototype.getPaintVertexBuffers=function(){return this._buffers},ue.prototype.getUniforms=function(t,e){var i=[];for(var s in this.binders){var c=this.binders[s];if(c instanceof pe||c instanceof ve||c instanceof he)for(var p=0,d=c.uniformNames;p<d.length;p+=1){var v=d[p];if(e[v]){var T=c.getBinding(t,e[v],v);i.push({name:v,property:s,binding:T})}}}return i},ue.prototype.setUniforms=function(t,e,i,s){for(var c=0,p=e;c<p.length;c+=1){var d=p[c],v=d.name,T=d.property;this.binders[T].setUniform(d.binding,s,i.get(T),v)}},ue.prototype.updatePaintBuffers=function(t){for(var e in this._buffers=[],this.binders){var i=this.binders[e];if(t&&i instanceof ye){var s=t.fromScale===2?i.zoomInPaintVertexBuffer:i.zoomOutPaintVertexBuffer;s&&this._buffers.push(s)}else(i instanceof ce||i instanceof he)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}},ue.prototype.upload=function(t){for(var e in this.binders){var i=this.binders[e];(i instanceof ce||i instanceof he||i instanceof ye)&&i.upload(t)}this.updatePaintBuffers()},ue.prototype.destroy=function(){for(var t in this.binders){var e=this.binders[t];(e instanceof ce||e instanceof he||e instanceof ye)&&e.destroy()}};var ae=function(t,e,i){i===void 0&&(i=function(){return!0}),this.programConfigurations={};for(var s=0,c=t;s<c.length;s+=1){var p=c[s];this.programConfigurations[p.id]=new ue(p,e,i)}this.needsUpload=!1,this._featureMap=new ot,this._bufferOffset=0};function rr(t,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[t]||[t.replace(e+"-","").replace(/-/g,"_")]}function Ci(t,e,i){var s={color:{source:us,composite:cl},number:{source:ha,composite:us}},c=function(p){return{"line-pattern":{source:yo,composite:yo},"fill-pattern":{source:yo,composite:yo},"fill-extrusion-pattern":{source:yo,composite:yo}}[p]}(t);return c&&c[i]||s[e][i]}ae.prototype.populatePaintArrays=function(t,e,i,s,c,p){for(var d in this.programConfigurations)this.programConfigurations[d].populatePaintArrays(t,e,s,c,p);e.id!==void 0&&this._featureMap.add(e.id,i,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0},ae.prototype.updatePaintArrays=function(t,e,i,s){for(var c=0,p=i;c<p.length;c+=1){var d=p[c];this.needsUpload=this.programConfigurations[d.id].updatePaintArrays(t,this._featureMap,e,d,s)||this.needsUpload}},ae.prototype.get=function(t){return this.programConfigurations[t]},ae.prototype.upload=function(t){if(this.needsUpload){for(var e in this.programConfigurations)this.programConfigurations[e].upload(t);this.needsUpload=!1}},ae.prototype.destroy=function(){for(var t in this.programConfigurations)this.programConfigurations[t].destroy()},jt("ConstantBinder",pe),jt("CrossFadedConstantBinder",ve),jt("SourceExpressionBinder",ce),jt("CrossFadedCompositeBinder",ye),jt("CompositeExpressionBinder",he),jt("ProgramConfiguration",ue,{omit:["_buffers"]}),jt("ProgramConfigurationSet",ae);var kr=Math.pow(2,14)-1,pr=-kr-1;function Pi(t){for(var e=8192/t.extent,i=t.loadGeometry(),s=0;s<i.length;s++)for(var c=i[s],p=0;p<c.length;p++){var d=c[p],v=Math.round(d.x*e),T=Math.round(d.y*e);d.x=lr(v,pr,kr),d.y=lr(T,pr,kr),(v<d.x||v>d.x+1||T<d.y||T>d.y+1)&&_i("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return i}function Mi(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Pi(t):[]}}function mn(t,e,i,s,c){t.emplaceBack(2*e+(s+1)/2,2*i+(c+1)/2)}var Zr=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new _o,this.indexArray=new la,this.segments=new Z,this.programConfigurations=new ae(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function ca(t,e){for(var i=0;i<t.length;i++)if(go(e,t[i]))return!0;for(var s=0;s<e.length;s++)if(go(t,e[s]))return!0;return!!Us(t,e)}function en(t,e,i){return!!go(t,e)||!!pa(e,t,i)}function Wn(t,e){if(t.length===1)return Ns(e,t[0]);for(var i=0;i<e.length;i++)for(var s=e[i],c=0;c<s.length;c++)if(go(t,s[c]))return!0;for(var p=0;p<t.length;p++)if(Ns(e,t[p]))return!0;for(var d=0;d<e.length;d++)if(Us(t,e[d]))return!0;return!1}function Mn(t,e,i){if(t.length>1){if(Us(t,e))return!0;for(var s=0;s<e.length;s++)if(pa(e[s],t,i))return!0}for(var c=0;c<t.length;c++)if(pa(t[c],e,i))return!0;return!1}function Us(t,e){if(t.length===0||e.length===0)return!1;for(var i=0;i<t.length-1;i++)for(var s=t[i],c=t[i+1],p=0;p<e.length-1;p++)if(ps(s,c,e[p],e[p+1]))return!0;return!1}function ps(t,e,i,s){return Ei(t,i,s)!==Ei(e,i,s)&&Ei(t,e,i)!==Ei(t,e,s)}function pa(t,e,i){var s=i*i;if(e.length===1)return t.distSqr(e[0])<s;for(var c=1;c<e.length;c++)if(fs(t,e[c-1],e[c])<s)return!0;return!1}function fs(t,e,i){var s=e.distSqr(i);if(s===0)return t.distSqr(e);var c=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/s;return t.distSqr(c<0?e:c>1?i:i.sub(e)._mult(c)._add(e))}function Ns(t,e){for(var i,s,c,p=!1,d=0;d<t.length;d++)for(var v=0,T=(i=t[d]).length-1;v<i.length;T=v++)(s=i[v]).y>e.y!=(c=i[T]).y>e.y&&e.x<(c.x-s.x)*(e.y-s.y)/(c.y-s.y)+s.x&&(p=!p);return p}function go(t,e){for(var i=!1,s=0,c=t.length-1;s<t.length;c=s++){var p=t[s],d=t[c];p.y>e.y!=d.y>e.y&&e.x<(d.x-p.x)*(e.y-p.y)/(d.y-p.y)+p.x&&(i=!i)}return i}function Zs(t,e,i){var s=i[0],c=i[2];if(t.x<s.x&&e.x<s.x||t.x>c.x&&e.x>c.x||t.y<s.y&&e.y<s.y||t.y>c.y&&e.y>c.y)return!1;var p=Ei(t,e,i[0]);return p!==Ei(t,e,i[1])||p!==Ei(t,e,i[2])||p!==Ei(t,e,i[3])}function vo(t,e,i){var s=e.paint.get(t).value;return s.kind==="constant"?s.value:i.programConfigurations.get(e.id).getMaxValue(t)}function nr(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Uo(t,e,i,s,c){if(!e[0]&&!e[1])return t;var p=Vt.convert(e)._mult(c);i==="viewport"&&p._rotate(-s);for(var d=[],v=0;v<t.length;v++)d.push(t[v].sub(p));return d}Zr.prototype.populate=function(t,e,i){var s=this.layers[0],c=[],p=null;s.type==="circle"&&(p=s.layout.get("circle-sort-key"));for(var d=0,v=t;d<v.length;d+=1){var T=v[d],P=T.feature,A=T.id,z=T.index,B=T.sourceLayerIndex,F=this.layers[0]._featureFilter.needGeometry,H=Mi(P,F);if(this.layers[0]._featureFilter.filter(new xt(this.zoom),H,i)){var X=p?p.evaluate(H,{},i):void 0,et={id:A,properties:P.properties,type:P.type,sourceLayerIndex:B,index:z,geometry:F?H.geometry:Pi(P),patterns:{},sortKey:X};c.push(et)}}p&&c.sort(function(Dt,$t){return Dt.sortKey-$t.sortKey});for(var $=0,lt=c;$<lt.length;$+=1){var ct=lt[$],ft=ct.geometry,mt=ct.index,Tt=ct.sourceLayerIndex,Lt=t[mt].feature;this.addFeature(ct,ft,mt,i),e.featureIndex.insert(Lt,ft,mt,Tt,this.index)}},Zr.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},Zr.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Zr.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Zr.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,U),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Zr.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Zr.prototype.addFeature=function(t,e,i,s){for(var c=0,p=e;c<p.length;c+=1)for(var d=0,v=p[c];d<v.length;d+=1){var T=v[d],P=T.x,A=T.y;if(!(P<0||P>=8192||A<0||A>=8192)){var z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),B=z.vertexLength;mn(this.layoutVertexArray,P,A,-1,-1),mn(this.layoutVertexArray,P,A,1,-1),mn(this.layoutVertexArray,P,A,1,1),mn(this.layoutVertexArray,P,A,-1,1),this.indexArray.emplaceBack(B,B+1,B+2),this.indexArray.emplaceBack(B,B+3,B+2),z.vertexLength+=4,z.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,{},s)},jt("CircleBucket",Zr,{omit:["layers"]});var fa=new Xi({"circle-sort-key":new Xt(V.layout_circle["circle-sort-key"])}),Ba={paint:new Xi({"circle-radius":new Xt(V.paint_circle["circle-radius"]),"circle-color":new Xt(V.paint_circle["circle-color"]),"circle-blur":new Xt(V.paint_circle["circle-blur"]),"circle-opacity":new Xt(V.paint_circle["circle-opacity"]),"circle-translate":new Qt(V.paint_circle["circle-translate"]),"circle-translate-anchor":new Qt(V.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Qt(V.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Qt(V.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Xt(V.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Xt(V.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Xt(V.paint_circle["circle-stroke-opacity"])}),layout:fa},Ge=typeof Float32Array!="undefined"?Float32Array:Array;function bn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function rn(t,e,i){var s=e[0],c=e[1],p=e[2],d=e[3],v=e[4],T=e[5],P=e[6],A=e[7],z=e[8],B=e[9],F=e[10],H=e[11],X=e[12],et=e[13],$=e[14],lt=e[15],ct=i[0],ft=i[1],mt=i[2],Tt=i[3];return t[0]=ct*s+ft*v+mt*z+Tt*X,t[1]=ct*c+ft*T+mt*B+Tt*et,t[2]=ct*p+ft*P+mt*F+Tt*$,t[3]=ct*d+ft*A+mt*H+Tt*lt,t[4]=(ct=i[4])*s+(ft=i[5])*v+(mt=i[6])*z+(Tt=i[7])*X,t[5]=ct*c+ft*T+mt*B+Tt*et,t[6]=ct*p+ft*P+mt*F+Tt*$,t[7]=ct*d+ft*A+mt*H+Tt*lt,t[8]=(ct=i[8])*s+(ft=i[9])*v+(mt=i[10])*z+(Tt=i[11])*X,t[9]=ct*c+ft*T+mt*B+Tt*et,t[10]=ct*p+ft*P+mt*F+Tt*$,t[11]=ct*d+ft*A+mt*H+Tt*lt,t[12]=(ct=i[12])*s+(ft=i[13])*v+(mt=i[14])*z+(Tt=i[15])*X,t[13]=ct*c+ft*T+mt*B+Tt*et,t[14]=ct*p+ft*P+mt*F+Tt*$,t[15]=ct*d+ft*A+mt*H+Tt*lt,t}Math.hypot||(Math.hypot=function(){for(var t=arguments,e=0,i=arguments.length;i--;)e+=t[i]*t[i];return Math.sqrt(e)});var Ra,gh=rn;function pl(t,e,i){var s=e[0],c=e[1],p=e[2],d=e[3];return t[0]=i[0]*s+i[4]*c+i[8]*p+i[12]*d,t[1]=i[1]*s+i[5]*c+i[9]*p+i[13]*d,t[2]=i[2]*s+i[6]*c+i[10]*p+i[14]*d,t[3]=i[3]*s+i[7]*c+i[11]*p+i[15]*d,t}Ra=new Ge(3),Ge!=Float32Array&&(Ra[0]=0,Ra[1]=0,Ra[2]=0),function(){var t=new Ge(4);Ge!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0)}();var vh=(function(){var t=new Ge(2);Ge!=Float32Array&&(t[0]=0,t[1]=0)}(),function(t){function e(i){t.call(this,i,Ba)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(i){return new Zr(i)},e.prototype.queryRadius=function(i){var s=i;return vo("circle-radius",this,s)+vo("circle-stroke-width",this,s)+nr(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(i,s,c,p,d,v,T,P){for(var A=Uo(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),v.angle,T),z=this.paint.get("circle-radius").evaluate(s,c)+this.paint.get("circle-stroke-width").evaluate(s,c),B=this.paint.get("circle-pitch-alignment")==="map",F=B?A:function(Lt,Dt){return Lt.map(function($t){return Vs($t,Dt)})}(A,P),H=B?z*T:z,X=0,et=p;X<et.length;X+=1)for(var $=0,lt=et[X];$<lt.length;$+=1){var ct=lt[$],ft=B?ct:Vs(ct,P),mt=H,Tt=pl([],[ct.x,ct.y,0,1],P);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?mt*=Tt[3]/v.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(mt*=v.cameraToCenterDistance/Tt[3]),en(F,ft,mt))return!0}return!1},e}(ii));function Vs(t,e){var i=pl([],[t.x,t.y,0,1],e);return new Vt(i[0]/i[3],i[1]/i[3])}var Au=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(Zr);function ds(t,e,i,s){var c=e.width,p=e.height;if(s){if(s instanceof Uint8ClampedArray)s=new Uint8Array(s.buffer);else if(s.length!==c*p*i)throw new RangeError("mismatched image size")}else s=new Uint8Array(c*p*i);return t.width=c,t.height=p,t.data=s,t}function fl(t,e,i){var s=e.width,c=e.height;if(s!==t.width||c!==t.height){var p=ds({},{width:s,height:c},i);xh(t,p,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,s),height:Math.min(t.height,c)},i),t.width=s,t.height=c,t.data=p.data}}function xh(t,e,i,s,c,p){if(c.width===0||c.height===0)return e;if(c.width>t.width||c.height>t.height||i.x>t.width-c.width||i.y>t.height-c.height)throw new RangeError("out of range source coordinates for image copy");if(c.width>e.width||c.height>e.height||s.x>e.width-c.width||s.y>e.height-c.height)throw new RangeError("out of range destination coordinates for image copy");for(var d=t.data,v=e.data,T=0;T<c.height;T++)for(var P=((i.y+T)*t.width+i.x)*p,A=((s.y+T)*e.width+s.x)*p,z=0;z<c.width*p;z++)v[A+z]=d[P+z];return e}jt("HeatmapBucket",Au,{omit:["layers"]});var qs=function(t,e){ds(this,t,1,e)};qs.prototype.resize=function(t){fl(this,t,1)},qs.prototype.clone=function(){return new qs({width:this.width,height:this.height},new Uint8Array(this.data))},qs.copy=function(t,e,i,s,c){xh(t,e,i,s,c,1)};var _n=function(t,e){ds(this,t,4,e)};_n.prototype.resize=function(t){fl(this,t,4)},_n.prototype.replace=function(t,e){e?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t},_n.prototype.clone=function(){return new _n({width:this.width,height:this.height},new Uint8Array(this.data))},_n.copy=function(t,e,i,s,c){xh(t,e,i,s,c,4)},jt("AlphaImage",qs),jt("RGBAImage",_n);var pf={paint:new Xi({"heatmap-radius":new Xt(V.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Xt(V.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Qt(V.paint_heatmap["heatmap-intensity"]),"heatmap-color":new xn(V.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Qt(V.paint_heatmap["heatmap-opacity"])})};function mc(t){var e={},i=t.resolution||256,s=t.clips?t.clips.length:1,c=t.image||new _n({width:i,height:s}),p=function(H,X,et){e[t.evaluationKey]=et;var $=t.expression.evaluate(e);c.data[H+X+0]=Math.floor(255*$.r/$.a),c.data[H+X+1]=Math.floor(255*$.g/$.a),c.data[H+X+2]=Math.floor(255*$.b/$.a),c.data[H+X+3]=Math.floor(255*$.a)};if(t.clips)for(var d=0,v=0;d<s;++d,v+=4*i)for(var T=0,P=0;T<i;T++,P+=4){var A=T/(i-1),z=t.clips[d];p(v,P,z.start*(1-A)+z.end*A)}else for(var B=0,F=0;B<i;B++,F+=4)p(0,F,B/(i-1));return c}var ff=function(t){function e(i){t.call(this,i,pf),this._updateColorRamp()}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(i){return new Au(i)},e.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="heatmap-color"&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){this.colorRamp=mc({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},e}(ii),df={paint:new Xi({"hillshade-illumination-direction":new Qt(V.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Qt(V.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Qt(V.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Qt(V.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Qt(V.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Qt(V.paint_hillshade["hillshade-accent-color"])})},mf=function(t){function e(i){t.call(this,i,df)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},e}(ii),_f=Ki([{name:"a_pos",components:2,type:"Int16"}],4).members,bh=Cu,yf=Cu;function Cu(t,e,i){i=i||2;var s,c,p,d,v,T,P,A=e&&e.length,z=A?e[0]*i:t.length,B=_c(t,0,z,i,!0),F=[];if(!B||B.next===B.prev)return F;if(A&&(B=function(X,et,$,lt){var ct,ft,mt,Tt=[];for(ct=0,ft=et.length;ct<ft;ct++)(mt=_c(X,et[ct]*lt,ct<ft-1?et[ct+1]*lt:X.length,lt,!1))===mt.next&&(mt.steiner=!0),Tt.push(Pf(mt));for(Tt.sort(wf),ct=0;ct<Tt.length;ct++)Tf(Tt[ct],$),$=ms($,$.next);return $}(t,e,B,i)),t.length>80*i){s=p=t[0],c=d=t[1];for(var H=i;H<z;H+=i)(v=t[H])<s&&(s=v),(T=t[H+1])<c&&(c=T),v>p&&(p=v),T>d&&(d=T);P=(P=Math.max(p-s,d-c))!==0?1/P:0}return Kl(B,F,i,s,c,P),F}function _c(t,e,i,s,c){var p,d;if(c===Sh(t,e,i,s)>0)for(p=e;p<i;p+=s)d=vc(p,t[p],t[p+1],d);else for(p=i-s;p>=e;p-=s)d=vc(p,t[p],t[p+1],d);return d&&Lu(d,d.next)&&(Yl(d),d=d.next),d}function ms(t,e){if(!t)return t;e||(e=t);var i,s=t;do if(i=!1,s.steiner||!Lu(s,s.next)&&Ji(s.prev,s,s.next)!==0)s=s.next;else{if(Yl(s),(s=e=s.prev)===s.next)break;i=!0}while(i||s!==e);return e}function Kl(t,e,i,s,c,p,d){if(t){!d&&p&&function(A,z,B,F){var H=A;do H.z===null&&(H.z=wh(H.x,H.y,z,B,F)),H.prevZ=H.prev,H.nextZ=H.next,H=H.next;while(H!==A);H.prevZ.nextZ=null,H.prevZ=null,function(X){var et,$,lt,ct,ft,mt,Tt,Lt,Dt=1;do{for($=X,X=null,ft=null,mt=0;$;){for(mt++,lt=$,Tt=0,et=0;et<Dt&&(Tt++,lt=lt.nextZ);et++);for(Lt=Dt;Tt>0||Lt>0&&lt;)Tt!==0&&(Lt===0||!lt||$.z<=lt.z)?(ct=$,$=$.nextZ,Tt--):(ct=lt,lt=lt.nextZ,Lt--),ft?ft.nextZ=ct:X=ct,ct.prevZ=ft,ft=ct;$=lt}ft.nextZ=null,Dt*=2}while(mt>1)}(H)}(t,s,c,p);for(var v,T,P=t;t.prev!==t.next;)if(v=t.prev,T=t.next,p?vf(t,s,c,p):gf(t))e.push(v.i/i),e.push(t.i/i),e.push(T.i/i),Yl(t),t=T.next,P=T.next;else if((t=T)===P){d?d===1?Kl(t=xf(ms(t),e,i),e,i,s,c,p,2):d===2&&bf(t,e,i,s,c,p):Kl(ms(t),e,i,s,c,p,1);break}}}function gf(t){var e=t.prev,i=t,s=t.next;if(Ji(e,i,s)>=0)return!1;for(var c=t.next.next;c!==t.prev;){if(dl(e.x,e.y,i.x,i.y,s.x,s.y,c.x,c.y)&&Ji(c.prev,c,c.next)>=0)return!1;c=c.next}return!0}function vf(t,e,i,s){var c=t.prev,p=t,d=t.next;if(Ji(c,p,d)>=0)return!1;for(var v=c.x>p.x?c.x>d.x?c.x:d.x:p.x>d.x?p.x:d.x,T=c.y>p.y?c.y>d.y?c.y:d.y:p.y>d.y?p.y:d.y,P=wh(c.x<p.x?c.x<d.x?c.x:d.x:p.x<d.x?p.x:d.x,c.y<p.y?c.y<d.y?c.y:d.y:p.y<d.y?p.y:d.y,e,i,s),A=wh(v,T,e,i,s),z=t.prevZ,B=t.nextZ;z&&z.z>=P&&B&&B.z<=A;){if(z!==t.prev&&z!==t.next&&dl(c.x,c.y,p.x,p.y,d.x,d.y,z.x,z.y)&&Ji(z.prev,z,z.next)>=0||(z=z.prevZ,B!==t.prev&&B!==t.next&&dl(c.x,c.y,p.x,p.y,d.x,d.y,B.x,B.y)&&Ji(B.prev,B,B.next)>=0))return!1;B=B.nextZ}for(;z&&z.z>=P;){if(z!==t.prev&&z!==t.next&&dl(c.x,c.y,p.x,p.y,d.x,d.y,z.x,z.y)&&Ji(z.prev,z,z.next)>=0)return!1;z=z.prevZ}for(;B&&B.z<=A;){if(B!==t.prev&&B!==t.next&&dl(c.x,c.y,p.x,p.y,d.x,d.y,B.x,B.y)&&Ji(B.prev,B,B.next)>=0)return!1;B=B.nextZ}return!0}function xf(t,e,i){var s=t;do{var c=s.prev,p=s.next.next;!Lu(c,p)&&yc(c,s,s.next,p)&&Jl(c,p)&&Jl(p,c)&&(e.push(c.i/i),e.push(s.i/i),e.push(p.i/i),Yl(s),Yl(s.next),s=t=p),s=s.next}while(s!==t);return ms(s)}function bf(t,e,i,s,c,p){var d=t;do{for(var v=d.next.next;v!==d.prev;){if(d.i!==v.i&&If(d,v)){var T=gc(d,v);return d=ms(d,d.next),T=ms(T,T.next),Kl(d,e,i,s,c,p),void Kl(T,e,i,s,c,p)}v=v.next}d=d.next}while(d!==t)}function wf(t,e){return t.x-e.x}function Tf(t,e){if(e=function(s,c){var p,d=c,v=s.x,T=s.y,P=-1/0;do{if(T<=d.y&&T>=d.next.y&&d.next.y!==d.y){var A=d.x+(T-d.y)*(d.next.x-d.x)/(d.next.y-d.y);if(A<=v&&A>P){if(P=A,A===v){if(T===d.y)return d;if(T===d.next.y)return d.next}p=d.x<d.next.x?d:d.next}}d=d.next}while(d!==c);if(!p)return null;if(v===P)return p;var z,B=p,F=p.x,H=p.y,X=1/0;d=p;do v>=d.x&&d.x>=F&&v!==d.x&&dl(T<H?v:P,T,F,H,T<H?P:v,T,d.x,d.y)&&(z=Math.abs(T-d.y)/(v-d.x),Jl(d,s)&&(z<X||z===X&&(d.x>p.x||d.x===p.x&&Sf(p,d)))&&(p=d,X=z)),d=d.next;while(d!==B);return p}(t,e)){var i=gc(e,t);ms(e,e.next),ms(i,i.next)}}function Sf(t,e){return Ji(t.prev,t,e.prev)<0&&Ji(e.next,t,t.next)<0}function wh(t,e,i,s,c){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*c)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)*c)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Pf(t){var e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t);return i}function dl(t,e,i,s,c,p,d,v){return(c-d)*(e-v)-(t-d)*(p-v)>=0&&(t-d)*(s-v)-(i-d)*(e-v)>=0&&(i-d)*(p-v)-(c-d)*(s-v)>=0}function If(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(i,s){var c=i;do{if(c.i!==i.i&&c.next.i!==i.i&&c.i!==s.i&&c.next.i!==s.i&&yc(c,c.next,i,s))return!0;c=c.next}while(c!==i);return!1}(t,e)&&(Jl(t,e)&&Jl(e,t)&&function(i,s){var c=i,p=!1,d=(i.x+s.x)/2,v=(i.y+s.y)/2;do c.y>v!=c.next.y>v&&c.next.y!==c.y&&d<(c.next.x-c.x)*(v-c.y)/(c.next.y-c.y)+c.x&&(p=!p),c=c.next;while(c!==i);return p}(t,e)&&(Ji(t.prev,t,e.prev)||Ji(t,e.prev,e))||Lu(t,e)&&Ji(t.prev,t,t.next)>0&&Ji(e.prev,e,e.next)>0)}function Ji(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Lu(t,e){return t.x===e.x&&t.y===e.y}function yc(t,e,i,s){var c=ku(Ji(t,e,i)),p=ku(Ji(t,e,s)),d=ku(Ji(i,s,t)),v=ku(Ji(i,s,e));return c!==p&&d!==v||!(c!==0||!zu(t,i,e))||!(p!==0||!zu(t,s,e))||!(d!==0||!zu(i,t,s))||!(v!==0||!zu(i,e,s))}function zu(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function ku(t){return t>0?1:t<0?-1:0}function Jl(t,e){return Ji(t.prev,t,t.next)<0?Ji(t,e,t.next)>=0&&Ji(t,t.prev,e)>=0:Ji(t,e,t.prev)<0||Ji(t,t.next,e)<0}function gc(t,e){var i=new Th(t.i,t.x,t.y),s=new Th(e.i,e.x,e.y),c=t.next,p=e.prev;return t.next=e,e.prev=t,i.next=c,c.prev=i,s.next=i,i.prev=s,p.next=s,s.prev=p,s}function vc(t,e,i,s){var c=new Th(t,e,i);return s?(c.next=s.next,c.prev=s,s.next.prev=c,s.next=c):(c.prev=c,c.next=c),c}function Yl(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Th(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Sh(t,e,i,s){for(var c=0,p=e,d=i-s;p<i;p+=s)c+=(t[d]-t[p])*(t[p+1]+t[d+1]),d=p;return c}function Ef(t,e,i,s,c){(function p(d,v,T,P,A){for(;P>T;){if(P-T>600){var z=P-T+1,B=v-T+1,F=Math.log(z),H=.5*Math.exp(2*F/3),X=.5*Math.sqrt(F*H*(z-H)/z)*(B-z/2<0?-1:1);p(d,v,Math.max(T,Math.floor(v-B*H/z+X)),Math.min(P,Math.floor(v+(z-B)*H/z+X)),A)}var et=d[v],$=T,lt=P;for($l(d,T,v),A(d[P],et)>0&&$l(d,T,P);$<lt;){for($l(d,$,lt),$++,lt--;A(d[$],et)<0;)$++;for(;A(d[lt],et)>0;)lt--}A(d[T],et)===0?$l(d,T,lt):$l(d,++lt,P),lt<=v&&(T=lt+1),v<=lt&&(P=lt-1)}})(t,e,i||0,s||t.length-1,c||Af)}function $l(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}function Af(t,e){return t<e?-1:t>e?1:0}function Ph(t,e){var i=t.length;if(i<=1)return[t];for(var s,c,p=[],d=0;d<i;d++){var v=ja(t[d]);v!==0&&(t[d].area=Math.abs(v),c===void 0&&(c=v<0),c===v<0?(s&&p.push(s),s=[t[d]]):s.push(t[d]))}if(s&&p.push(s),e>1)for(var T=0;T<p.length;T++)p[T].length<=e||(Ef(p[T],e,1,p[T].length-1,Cf),p[T]=p[T].slice(0,e));return p}function Cf(t,e){return e.area-t.area}function Ih(t,e,i){for(var s=i.patternDependencies,c=!1,p=0,d=e;p<d.length;p+=1){var v=d[p].paint.get(t+"-pattern");v.isConstant()||(c=!0);var T=v.constantOr(null);T&&(c=!0,s[T.to]=!0,s[T.from]=!0)}return c}function Eh(t,e,i,s,c){for(var p=c.patternDependencies,d=0,v=e;d<v.length;d+=1){var T=v[d],P=T.paint.get(t+"-pattern").value;if(P.kind!=="constant"){var A=P.evaluate({zoom:s-1},i,{},c.availableImages),z=P.evaluate({zoom:s},i,{},c.availableImages),B=P.evaluate({zoom:s+1},i,{},c.availableImages);z=z&&z.name?z.name:z,B=B&&B.name?B.name:B,p[A=A&&A.name?A.name:A]=!0,p[z]=!0,p[B]=!0,i.patterns[T.id]={min:A,mid:z,max:B}}}return i}Cu.deviation=function(t,e,i,s){var c=e&&e.length,p=Math.abs(Sh(t,0,c?e[0]*i:t.length,i));if(c)for(var d=0,v=e.length;d<v;d++)p-=Math.abs(Sh(t,e[d]*i,d<v-1?e[d+1]*i:t.length,i));var T=0;for(d=0;d<s.length;d+=3){var P=s[d]*i,A=s[d+1]*i,z=s[d+2]*i;T+=Math.abs((t[P]-t[z])*(t[A+1]-t[P+1])-(t[P]-t[A])*(t[z+1]-t[P+1]))}return p===0&&T===0?0:Math.abs((T-p)/p)},Cu.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},s=0,c=0;c<t.length;c++){for(var p=0;p<t[c].length;p++)for(var d=0;d<e;d++)i.vertices.push(t[c][p][d]);c>0&&i.holes.push(s+=t[c-1].length)}return i},bh.default=yf;var No=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _o,this.indexArray=new la,this.indexArray2=new Fs,this.programConfigurations=new ae(t.layers,t.zoom),this.segments=new Z,this.segments2=new Z,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};No.prototype.populate=function(t,e,i){this.hasPattern=Ih("fill",this.layers,e);for(var s=this.layers[0].layout.get("fill-sort-key"),c=[],p=0,d=t;p<d.length;p+=1){var v=d[p],T=v.feature,P=v.id,A=v.index,z=v.sourceLayerIndex,B=this.layers[0]._featureFilter.needGeometry,F=Mi(T,B);if(this.layers[0]._featureFilter.filter(new xt(this.zoom),F,i)){var H=s?s.evaluate(F,{},i,e.availableImages):void 0,X={id:P,properties:T.properties,type:T.type,sourceLayerIndex:z,index:A,geometry:B?F.geometry:Pi(T),patterns:{},sortKey:H};c.push(X)}}s&&c.sort(function(Lt,Dt){return Lt.sortKey-Dt.sortKey});for(var et=0,$=c;et<$.length;et+=1){var lt=$[et],ct=lt.geometry,ft=lt.index,mt=lt.sourceLayerIndex;if(this.hasPattern){var Tt=Eh("fill",this.layers,lt,this.zoom,e);this.patternFeatures.push(Tt)}else this.addFeature(lt,ct,ft,i,{});e.featureIndex.insert(t[ft].feature,ct,ft,mt,this.index)}},No.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},No.prototype.addFeatures=function(t,e,i){for(var s=0,c=this.patternFeatures;s<c.length;s+=1){var p=c[s];this.addFeature(p,p.geometry,p.index,e,i)}},No.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},No.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},No.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,_f),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0},No.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},No.prototype.addFeature=function(t,e,i,s,c){for(var p=0,d=Ph(e,500);p<d.length;p+=1){for(var v=d[p],T=0,P=0,A=v;P<A.length;P+=1)T+=A[P].length;for(var z=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),B=z.vertexLength,F=[],H=[],X=0,et=v;X<et.length;X+=1){var $=et[X];if($.length!==0){$!==v[0]&&H.push(F.length/2);var lt=this.segments2.prepareSegment($.length,this.layoutVertexArray,this.indexArray2),ct=lt.vertexLength;this.layoutVertexArray.emplaceBack($[0].x,$[0].y),this.indexArray2.emplaceBack(ct+$.length-1,ct),F.push($[0].x),F.push($[0].y);for(var ft=1;ft<$.length;ft++)this.layoutVertexArray.emplaceBack($[ft].x,$[ft].y),this.indexArray2.emplaceBack(ct+ft-1,ct+ft),F.push($[ft].x),F.push($[ft].y);lt.vertexLength+=$.length,lt.primitiveLength+=$.length}}for(var mt=bh(F,H),Tt=0;Tt<mt.length;Tt+=3)this.indexArray.emplaceBack(B+mt[Tt],B+mt[Tt+1],B+mt[Tt+2]);z.vertexLength+=T,z.primitiveLength+=mt.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,c,s)},jt("FillBucket",No,{omit:["layers","patternFeatures"]});var Lf=new Xi({"fill-sort-key":new Xt(V.layout_fill["fill-sort-key"])}),zf={paint:new Xi({"fill-antialias":new Qt(V.paint_fill["fill-antialias"]),"fill-opacity":new Xt(V.paint_fill["fill-opacity"]),"fill-color":new Xt(V.paint_fill["fill-color"]),"fill-outline-color":new Xt(V.paint_fill["fill-outline-color"]),"fill-translate":new Qt(V.paint_fill["fill-translate"]),"fill-translate-anchor":new Qt(V.paint_fill["fill-translate-anchor"]),"fill-pattern":new as(V.paint_fill["fill-pattern"])}),layout:Lf},kf=function(t){function e(i){t.call(this,i,zf)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(i,s){t.prototype.recalculate.call(this,i,s);var c=this.paint._values["fill-outline-color"];c.value.kind==="constant"&&c.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(i){return new No(i)},e.prototype.queryRadius=function(){return nr(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(i,s,c,p,d,v,T){return Wn(Uo(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),v.angle,T),p)},e.prototype.isTileClipped=function(){return!0},e}(ii),Mf=Ki([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,xc=ml;function ml(t,e,i,s,c){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=s,this._values=c,t.readFields(Df,this,e)}function Df(t,e,i){t==1?e.id=i.readVarint():t==2?function(s,c){for(var p=s.readVarint()+s.pos;s.pos<p;){var d=c._keys[s.readVarint()],v=c._values[s.readVarint()];c.properties[d]=v}}(i,e):t==3?e.type=i.readVarint():t==4&&(e._geometry=i.pos)}function Bf(t){for(var e,i,s=0,c=0,p=t.length,d=p-1;c<p;d=c++)s+=((i=t[d]).x-(e=t[c]).x)*(e.y+i.y);return s}ml.types=["Unknown","Point","LineString","Polygon"],ml.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,s=1,c=0,p=0,d=0,v=[];t.pos<i;){if(c<=0){var T=t.readVarint();s=7&T,c=T>>3}if(c--,s===1||s===2)p+=t.readSVarint(),d+=t.readSVarint(),s===1&&(e&&v.push(e),e=[]),e.push(new Vt(p,d));else{if(s!==7)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&v.push(e),v},ml.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,s=0,c=0,p=0,d=1/0,v=-1/0,T=1/0,P=-1/0;t.pos<e;){if(s<=0){var A=t.readVarint();i=7&A,s=A>>3}if(s--,i===1||i===2)(c+=t.readSVarint())<d&&(d=c),c>v&&(v=c),(p+=t.readSVarint())<T&&(T=p),p>P&&(P=p);else if(i!==7)throw new Error("unknown command "+i)}return[d,T,v,P]},ml.prototype.toGeoJSON=function(t,e,i){var s,c,p=this.extent*Math.pow(2,i),d=this.extent*t,v=this.extent*e,T=this.loadGeometry(),P=ml.types[this.type];function A(F){for(var H=0;H<F.length;H++){var X=F[H];F[H]=[360*(X.x+d)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(X.y+v)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(s=0;s<T.length;s++)z[s]=T[s][0];A(T=z);break;case 2:for(s=0;s<T.length;s++)A(T[s]);break;case 3:for(T=function(F){var H=F.length;if(H<=1)return[F];for(var X,et,$=[],lt=0;lt<H;lt++){var ct=Bf(F[lt]);ct!==0&&(et===void 0&&(et=ct<0),et===ct<0?(X&&$.push(X),X=[F[lt]]):X.push(F[lt]))}return X&&$.push(X),$}(T),s=0;s<T.length;s++)for(c=0;c<T[s].length;c++)A(T[s][c])}T.length===1?T=T[0]:P="Multi"+P;var B={type:"Feature",geometry:{type:P,coordinates:T},properties:this.properties};return"id"in this&&(B.id=this.id),B};var bc=wc;function wc(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Rf,this,e),this.length=this._features.length}function Rf(t,e,i){t===15?e.version=i.readVarint():t===1?e.name=i.readString():t===5?e.extent=i.readVarint():t===2?e._features.push(i.pos):t===3?e._keys.push(i.readString()):t===4&&e._values.push(function(s){for(var c=null,p=s.readVarint()+s.pos;s.pos<p;){var d=s.readVarint()>>3;c=d===1?s.readString():d===2?s.readFloat():d===3?s.readDouble():d===4?s.readVarint64():d===5?s.readVarint():d===6?s.readSVarint():d===7?s.readBoolean():null}return c}(i))}function Of(t,e,i){if(t===3){var s=new bc(i,i.readVarint()+i.pos);s.length&&(e[s.name]=s)}}wc.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new xc(this._pbf,e,this.extent,this._keys,this._values)};var _l={VectorTile:function(t,e){this.layers=t.readFields(Of,{},e)},VectorTileFeature:xc,VectorTileLayer:bc},Ff=_l.VectorTileFeature.types,Ah=Math.pow(2,13);function Ql(t,e,i,s,c,p,d,v){t.emplaceBack(e,i,2*Math.floor(s*Ah)+d,c*Ah*2,p*Ah*2,Math.round(v))}var Zo=function(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(e){return e.id}),this.index=t.index,this.hasPattern=!1,this.layoutVertexArray=new Fo,this.indexArray=new la,this.programConfigurations=new ae(t.layers,t.zoom),this.segments=new Z,this.stateDependentLayerIds=this.layers.filter(function(e){return e.isStateDependent()}).map(function(e){return e.id})};function Uf(t,e){return t.x===e.x&&(t.x<0||t.x>8192)||t.y===e.y&&(t.y<0||t.y>8192)}Zo.prototype.populate=function(t,e,i){this.features=[],this.hasPattern=Ih("fill-extrusion",this.layers,e);for(var s=0,c=t;s<c.length;s+=1){var p=c[s],d=p.feature,v=p.id,T=p.index,P=p.sourceLayerIndex,A=this.layers[0]._featureFilter.needGeometry,z=Mi(d,A);if(this.layers[0]._featureFilter.filter(new xt(this.zoom),z,i)){var B={id:v,sourceLayerIndex:P,index:T,geometry:A?z.geometry:Pi(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(Eh("fill-extrusion",this.layers,B,this.zoom,e)):this.addFeature(B,B.geometry,T,i,{}),e.featureIndex.insert(d,B.geometry,T,P,this.index,!0)}}},Zo.prototype.addFeatures=function(t,e,i){for(var s=0,c=this.features;s<c.length;s+=1){var p=c[s];this.addFeature(p,p.geometry,p.index,e,i)}},Zo.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},Zo.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Zo.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Zo.prototype.upload=function(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Mf),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},Zo.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Zo.prototype.addFeature=function(t,e,i,s,c){for(var p=0,d=Ph(e,500);p<d.length;p+=1){for(var v=d[p],T=0,P=0,A=v;P<A.length;P+=1)T+=A[P].length;for(var z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),B=0,F=v;B<F.length;B+=1){var H=F[B];if(H.length!==0&&!((Pe=H).every(function(_e){return _e.x<0})||Pe.every(function(_e){return _e.x>8192})||Pe.every(function(_e){return _e.y<0})||Pe.every(function(_e){return _e.y>8192})))for(var X=0,et=0;et<H.length;et++){var $=H[et];if(et>=1){var lt=H[et-1];if(!Uf($,lt)){z.vertexLength+4>Z.MAX_VERTEX_ARRAY_LENGTH&&(z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var ct=$.sub(lt)._perp()._unit(),ft=lt.dist($);X+ft>32768&&(X=0),Ql(this.layoutVertexArray,$.x,$.y,ct.x,ct.y,0,0,X),Ql(this.layoutVertexArray,$.x,$.y,ct.x,ct.y,0,1,X),Ql(this.layoutVertexArray,lt.x,lt.y,ct.x,ct.y,0,0,X+=ft),Ql(this.layoutVertexArray,lt.x,lt.y,ct.x,ct.y,0,1,X);var mt=z.vertexLength;this.indexArray.emplaceBack(mt,mt+2,mt+1),this.indexArray.emplaceBack(mt+1,mt+2,mt+3),z.vertexLength+=4,z.primitiveLength+=2}}}}if(z.vertexLength+T>Z.MAX_VERTEX_ARRAY_LENGTH&&(z=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray)),Ff[t.type]==="Polygon"){for(var Tt=[],Lt=[],Dt=z.vertexLength,$t=0,Ut=v;$t<Ut.length;$t+=1){var ee=Ut[$t];if(ee.length!==0){ee!==v[0]&&Lt.push(Tt.length/2);for(var Nt=0;Nt<ee.length;Nt++){var xe=ee[Nt];Ql(this.layoutVertexArray,xe.x,xe.y,0,0,1,1,0),Tt.push(xe.x),Tt.push(xe.y)}}}for(var le=bh(Tt,Lt),Jt=0;Jt<le.length;Jt+=3)this.indexArray.emplaceBack(Dt+le[Jt],Dt+le[Jt+2],Dt+le[Jt+1]);z.primitiveLength+=le.length/3,z.vertexLength+=T}}var Pe;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,c,s)},jt("FillExtrusionBucket",Zo,{omit:["layers","features"]});var Nf={paint:new Xi({"fill-extrusion-opacity":new Qt(V["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Xt(V["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Qt(V["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Qt(V["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new as(V["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Xt(V["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Xt(V["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Qt(V["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},Zf=function(t){function e(i){t.call(this,i,Nf)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.createBucket=function(i){return new Zo(i)},e.prototype.queryRadius=function(){return nr(this.paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(i,s,c,p,d,v,T,P){var A=Uo(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),v.angle,T),z=this.paint.get("fill-extrusion-height").evaluate(s,c),B=this.paint.get("fill-extrusion-base").evaluate(s,c),F=function(X,et,$,lt){for(var ct=[],ft=0,mt=X;ft<mt.length;ft+=1){var Tt=mt[ft],Lt=[Tt.x,Tt.y,0,1];pl(Lt,Lt,et),ct.push(new Vt(Lt[0]/Lt[3],Lt[1]/Lt[3]))}return ct}(A,P),H=function(X,et,$,lt){for(var ct=[],ft=[],mt=lt[8]*et,Tt=lt[9]*et,Lt=lt[10]*et,Dt=lt[11]*et,$t=lt[8]*$,Ut=lt[9]*$,ee=lt[10]*$,Nt=lt[11]*$,xe=0,le=X;xe<le.length;xe+=1){for(var Jt=[],Pe=[],_e=0,ze=le[xe];_e<ze.length;_e+=1){var re=ze[_e],Ne=re.x,di=re.y,Li=lt[0]*Ne+lt[4]*di+lt[12],Ii=lt[1]*Ne+lt[5]*di+lt[13],mi=lt[2]*Ne+lt[6]*di+lt[14],zi=lt[3]*Ne+lt[7]*di+lt[15],or=mi+Lt,ar=zi+Dt,qr=Li+$t,dr=Ii+Ut,jr=mi+ee,Di=zi+Nt,mr=new Vt((Li+mt)/ar,(Ii+Tt)/ar);mr.z=or/ar,Jt.push(mr);var Ae=new Vt(qr/Di,dr/Di);Ae.z=jr/Di,Pe.push(Ae)}ct.push(Jt),ft.push(Pe)}return[ct,ft]}(p,B,z,P);return function(X,et,$){var lt=1/0;Wn($,et)&&(lt=Tc($,et[0]));for(var ct=0;ct<et.length;ct++)for(var ft=et[ct],mt=X[ct],Tt=0;Tt<ft.length-1;Tt++){var Lt=ft[Tt],Dt=[Lt,ft[Tt+1],mt[Tt+1],mt[Tt],Lt];ca($,Dt)&&(lt=Math.min(lt,Tc($,Dt)))}return lt!==1/0&&lt}(H[0],H[1],F)},e}(ii);function tu(t,e){return t.x*e.x+t.y*e.y}function Tc(t,e){if(t.length===1){for(var i,s=0,c=e[s++];!i||c.equals(i);)if(!(i=e[s++]))return 1/0;for(;s<e.length;s++){var p=e[s],d=t[0],v=i.sub(c),T=p.sub(c),P=d.sub(c),A=tu(v,v),z=tu(v,T),B=tu(T,T),F=tu(P,v),H=tu(P,T),X=A*B-z*z,et=(B*F-z*H)/X,$=(A*H-z*F)/X,lt=c.z*(1-et-$)+i.z*et+p.z*$;if(isFinite(lt))return lt}return 1/0}for(var ct=1/0,ft=0,mt=e;ft<mt.length;ft+=1)ct=Math.min(ct,mt[ft].z);return ct}var Vf=Ki([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,qf=Ki([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,jf=_l.VectorTileFeature.types,Gf=Math.cos(Math.PI/180*37.5),Sc=Math.pow(2,14)/.5,nn=function(t){var e=this;this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(i){return i.id}),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(i){e.gradients[i.id]={}}),this.layoutVertexArray=new dn,this.layoutVertexArray2=new us,this.indexArray=new la,this.programConfigurations=new ae(t.layers,t.zoom),this.segments=new Z,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(i){return i.isStateDependent()}).map(function(i){return i.id})};nn.prototype.populate=function(t,e,i){this.hasPattern=Ih("line",this.layers,e);for(var s=this.layers[0].layout.get("line-sort-key"),c=[],p=0,d=t;p<d.length;p+=1){var v=d[p],T=v.feature,P=v.id,A=v.index,z=v.sourceLayerIndex,B=this.layers[0]._featureFilter.needGeometry,F=Mi(T,B);if(this.layers[0]._featureFilter.filter(new xt(this.zoom),F,i)){var H=s?s.evaluate(F,{},i):void 0,X={id:P,properties:T.properties,type:T.type,sourceLayerIndex:z,index:A,geometry:B?F.geometry:Pi(T),patterns:{},sortKey:H};c.push(X)}}s&&c.sort(function(Lt,Dt){return Lt.sortKey-Dt.sortKey});for(var et=0,$=c;et<$.length;et+=1){var lt=$[et],ct=lt.geometry,ft=lt.index,mt=lt.sourceLayerIndex;if(this.hasPattern){var Tt=Eh("line",this.layers,lt,this.zoom,e);this.patternFeatures.push(Tt)}else this.addFeature(lt,ct,ft,i,{});e.featureIndex.insert(t[ft].feature,ct,ft,mt,this.index)}},nn.prototype.update=function(t,e,i){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,e,this.stateDependentLayers,i)},nn.prototype.addFeatures=function(t,e,i){for(var s=0,c=this.patternFeatures;s<c.length;s+=1){var p=c[s];this.addFeature(p,p.geometry,p.index,e,i)}},nn.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},nn.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},nn.prototype.upload=function(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,qf)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Vf),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0},nn.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},nn.prototype.lineFeatureClips=function(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}},nn.prototype.addFeature=function(t,e,i,s,c){var p=this.layers[0].layout,d=p.get("line-join").evaluate(t,{}),v=p.get("line-cap"),T=p.get("line-miter-limit"),P=p.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(var A=0,z=e;A<z.length;A+=1)this.addLine(z[A],t,d,v,T,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,i,c,s)},nn.prototype.addLine=function(t,e,i,s,c,p){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var d=0;d<t.length-1;d++)this.totalDistance+=t[d].dist(t[d+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var v=jf[e.type]==="Polygon",T=t.length;T>=2&&t[T-1].equals(t[T-2]);)T--;for(var P=0;P<T-1&&t[P].equals(t[P+1]);)P++;if(!(T<(v?3:2))){i==="bevel"&&(c=1.05);var A,z=this.overscaling<=16?122880/(512*this.overscaling):0,B=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray),F=void 0,H=void 0,X=void 0,et=void 0;this.e1=this.e2=-1,v&&(et=t[P].sub(A=t[T-2])._unit()._perp());for(var $=P;$<T;$++)if(!(H=$===T-1?v?t[P+1]:void 0:t[$+1])||!t[$].equals(H)){et&&(X=et),A&&(F=A),A=t[$],et=H?H.sub(A)._unit()._perp():X;var lt=(X=X||et).add(et);lt.x===0&&lt.y===0||lt._unit();var ct=X.x*et.x+X.y*et.y,ft=lt.x*et.x+lt.y*et.y,mt=ft!==0?1/ft:1/0,Tt=2*Math.sqrt(2-2*ft),Lt=ft<Gf&&F&&H,Dt=X.x*et.y-X.y*et.x>0;if(Lt&&$>P){var $t=A.dist(F);if($t>2*z){var Ut=A.sub(A.sub(F)._mult(z/$t)._round());this.updateDistance(F,Ut),this.addCurrentVertex(Ut,X,0,0,B),F=Ut}}var ee=F&&H,Nt=ee?i:v?"butt":s;if(ee&&Nt==="round"&&(mt<p?Nt="miter":mt<=2&&(Nt="fakeround")),Nt==="miter"&&mt>c&&(Nt="bevel"),Nt==="bevel"&&(mt>2&&(Nt="flipbevel"),mt<c&&(Nt="miter")),F&&this.updateDistance(F,A),Nt==="miter")lt._mult(mt),this.addCurrentVertex(A,lt,0,0,B);else if(Nt==="flipbevel"){if(mt>100)lt=et.mult(-1);else{var xe=mt*X.add(et).mag()/X.sub(et).mag();lt._perp()._mult(xe*(Dt?-1:1))}this.addCurrentVertex(A,lt,0,0,B),this.addCurrentVertex(A,lt.mult(-1),0,0,B)}else if(Nt==="bevel"||Nt==="fakeround"){var le=-Math.sqrt(mt*mt-1),Jt=Dt?le:0,Pe=Dt?0:le;if(F&&this.addCurrentVertex(A,X,Jt,Pe,B),Nt==="fakeround")for(var _e=Math.round(180*Tt/Math.PI/20),ze=1;ze<_e;ze++){var re=ze/_e;if(re!==.5){var Ne=re-.5;re+=re*Ne*(re-1)*((1.0904+ct*(ct*(3.55645-1.43519*ct)-3.2452))*Ne*Ne+(.848013+ct*(.215638*ct-1.06021)))}var di=et.sub(X)._mult(re)._add(X)._unit()._mult(Dt?-1:1);this.addHalfVertex(A,di.x,di.y,!1,Dt,0,B)}H&&this.addCurrentVertex(A,et,-Jt,-Pe,B)}else if(Nt==="butt")this.addCurrentVertex(A,lt,0,0,B);else if(Nt==="square"){var Li=F?1:-1;this.addCurrentVertex(A,lt,Li,Li,B)}else Nt==="round"&&(F&&(this.addCurrentVertex(A,X,0,0,B),this.addCurrentVertex(A,X,1,1,B,!0)),H&&(this.addCurrentVertex(A,et,-1,-1,B,!0),this.addCurrentVertex(A,et,0,0,B)));if(Lt&&$<T-1){var Ii=A.dist(H);if(Ii>2*z){var mi=A.add(H.sub(A)._mult(z/Ii)._round());this.updateDistance(A,mi),this.addCurrentVertex(mi,et,0,0,B),A=mi}}}}},nn.prototype.addCurrentVertex=function(t,e,i,s,c,p){p===void 0&&(p=!1);var d=e.y*s-e.x,v=-e.y-e.x*s;this.addHalfVertex(t,e.x+e.y*i,e.y-e.x*i,p,!1,i,c),this.addHalfVertex(t,d,v,p,!0,-s,c),this.distance>Sc/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(t,e,i,s,c,p))},nn.prototype.addHalfVertex=function(t,e,i,s,c,p,d){var v=.5*(this.lineClips?this.scaledDistance*(Sc-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((t.x<<1)+(s?1:0),(t.y<<1)+(c?1:0),Math.round(63*e)+128,Math.round(63*i)+128,1+(p===0?0:p<0?-1:1)|(63&v)<<2,v>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var T=d.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,T),d.primitiveLength++),c?this.e2=T:this.e1=T},nn.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},nn.prototype.updateDistance=function(t,e){this.distance+=t.dist(e),this.updateScaledDistance()},jt("LineBucket",nn,{omit:["layers","patternFeatures"]});var Wf=new Xi({"line-cap":new Qt(V.layout_line["line-cap"]),"line-join":new Xt(V.layout_line["line-join"]),"line-miter-limit":new Qt(V.layout_line["line-miter-limit"]),"line-round-limit":new Qt(V.layout_line["line-round-limit"]),"line-sort-key":new Xt(V.layout_line["line-sort-key"])}),Pc={paint:new Xi({"line-opacity":new Xt(V.paint_line["line-opacity"]),"line-color":new Xt(V.paint_line["line-color"]),"line-translate":new Qt(V.paint_line["line-translate"]),"line-translate-anchor":new Qt(V.paint_line["line-translate-anchor"]),"line-width":new Xt(V.paint_line["line-width"]),"line-gap-width":new Xt(V.paint_line["line-gap-width"]),"line-offset":new Xt(V.paint_line["line-offset"]),"line-blur":new Xt(V.paint_line["line-blur"]),"line-dasharray":new cr(V.paint_line["line-dasharray"]),"line-pattern":new as(V.paint_line["line-pattern"]),"line-gradient":new xn(V.paint_line["line-gradient"])}),layout:Wf},Ic=new(function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(i,s){return s=new xt(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),t.prototype.possiblyEvaluate.call(this,i,s)},e.prototype.evaluate=function(i,s,c,p){return s=ki({},s,{zoom:Math.floor(s.zoom)}),t.prototype.evaluate.call(this,i,s,c,p)},e}(Xt))(Pc.paint.properties["line-width"].specification);Ic.useIntegerZoom=!0;var Hf=function(t){function e(i){t.call(this,i,Pc),this.gradientVersion=0}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof br,this.gradientVersion=(this.gradientVersion+1)%sr)},e.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},e.prototype.recalculate=function(i,s){t.prototype.recalculate.call(this,i,s),this.paint._values["line-floorwidth"]=Ic.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)},e.prototype.createBucket=function(i){return new nn(i)},e.prototype.queryRadius=function(i){var s=i,c=Ec(vo("line-width",this,s),vo("line-gap-width",this,s)),p=vo("line-offset",this,s);return c/2+Math.abs(p)+nr(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(i,s,c,p,d,v,T){var P=Uo(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),v.angle,T),A=T/2*Ec(this.paint.get("line-width").evaluate(s,c),this.paint.get("line-gap-width").evaluate(s,c)),z=this.paint.get("line-offset").evaluate(s,c);return z&&(p=function(B,F){for(var H=[],X=new Vt(0,0),et=0;et<B.length;et++){for(var $=B[et],lt=[],ct=0;ct<$.length;ct++){var ft=$[ct],mt=$[ct+1],Tt=ct===0?X:ft.sub($[ct-1])._unit()._perp(),Lt=ct===$.length-1?X:mt.sub(ft)._unit()._perp(),Dt=Tt._add(Lt)._unit();Dt._mult(1/(Dt.x*Lt.x+Dt.y*Lt.y)),lt.push(Dt._mult(F)._add(ft))}H.push(lt)}return H}(p,z*T)),function(B,F,H){for(var X=0;X<F.length;X++){var et=F[X];if(B.length>=3){for(var $=0;$<et.length;$++)if(go(B,et[$]))return!0}if(Mn(B,et,H))return!0}return!1}(P,p,A)},e.prototype.isTileClipped=function(){return!0},e}(ii);function Ec(t,e){return e>0?e+2*t:t}var Xf=Ki([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Kf=Ki([{name:"a_projected_pos",components:3,type:"Float32"}],4),Jf=(Ki([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Ki([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Ac=(Ki([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Ki([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Yf=Ki([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function $f(t,e,i){return t.sections.forEach(function(s){s.text=function(c,p,d){var v=p.layout.get("text-transform").evaluate(d,{});return v==="uppercase"?c=c.toLocaleUpperCase():v==="lowercase"&&(c=c.toLocaleLowerCase()),wt.applyArabicShaping&&(c=wt.applyArabicShaping(c)),c}(s.text,e,i)}),t}Ki([{name:"triangle",components:3,type:"Uint16"}]),Ki([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ki([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ki([{type:"Float32",name:"offsetX"}]),Ki([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var eu={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},Cc=function(t,e,i,s,c){var p,d,v=8*c-s-1,T=(1<<v)-1,P=T>>1,A=-7,z=i?c-1:0,B=i?-1:1,F=t[e+z];for(z+=B,p=F&(1<<-A)-1,F>>=-A,A+=v;A>0;p=256*p+t[e+z],z+=B,A-=8);for(d=p&(1<<-A)-1,p>>=-A,A+=s;A>0;d=256*d+t[e+z],z+=B,A-=8);if(p===0)p=1-P;else{if(p===T)return d?NaN:1/0*(F?-1:1);d+=Math.pow(2,s),p-=P}return(F?-1:1)*d*Math.pow(2,p-s)},Lc=function(t,e,i,s,c,p){var d,v,T,P=8*p-c-1,A=(1<<P)-1,z=A>>1,B=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=s?0:p-1,H=s?1:-1,X=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,d=A):(d=Math.floor(Math.log(e)/Math.LN2),e*(T=Math.pow(2,-d))<1&&(d--,T*=2),(e+=d+z>=1?B/T:B*Math.pow(2,1-z))*T>=2&&(d++,T/=2),d+z>=A?(v=0,d=A):d+z>=1?(v=(e*T-1)*Math.pow(2,c),d+=z):(v=e*Math.pow(2,z-1)*Math.pow(2,c),d=0));c>=8;t[i+F]=255&v,F+=H,v/=256,c-=8);for(d=d<<c|v,P+=c;P>0;t[i+F]=255&d,F+=H,d/=256,P-=8);t[i+F-H]|=128*X},Mu=si;function si(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}si.Varint=0,si.Fixed64=1,si.Bytes=2,si.Fixed32=5;var zc=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function Oa(t){return t.type===si.Bytes?t.readVarint()+t.pos:t.pos+1}function yl(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function kc(t,e,i){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(s);for(var c=i.pos-1;c>=t;c--)i.buf[c+s]=i.buf[c]}function Qf(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function td(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function ed(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function id(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function rd(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function nd(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function od(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function ad(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function sd(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function Du(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function gl(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function Mc(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function ld(t,e,i){t===1&&i.readMessage(ud,e)}function ud(t,e,i){if(t===3){var s=i.readMessage(hd,{}),c=s.width,p=s.height,d=s.left,v=s.top,T=s.advance;e.push({id:s.id,bitmap:new qs({width:c+6,height:p+6},s.bitmap),metrics:{width:c,height:p,left:d,top:v,advance:T}})}}function hd(t,e,i){t===1?e.id=i.readVarint():t===2?e.bitmap=i.readBytes():t===3?e.width=i.readVarint():t===4?e.height=i.readVarint():t===5?e.left=i.readSVarint():t===6?e.top=i.readSVarint():t===7&&(e.advance=i.readVarint())}function Dc(t){for(var e=0,i=0,s=0,c=t;s<c.length;s+=1){var p=c[s];e+=p.w*p.h,i=Math.max(i,p.w)}t.sort(function(X,et){return et.h-X.h});for(var d=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}],v=0,T=0,P=0,A=t;P<A.length;P+=1)for(var z=A[P],B=d.length-1;B>=0;B--){var F=d[B];if(!(z.w>F.w||z.h>F.h)){if(z.x=F.x,z.y=F.y,T=Math.max(T,z.y+z.h),v=Math.max(v,z.x+z.w),z.w===F.w&&z.h===F.h){var H=d.pop();B<d.length&&(d[B]=H)}else z.h===F.h?(F.x+=z.w,F.w-=z.w):z.w===F.w?(F.y+=z.h,F.h-=z.h):(d.push({x:F.x+z.w,y:F.y,w:F.w-z.w,h:z.h}),F.y+=z.h,F.h-=z.h);break}}return{w:v,h:T,fill:e/(v*T)||0}}si.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var s=this.readVarint(),c=s>>3,p=this.pos;this.type=7&s,t(c,e,this),this.pos===p&&this.skip(s)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Du(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Mc(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Du(this.buf,this.pos)+4294967296*Du(this.buf,this.pos+4);return this.pos+=8,t},readSFixed64:function(){var t=Du(this.buf,this.pos)+4294967296*Mc(this.buf,this.pos+4);return this.pos+=8,t},readFloat:function(){var t=Cc(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=Cc(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,s=this.buf;return e=127&(i=s[this.pos++]),i<128?e:(e|=(127&(i=s[this.pos++]))<<7,i<128?e:(e|=(127&(i=s[this.pos++]))<<14,i<128?e:(e|=(127&(i=s[this.pos++]))<<21,i<128?e:function(c,p,d){var v,T,P=d.buf;if(v=(112&(T=P[d.pos++]))>>4,T<128||(v|=(127&(T=P[d.pos++]))<<3,T<128)||(v|=(127&(T=P[d.pos++]))<<10,T<128)||(v|=(127&(T=P[d.pos++]))<<17,T<128)||(v|=(127&(T=P[d.pos++]))<<24,T<128)||(v|=(1&(T=P[d.pos++]))<<31,T<128))return yl(c,v,p);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=s[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&zc?function(i,s,c){return zc.decode(i.subarray(s,c))}(this.buf,e,t):function(i,s,c){for(var p="",d=s;d<c;){var v,T,P,A=i[d],z=null,B=A>239?4:A>223?3:A>191?2:1;if(d+B>c)break;B===1?A<128&&(z=A):B===2?(192&(v=i[d+1]))==128&&(z=(31&A)<<6|63&v)<=127&&(z=null):B===3?(T=i[d+2],(192&(v=i[d+1]))==128&&(192&T)==128&&((z=(15&A)<<12|(63&v)<<6|63&T)<=2047||z>=55296&&z<=57343)&&(z=null)):B===4&&(T=i[d+2],P=i[d+3],(192&(v=i[d+1]))==128&&(192&T)==128&&(192&P)==128&&((z=(15&A)<<18|(63&v)<<12|(63&T)<<6|63&P)<=65535||z>=1114112)&&(z=null)),z===null?(z=65533,B=1):z>65535&&(z-=65536,p+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),p+=String.fromCharCode(z),d+=B}return p}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==si.Bytes)return t.push(this.readVarint(e));var i=Oa(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==si.Bytes)return t.push(this.readSVarint());var e=Oa(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==si.Bytes)return t.push(this.readBoolean());var e=Oa(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==si.Bytes)return t.push(this.readFloat());var e=Oa(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==si.Bytes)return t.push(this.readDouble());var e=Oa(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==si.Bytes)return t.push(this.readFixed32());var e=Oa(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==si.Bytes)return t.push(this.readSFixed32());var e=Oa(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==si.Bytes)return t.push(this.readFixed64());var e=Oa(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==si.Bytes)return t.push(this.readSFixed64());var e=Oa(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===si.Varint)for(;this.buf[this.pos++]>127;);else if(e===si.Bytes)this.pos=this.readVarint()+this.pos;else if(e===si.Fixed32)this.pos+=4;else{if(e!==si.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),gl(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),gl(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),gl(this.buf,-1&t,this.pos),gl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),gl(this.buf,-1&t,this.pos),gl(this.buf,Math.floor(t*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,i){var s,c;if(e>=0?(s=e%4294967296|0,c=e/4294967296|0):(c=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,c=c+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),function(p,d,v){v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,p>>>=7,v.buf[v.pos++]=127&p|128,v.buf[v.pos]=127&(p>>>=7)}(s,0,i),function(p,d){var v=(7&p)<<4;d.buf[d.pos++]|=v|((p>>>=3)?128:0),p&&(d.buf[d.pos++]=127&p|((p>>>=7)?128:0),p&&(d.buf[d.pos++]=127&p|((p>>>=7)?128:0),p&&(d.buf[d.pos++]=127&p|((p>>>=7)?128:0),p&&(d.buf[d.pos++]=127&p|((p>>>=7)?128:0),p&&(d.buf[d.pos++]=127&p)))))}(c,i)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(s,c,p){for(var d,v,T=0;T<c.length;T++){if((d=c.charCodeAt(T))>55295&&d<57344){if(!v){d>56319||T+1===c.length?(s[p++]=239,s[p++]=191,s[p++]=189):v=d;continue}if(d<56320){s[p++]=239,s[p++]=191,s[p++]=189,v=d;continue}d=v-55296<<10|d-56320|65536,v=null}else v&&(s[p++]=239,s[p++]=191,s[p++]=189,v=null);d<128?s[p++]=d:(d<2048?s[p++]=d>>6|192:(d<65536?s[p++]=d>>12|224:(s[p++]=d>>18|240,s[p++]=d>>12&63|128),s[p++]=d>>6&63|128),s[p++]=63&d|128)}return p}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&kc(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),Lc(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Lc(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var s=this.pos-i;s>=128&&kc(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s},writeMessage:function(t,e,i){this.writeTag(t,si.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,Qf,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,td,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,rd,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,ed,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,id,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,nd,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,od,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,ad,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,sd,e)},writeBytesField:function(t,e){this.writeTag(t,si.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,si.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,si.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,si.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,si.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,si.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,si.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,si.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,si.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,si.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};var Bu=function(t,e){var i=e.pixelRatio,s=e.version,c=e.stretchX,p=e.stretchY,d=e.content;this.paddedRect=t,this.pixelRatio=i,this.stretchX=c,this.stretchY=p,this.content=d,this.version=s},iu={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};iu.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},iu.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},iu.tlbr.get=function(){return this.tl.concat(this.br)},iu.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Bu.prototype,iu);var ru=function(t,e){var i={},s={};this.haveRenderCallbacks=[];var c=[];this.addImages(t,i,c),this.addImages(e,s,c);var p=Dc(c),d=new _n({width:p.w||1,height:p.h||1});for(var v in t){var T=t[v],P=i[v].paddedRect;_n.copy(T.data,d,{x:0,y:0},{x:P.x+1,y:P.y+1},T.data)}for(var A in e){var z=e[A],B=s[A].paddedRect,F=B.x+1,H=B.y+1,X=z.data.width,et=z.data.height;_n.copy(z.data,d,{x:0,y:0},{x:F,y:H},z.data),_n.copy(z.data,d,{x:0,y:et-1},{x:F,y:H-1},{width:X,height:1}),_n.copy(z.data,d,{x:0,y:0},{x:F,y:H+et},{width:X,height:1}),_n.copy(z.data,d,{x:X-1,y:0},{x:F-1,y:H},{width:1,height:et}),_n.copy(z.data,d,{x:0,y:0},{x:F+X,y:H},{width:1,height:et})}this.image=d,this.iconPositions=i,this.patternPositions=s};ru.prototype.addImages=function(t,e,i){for(var s in t){var c=t[s],p={x:0,y:0,w:c.data.width+2,h:c.data.height+2};i.push(p),e[s]=new Bu(p,c),c.hasRenderCallback&&this.haveRenderCallbacks.push(s)}},ru.prototype.patchUpdatedImages=function(t,e){for(var i in t.dispatchRenderCallbacks(this.haveRenderCallbacks),t.updatedImages)this.patchUpdatedImage(this.iconPositions[i],t.getImage(i),e),this.patchUpdatedImage(this.patternPositions[i],t.getImage(i),e)},ru.prototype.patchUpdatedImage=function(t,e,i){if(t&&e&&t.version!==e.version){t.version=e.version;var s=t.tl;i.update(e.data,void 0,{x:s[0],y:s[1]})}},jt("ImagePosition",Bu),jt("ImageAtlas",ru);var Dn={horizontal:1,vertical:2,horizontalOnly:3},vl=function(){this.scale=1,this.fontStack="",this.imageName=null};vl.forText=function(t,e){var i=new vl;return i.scale=t||1,i.fontStack=e,i},vl.forImage=function(t){var e=new vl;return e.imageName=t,e};var Vr=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Ru(t,e,i,s,c,p,d,v,T,P,A,z,B,F,H,X){var et,$=Vr.fromFeature(t,c);z===Dn.vertical&&$.verticalizePunctuation();var lt=wt.processBidirectionalText,ct=wt.processStyledBidirectionalText;if(lt&&$.sections.length===1){et=[];for(var ft=0,mt=lt($.toString(),Ch($,P,p,e,s,F,H));ft<mt.length;ft+=1){var Tt=mt[ft],Lt=new Vr;Lt.text=Tt,Lt.sections=$.sections;for(var Dt=0;Dt<Tt.length;Dt++)Lt.sectionIndex.push(0);et.push(Lt)}}else if(ct){et=[];for(var $t=0,Ut=ct($.text,$.sectionIndex,Ch($,P,p,e,s,F,H));$t<Ut.length;$t+=1){var ee=Ut[$t],Nt=new Vr;Nt.text=ee[0],Nt.sectionIndex=ee[1],Nt.sections=$.sections,et.push(Nt)}}else et=function(Jt,Pe){for(var _e=[],ze=Jt.text,re=0,Ne=0,di=Pe;Ne<di.length;Ne+=1){var Li=di[Ne];_e.push(Jt.substring(re,Li)),re=Li}return re<ze.length&&_e.push(Jt.substring(re,ze.length)),_e}($,Ch($,P,p,e,s,F,H));var xe=[],le={positionedLines:xe,text:$.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:z,iconsInText:!1,verticalizable:!1};return function(Jt,Pe,_e,ze,re,Ne,di,Li,Ii,mi,zi,or){for(var ar=0,qr=-17,dr=0,jr=0,Di=Li==="right"?1:Li==="left"?0:.5,mr=0,Ae=0,ri=re;Ae<ri.length;Ae+=1){var Ye=ri[Ae];Ye.trim();var De=Ye.getMaxScale(),on=24*(De-1),Mr={positionedGlyphs:[],lineOffset:0};Jt.positionedLines[mr]=Mr;var ci=Mr.positionedGlyphs,qi=0;if(Ye.length()){for(var Dr=0;Dr<Ye.length();Dr++){var Ze=Ye.getSection(Dr),da=Ye.getSectionIndex(Dr),Bn=Ye.getCharCode(Dr),ma=0,Bi=null,_a=null,xo=null,El=24,Hs=!(Ii===Dn.horizontal||!zi&&!Ma(Bn)||zi&&(Ou[Bn]||(Za=Bn,Bt.Arabic(Za)||Bt["Arabic Supplement"](Za)||Bt["Arabic Extended-A"](Za)||Bt["Arabic Presentation Forms-A"](Za)||Bt["Arabic Presentation Forms-B"](Za))));if(Ze.imageName){var Al=ze[Ze.imageName];if(!Al)continue;xo=Ze.imageName,Jt.iconsInText=Jt.iconsInText||!0,_a=Al.paddedRect;var Na=Al.displaySize;Ze.scale=24*Ze.scale/or,ma=on+(24-Na[1]*Ze.scale),El=(Bi={width:Na[0],height:Na[1],left:1,top:-3,advance:Hs?Na[1]:Na[0]}).advance;var Cl=Hs?Na[0]*Ze.scale-24*De:Na[1]*Ze.scale-24*De;Cl>0&&Cl>qi&&(qi=Cl)}else{var Wu=_e[Ze.fontStack],Ll=Wu&&Wu[Bn];if(Ll&&Ll.rect)_a=Ll.rect,Bi=Ll.metrics;else{var au=Pe[Ze.fontStack],Hu=au&&au[Bn];if(!Hu)continue;Bi=Hu.metrics}ma=24*(De-Ze.scale)}Hs?(Jt.verticalizable=!0,ci.push({glyph:Bn,imageName:xo,x:ar,y:qr+ma,vertical:Hs,scale:Ze.scale,fontStack:Ze.fontStack,sectionIndex:da,metrics:Bi,rect:_a}),ar+=El*Ze.scale+mi):(ci.push({glyph:Bn,imageName:xo,x:ar,y:qr+ma,vertical:Hs,scale:Ze.scale,fontStack:Ze.fontStack,sectionIndex:da,metrics:Bi,rect:_a}),ar+=Bi.advance*Ze.scale+mi)}ci.length!==0&&(dr=Math.max(ar-mi,dr),pd(ci,0,ci.length-1,Di,qi)),ar=0;var Xu=Ne*De+qi;Mr.lineOffset=Math.max(qi,on),qr+=Xu,jr=Math.max(Xu,jr),++mr}else qr+=Ne,++mr}var Za,su=qr- -17,zl=Lh(di),ys=zl.horizontalAlign,kl=zl.verticalAlign;(function(Ku,Ju,lu,uu,Yu,hu,cu,pu,$u){var Ml,Qu=(Ju-lu)*Yu;Ml=hu!==cu?-pu*uu- -17:(-uu*$u+.5)*cu;for(var Dl=0,fu=Ku;Dl<fu.length;Dl+=1)for(var Xs=0,du=fu[Dl].positionedGlyphs;Xs<du.length;Xs+=1){var Bl=du[Xs];Bl.x+=Qu,Bl.y+=Ml}})(Jt.positionedLines,Di,ys,kl,dr,jr,Ne,su,re.length),Jt.top+=-kl*su,Jt.bottom=Jt.top+su,Jt.left+=-ys*dr,Jt.right=Jt.left+dr}(le,e,i,s,et,d,v,T,z,P,B,X),!function(Jt){for(var Pe=0,_e=Jt;Pe<_e.length;Pe+=1)if(_e[Pe].positionedGlyphs.length!==0)return!1;return!0}(xe)&&le}Vr.fromFeature=function(t,e){for(var i=new Vr,s=0;s<t.sections.length;s++){var c=t.sections[s];c.image?i.addImageSection(c):i.addTextSection(c,e)}return i},Vr.prototype.length=function(){return this.text.length},Vr.prototype.getSection=function(t){return this.sections[this.sectionIndex[t]]},Vr.prototype.getSectionIndex=function(t){return this.sectionIndex[t]},Vr.prototype.getCharCode=function(t){return this.text.charCodeAt(t)},Vr.prototype.verticalizePunctuation=function(){this.text=function(t){for(var e="",i=0;i<t.length;i++){var s=t.charCodeAt(i+1)||null,c=t.charCodeAt(i-1)||null;e+=s&&ns(s)&&!eu[t[i+1]]||c&&ns(c)&&!eu[t[i-1]]||!eu[t[i]]?t[i]:eu[t[i]]}return e}(this.text)},Vr.prototype.trim=function(){for(var t=0,e=0;e<this.text.length&&Ou[this.text.charCodeAt(e)];e++)t++;for(var i=this.text.length,s=this.text.length-1;s>=0&&s>=t&&Ou[this.text.charCodeAt(s)];s--)i--;this.text=this.text.substring(t,i),this.sectionIndex=this.sectionIndex.slice(t,i)},Vr.prototype.substring=function(t,e){var i=new Vr;return i.text=this.text.substring(t,e),i.sectionIndex=this.sectionIndex.slice(t,e),i.sections=this.sections,i},Vr.prototype.toString=function(){return this.text},Vr.prototype.getMaxScale=function(){var t=this;return this.sectionIndex.reduce(function(e,i){return Math.max(e,t.sections[i].scale)},0)},Vr.prototype.addTextSection=function(t,e){this.text+=t.text,this.sections.push(vl.forText(t.scale,t.fontStack||e));for(var i=this.sections.length-1,s=0;s<t.text.length;++s)this.sectionIndex.push(i)},Vr.prototype.addImageSection=function(t){var e=t.image?t.image.name:"";if(e.length!==0){var i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCharCode(i),this.sections.push(vl.forImage(e)),this.sectionIndex.push(this.sections.length-1)):_i("Reached maximum number of images 6401")}else _i("Can't add FormattedSection with an empty image.")},Vr.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Ou={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},wn={};function Bc(t,e,i,s,c,p){if(e.imageName){var d=s[e.imageName];return d?d.displaySize[0]*e.scale*24/p+c:0}var v=i[e.fontStack],T=v&&v[t];return T?T.metrics.advance*e.scale+c:0}function Rc(t,e,i,s){var c=Math.pow(t-e,2);return s?t<e?c/2:2*c:c+Math.abs(i)*i}function cd(t,e,i){var s=0;return t===10&&(s-=1e4),i&&(s+=150),t!==40&&t!==65288||(s+=50),e!==41&&e!==65289||(s+=50),s}function Oc(t,e,i,s,c,p){for(var d=null,v=Rc(e,i,c,p),T=0,P=s;T<P.length;T+=1){var A=P[T],z=Rc(e-A.x,i,c,p)+A.badness;z<=v&&(d=A,v=z)}return{index:t,x:e,priorBreak:d,badness:v}}function Ch(t,e,i,s,c,p,d){if(p!=="point")return[];if(!t)return[];for(var v,T=[],P=function(et,$,lt,ct,ft,mt){for(var Tt=0,Lt=0;Lt<et.length();Lt++){var Dt=et.getSection(Lt);Tt+=Bc(et.getCharCode(Lt),Dt,ct,ft,$,mt)}return Tt/Math.max(1,Math.ceil(Tt/lt))}(t,e,i,s,c,d),A=t.text.indexOf("\u200B")>=0,z=0,B=0;B<t.length();B++){var F=t.getSection(B),H=t.getCharCode(B);if(Ou[H]||(z+=Bc(H,F,s,c,e,d)),B<t.length()-1){var X=!((v=H)<11904||!(Bt["Bopomofo Extended"](v)||Bt.Bopomofo(v)||Bt["CJK Compatibility Forms"](v)||Bt["CJK Compatibility Ideographs"](v)||Bt["CJK Compatibility"](v)||Bt["CJK Radicals Supplement"](v)||Bt["CJK Strokes"](v)||Bt["CJK Symbols and Punctuation"](v)||Bt["CJK Unified Ideographs Extension A"](v)||Bt["CJK Unified Ideographs"](v)||Bt["Enclosed CJK Letters and Months"](v)||Bt["Halfwidth and Fullwidth Forms"](v)||Bt.Hiragana(v)||Bt["Ideographic Description Characters"](v)||Bt["Kangxi Radicals"](v)||Bt["Katakana Phonetic Extensions"](v)||Bt.Katakana(v)||Bt["Vertical Forms"](v)||Bt["Yi Radicals"](v)||Bt["Yi Syllables"](v)));(wn[H]||X||F.imageName)&&T.push(Oc(B+1,z,P,T,cd(H,t.getCharCode(B+1),X&&A),!1))}}return function et($){return $?et($.priorBreak).concat($.index):[]}(Oc(t.length(),z,P,T,0,!0))}function Lh(t){var e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function pd(t,e,i,s,c){if(s||c)for(var p=t[i],d=(t[i].x+p.metrics.advance*p.scale)*s,v=e;v<=i;v++)t[v].x-=d,t[v].y+=c}function Fc(t,e,i,s,c,p){var d,v=t.image;if(v.content){var T=v.content,P=v.pixelRatio||1;d=[T[0]/P,T[1]/P,v.displaySize[0]-T[2]/P,v.displaySize[1]-T[3]/P]}var A,z,B,F,H=e.left*p,X=e.right*p;i==="width"||i==="both"?(F=c[0]+H-s[3],z=c[0]+X+s[1]):z=(F=c[0]+(H+X-v.displaySize[0])/2)+v.displaySize[0];var et=e.top*p,$=e.bottom*p;return i==="height"||i==="both"?(A=c[1]+et-s[0],B=c[1]+$+s[2]):B=(A=c[1]+(et+$-v.displaySize[1])/2)+v.displaySize[1],{image:v,top:A,right:z,bottom:B,left:F,collisionPadding:d}}wn[10]=!0,wn[32]=!0,wn[38]=!0,wn[40]=!0,wn[41]=!0,wn[43]=!0,wn[45]=!0,wn[47]=!0,wn[173]=!0,wn[183]=!0,wn[8203]=!0,wn[8208]=!0,wn[8211]=!0,wn[8231]=!0;var xl=function(t){function e(i,s,c,p){t.call(this,i,s),this.angle=c,p!==void 0&&(this.segment=p)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(Vt);function zh(t,e){var i=e.expression;if(i.kind==="constant")return{kind:"constant",layoutSize:i.evaluate(new xt(t+1))};if(i.kind==="source")return{kind:"source"};for(var s=i.zoomStops,c=i.interpolationType,p=0;p<s.length&&s[p]<=t;)p++;for(var d=p=Math.max(0,p-1);d<s.length&&s[d]<t+1;)d++;d=Math.min(s.length-1,d);var v=s[p],T=s[d];return i.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:T,interpolationType:c}:{kind:"camera",minZoom:v,maxZoom:T,minSize:i.evaluate(new xt(v)),maxSize:i.evaluate(new xt(T)),interpolationType:c}}function Uc(t,e,i){var s=e.uSize,c=i.lowerSize;return t.kind==="source"?c/128:t.kind==="composite"?wi(c/128,i.upperSize/128,e.uSizeT):s}function Nc(t,e){var i=0,s=0;if(t.kind==="constant")s=t.layoutSize;else if(t.kind!=="source"){var c=t.interpolationType,p=c?lr(Vi.interpolationFactor(c,e,t.minZoom,t.maxZoom),0,1):0;t.kind==="camera"?s=wi(t.minSize,t.maxSize,p):i=p}return{uSizeT:i,uSize:s}}jt("Anchor",xl);var fd=Object.freeze({__proto__:null,getSizeData:zh,evaluateSizeForFeature:Uc,evaluateSizeForZoom:Nc,SIZE_PACK_FACTOR:128});function Zc(t,e,i,s,c){if(e.segment===void 0)return!0;for(var p=e,d=e.segment+1,v=0;v>-i/2;){if(--d<0)return!1;v-=t[d].dist(p),p=t[d]}v+=t[d].dist(t[d+1]),d++;for(var T=[],P=0;v<i/2;){var A=t[d],z=t[d+1];if(!z)return!1;var B=t[d-1].angleTo(A)-A.angleTo(z);for(B=Math.abs((B+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:v,angleDelta:B}),P+=B;v-T[0].distance>s;)P-=T.shift().angleDelta;if(P>c)return!1;d++,v+=A.dist(z)}return!0}function Vc(t){for(var e=0,i=0;i<t.length-1;i++)e+=t[i].dist(t[i+1]);return e}function qc(t,e,i){return t?.6*e*i:0}function jc(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function dd(t,e,i,s,c,p){for(var d=qc(i,c,p),v=jc(i,s)*p,T=0,P=Vc(t)/2,A=0;A<t.length-1;A++){var z=t[A],B=t[A+1],F=z.dist(B);if(T+F>P){var H=(P-T)/F,X=wi(z.x,B.x,H),et=wi(z.y,B.y,H),$=new xl(X,et,B.angleTo(z),A);return $._round(),!d||Zc(t,$,v,d,e)?$:void 0}T+=F}}function md(t,e,i,s,c,p,d,v,T){var P=qc(s,p,d),A=jc(s,c),z=A*d,B=t[0].x===0||t[0].x===T||t[0].y===0||t[0].y===T;return e-z<e/4&&(e=z+e/4),function F(H,X,et,$,lt,ct,ft,mt,Tt){for(var Lt=ct/2,Dt=Vc(H),$t=0,Ut=X-et,ee=[],Nt=0;Nt<H.length-1;Nt++){for(var xe=H[Nt],le=H[Nt+1],Jt=xe.dist(le),Pe=le.angleTo(xe);Ut+et<$t+Jt;){var _e=((Ut+=et)-$t)/Jt,ze=wi(xe.x,le.x,_e),re=wi(xe.y,le.y,_e);if(ze>=0&&ze<Tt&&re>=0&&re<Tt&&Ut-Lt>=0&&Ut+Lt<=Dt){var Ne=new xl(ze,re,Pe,Nt);Ne._round(),$&&!Zc(H,Ne,ct,$,lt)||ee.push(Ne)}}$t+=Jt}return mt||ee.length||ft||(ee=F(H,$t/2,et,$,lt,ct,ft,!0,Tt)),ee}(t,B?e/2*v%e:(A/2+2*p)*d*v%e,e,P,i,z,B,!1,T)}function Gc(t,e,i,s,c){for(var p=[],d=0;d<t.length;d++)for(var v=t[d],T=void 0,P=0;P<v.length-1;P++){var A=v[P],z=v[P+1];A.x<e&&z.x<e||(A.x<e?A=new Vt(e,A.y+(e-A.x)/(z.x-A.x)*(z.y-A.y))._round():z.x<e&&(z=new Vt(e,A.y+(e-A.x)/(z.x-A.x)*(z.y-A.y))._round()),A.y<i&&z.y<i||(A.y<i?A=new Vt(A.x+(i-A.y)/(z.y-A.y)*(z.x-A.x),i)._round():z.y<i&&(z=new Vt(A.x+(i-A.y)/(z.y-A.y)*(z.x-A.x),i)._round()),A.x>=s&&z.x>=s||(A.x>=s?A=new Vt(s,A.y+(s-A.x)/(z.x-A.x)*(z.y-A.y))._round():z.x>=s&&(z=new Vt(s,A.y+(s-A.x)/(z.x-A.x)*(z.y-A.y))._round()),A.y>=c&&z.y>=c||(A.y>=c?A=new Vt(A.x+(c-A.y)/(z.y-A.y)*(z.x-A.x),c)._round():z.y>=c&&(z=new Vt(A.x+(c-A.y)/(z.y-A.y)*(z.x-A.x),c)._round()),T&&A.equals(T[T.length-1])||p.push(T=[A]),T.push(z)))))}return p}function Wc(t,e,i,s){var c=[],p=t.image,d=p.pixelRatio,v=p.paddedRect.w-2,T=p.paddedRect.h-2,P=t.right-t.left,A=t.bottom-t.top,z=p.stretchX||[[0,v]],B=p.stretchY||[[0,T]],F=function(ze,re){return ze+re[1]-re[0]},H=z.reduce(F,0),X=B.reduce(F,0),et=v-H,$=T-X,lt=0,ct=H,ft=0,mt=X,Tt=0,Lt=et,Dt=0,$t=$;if(p.content&&s){var Ut=p.content;lt=Fu(z,0,Ut[0]),ft=Fu(B,0,Ut[1]),ct=Fu(z,Ut[0],Ut[2]),mt=Fu(B,Ut[1],Ut[3]),Tt=Ut[0]-lt,Dt=Ut[1]-ft,Lt=Ut[2]-Ut[0]-ct,$t=Ut[3]-Ut[1]-mt}var ee=function(ze,re,Ne,di){var Li=Uu(ze.stretch-lt,ct,P,t.left),Ii=Nu(ze.fixed-Tt,Lt,ze.stretch,H),mi=Uu(re.stretch-ft,mt,A,t.top),zi=Nu(re.fixed-Dt,$t,re.stretch,X),or=Uu(Ne.stretch-lt,ct,P,t.left),ar=Nu(Ne.fixed-Tt,Lt,Ne.stretch,H),qr=Uu(di.stretch-ft,mt,A,t.top),dr=Nu(di.fixed-Dt,$t,di.stretch,X),jr=new Vt(Li,mi),Di=new Vt(or,mi),mr=new Vt(or,qr),Ae=new Vt(Li,qr),ri=new Vt(Ii/d,zi/d),Ye=new Vt(ar/d,dr/d),De=e*Math.PI/180;if(De){var on=Math.sin(De),Mr=Math.cos(De),ci=[Mr,-on,on,Mr];jr._matMult(ci),Di._matMult(ci),Ae._matMult(ci),mr._matMult(ci)}var qi=ze.stretch+ze.fixed,Dr=re.stretch+re.fixed;return{tl:jr,tr:Di,bl:Ae,br:mr,tex:{x:p.paddedRect.x+1+qi,y:p.paddedRect.y+1+Dr,w:Ne.stretch+Ne.fixed-qi,h:di.stretch+di.fixed-Dr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ri,pixelOffsetBR:Ye,minFontScaleX:Lt/d/P,minFontScaleY:$t/d/A,isSDF:i}};if(s&&(p.stretchX||p.stretchY))for(var Nt=Hc(z,et,H),xe=Hc(B,$,X),le=0;le<Nt.length-1;le++)for(var Jt=Nt[le],Pe=Nt[le+1],_e=0;_e<xe.length-1;_e++)c.push(ee(Jt,xe[_e],Pe,xe[_e+1]));else c.push(ee({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:T+1}));return c}function Fu(t,e,i){for(var s=0,c=0,p=t;c<p.length;c+=1){var d=p[c];s+=Math.max(e,Math.min(i,d[1]))-Math.max(e,Math.min(i,d[0]))}return s}function Hc(t,e,i){for(var s=[{fixed:-1,stretch:0}],c=0,p=t;c<p.length;c+=1){var d=p[c],v=d[0],T=d[1],P=s[s.length-1];s.push({fixed:v-P.stretch,stretch:P.stretch}),s.push({fixed:v-P.stretch,stretch:P.stretch+(T-v)})}return s.push({fixed:e+1,stretch:i}),s}function Uu(t,e,i,s){return t/e*i+s}function Nu(t,e,i,s){return t-e*i/s}var Zu=function(t,e,i,s,c,p,d,v,T,P){if(this.boxStartIndex=t.length,T){var A=p.top,z=p.bottom,B=p.collisionPadding;B&&(A-=B[1],z+=B[3]);var F=z-A;F>0&&(F=Math.max(10,F),this.circleDiameter=F)}else{var H=p.top*d-v,X=p.bottom*d+v,et=p.left*d-v,$=p.right*d+v,lt=p.collisionPadding;if(lt&&(et-=lt[0]*d,H-=lt[1]*d,$+=lt[2]*d,X+=lt[3]*d),P){var ct=new Vt(et,H),ft=new Vt($,H),mt=new Vt(et,X),Tt=new Vt($,X),Lt=P*Math.PI/180;ct._rotate(Lt),ft._rotate(Lt),mt._rotate(Lt),Tt._rotate(Lt),et=Math.min(ct.x,ft.x,mt.x,Tt.x),$=Math.max(ct.x,ft.x,mt.x,Tt.x),H=Math.min(ct.y,ft.y,mt.y,Tt.y),X=Math.max(ct.y,ft.y,mt.y,Tt.y)}t.emplaceBack(e.x,e.y,et,H,$,X,i,s,c)}this.boxEndIndex=t.length},bl=function(t,e){if(t===void 0&&(t=[]),e===void 0&&(e=_d),this.data=t,this.length=this.data.length,this.compare=e,this.length>0)for(var i=(this.length>>1)-1;i>=0;i--)this._down(i)};function _d(t,e){return t<e?-1:t>e?1:0}function yd(t,e,i){e===void 0&&(e=1),i===void 0&&(i=!1);for(var s=1/0,c=1/0,p=-1/0,d=-1/0,v=t[0],T=0;T<v.length;T++){var P=v[T];(!T||P.x<s)&&(s=P.x),(!T||P.y<c)&&(c=P.y),(!T||P.x>p)&&(p=P.x),(!T||P.y>d)&&(d=P.y)}var A=Math.min(p-s,d-c),z=A/2,B=new bl([],gd);if(A===0)return new Vt(s,c);for(var F=s;F<p;F+=A)for(var H=c;H<d;H+=A)B.push(new wl(F+z,H+z,z,t));for(var X=function(lt){for(var ct=0,ft=0,mt=0,Tt=lt[0],Lt=0,Dt=Tt.length,$t=Dt-1;Lt<Dt;$t=Lt++){var Ut=Tt[Lt],ee=Tt[$t],Nt=Ut.x*ee.y-ee.x*Ut.y;ft+=(Ut.x+ee.x)*Nt,mt+=(Ut.y+ee.y)*Nt,ct+=3*Nt}return new wl(ft/ct,mt/ct,0,lt)}(t),et=B.length;B.length;){var $=B.pop();($.d>X.d||!X.d)&&(X=$,i&&console.log("found best %d after %d probes",Math.round(1e4*$.d)/1e4,et)),$.max-X.d<=e||(B.push(new wl($.p.x-(z=$.h/2),$.p.y-z,z,t)),B.push(new wl($.p.x+z,$.p.y-z,z,t)),B.push(new wl($.p.x-z,$.p.y+z,z,t)),B.push(new wl($.p.x+z,$.p.y+z,z,t)),et+=4)}return i&&(console.log("num probes: "+et),console.log("best distance: "+X.d)),X.p}function gd(t,e){return e.max-t.max}function wl(t,e,i,s){this.p=new Vt(t,e),this.h=i,this.d=function(c,p){for(var d=!1,v=1/0,T=0;T<p.length;T++)for(var P=p[T],A=0,z=P.length,B=z-1;A<z;B=A++){var F=P[A],H=P[B];F.y>c.y!=H.y>c.y&&c.x<(H.x-F.x)*(c.y-F.y)/(H.y-F.y)+F.x&&(d=!d),v=Math.min(v,fs(c,F,H))}return(d?1:-1)*Math.sqrt(v)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}bl.prototype.push=function(t){this.data.push(t),this.length++,this._up(this.length-1)},bl.prototype.pop=function(){if(this.length!==0){var t=this.data[0],e=this.data.pop();return this.length--,this.length>0&&(this.data[0]=e,this._down(0)),t}},bl.prototype.peek=function(){return this.data[0]},bl.prototype._up=function(t){for(var e=this.data,i=this.compare,s=e[t];t>0;){var c=t-1>>1,p=e[c];if(i(s,p)>=0)break;e[t]=p,t=c}e[t]=s},bl.prototype._down=function(t){for(var e=this.data,i=this.compare,s=this.length>>1,c=e[t];t<s;){var p=1+(t<<1),d=e[p],v=p+1;if(v<this.length&&i(e[v],d)<0&&(p=v,d=e[v]),i(d,c)>=0)break;e[t]=d,t=p}e[t]=c};var kh=Number.POSITIVE_INFINITY;function Xc(t,e){return e[1]!==kh?function(i,s,c){var p=0,d=0;switch(s=Math.abs(s),c=Math.abs(c),i){case"top-right":case"top-left":case"top":d=c-7;break;case"bottom-right":case"bottom-left":case"bottom":d=7-c}switch(i){case"top-right":case"bottom-right":case"right":p=-s;break;case"top-left":case"bottom-left":case"left":p=s}return[p,d]}(t,e[0],e[1]):function(i,s){var c=0,p=0;s<0&&(s=0);var d=s/Math.sqrt(2);switch(i){case"top-right":case"top-left":p=d-7;break;case"bottom-right":case"bottom-left":p=7-d;break;case"bottom":p=7-s;break;case"top":p=s-7}switch(i){case"top-right":case"bottom-right":c=-d;break;case"top-left":case"bottom-left":c=d;break;case"left":c=s;break;case"right":c=-s}return[c,p]}(t,e[0])}function Mh(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Kc(t,e,i,s,c,p,d,v,T,P,A,z,B,F,H){var X=function(ft,mt,Tt,Lt,Dt,$t,Ut,ee){for(var Nt=Lt.layout.get("text-rotate").evaluate($t,{})*Math.PI/180,xe=[],le=0,Jt=mt.positionedLines;le<Jt.length;le+=1)for(var Pe=Jt[le],_e=0,ze=Pe.positionedGlyphs;_e<ze.length;_e+=1){var re=ze[_e];if(re.rect){var Ne=re.rect||{},di=4,Li=!0,Ii=1,mi=0,zi=(Dt||ee)&&re.vertical,or=re.metrics.advance*re.scale/2;if(ee&&mt.verticalizable&&(mi=Pe.lineOffset/2-(re.imageName?-(24-re.metrics.width*re.scale)/2:24*(re.scale-1))),re.imageName){var ar=Ut[re.imageName];Li=ar.sdf,di=1/(Ii=ar.pixelRatio)}var qr=Dt?[re.x+or,re.y]:[0,0],dr=Dt?[0,0]:[re.x+or+Tt[0],re.y+Tt[1]-mi],jr=[0,0];zi&&(jr=dr,dr=[0,0]);var Di=(re.metrics.left-di)*re.scale-or+dr[0],mr=(-re.metrics.top-di)*re.scale+dr[1],Ae=Di+Ne.w*re.scale/Ii,ri=mr+Ne.h*re.scale/Ii,Ye=new Vt(Di,mr),De=new Vt(Ae,mr),on=new Vt(Di,ri),Mr=new Vt(Ae,ri);if(zi){var ci=new Vt(-or,or- -17),qi=-Math.PI/2,Dr=12-or,Ze=new Vt(22-Dr,-(re.imageName?Dr:0)),da=new(Function.prototype.bind.apply(Vt,[null].concat(jr)));Ye._rotateAround(qi,ci)._add(Ze)._add(da),De._rotateAround(qi,ci)._add(Ze)._add(da),on._rotateAround(qi,ci)._add(Ze)._add(da),Mr._rotateAround(qi,ci)._add(Ze)._add(da)}if(Nt){var Bn=Math.sin(Nt),ma=Math.cos(Nt),Bi=[ma,-Bn,Bn,ma];Ye._matMult(Bi),De._matMult(Bi),on._matMult(Bi),Mr._matMult(Bi)}var _a=new Vt(0,0),xo=new Vt(0,0);xe.push({tl:Ye,tr:De,bl:on,br:Mr,tex:Ne,writingMode:mt.writingMode,glyphOffset:qr,sectionIndex:re.sectionIndex,isSDF:Li,pixelOffsetTL:_a,pixelOffsetBR:xo,minFontScaleX:0,minFontScaleY:0})}}return xe}(0,i,v,c,p,d,s,t.allowVerticalPlacement),et=t.textSizeData,$=null;et.kind==="source"?($=[128*c.layout.get("text-size").evaluate(d,{})])[0]>32640&&_i(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):et.kind==="composite"&&(($=[128*F.compositeTextSizes[0].evaluate(d,{},H),128*F.compositeTextSizes[1].evaluate(d,{},H)])[0]>32640||$[1]>32640)&&_i(t.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),t.addSymbols(t.text,X,$,v,p,d,P,e,T.lineStartIndex,T.lineLength,B,H);for(var lt=0,ct=A;lt<ct.length;lt+=1)z[ct[lt]]=t.text.placedSymbolArray.length-1;return 4*X.length}function Jc(t){for(var e in t)return t[e];return null}function vd(t,e,i,s){var c=t.compareText;if(e in c){for(var p=c[e],d=p.length-1;d>=0;d--)if(s.dist(p[d])<i)return!0}else c[e]=[];return c[e].push(s),!1}var xd=_l.VectorTileFeature.types,bd=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Vu(t,e,i,s,c,p,d,v,T,P,A,z,B){var F=v?Math.min(32640,Math.round(v[0])):0,H=v?Math.min(32640,Math.round(v[1])):0;t.emplaceBack(e,i,Math.round(32*s),Math.round(32*c),p,d,(F<<1)+(T?1:0),H,16*P,16*A,256*z,256*B)}function Dh(t,e,i){t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i)}function wd(t){for(var e=0,i=t.sections;e<i.length;e+=1)if(os(i[e].text))return!0;return!1}var Tl=function(t){this.layoutVertexArray=new ul,this.indexArray=new la,this.programConfigurations=t,this.segments=new Z,this.dynamicLayoutVertexArray=new hs,this.opacityVertexArray=new Os,this.placedSymbolArray=new l};Tl.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},Tl.prototype.upload=function(t,e,i,s){this.isEmpty()||(i&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Xf.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,e),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,Kf.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,bd,!0),this.opacityVertexBuffer.itemSize=1),(i||s)&&this.programConfigurations.upload(t))},Tl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},jt("SymbolBuffers",Tl);var nu=function(t,e,i){this.layoutVertexArray=new t,this.layoutAttributes=e,this.indexArray=new i,this.segments=new Z,this.collisionVertexArray=new Wl};nu.prototype.upload=function(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,Jf.members,!0)},nu.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},jt("CollisionBuffers",nu);var ei=function(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(function(p){return p.id}),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=bn([]),this.placementViewportMatrix=bn([]);var e=this.layers[0]._unevaluatedLayout._values;this.textSizeData=zh(this.zoom,e["text-size"]),this.iconSizeData=zh(this.zoom,e["icon-size"]);var i=this.layers[0].layout,s=i.get("symbol-sort-key"),c=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=c!=="viewport-y"&&s.constantOr(1)!==void 0,this.sortFeaturesByY=(c==="viewport-y"||c==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,i.get("symbol-placement")==="point"&&(this.writingModes=i.get("text-writing-mode").map(function(p){return Dn[p]})),this.stateDependentLayerIds=this.layers.filter(function(p){return p.isStateDependent()}).map(function(p){return p.id}),this.sourceID=t.sourceID};ei.prototype.createArrays=function(){this.text=new Tl(new ae(this.layers,this.zoom,function(t){return/^text/.test(t)})),this.icon=new Tl(new ae(this.layers,this.zoom,function(t){return/^icon/.test(t)})),this.glyphOffsetArray=new g,this.lineVertexArray=new w,this.symbolInstances=new y},ei.prototype.calculateGlyphDependencies=function(t,e,i,s,c){for(var p=0;p<t.length;p++)if(e[t.charCodeAt(p)]=!0,(i||s)&&c){var d=eu[t.charAt(p)];d&&(e[d.charCodeAt(0)]=!0)}},ei.prototype.populate=function(t,e,i){var s=this.layers[0],c=s.layout,p=c.get("text-font"),d=c.get("text-field"),v=c.get("icon-image"),T=(d.value.kind!=="constant"||d.value.value instanceof bi&&!d.value.value.isEmpty()||d.value.value.toString().length>0)&&(p.value.kind!=="constant"||p.value.value.length>0),P=v.value.kind!=="constant"||!!v.value.value||Object.keys(v.parameters).length>0,A=c.get("symbol-sort-key");if(this.features=[],T||P){for(var z=e.iconDependencies,B=e.glyphDependencies,F=e.availableImages,H=new xt(this.zoom),X=0,et=t;X<et.length;X+=1){var $=et[X],lt=$.feature,ct=$.id,ft=$.index,mt=$.sourceLayerIndex,Tt=s._featureFilter.needGeometry,Lt=Mi(lt,Tt);if(s._featureFilter.filter(H,Lt,i)){Tt||(Lt.geometry=Pi(lt));var Dt=void 0;if(T){var $t=s.getValueAndResolveTokens("text-field",Lt,i,F),Ut=bi.factory($t);wd(Ut)&&(this.hasRTLText=!0),(!this.hasRTLText||rt()==="unavailable"||this.hasRTLText&&wt.isParsed())&&(Dt=$f(Ut,s,Lt))}var ee=void 0;if(P){var Nt=s.getValueAndResolveTokens("icon-image",Lt,i,F);ee=Nt instanceof ur?Nt:ur.fromString(Nt)}if(Dt||ee){var xe=this.sortFeaturesByKey?A.evaluate(Lt,{},i):void 0;if(this.features.push({id:ct,text:Dt,icon:ee,index:ft,sourceLayerIndex:mt,geometry:Lt.geometry,properties:lt.properties,type:xd[lt.type],sortKey:xe}),ee&&(z[ee.name]=!0),Dt){var le=p.evaluate(Lt,{},i).join(","),Jt=c.get("text-rotation-alignment")==="map"&&c.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Dn.vertical)>=0;for(var Pe=0,_e=Dt.sections;Pe<_e.length;Pe+=1){var ze=_e[Pe];if(ze.image)z[ze.image.name]=!0;else{var re=rs(Dt.toString()),Ne=ze.fontStack||le,di=B[Ne]=B[Ne]||{};this.calculateGlyphDependencies(ze.text,di,Jt,this.allowVerticalPlacement,re)}}}}}}c.get("symbol-placement")==="line"&&(this.features=function(Li){var Ii={},mi={},zi=[],or=0;function ar(ci){zi.push(Li[ci]),or++}function qr(ci,qi,Dr){var Ze=mi[ci];return delete mi[ci],mi[qi]=Ze,zi[Ze].geometry[0].pop(),zi[Ze].geometry[0]=zi[Ze].geometry[0].concat(Dr[0]),Ze}function dr(ci,qi,Dr){var Ze=Ii[qi];return delete Ii[qi],Ii[ci]=Ze,zi[Ze].geometry[0].shift(),zi[Ze].geometry[0]=Dr[0].concat(zi[Ze].geometry[0]),Ze}function jr(ci,qi,Dr){var Ze=Dr?qi[0][qi[0].length-1]:qi[0][0];return ci+":"+Ze.x+":"+Ze.y}for(var Di=0;Di<Li.length;Di++){var mr=Li[Di],Ae=mr.geometry,ri=mr.text?mr.text.toString():null;if(ri){var Ye=jr(ri,Ae),De=jr(ri,Ae,!0);if(Ye in mi&&De in Ii&&mi[Ye]!==Ii[De]){var on=dr(Ye,De,Ae),Mr=qr(Ye,De,zi[on].geometry);delete Ii[Ye],delete mi[De],mi[jr(ri,zi[Mr].geometry,!0)]=Mr,zi[on].geometry=null}else Ye in mi?qr(Ye,De,Ae):De in Ii?dr(Ye,De,Ae):(ar(Di),Ii[Ye]=or-1,mi[De]=or-1)}else ar(Di)}return zi.filter(function(ci){return ci.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(Li,Ii){return Li.sortKey-Ii.sortKey})}},ei.prototype.update=function(t,e,i){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,e,this.layers,i),this.icon.programConfigurations.updatePaintArrays(t,e,this.layers,i))},ei.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},ei.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},ei.prototype.upload=function(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},ei.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},ei.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},ei.prototype.addToLineVertexArray=function(t,e){var i=this.lineVertexArray.length;if(t.segment!==void 0){for(var s=t.dist(e[t.segment+1]),c=t.dist(e[t.segment]),p={},d=t.segment+1;d<e.length;d++)p[d]={x:e[d].x,y:e[d].y,tileUnitDistanceFromAnchor:s},d<e.length-1&&(s+=e[d+1].dist(e[d]));for(var v=t.segment||0;v>=0;v--)p[v]={x:e[v].x,y:e[v].y,tileUnitDistanceFromAnchor:c},v>0&&(c+=e[v-1].dist(e[v]));for(var T=0;T<e.length;T++){var P=p[T];this.lineVertexArray.emplaceBack(P.x,P.y,P.tileUnitDistanceFromAnchor)}}return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}},ei.prototype.addSymbols=function(t,e,i,s,c,p,d,v,T,P,A,z){for(var B=t.indexArray,F=t.layoutVertexArray,H=t.segments.prepareSegment(4*e.length,F,B,this.canOverlap?p.sortKey:void 0),X=this.glyphOffsetArray.length,et=H.vertexLength,$=this.allowVerticalPlacement&&d===Dn.vertical?Math.PI/2:0,lt=p.text&&p.text.sections,ct=0;ct<e.length;ct++){var ft=e[ct],mt=ft.tl,Tt=ft.tr,Lt=ft.bl,Dt=ft.br,$t=ft.tex,Ut=ft.pixelOffsetTL,ee=ft.pixelOffsetBR,Nt=ft.minFontScaleX,xe=ft.minFontScaleY,le=ft.glyphOffset,Jt=ft.isSDF,Pe=ft.sectionIndex,_e=H.vertexLength,ze=le[1];Vu(F,v.x,v.y,mt.x,ze+mt.y,$t.x,$t.y,i,Jt,Ut.x,Ut.y,Nt,xe),Vu(F,v.x,v.y,Tt.x,ze+Tt.y,$t.x+$t.w,$t.y,i,Jt,ee.x,Ut.y,Nt,xe),Vu(F,v.x,v.y,Lt.x,ze+Lt.y,$t.x,$t.y+$t.h,i,Jt,Ut.x,ee.y,Nt,xe),Vu(F,v.x,v.y,Dt.x,ze+Dt.y,$t.x+$t.w,$t.y+$t.h,i,Jt,ee.x,ee.y,Nt,xe),Dh(t.dynamicLayoutVertexArray,v,$),B.emplaceBack(_e,_e+1,_e+2),B.emplaceBack(_e+1,_e+2,_e+3),H.vertexLength+=4,H.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(le[0]),ct!==e.length-1&&Pe===e[ct+1].sectionIndex||t.programConfigurations.populatePaintArrays(F.length,p,p.index,{},z,lt&&lt[Pe])}t.placedSymbolArray.emplaceBack(v.x,v.y,X,this.glyphOffsetArray.length-X,et,T,P,v.segment,i?i[0]:0,i?i[1]:0,s[0],s[1],d,0,!1,0,A)},ei.prototype._addCollisionDebugVertex=function(t,e,i,s,c,p){return e.emplaceBack(0,0),t.emplaceBack(i.x,i.y,s,c,Math.round(p.x),Math.round(p.y))},ei.prototype.addCollisionDebugVertices=function(t,e,i,s,c,p,d){var v=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),T=v.vertexLength,P=c.layoutVertexArray,A=c.collisionVertexArray,z=d.anchorX,B=d.anchorY;this._addCollisionDebugVertex(P,A,p,z,B,new Vt(t,e)),this._addCollisionDebugVertex(P,A,p,z,B,new Vt(i,e)),this._addCollisionDebugVertex(P,A,p,z,B,new Vt(i,s)),this._addCollisionDebugVertex(P,A,p,z,B,new Vt(t,s)),v.vertexLength+=4;var F=c.indexArray;F.emplaceBack(T,T+1),F.emplaceBack(T+1,T+2),F.emplaceBack(T+2,T+3),F.emplaceBack(T+3,T),v.primitiveLength+=4},ei.prototype.addDebugCollisionBoxes=function(t,e,i,s){for(var c=t;c<e;c++){var p=this.collisionBoxArray.get(c);this.addCollisionDebugVertices(p.x1,p.y1,p.x2,p.y2,s?this.textCollisionBox:this.iconCollisionBox,p.anchorPoint,i)}},ei.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new nu(cs,Ac.members,Fs),this.iconCollisionBox=new nu(cs,Ac.members,Fs);for(var t=0;t<this.symbolInstances.length;t++){var e=this.symbolInstances.get(t);this.addDebugCollisionBoxes(e.textBoxStartIndex,e.textBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.verticalTextBoxStartIndex,e.verticalTextBoxEndIndex,e,!0),this.addDebugCollisionBoxes(e.iconBoxStartIndex,e.iconBoxEndIndex,e,!1),this.addDebugCollisionBoxes(e.verticalIconBoxStartIndex,e.verticalIconBoxEndIndex,e,!1)}},ei.prototype._deserializeCollisionBoxesForSymbol=function(t,e,i,s,c,p,d,v,T){for(var P={},A=e;A<i;A++){var z=t.get(A);P.textBox={x1:z.x1,y1:z.y1,x2:z.x2,y2:z.y2,anchorPointX:z.anchorPointX,anchorPointY:z.anchorPointY},P.textFeatureIndex=z.featureIndex;break}for(var B=s;B<c;B++){var F=t.get(B);P.verticalTextBox={x1:F.x1,y1:F.y1,x2:F.x2,y2:F.y2,anchorPointX:F.anchorPointX,anchorPointY:F.anchorPointY},P.verticalTextFeatureIndex=F.featureIndex;break}for(var H=p;H<d;H++){var X=t.get(H);P.iconBox={x1:X.x1,y1:X.y1,x2:X.x2,y2:X.y2,anchorPointX:X.anchorPointX,anchorPointY:X.anchorPointY},P.iconFeatureIndex=X.featureIndex;break}for(var et=v;et<T;et++){var $=t.get(et);P.verticalIconBox={x1:$.x1,y1:$.y1,x2:$.x2,y2:$.y2,anchorPointX:$.anchorPointX,anchorPointY:$.anchorPointY},P.verticalIconFeatureIndex=$.featureIndex;break}return P},ei.prototype.deserializeCollisionBoxes=function(t){this.collisionArrays=[];for(var e=0;e<this.symbolInstances.length;e++){var i=this.symbolInstances.get(e);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}},ei.prototype.hasTextData=function(){return this.text.segments.get().length>0},ei.prototype.hasIconData=function(){return this.icon.segments.get().length>0},ei.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},ei.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},ei.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},ei.prototype.addIndicesForPlacedSymbol=function(t,e){for(var i=t.placedSymbolArray.get(e),s=i.vertexStartIndex+4*i.numGlyphs,c=i.vertexStartIndex;c<s;c+=4)t.indexArray.emplaceBack(c,c+1,c+2),t.indexArray.emplaceBack(c+1,c+2,c+3)},ei.prototype.getSortedSymbolIndexes=function(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var e=Math.sin(t),i=Math.cos(t),s=[],c=[],p=[],d=0;d<this.symbolInstances.length;++d){p.push(d);var v=this.symbolInstances.get(d);s.push(0|Math.round(e*v.anchorX+i*v.anchorY)),c.push(v.featureIndex)}return p.sort(function(T,P){return s[T]-s[P]||c[P]-c[T]}),p},ei.prototype.addToSortKeyRanges=function(t,e){var i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===e?i.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:e,symbolInstanceStart:t,symbolInstanceEnd:t+1})},ei.prototype.sortFeatures=function(t){var e=this;if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var i=0,s=this.symbolInstanceIndexes;i<s.length;i+=1){var c=this.symbolInstances.get(s[i]);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach(function(p,d,v){p>=0&&v.indexOf(p)===d&&e.addIndicesForPlacedSymbol(e.text,p)}),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},jt("SymbolBucket",ei,{omit:["layers","collisionBoxArray","features","compareText"]}),ei.MAX_GLYPHS=65535,ei.addDynamicAttributes=Dh;var Td=new Xi({"symbol-placement":new Qt(V.layout_symbol["symbol-placement"]),"symbol-spacing":new Qt(V.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Qt(V.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Xt(V.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Qt(V.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Qt(V.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Qt(V.layout_symbol["icon-ignore-placement"]),"icon-optional":new Qt(V.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Qt(V.layout_symbol["icon-rotation-alignment"]),"icon-size":new Xt(V.layout_symbol["icon-size"]),"icon-text-fit":new Qt(V.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Qt(V.layout_symbol["icon-text-fit-padding"]),"icon-image":new Xt(V.layout_symbol["icon-image"]),"icon-rotate":new Xt(V.layout_symbol["icon-rotate"]),"icon-padding":new Qt(V.layout_symbol["icon-padding"]),"icon-keep-upright":new Qt(V.layout_symbol["icon-keep-upright"]),"icon-offset":new Xt(V.layout_symbol["icon-offset"]),"icon-anchor":new Xt(V.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Qt(V.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Qt(V.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Qt(V.layout_symbol["text-rotation-alignment"]),"text-field":new Xt(V.layout_symbol["text-field"]),"text-font":new Xt(V.layout_symbol["text-font"]),"text-size":new Xt(V.layout_symbol["text-size"]),"text-max-width":new Xt(V.layout_symbol["text-max-width"]),"text-line-height":new Qt(V.layout_symbol["text-line-height"]),"text-letter-spacing":new Xt(V.layout_symbol["text-letter-spacing"]),"text-justify":new Xt(V.layout_symbol["text-justify"]),"text-radial-offset":new Xt(V.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Qt(V.layout_symbol["text-variable-anchor"]),"text-anchor":new Xt(V.layout_symbol["text-anchor"]),"text-max-angle":new Qt(V.layout_symbol["text-max-angle"]),"text-writing-mode":new Qt(V.layout_symbol["text-writing-mode"]),"text-rotate":new Xt(V.layout_symbol["text-rotate"]),"text-padding":new Qt(V.layout_symbol["text-padding"]),"text-keep-upright":new Qt(V.layout_symbol["text-keep-upright"]),"text-transform":new Xt(V.layout_symbol["text-transform"]),"text-offset":new Xt(V.layout_symbol["text-offset"]),"text-allow-overlap":new Qt(V.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Qt(V.layout_symbol["text-ignore-placement"]),"text-optional":new Qt(V.layout_symbol["text-optional"])}),Bh={paint:new Xi({"icon-opacity":new Xt(V.paint_symbol["icon-opacity"]),"icon-color":new Xt(V.paint_symbol["icon-color"]),"icon-halo-color":new Xt(V.paint_symbol["icon-halo-color"]),"icon-halo-width":new Xt(V.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Xt(V.paint_symbol["icon-halo-blur"]),"icon-translate":new Qt(V.paint_symbol["icon-translate"]),"icon-translate-anchor":new Qt(V.paint_symbol["icon-translate-anchor"]),"text-opacity":new Xt(V.paint_symbol["text-opacity"]),"text-color":new Xt(V.paint_symbol["text-color"],{runtimeType:Rt,getOverride:function(t){return t.textColor},hasOverride:function(t){return!!t.textColor}}),"text-halo-color":new Xt(V.paint_symbol["text-halo-color"]),"text-halo-width":new Xt(V.paint_symbol["text-halo-width"]),"text-halo-blur":new Xt(V.paint_symbol["text-halo-blur"]),"text-translate":new Qt(V.paint_symbol["text-translate"]),"text-translate-anchor":new Qt(V.paint_symbol["text-translate-anchor"])}),layout:Td},Sl=function(t){this.type=t.property.overrides?t.property.overrides.runtimeType:qt,this.defaultValue=t};Sl.prototype.evaluate=function(t){if(t.formattedSection){var e=this.defaultValue.property.overrides;if(e&&e.hasOverride(t.formattedSection))return e.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default},Sl.prototype.eachChild=function(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)},Sl.prototype.outputDefined=function(){return!1},Sl.prototype.serialize=function(){return null},jt("FormatSectionOverride",Sl,{omit:["defaultValue"]});var Sd=function(t){function e(i){t.call(this,i,Bh)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.recalculate=function(i,s){if(t.prototype.recalculate.call(this,i,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var c=this.layout.get("text-writing-mode");if(c){for(var p=[],d=0,v=c;d<v.length;d+=1){var T=v[d];p.indexOf(T)<0&&p.push(T)}this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(i,s,c,p){var d=this.layout.get(i).evaluate(s,{},c,p),v=this._unevaluatedLayout._values[i];return v.isDataDriven()||po(v.value)||!d?d:function(T,P){return P.replace(/{([^{}]+)}/g,function(A,z){return z in T?String(T[z]):""})}(s.properties,d)},e.prototype.createBucket=function(i){return new ei(i)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var i=0,s=Bh.paint.overridableProperties;i<s.length;i+=1){var c=s[i];if(e.hasPaintOverride(this.layout,c)){var p,d=this.paint.get(c),v=new Sl(d),T=new zo(v,d.property.specification);p=d.value.kind==="constant"||d.value.kind==="source"?new pn("source",T):new qn("composite",T,d.value.zoomStops,d.value._interpolationType),this.paint._values[c]=new Si(d.property,p,d.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(i,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven())&&e.hasPaintOverride(this.layout,i)},e.hasPaintOverride=function(i,s){var c=i.get("text-field"),p=Bh.paint.properties[s],d=!1,v=function(A){for(var z=0,B=A;z<B.length;z+=1)if(p.overrides&&p.overrides.hasOverride(B[z]))return void(d=!0)};if(c.value.kind==="constant"&&c.value.value instanceof bi)v(c.value.value.sections);else if(c.value.kind==="source"){var T=function(A){d||(A instanceof ai&&pi(A.value)===Be?v(A.value.sections):A instanceof Qe?v(A.sections):A.eachChild(T))},P=c.value;P._styleExpression&&T(P._styleExpression.expression)}return d},e}(ii),Pd={paint:new Xi({"background-color":new Qt(V.paint_background["background-color"]),"background-pattern":new cr(V.paint_background["background-pattern"]),"background-opacity":new Qt(V.paint_background["background-opacity"])})},Id=function(t){function e(i){t.call(this,i,Pd)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(ii),Ed={paint:new Xi({"raster-opacity":new Qt(V.paint_raster["raster-opacity"]),"raster-hue-rotate":new Qt(V.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Qt(V.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Qt(V.paint_raster["raster-brightness-max"]),"raster-saturation":new Qt(V.paint_raster["raster-saturation"]),"raster-contrast":new Qt(V.paint_raster["raster-contrast"]),"raster-resampling":new Qt(V.paint_raster["raster-resampling"]),"raster-fade-duration":new Qt(V.paint_raster["raster-fade-duration"])})},Ad=function(t){function e(i){t.call(this,i,Ed)}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e}(ii),Cd=function(t){function e(i){t.call(this,i,{}),this.implementation=i}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},e.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)},e.prototype.onRemove=function(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)},e}(ii),Ld={circle:vh,heatmap:ff,hillshade:mf,fill:kf,"fill-extrusion":Zf,line:Hf,symbol:Sd,background:Id,raster:Ad},Yc=Ct.HTMLImageElement,$c=Ct.HTMLCanvasElement,Qc=Ct.HTMLVideoElement,tp=Ct.ImageData,qu=Ct.ImageBitmap,js=function(t,e,i,s){this.context=t,this.format=i,this.texture=t.gl.createTexture(),this.update(e,s)};js.prototype.update=function(t,e,i){var s=t.width,c=t.height,p=!(this.size&&this.size[0]===s&&this.size[1]===c||i),d=this.context,v=d.gl;if(this.useMipmap=Boolean(e&&e.useMipmap),v.bindTexture(v.TEXTURE_2D,this.texture),d.pixelStoreUnpackFlipY.set(!1),d.pixelStoreUnpack.set(1),d.pixelStoreUnpackPremultiplyAlpha.set(this.format===v.RGBA&&(!e||e.premultiply!==!1)),p)this.size=[s,c],t instanceof Yc||t instanceof $c||t instanceof Qc||t instanceof tp||qu&&t instanceof qu?v.texImage2D(v.TEXTURE_2D,0,this.format,this.format,v.UNSIGNED_BYTE,t):v.texImage2D(v.TEXTURE_2D,0,this.format,s,c,0,this.format,v.UNSIGNED_BYTE,t.data);else{var T=i||{x:0,y:0},P=T.x,A=T.y;t instanceof Yc||t instanceof $c||t instanceof Qc||t instanceof tp||qu&&t instanceof qu?v.texSubImage2D(v.TEXTURE_2D,0,P,A,v.RGBA,v.UNSIGNED_BYTE,t):v.texSubImage2D(v.TEXTURE_2D,0,P,A,s,c,v.RGBA,v.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&v.generateMipmap(v.TEXTURE_2D)},js.prototype.bind=function(t,e,i){var s=this.context.gl;s.bindTexture(s.TEXTURE_2D,this.texture),i!==s.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(i=s.LINEAR),t!==this.filter&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,t),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,i||t),this.filter=t),e!==this.wrap&&(s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,e),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,e),this.wrap=e)},js.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},js.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Rh=function(t){var e=this;this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){e._triggered=!1,e._callback()})};Rh.prototype.trigger=function(){var t=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){t._triggered=!1,t._callback()},0))},Rh.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Pl=function(t,e,i){this.target=t,this.parent=e,this.mapId=i,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},To(["receive","process"],this),this.invoker=new Rh(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ti()?t:Ct};function ep(t,e,i){var s=2*Math.PI*6378137/256/Math.pow(2,i);return[t*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}Pl.prototype.send=function(t,e,i,s,c){var p=this;c===void 0&&(c=!1);var d=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(this.callbacks[d]=i);var v=xa(this.globalScope)?void 0:[];return this.target.postMessage({id:d,type:t,hasCallback:!!i,targetMapId:s,mustQueue:c,sourceMapId:this.mapId,data:fn(e,v)},v),{cancel:function(){i&&delete p.callbacks[d],p.target.postMessage({id:d,type:"<cancel>",targetMapId:s,sourceMapId:p.mapId})}}},Pl.prototype.receive=function(t){var e=t.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){delete this.tasks[i];var s=this.cancelCallbacks[i];delete this.cancelCallbacks[i],s&&s()}else Ti()||e.mustQueue?(this.tasks[i]=e,this.taskQueue.push(i),this.invoker.trigger()):this.processTask(i,e)},Pl.prototype.process=function(){if(this.taskQueue.length){var t=this.taskQueue.shift(),e=this.tasks[t];delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(t,e)}},Pl.prototype.processTask=function(t,e){var i=this;if(e.type==="<response>"){var s=this.callbacks[t];delete this.callbacks[t],s&&(e.error?s(Fr(e.error)):s(null,Fr(e.data)))}else{var c=!1,p=xa(this.globalScope)?void 0:[],d=e.hasCallback?function(A,z){c=!0,delete i.cancelCallbacks[t],i.target.postMessage({id:t,type:"<response>",sourceMapId:i.mapId,error:A?fn(A):null,data:fn(z,p)},p)}:function(A){c=!0},v=null,T=Fr(e.data);if(this.parent[e.type])v=this.parent[e.type](e.sourceMapId,T,d);else if(this.parent.getWorkerSource){var P=e.type.split(".");v=this.parent.getWorkerSource(e.sourceMapId,P[0],T.source)[P[1]](T,d)}else d(new Error("Could not find function "+e.type));!c&&v&&v.cancel&&(this.cancelCallbacks[t]=v.cancel)}},Pl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Yi=function(t,e){t&&(e?this.setSouthWest(t).setNorthEast(e):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))};Yi.prototype.setNorthEast=function(t){return this._ne=t instanceof fi?new fi(t.lng,t.lat):fi.convert(t),this},Yi.prototype.setSouthWest=function(t){return this._sw=t instanceof fi?new fi(t.lng,t.lat):fi.convert(t),this},Yi.prototype.extend=function(t){var e,i,s=this._sw,c=this._ne;if(t instanceof fi)e=t,i=t;else{if(!(t instanceof Yi))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Yi.convert(t)):this.extend(fi.convert(t)):this;if(i=t._ne,!(e=t._sw)||!i)return this}return s||c?(s.lng=Math.min(e.lng,s.lng),s.lat=Math.min(e.lat,s.lat),c.lng=Math.max(i.lng,c.lng),c.lat=Math.max(i.lat,c.lat)):(this._sw=new fi(e.lng,e.lat),this._ne=new fi(i.lng,i.lat)),this},Yi.prototype.getCenter=function(){return new fi((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Yi.prototype.getSouthWest=function(){return this._sw},Yi.prototype.getNorthEast=function(){return this._ne},Yi.prototype.getNorthWest=function(){return new fi(this.getWest(),this.getNorth())},Yi.prototype.getSouthEast=function(){return new fi(this.getEast(),this.getSouth())},Yi.prototype.getWest=function(){return this._sw.lng},Yi.prototype.getSouth=function(){return this._sw.lat},Yi.prototype.getEast=function(){return this._ne.lng},Yi.prototype.getNorth=function(){return this._ne.lat},Yi.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Yi.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Yi.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Yi.prototype.contains=function(t){var e=fi.convert(t),i=e.lng,s=e.lat,c=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(c=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&c},Yi.convert=function(t){return!t||t instanceof Yi?t:new Yi(t)};var fi=function(t,e){if(isNaN(t)||isNaN(e))throw new Error("Invalid LngLat object: ("+t+", "+e+")");if(this.lng=+t,this.lat=+e,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};fi.prototype.wrap=function(){return new fi(bo(this.lng,-180,180),this.lat)},fi.prototype.toArray=function(){return[this.lng,this.lat]},fi.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},fi.prototype.distanceTo=function(t){var e=Math.PI/180,i=this.lat*e,s=t.lat*e,c=Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos((t.lng-this.lng)*e);return 63710088e-1*Math.acos(Math.min(c,1))},fi.prototype.toBounds=function(t){t===void 0&&(t=0);var e=360*t/40075017,i=e/Math.cos(Math.PI/180*this.lat);return new Yi(new fi(this.lng-i,this.lat-e),new fi(this.lng+i,this.lat+e))},fi.convert=function(t){if(t instanceof fi)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new fi(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new fi(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var ip=2*Math.PI*63710088e-1;function rp(t){return ip*Math.cos(t*Math.PI/180)}function np(t){return(180+t)/360}function op(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function ap(t,e){return t/rp(e)}function Oh(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}var Gs=function(t,e,i){i===void 0&&(i=0),this.x=+t,this.y=+e,this.z=+i};Gs.fromLngLat=function(t,e){e===void 0&&(e=0);var i=fi.convert(t);return new Gs(np(i.lng),op(i.lat),ap(e,i.lat))},Gs.prototype.toLngLat=function(){return new fi(360*this.x-180,Oh(this.y))},Gs.prototype.toAltitude=function(){return this.z*rp(Oh(this.y))},Gs.prototype.meterInMercatorCoordinateUnits=function(){return 1/ip*(t=Oh(this.y),1/Math.cos(t*Math.PI/180));var t};var Ws=function(t,e,i){this.z=t,this.x=e,this.y=i,this.key=ou(0,t,t,e,i)};Ws.prototype.equals=function(t){return this.z===t.z&&this.x===t.x&&this.y===t.y},Ws.prototype.url=function(t,e){var i,s,c,p,d,v=(s=this.y,c=this.z,p=ep(256*(i=this.x),256*(s=Math.pow(2,c)-s-1),c),d=ep(256*(i+1),256*(s+1),c),p[0]+","+p[1]+","+d[0]+","+d[1]),T=function(P,A,z){for(var B,F="",H=P;H>0;H--)F+=(A&(B=1<<H-1)?1:0)+(z&B?2:0);return F}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(e==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",T).replace("{bbox-epsg-3857}",v)},Ws.prototype.getTilePoint=function(t){var e=Math.pow(2,this.z);return new Vt(8192*(t.x*e-this.x),8192*(t.y*e-this.y))},Ws.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var sp=function(t,e){this.wrap=t,this.canonical=e,this.key=ou(t,e.z,e.z,e.x,e.y)},$i=function(t,e,i,s,c){this.overscaledZ=t,this.wrap=e,this.canonical=new Ws(i,+s,+c),this.key=ou(e,t,i,s,c)};function ou(t,e,i,s,c){(t*=2)<0&&(t=-1*t-1);var p=1<<i;return(p*p*t+p*c+s).toString(36)+i.toString(36)+e.toString(36)}$i.prototype.equals=function(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)},$i.prototype.scaledTo=function(t){var e=this.canonical.z-t;return t>this.canonical.z?new $i(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new $i(t,this.wrap,t,this.canonical.x>>e,this.canonical.y>>e)},$i.prototype.calculateScaledKey=function(t,e){var i=this.canonical.z-t;return t>this.canonical.z?ou(this.wrap*+e,t,this.canonical.z,this.canonical.x,this.canonical.y):ou(this.wrap*+e,t,t,this.canonical.x>>i,this.canonical.y>>i)},$i.prototype.isChildOf=function(t){if(t.wrap!==this.wrap)return!1;var e=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>e&&t.canonical.y===this.canonical.y>>e},$i.prototype.children=function(t){if(this.overscaledZ>=t)return[new $i(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var e=this.canonical.z+1,i=2*this.canonical.x,s=2*this.canonical.y;return[new $i(e,this.wrap,e,i,s),new $i(e,this.wrap,e,i+1,s),new $i(e,this.wrap,e,i,s+1),new $i(e,this.wrap,e,i+1,s+1)]},$i.prototype.isLessThan=function(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))},$i.prototype.wrapped=function(){return new $i(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},$i.prototype.unwrapTo=function(t){return new $i(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)},$i.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},$i.prototype.toUnwrapped=function(){return new sp(this.wrap,this.canonical)},$i.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},$i.prototype.getTilePoint=function(t){return this.canonical.getTilePoint(new Gs(t.x-this.wrap,t.y))},jt("CanonicalTileID",Ws),jt("OverscaledTileID",$i,{omit:["posMatrix"]});var Fa=function(t,e,i){if(this.uid=t,e.height!==e.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return _i('"'+i+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=e.height;var s=this.dim=e.height-2;this.data=new Uint32Array(e.data.buffer),this.encoding=i||"mapbox";for(var c=0;c<s;c++)this.data[this._idx(-1,c)]=this.data[this._idx(0,c)],this.data[this._idx(s,c)]=this.data[this._idx(s-1,c)],this.data[this._idx(c,-1)]=this.data[this._idx(c,0)],this.data[this._idx(c,s)]=this.data[this._idx(c,s-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(s,-1)]=this.data[this._idx(s-1,0)],this.data[this._idx(-1,s)]=this.data[this._idx(0,s-1)],this.data[this._idx(s,s)]=this.data[this._idx(s-1,s-1)]};Fa.prototype.get=function(t,e){var i=new Uint8Array(this.data.buffer),s=4*this._idx(t,e);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(i[s],i[s+1],i[s+2])},Fa.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Fa.prototype._idx=function(t,e){if(t<-1||t>=this.dim+1||e<-1||e>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(e+1)*this.stride+(t+1)},Fa.prototype._unpackMapbox=function(t,e,i){return(256*t*256+256*e+i)/10-1e4},Fa.prototype._unpackTerrarium=function(t,e,i){return 256*t+e+i/256-32768},Fa.prototype.getPixels=function(){return new _n({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Fa.prototype.backfillBorder=function(t,e,i){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");var s=e*this.dim,c=e*this.dim+this.dim,p=i*this.dim,d=i*this.dim+this.dim;switch(e){case-1:s=c-1;break;case 1:c=s+1}switch(i){case-1:p=d-1;break;case 1:d=p+1}for(var v=-e*this.dim,T=-i*this.dim,P=p;P<d;P++)for(var A=s;A<c;A++)this.data[this._idx(A,P)]=t.data[this._idx(A+v,P+T)]},jt("DEMData",Fa);var ju=function(t){this._stringToNumber={},this._numberToString=[];for(var e=0;e<t.length;e++){var i=t[e];this._stringToNumber[i]=e,this._numberToString[e]=i}};ju.prototype.encode=function(t){return this._stringToNumber[t]},ju.prototype.decode=function(t){return this._numberToString[t]};var Gu=function(t,e,i,s,c){this.type="Feature",this._vectorTileFeature=t,t._z=e,t._x=i,t._y=s,this.properties=t.properties,this.id=c},Fh={geometry:{configurable:!0}};Fh.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Fh.geometry.set=function(t){this._geometry=t},Gu.prototype.toJSON=function(){var t={geometry:this.geometry};for(var e in this)e!=="_geometry"&&e!=="_vectorTileFeature"&&(t[e]=this[e]);return t},Object.defineProperties(Gu.prototype,Fh);var Il=function(){this.state={},this.stateChanges={},this.deletedStates={}};Il.prototype.updateState=function(t,e,i){var s=String(e);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][s]=this.stateChanges[t][s]||{},ki(this.stateChanges[t][s],i),this.deletedStates[t]===null)for(var c in this.deletedStates[t]={},this.state[t])c!==s&&(this.deletedStates[t][c]=null);else if(this.deletedStates[t]&&this.deletedStates[t][s]===null)for(var p in this.deletedStates[t][s]={},this.state[t][s])i[p]||(this.deletedStates[t][s][p]=null);else for(var d in i)this.deletedStates[t]&&this.deletedStates[t][s]&&this.deletedStates[t][s][d]===null&&delete this.deletedStates[t][s][d]},Il.prototype.removeFeatureState=function(t,e,i){if(this.deletedStates[t]!==null){var s=String(e);if(this.deletedStates[t]=this.deletedStates[t]||{},i&&e!==void 0)this.deletedStates[t][s]!==null&&(this.deletedStates[t][s]=this.deletedStates[t][s]||{},this.deletedStates[t][s][i]=null);else if(e!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][s])for(i in this.deletedStates[t][s]={},this.stateChanges[t][s])this.deletedStates[t][s][i]=null;else this.deletedStates[t][s]=null;else this.deletedStates[t]=null}},Il.prototype.getState=function(t,e){var i=String(e),s=ki({},(this.state[t]||{})[i],(this.stateChanges[t]||{})[i]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){var c=this.deletedStates[t][e];if(c===null)return{};for(var p in c)delete s[p]}return s},Il.prototype.initializeTileState=function(t,e){t.setFeatureState(this.state,e)},Il.prototype.coalesceChanges=function(t,e){var i={};for(var s in this.stateChanges){this.state[s]=this.state[s]||{};var c={};for(var p in this.stateChanges[s])this.state[s][p]||(this.state[s][p]={}),ki(this.state[s][p],this.stateChanges[s][p]),c[p]=this.state[s][p];i[s]=c}for(var d in this.deletedStates){this.state[d]=this.state[d]||{};var v={};if(this.deletedStates[d]===null)for(var T in this.state[d])v[T]={},this.state[d][T]={};else for(var P in this.deletedStates[d]){if(this.deletedStates[d][P]===null)this.state[d][P]={};else for(var A=0,z=Object.keys(this.deletedStates[d][P]);A<z.length;A+=1)delete this.state[d][P][z[A]];v[P]=this.state[d][P]}i[d]=i[d]||{},ki(i[d],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(var B in t)t[B].setFeatureState(i,e)};var Ua=function(t,e){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Gn(8192,16,0),this.grid3D=new Gn(8192,16,0),this.featureIndexArray=new k,this.promoteId=e};function lp(t,e,i,s,c){return Qi(t,function(p,d){var v=e instanceof Oo?e.get(d):null;return v&&v.evaluate?v.evaluate(i,s,c):v})}function up(t){for(var e=1/0,i=1/0,s=-1/0,c=-1/0,p=0,d=t;p<d.length;p+=1){var v=d[p];e=Math.min(e,v.x),i=Math.min(i,v.y),s=Math.max(s,v.x),c=Math.max(c,v.y)}return{minX:e,minY:i,maxX:s,maxY:c}}function zd(t,e){return e-t}Ua.prototype.insert=function(t,e,i,s,c,p){var d=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,s,c);for(var v=p?this.grid3D:this.grid,T=0;T<e.length;T++){for(var P=e[T],A=[1/0,1/0,-1/0,-1/0],z=0;z<P.length;z++){var B=P[z];A[0]=Math.min(A[0],B.x),A[1]=Math.min(A[1],B.y),A[2]=Math.max(A[2],B.x),A[3]=Math.max(A[3],B.y)}A[0]<8192&&A[1]<8192&&A[2]>=0&&A[3]>=0&&v.insert(d,A[0],A[1],A[2],A[3])}},Ua.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new _l.VectorTile(new Mu(this.rawTileData)).layers,this.sourceLayerCoder=new ju(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Ua.prototype.query=function(t,e,i,s){var c=this;this.loadVTLayers();for(var p=t.params||{},d=8192/t.tileSize/t.scale,v=Jo(p.filter),T=t.queryGeometry,P=t.queryPadding*d,A=up(T),z=this.grid.query(A.minX-P,A.minY-P,A.maxX+P,A.maxY+P),B=up(t.cameraQueryGeometry),F=this.grid3D.query(B.minX-P,B.minY-P,B.maxX+P,B.maxY+P,function(ft,mt,Tt,Lt){return function(Dt,$t,Ut,ee,Nt){for(var xe=0,le=Dt;xe<le.length;xe+=1){var Jt=le[xe];if($t<=Jt.x&&Ut<=Jt.y&&ee>=Jt.x&&Nt>=Jt.y)return!0}var Pe=[new Vt($t,Ut),new Vt($t,Nt),new Vt(ee,Nt),new Vt(ee,Ut)];if(Dt.length>2){for(var _e=0,ze=Pe;_e<ze.length;_e+=1)if(go(Dt,ze[_e]))return!0}for(var re=0;re<Dt.length-1;re++)if(Zs(Dt[re],Dt[re+1],Pe))return!0;return!1}(t.cameraQueryGeometry,ft-P,mt-P,Tt+P,Lt+P)}),H=0,X=F;H<X.length;H+=1)z.push(X[H]);z.sort(zd);for(var et,$={},lt=function(ft){var mt=z[ft];if(mt!==et){et=mt;var Tt=c.featureIndexArray.get(mt),Lt=null;c.loadMatchingFeature($,Tt.bucketIndex,Tt.sourceLayerIndex,Tt.featureIndex,v,p.layers,p.availableImages,e,i,s,function(Dt,$t,Ut){return Lt||(Lt=Pi(Dt)),$t.queryIntersectsFeature(T,Dt,Ut,Lt,c.z,t.transform,d,t.pixelPosMatrix)})}},ct=0;ct<z.length;ct++)lt(ct);return $},Ua.prototype.loadMatchingFeature=function(t,e,i,s,c,p,d,v,T,P,A){var z=this.bucketLayerIDs[e];if(!p||function(Dt,$t){for(var Ut=0;Ut<Dt.length;Ut++)if($t.indexOf(Dt[Ut])>=0)return!0;return!1}(p,z)){var B=this.sourceLayerCoder.decode(i),F=this.vtLayers[B].feature(s);if(c.needGeometry){var H=Mi(F,!0);if(!c.filter(new xt(this.tileID.overscaledZ),H,this.tileID.canonical))return}else if(!c.filter(new xt(this.tileID.overscaledZ),F))return;for(var X=this.getId(F,B),et=0;et<z.length;et++){var $=z[et];if(!(p&&p.indexOf($)<0)){var lt=v[$];if(lt){var ct={};X!==void 0&&P&&(ct=P.getState(lt.sourceLayer||"_geojsonTileLayer",X));var ft=ki({},T[$]);ft.paint=lp(ft.paint,lt.paint,F,ct,d),ft.layout=lp(ft.layout,lt.layout,F,ct,d);var mt=!A||A(F,lt,ct);if(mt){var Tt=new Gu(F,this.z,this.x,this.y,X);Tt.layer=ft;var Lt=t[$];Lt===void 0&&(Lt=t[$]=[]),Lt.push({featureIndex:s,feature:Tt,intersectionZ:mt})}}}}}},Ua.prototype.lookupSymbolFeatures=function(t,e,i,s,c,p,d,v){var T={};this.loadVTLayers();for(var P=Jo(c),A=0,z=t;A<z.length;A+=1)this.loadMatchingFeature(T,i,s,z[A],P,p,d,v,e);return T},Ua.prototype.hasLayer=function(t){for(var e=0,i=this.bucketLayerIDs;e<i.length;e+=1)for(var s=0,c=i[e];s<c.length;s+=1)if(t===c[s])return!0;return!1},Ua.prototype.getId=function(t,e){var i=t.id;return this.promoteId&&typeof(i=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[e]])=="boolean"&&(i=Number(i)),i},jt("FeatureIndex",Ua,{omit:["rawTileData","sourceLayerCoder"]});var fr=function(t,e){this.tileID=t,this.uid=wo(),this.uses=0,this.tileSize=e,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};fr.prototype.registerFadeDuration=function(t){var e=t+this.timeAdded;e<_r.now()||this.fadeEndTime&&e<this.fadeEndTime||(this.fadeEndTime=e)},fr.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},fr.prototype.loadVectorData=function(t,e,i){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){for(var s in t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(P,A){var z={};if(!A)return z;for(var B=function(){var X=H[F],et=X.layerIds.map(function(ct){return A.getLayer(ct)}).filter(Boolean);if(et.length!==0){X.layers=et,X.stateDependentLayerIds&&(X.stateDependentLayers=X.stateDependentLayerIds.map(function(ct){return et.filter(function(ft){return ft.id===ct})[0]}));for(var $=0,lt=et;$<lt.length;$+=1)z[lt[$].id]=X}},F=0,H=P;F<H.length;F+=1)B();return z}(t.buckets,e.style),this.hasSymbolBuckets=!1,this.buckets){var c=this.buckets[s];if(c instanceof ei){if(this.hasSymbolBuckets=!0,!i)break;c.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var p in this.buckets){var d=this.buckets[p];if(d instanceof ei&&d.hasRTLText){this.hasRTLText=!0,wt.isLoading()||wt.isLoaded()||rt()!=="deferred"||pt();break}}for(var v in this.queryPadding=0,this.buckets){var T=this.buckets[v];this.queryPadding=Math.max(this.queryPadding,e.style.getLayer(v).queryRadius(T))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new a},fr.prototype.unloadVectorData=function(){for(var t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},fr.prototype.getBucket=function(t){return this.buckets[t.id]},fr.prototype.upload=function(t){for(var e in this.buckets){var i=this.buckets[e];i.uploadPending()&&i.upload(t)}var s=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new js(t,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new js(t,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)},fr.prototype.prepare=function(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)},fr.prototype.queryRenderedFeatures=function(t,e,i,s,c,p,d,v,T,P){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:s,cameraQueryGeometry:c,scale:p,tileSize:this.tileSize,pixelPosMatrix:P,transform:v,params:d,queryPadding:this.queryPadding*T},t,e,i):{}},fr.prototype.querySourceFeatures=function(t,e){var i=this.latestFeatureIndex;if(i&&i.rawTileData){var s=i.loadVTLayers(),c=e?e.sourceLayer:"",p=s._geojsonTileLayer||s[c];if(p)for(var d=Jo(e&&e.filter),v=this.tileID.canonical,T=v.z,P=v.x,A=v.y,z={z:T,x:P,y:A},B=0;B<p.length;B++){var F=p.feature(B);if(d.needGeometry){var H=Mi(F,!0);if(!d.filter(new xt(this.tileID.overscaledZ),H,this.tileID.canonical))continue}else if(!d.filter(new xt(this.tileID.overscaledZ),F))continue;var X=i.getId(F,c),et=new Gu(F,T,P,A,X);et.tile=z,t.push(et)}}},fr.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},fr.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},fr.prototype.setExpiryData=function(t){var e=this.expirationTime;if(t.cacheControl){var i=Sn(t.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){var s=Date.now(),c=!1;if(this.expirationTime>s)c=!1;else if(e)if(this.expirationTime<e)c=!0;else{var p=this.expirationTime-e;p?this.expirationTime=s+Math.max(p,3e4):c=!0}else c=!0;c?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},fr.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},fr.prototype.setFeatureState=function(t,e){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(t).length!==0){var i=this.latestFeatureIndex.loadVTLayers();for(var s in this.buckets)if(e.style.hasLayer(s)){var c=this.buckets[s],p=c.layers[0].sourceLayer||"_geojsonTileLayer",d=i[p],v=t[p];if(d&&v&&Object.keys(v).length!==0){c.update(v,d,this.imageAtlas&&this.imageAtlas.patternPositions||{});var T=e&&e.style&&e.style.getLayer(s);T&&(this.queryPadding=Math.max(this.queryPadding,T.queryRadius(c)))}}}},fr.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},fr.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<_r.now()},fr.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},fr.prototype.setHoldDuration=function(t){this.symbolFadeHoldUntil=_r.now()+t},fr.prototype.setDependencies=function(t,e){for(var i={},s=0,c=e;s<c.length;s+=1)i[c[s]]=!0;this.dependencies[t]=i},fr.prototype.hasDependency=function(t,e){for(var i=0,s=t;i<s.length;i+=1){var c=this.dependencies[s[i]];if(c){for(var p=0,d=e;p<d.length;p+=1)if(c[d[p]])return!0}}return!1};var _s=Ct.performance,hp=function(t){this._marks={start:[t.url,"start"].join("#"),end:[t.url,"end"].join("#"),measure:t.url.toString()},_s.mark(this._marks.start)};hp.prototype.finish=function(){_s.mark(this._marks.end);var t=_s.getEntriesByName(this._marks.measure);return t.length===0&&(_s.measure(this._marks.measure,this._marks.start,this._marks.end),t=_s.getEntriesByName(this._marks.measure),_s.clearMarks(this._marks.start),_s.clearMarks(this._marks.end),_s.clearMeasures(this._marks.measure)),t},u.Actor=Pl,u.AlphaImage=qs,u.CanonicalTileID=Ws,u.CollisionBoxArray=a,u.Color=se,u.DEMData=Fa,u.DataConstantProperty=Qt,u.DictionaryCoder=ju,u.EXTENT=8192,u.ErrorEvent=it,u.EvaluationParameters=xt,u.Event=W,u.Evented=at,u.FeatureIndex=Ua,u.FillBucket=No,u.FillExtrusionBucket=Zo,u.ImageAtlas=ru,u.ImagePosition=Bu,u.LineBucket=nn,u.LngLat=fi,u.LngLatBounds=Yi,u.MercatorCoordinate=Gs,u.ONE_EM=24,u.OverscaledTileID=$i,u.Point=Vt,u.Point$1=Vt,u.Properties=Xi,u.Protobuf=Mu,u.RGBAImage=_n,u.RequestManager=yr,u.RequestPerformance=hp,u.ResourceType=Ga,u.SegmentVector=Z,u.SourceFeatureState=Il,u.StructArrayLayout1ui2=Xl,u.StructArrayLayout2f1f2i16=Da,u.StructArrayLayout2i4=_o,u.StructArrayLayout3ui6=la,u.StructArrayLayout4i8=Rs,u.SymbolBucket=ei,u.Texture=js,u.Tile=fr,u.Transitionable=me,u.Uniform1f=kt,u.Uniform1i=Pt,u.Uniform2f=zt,u.Uniform3f=Zt,u.Uniform4f=te,u.UniformColor=oe,u.UniformMatrix4f=Me,u.UnwrappedTileID=sp,u.ValidationError=Y,u.WritingMode=Dn,u.ZoomHistory=is,u.add=function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t},u.addDynamicAttributes=Dh,u.asyncAll=function(t,e,i){if(!t.length)return i(null,[]);var s=t.length,c=new Array(t.length),p=null;t.forEach(function(d,v){e(d,function(T,P){T&&(p=T),c[v]=P,--s==0&&i(p,c)})})},u.bezier=oi,u.bindAll=To,u.browser=_r,u.cacheEntryPossiblyAdded=function(t){++vr>wa&&(t.getActor().send("enforceCacheSizeLimit",So),vr=0)},u.clamp=lr,u.clearTileCache=function(t){var e=Ct.caches.delete("mapbox-tiles");t&&e.catch(t).then(function(){return t()})},u.clipLine=Gc,u.clone=function(t){var e=new Ge(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},u.clone$1=li,u.clone$2=function(t){var e=new Ge(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},u.collisionCircleLayout=Yf,u.config=Ke,u.create=function(){var t=new Ge(16);return Ge!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},u.create$1=function(){var t=new Ge(9);return Ge!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},u.create$2=function(){var t=new Ge(4);return Ge!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},u.createCommonjsModule=Et,u.createExpression=Ya,u.createLayout=Ki,u.createStyleLayer=function(t){return t.type==="custom"?new Cd(t):new Ld[t.type](t)},u.cross=function(t,e,i){var s=e[0],c=e[1],p=e[2],d=i[0],v=i[1],T=i[2];return t[0]=c*T-p*v,t[1]=p*d-s*T,t[2]=s*v-c*d,t},u.deepEqual=function t(e,i){if(Array.isArray(e)){if(!Array.isArray(i)||e.length!==i.length)return!1;for(var s=0;s<e.length;s++)if(!t(e[s],i[s]))return!1;return!0}if(typeof e=="object"&&e!==null&&i!==null){if(typeof i!="object"||Object.keys(e).length!==Object.keys(i).length)return!1;for(var c in e)if(!t(e[c],i[c]))return!1;return!0}return e===i},u.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},u.dot$1=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},u.ease=Je,u.emitValidationErrors=oa,u.endsWith=Xn,u.enforceCacheSizeLimit=function(t){Qn(),ln&&ln.then(function(e){e.keys().then(function(i){for(var s=0;s<i.length-t;s++)e.delete(i[s])})})},u.evaluateSizeForFeature=Uc,u.evaluateSizeForZoom=Nc,u.evaluateVariableOffset=Xc,u.evented=N,u.extend=ki,u.featureFilter=Jo,u.filterObject=Tn,u.fromRotation=function(t,e){var i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=i,t[2]=0,t[3]=-i,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},u.getAnchorAlignment=Lh,u.getAnchorJustification=Mh,u.getArrayBuffer=Ta,u.getImage=D,u.getJSON=function(t,e){return Io(ki(t,{type:"json"}),e)},u.getRTLTextPluginStatus=rt,u.getReferrer=Rr,u.getVideo=function(t,e){var i,s,c=Ct.document.createElement("video");c.muted=!0,c.onloadstart=function(){e(null,c)};for(var p=0;p<t.length;p++){var d=Ct.document.createElement("source");i=t[p],s=void 0,(s=Ct.document.createElement("a")).href=i,(s.protocol!==Ct.document.location.protocol||s.host!==Ct.document.location.host)&&(c.crossOrigin="Anonymous"),d.src=t[p],c.appendChild(d)}return{cancel:function(){}}},u.identity=bn,u.invert=function(t,e){var i=e[0],s=e[1],c=e[2],p=e[3],d=e[4],v=e[5],T=e[6],P=e[7],A=e[8],z=e[9],B=e[10],F=e[11],H=e[12],X=e[13],et=e[14],$=e[15],lt=i*v-s*d,ct=i*T-c*d,ft=i*P-p*d,mt=s*T-c*v,Tt=s*P-p*v,Lt=c*P-p*T,Dt=A*X-z*H,$t=A*et-B*H,Ut=A*$-F*H,ee=z*et-B*X,Nt=z*$-F*X,xe=B*$-F*et,le=lt*xe-ct*Nt+ft*ee+mt*Ut-Tt*$t+Lt*Dt;return le?(t[0]=(v*xe-T*Nt+P*ee)*(le=1/le),t[1]=(c*Nt-s*xe-p*ee)*le,t[2]=(X*Lt-et*Tt+$*mt)*le,t[3]=(B*Tt-z*Lt-F*mt)*le,t[4]=(T*Ut-d*xe-P*$t)*le,t[5]=(i*xe-c*Ut+p*$t)*le,t[6]=(et*ft-H*Lt-$*ct)*le,t[7]=(A*Lt-B*ft+F*ct)*le,t[8]=(d*Nt-v*Ut+P*Dt)*le,t[9]=(s*Ut-i*Nt-p*Dt)*le,t[10]=(H*Tt-X*ft+$*lt)*le,t[11]=(z*ft-A*Tt-F*lt)*le,t[12]=(v*$t-d*ee-T*Dt)*le,t[13]=(i*ee-s*$t+c*Dt)*le,t[14]=(X*ct-H*mt-et*lt)*le,t[15]=(A*mt-z*ct+B*lt)*le,t):null},u.isChar=Bt,u.isMapboxURL=Wr,u.keysDifference=function(t,e){var i=[];for(var s in t)s in e||i.push(s);return i},u.makeRequest=Io,u.mapObject=Qi,u.mercatorXfromLng=np,u.mercatorYfromLat=op,u.mercatorZfromAltitude=ap,u.mul=gh,u.multiply=rn,u.mvt=_l,u.nextPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},u.normalize=function(t,e){var i=e[0],s=e[1],c=e[2],p=i*i+s*s+c*c;return p>0&&(p=1/Math.sqrt(p)),t[0]=e[0]*p,t[1]=e[1]*p,t[2]=e[2]*p,t},u.number=wi,u.offscreenCanvasSupported=En,u.ortho=function(t,e,i,s,c,p,d){var v=1/(e-i),T=1/(s-c),P=1/(p-d);return t[0]=-2*v,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*T,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*P,t[11]=0,t[12]=(e+i)*v,t[13]=(c+s)*T,t[14]=(d+p)*P,t[15]=1,t},u.parseGlyphPBF=function(t){return new Mu(t).readFields(ld,[])},u.pbf=Mu,u.performSymbolLayout=function(t,e,i,s,c,p,d){t.createArrays(),t.tilePixelRatio=8192/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;var v=t.layers[0].layout,T=t.layers[0]._unevaluatedLayout._values,P={};if(t.textSizeData.kind==="composite"){var A=t.textSizeData,z=A.maxZoom;P.compositeTextSizes=[T["text-size"].possiblyEvaluate(new xt(A.minZoom),d),T["text-size"].possiblyEvaluate(new xt(z),d)]}if(t.iconSizeData.kind==="composite"){var B=t.iconSizeData,F=B.maxZoom;P.compositeIconSizes=[T["icon-size"].possiblyEvaluate(new xt(B.minZoom),d),T["icon-size"].possiblyEvaluate(new xt(F),d)]}P.layoutTextSize=T["text-size"].possiblyEvaluate(new xt(t.zoom+1),d),P.layoutIconSize=T["icon-size"].possiblyEvaluate(new xt(t.zoom+1),d),P.textMaxSize=T["text-size"].possiblyEvaluate(new xt(18));for(var H=24*v.get("text-line-height"),X=v.get("text-rotation-alignment")==="map"&&v.get("symbol-placement")!=="point",et=v.get("text-keep-upright"),$=v.get("text-size"),lt=function(){var mt=ft[ct],Tt=v.get("text-font").evaluate(mt,{},d).join(","),Lt=$.evaluate(mt,{},d),Dt=P.layoutTextSize.evaluate(mt,{},d),$t=P.layoutIconSize.evaluate(mt,{},d),Ut={horizontal:{},vertical:void 0},ee=mt.text,Nt=[0,0];if(ee){var xe=ee.toString(),le=24*v.get("text-letter-spacing").evaluate(mt,{},d),Jt=function(Ae){for(var ri=0,Ye=Ae;ri<Ye.length;ri+=1)if(De=Ye[ri].charCodeAt(0),Bt.Arabic(De)||Bt["Arabic Supplement"](De)||Bt["Arabic Extended-A"](De)||Bt["Arabic Presentation Forms-A"](De)||Bt["Arabic Presentation Forms-B"](De))return!1;var De;return!0}(xe)?le:0,Pe=v.get("text-anchor").evaluate(mt,{},d),_e=v.get("text-variable-anchor");if(!_e){var ze=v.get("text-radial-offset").evaluate(mt,{},d);Nt=ze?Xc(Pe,[24*ze,kh]):v.get("text-offset").evaluate(mt,{},d).map(function(Ae){return 24*Ae})}var re=X?"center":v.get("text-justify").evaluate(mt,{},d),Ne=v.get("symbol-placement"),di=Ne==="point"?24*v.get("text-max-width").evaluate(mt,{},d):0,Li=function(){t.allowVerticalPlacement&&rs(xe)&&(Ut.vertical=Ru(ee,e,i,c,Tt,di,H,Pe,"left",Jt,Nt,Dn.vertical,!0,Ne,Dt,Lt))};if(!X&&_e){for(var Ii=re==="auto"?_e.map(function(Ae){return Mh(Ae)}):[re],mi=!1,zi=0;zi<Ii.length;zi++){var or=Ii[zi];if(!Ut.horizontal[or])if(mi)Ut.horizontal[or]=Ut.horizontal[0];else{var ar=Ru(ee,e,i,c,Tt,di,H,"center",or,Jt,Nt,Dn.horizontal,!1,Ne,Dt,Lt);ar&&(Ut.horizontal[or]=ar,mi=ar.positionedLines.length===1)}}Li()}else{re==="auto"&&(re=Mh(Pe));var qr=Ru(ee,e,i,c,Tt,di,H,Pe,re,Jt,Nt,Dn.horizontal,!1,Ne,Dt,Lt);qr&&(Ut.horizontal[re]=qr),Li(),rs(xe)&&X&&et&&(Ut.vertical=Ru(ee,e,i,c,Tt,di,H,Pe,re,Jt,Nt,Dn.vertical,!1,Ne,Dt,Lt))}}var dr=void 0,jr=!1;if(mt.icon&&mt.icon.name){var Di=s[mt.icon.name];Di&&(dr=function(Ae,ri,Ye){var De=Lh(Ye),on=ri[0]-Ae.displaySize[0]*De.horizontalAlign,Mr=ri[1]-Ae.displaySize[1]*De.verticalAlign;return{image:Ae,top:Mr,bottom:Mr+Ae.displaySize[1],left:on,right:on+Ae.displaySize[0]}}(c[mt.icon.name],v.get("icon-offset").evaluate(mt,{},d),v.get("icon-anchor").evaluate(mt,{},d)),jr=Di.sdf,t.sdfIcons===void 0?t.sdfIcons=Di.sdf:t.sdfIcons!==Di.sdf&&_i("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Di.pixelRatio!==t.pixelRatio||v.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}var mr=Jc(Ut.horizontal)||Ut.vertical;t.iconsInText=!!mr&&mr.iconsInText,(mr||dr)&&function(Ae,ri,Ye,De,on,Mr,ci,qi,Dr,Ze,da){var Bn=Mr.textMaxSize.evaluate(ri,{});Bn===void 0&&(Bn=ci);var ma,Bi=Ae.layers[0].layout,_a=Bi.get("icon-offset").evaluate(ri,{},da),xo=Jc(Ye.horizontal),El=ci/24,Hs=Ae.tilePixelRatio*El,Al=Ae.tilePixelRatio*Bn/24,Na=Ae.tilePixelRatio*qi,Cl=Ae.tilePixelRatio*Bi.get("symbol-spacing"),Wu=Bi.get("text-padding")*Ae.tilePixelRatio,Ll=Bi.get("icon-padding")*Ae.tilePixelRatio,au=Bi.get("text-max-angle")/180*Math.PI,Hu=Bi.get("text-rotation-alignment")==="map"&&Bi.get("symbol-placement")!=="point",Xu=Bi.get("icon-rotation-alignment")==="map"&&Bi.get("symbol-placement")!=="point",Za=Bi.get("symbol-placement"),su=Cl/2,zl=Bi.get("icon-text-fit");De&&zl!=="none"&&(Ae.allowVerticalPlacement&&Ye.vertical&&(ma=Fc(De,Ye.vertical,zl,Bi.get("icon-text-fit-padding"),_a,El)),xo&&(De=Fc(De,xo,zl,Bi.get("icon-text-fit-padding"),_a,El)));var ys=function(kd,mu){mu.x<0||mu.x>=8192||mu.y<0||mu.y>=8192||function(Ri,Vo,Md,gs,Vh,fp,th,ya,eh,_u,ih,rh,qh,dp,yu,mp,_p,yp,gp,vp,Rn,nh,xp,ga,Dd){var bp,Ks,Rl,Ol,Fl,Ul=Ri.addToLineVertexArray(Vo,Md),wp=0,Tp=0,Sp=0,Pp=0,jh=-1,Gh=-1,Va={},Ip=G(""),Wh=0,Hh=0;if(ya._unevaluatedLayout.getValue("text-radial-offset")===void 0?(Wh=(bp=ya.layout.get("text-offset").evaluate(Rn,{},ga).map(function(vu){return 24*vu}))[0],Hh=bp[1]):(Wh=24*ya.layout.get("text-radial-offset").evaluate(Rn,{},ga),Hh=kh),Ri.allowVerticalPlacement&&gs.vertical){var Ep=ya.layout.get("text-rotate").evaluate(Rn,{},ga)+90;Ol=new Zu(eh,Vo,_u,ih,rh,gs.vertical,qh,dp,yu,Ep),th&&(Fl=new Zu(eh,Vo,_u,ih,rh,th,_p,yp,yu,Ep))}if(Vh){var Xh=ya.layout.get("icon-rotate").evaluate(Rn,{}),Ap=ya.layout.get("icon-text-fit")!=="none",Cp=Wc(Vh,Xh,xp,Ap),Kh=th?Wc(th,Xh,xp,Ap):void 0;Rl=new Zu(eh,Vo,_u,ih,rh,Vh,_p,yp,!1,Xh),wp=4*Cp.length;var Lp=Ri.iconSizeData,gu=null;Lp.kind==="source"?(gu=[128*ya.layout.get("icon-size").evaluate(Rn,{})])[0]>32640&&_i(Ri.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Lp.kind==="composite"&&((gu=[128*nh.compositeIconSizes[0].evaluate(Rn,{},ga),128*nh.compositeIconSizes[1].evaluate(Rn,{},ga)])[0]>32640||gu[1]>32640)&&_i(Ri.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ri.addSymbols(Ri.icon,Cp,gu,vp,gp,Rn,!1,Vo,Ul.lineStartIndex,Ul.lineLength,-1,ga),jh=Ri.icon.placedSymbolArray.length-1,Kh&&(Tp=4*Kh.length,Ri.addSymbols(Ri.icon,Kh,gu,vp,gp,Rn,Dn.vertical,Vo,Ul.lineStartIndex,Ul.lineLength,-1,ga),Gh=Ri.icon.placedSymbolArray.length-1)}for(var zp in gs.horizontal){var oh=gs.horizontal[zp];if(!Ks){Ip=G(oh.text);var Bd=ya.layout.get("text-rotate").evaluate(Rn,{},ga);Ks=new Zu(eh,Vo,_u,ih,rh,oh,qh,dp,yu,Bd)}var kp=oh.positionedLines.length===1;if(Sp+=Kc(Ri,Vo,oh,fp,ya,yu,Rn,mp,Ul,gs.vertical?Dn.horizontal:Dn.horizontalOnly,kp?Object.keys(gs.horizontal):[zp],Va,jh,nh,ga),kp)break}gs.vertical&&(Pp+=Kc(Ri,Vo,gs.vertical,fp,ya,yu,Rn,mp,Ul,Dn.vertical,["vertical"],Va,Gh,nh,ga));var Rd=Ks?Ks.boxStartIndex:Ri.collisionBoxArray.length,Od=Ks?Ks.boxEndIndex:Ri.collisionBoxArray.length,Fd=Ol?Ol.boxStartIndex:Ri.collisionBoxArray.length,Ud=Ol?Ol.boxEndIndex:Ri.collisionBoxArray.length,Nd=Rl?Rl.boxStartIndex:Ri.collisionBoxArray.length,Zd=Rl?Rl.boxEndIndex:Ri.collisionBoxArray.length,Vd=Fl?Fl.boxStartIndex:Ri.collisionBoxArray.length,qd=Fl?Fl.boxEndIndex:Ri.collisionBoxArray.length,va=-1,ah=function(vu,Dp){return vu&&vu.circleDiameter?Math.max(vu.circleDiameter,Dp):Dp};va=ah(Ks,va),va=ah(Ol,va),va=ah(Rl,va);var Mp=(va=ah(Fl,va))>-1?1:0;Mp&&(va*=Dd/24),Ri.glyphOffsetArray.length>=ei.MAX_GLYPHS&&_i("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Rn.sortKey!==void 0&&Ri.addToSortKeyRanges(Ri.symbolInstances.length,Rn.sortKey),Ri.symbolInstances.emplaceBack(Vo.x,Vo.y,Va.right>=0?Va.right:-1,Va.center>=0?Va.center:-1,Va.left>=0?Va.left:-1,Va.vertical||-1,jh,Gh,Ip,Rd,Od,Fd,Ud,Nd,Zd,Vd,qd,_u,Sp,Pp,wp,Tp,Mp,0,qh,Wh,Hh,va)}(Ae,mu,kd,Ye,De,on,ma,Ae.layers[0],Ae.collisionBoxArray,ri.index,ri.sourceLayerIndex,Ae.index,Hs,Wu,Hu,Dr,Na,Ll,Xu,_a,ri,Mr,Ze,da,ci)};if(Za==="line")for(var kl=0,Ku=Gc(ri.geometry,0,0,8192,8192);kl<Ku.length;kl+=1)for(var Ju=Ku[kl],lu=0,uu=md(Ju,Cl,au,Ye.vertical||xo,De,24,Al,Ae.overscaling,8192);lu<uu.length;lu+=1){var Yu=uu[lu];xo&&vd(Ae,xo.text,su,Yu)||ys(Ju,Yu)}else if(Za==="line-center")for(var hu=0,cu=ri.geometry;hu<cu.length;hu+=1){var pu=cu[hu];if(pu.length>1){var $u=dd(pu,au,Ye.vertical||xo,De,24,Al);$u&&ys(pu,$u)}}else if(ri.type==="Polygon")for(var Ml=0,Qu=Ph(ri.geometry,0);Ml<Qu.length;Ml+=1){var Dl=Qu[Ml],fu=yd(Dl,16);ys(Dl[0],new xl(fu.x,fu.y,0))}else if(ri.type==="LineString")for(var Xs=0,du=ri.geometry;Xs<du.length;Xs+=1){var Bl=du[Xs];ys(Bl,new xl(Bl[0].x,Bl[0].y,0))}else if(ri.type==="Point")for(var Uh=0,cp=ri.geometry;Uh<cp.length;Uh+=1)for(var Nh=0,pp=cp[Uh];Nh<pp.length;Nh+=1){var Zh=pp[Nh];ys([Zh],new xl(Zh.x,Zh.y,0))}}(t,mt,Ut,dr,s,P,Dt,$t,Nt,jr,d)},ct=0,ft=t.features;ct<ft.length;ct+=1)lt();p&&t.generateCollisionDebugBuffers()},u.perspective=function(t,e,i,s,c){var p,d=1/Math.tan(e/2);return t[0]=d/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,c!=null&&c!==1/0?(t[10]=(c+s)*(p=1/(s-c)),t[14]=2*c*s*p):(t[10]=-1,t[14]=-2*s),t},u.pick=function(t,e){for(var i={},s=0;s<e.length;s++){var c=e[s];c in t&&(i[c]=t[c])}return i},u.plugin=wt,u.polygonIntersectsPolygon=ca,u.postMapLoadEvent=Go,u.postTurnstileEvent=jo,u.potpack=Dc,u.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],u.register=jt,u.registerForPluginStateChange=function(t){return t({pluginStatus:h,pluginURL:_}),N.on("pluginStateChange",t),t},u.renderColorRamp=mc,u.rotate=function(t,e,i){var s=e[0],c=e[1],p=e[2],d=e[3],v=Math.sin(i),T=Math.cos(i);return t[0]=s*T+p*v,t[1]=c*T+d*v,t[2]=s*-v+p*T,t[3]=c*-v+d*T,t},u.rotateX=function(t,e,i){var s=Math.sin(i),c=Math.cos(i),p=e[4],d=e[5],v=e[6],T=e[7],P=e[8],A=e[9],z=e[10],B=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=p*c+P*s,t[5]=d*c+A*s,t[6]=v*c+z*s,t[7]=T*c+B*s,t[8]=P*c-p*s,t[9]=A*c-d*s,t[10]=z*c-v*s,t[11]=B*c-T*s,t},u.rotateZ=function(t,e,i){var s=Math.sin(i),c=Math.cos(i),p=e[0],d=e[1],v=e[2],T=e[3],P=e[4],A=e[5],z=e[6],B=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=p*c+P*s,t[1]=d*c+A*s,t[2]=v*c+z*s,t[3]=T*c+B*s,t[4]=P*c-p*s,t[5]=A*c-d*s,t[6]=z*c-v*s,t[7]=B*c-T*s,t},u.scale=function(t,e,i){var s=i[0],c=i[1],p=i[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*c,t[5]=e[5]*c,t[6]=e[6]*c,t[7]=e[7]*c,t[8]=e[8]*p,t[9]=e[9]*p,t[10]=e[10]*p,t[11]=e[11]*p,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},u.scale$1=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},u.scale$2=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t},u.setCacheLimits=function(t,e){So=t,wa=e},u.setRTLTextPlugin=function(t,e,i){if(i===void 0&&(i=!1),h==="deferred"||h==="loading"||h==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");_=_r.resolveURL(t),h="deferred",r=e,E(),i||pt()},u.sphericalToCartesian=function(t){var e=t[0],i=t[1],s=t[2];return i+=90,i*=Math.PI/180,s*=Math.PI/180,{x:e*Math.cos(i)*Math.sin(s),y:e*Math.sin(i)*Math.sin(s),z:e*Math.cos(s)}},u.sqrLen=function(t){var e=t[0],i=t[1];return e*e+i*i},u.styleSpec=V,u.sub=function(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t},u.symbolSize=fd,u.transformMat3=function(t,e,i){var s=e[0],c=e[1],p=e[2];return t[0]=s*i[0]+c*i[3]+p*i[6],t[1]=s*i[1]+c*i[4]+p*i[7],t[2]=s*i[2]+c*i[5]+p*i[8],t},u.transformMat4=pl,u.translate=function(t,e,i){var s,c,p,d,v,T,P,A,z,B,F,H,X=i[0],et=i[1],$=i[2];return e===t?(t[12]=e[0]*X+e[4]*et+e[8]*$+e[12],t[13]=e[1]*X+e[5]*et+e[9]*$+e[13],t[14]=e[2]*X+e[6]*et+e[10]*$+e[14],t[15]=e[3]*X+e[7]*et+e[11]*$+e[15]):(c=e[1],p=e[2],d=e[3],v=e[4],T=e[5],P=e[6],A=e[7],z=e[8],B=e[9],F=e[10],H=e[11],t[0]=s=e[0],t[1]=c,t[2]=p,t[3]=d,t[4]=v,t[5]=T,t[6]=P,t[7]=A,t[8]=z,t[9]=B,t[10]=F,t[11]=H,t[12]=s*X+v*et+z*$+e[12],t[13]=c*X+T*et+B*$+e[13],t[14]=p*X+P*et+F*$+e[14],t[15]=d*X+A*et+H*$+e[15]),t},u.triggerPluginCompletionEvent=b,u.uniqueId=wo,u.validateCustomStyleLayer=function(t){var e=[],i=t.id;return i===void 0&&e.push({message:"layers."+i+': missing required property "id"'}),t.render===void 0&&e.push({message:"layers."+i+': missing required method "render"'}),t.renderingMode&&t.renderingMode!=="2d"&&t.renderingMode!=="3d"&&e.push({message:"layers."+i+': property "renderingMode" must be either "2d" or "3d"'}),e},u.validateLight=jl,u.validateStyle=jn,u.values=function(t){var e=[];for(var i in t)e.push(t[i]);return e},u.vectorTile=_l,u.version="1.13.1",u.warnOnce=_i,u.webpSupported=sn,u.window=Ct,u.wrap=bo}),nt(["./shared"],function(u){function Et(C){var D=typeof C;if(D==="number"||D==="boolean"||D==="string"||C==null)return JSON.stringify(C);if(Array.isArray(C)){for(var O="[",j=0,W=C;j<W.length;j+=1)O+=Et(W[j])+",";return O+"]"}for(var it=Object.keys(C).sort(),at="{",V=0;V<it.length;V++)at+=JSON.stringify(it[V])+":"+Et(C[it[V]])+",";return at+"}"}function st(C){for(var D="",O=0,j=u.refProperties;O<j.length;O+=1)D+="/"+Et(C[j[O]]);return D}var Kt=function(C){this.keyCache={},C&&this.replace(C)};Kt.prototype.replace=function(C){this._layerConfigs={},this._layers={},this.update(C,[])},Kt.prototype.update=function(C,D){for(var O=this,j=0,W=C;j<W.length;j+=1){var it=W[j];this._layerConfigs[it.id]=it;var at=this._layers[it.id]=u.createStyleLayer(it);at._featureFilter=u.featureFilter(at.filter),this.keyCache[it.id]&&delete this.keyCache[it.id]}for(var V=0,Y=D;V<Y.length;V+=1){var ut=Y[V];delete this.keyCache[ut],delete this._layerConfigs[ut],delete this._layers[ut]}this.familiesBySource={};for(var St=0,At=function(Mt,Rt){for(var ge={},Ot=0;Ot<Mt.length;Ot++){var be=Rt&&Rt[Mt[Ot].id]||st(Mt[Ot]);Rt&&(Rt[Mt[Ot].id]=be);var Be=ge[be];Be||(Be=ge[be]=[]),Be.push(Mt[Ot])}var we=[];for(var Re in ge)we.push(ge[Re]);return we}(u.values(this._layerConfigs),this.keyCache);St<At.length;St+=1){var gt=At[St].map(function(Mt){return O._layers[Mt.id]}),It=gt[0];if(It.visibility!=="none"){var Ht=It.source||"",qt=this.familiesBySource[Ht];qt||(qt=this.familiesBySource[Ht]={});var bt=It.sourceLayer||"_geojsonTileLayer",Ft=qt[bt];Ft||(Ft=qt[bt]=[]),Ft.push(gt)}}};var Vt=function(C){var D={},O=[];for(var j in C){var W=C[j],it=D[j]={};for(var at in W){var V=W[+at];if(V&&V.bitmap.width!==0&&V.bitmap.height!==0){var Y={x:0,y:0,w:V.bitmap.width+2,h:V.bitmap.height+2};O.push(Y),it[at]={rect:Y,metrics:V.metrics}}}}var ut=u.potpack(O),St=new u.AlphaImage({width:ut.w||1,height:ut.h||1});for(var At in C){var gt=C[At];for(var It in gt){var Ht=gt[+It];if(Ht&&Ht.bitmap.width!==0&&Ht.bitmap.height!==0){var qt=D[At][It].rect;u.AlphaImage.copy(Ht.bitmap,St,{x:0,y:0},{x:qt.x+1,y:qt.y+1},Ht.bitmap)}}}this.image=St,this.positions=D};u.register("GlyphAtlas",Vt);var fe=function(C){this.tileID=new u.OverscaledTileID(C.tileID.overscaledZ,C.tileID.wrap,C.tileID.canonical.z,C.tileID.canonical.x,C.tileID.canonical.y),this.uid=C.uid,this.zoom=C.zoom,this.pixelRatio=C.pixelRatio,this.tileSize=C.tileSize,this.source=C.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=C.showCollisionBoxes,this.collectResourceTiming=!!C.collectResourceTiming,this.returnDependencies=!!C.returnDependencies,this.promoteId=C.promoteId};function Ct(C,D,O){for(var j=new u.EvaluationParameters(D),W=0,it=C;W<it.length;W+=1)it[W].recalculate(j,O)}function sr(C,D){var O=u.getArrayBuffer(C.request,function(j,W,it,at){j?D(j):W&&D(null,{vectorTile:new u.vectorTile.VectorTile(new u.pbf(W)),rawData:W,cacheControl:it,expires:at})});return function(){O.cancel(),D()}}fe.prototype.parse=function(C,D,O,j,W){var it=this;this.status="parsing",this.data=C,this.collisionBoxArray=new u.CollisionBoxArray;var at=new u.DictionaryCoder(Object.keys(C.layers).sort()),V=new u.FeatureIndex(this.tileID,this.promoteId);V.bucketLayerIDs=[];var Y,ut,St,At,gt={},It={featureIndex:V,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:O},Ht=D.familiesBySource[this.source];for(var qt in Ht){var bt=C.layers[qt];if(bt){bt.version===1&&u.warnOnce('Vector tile source "'+this.source+'" layer "'+qt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var Ft=at.encode(qt),Mt=[],Rt=0;Rt<bt.length;Rt++){var ge=bt.feature(Rt),Ot=V.getId(ge,qt);Mt.push({feature:ge,id:Ot,index:Rt,sourceLayerIndex:Ft})}for(var be=0,Be=Ht[qt];be<Be.length;be+=1){var we=Be[be],Re=we[0];Re.minzoom&&this.zoom<Math.floor(Re.minzoom)||Re.maxzoom&&this.zoom>=Re.maxzoom||Re.visibility!=="none"&&(Ct(we,this.zoom,O),(gt[Re.id]=Re.createBucket({index:V.bucketLayerIDs.length,layers:we,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ft,sourceID:this.source})).populate(Mt,It,this.tileID.canonical),V.bucketLayerIDs.push(we.map(function(Oe){return Oe.id})))}}}var Ie=u.mapObject(It.glyphDependencies,function(Oe){return Object.keys(Oe).map(Number)});Object.keys(Ie).length?j.send("getGlyphs",{uid:this.uid,stacks:Ie},function(Oe,Yt){Y||(Y=Oe,ut=Yt,xi.call(it))}):ut={};var Ui=Object.keys(It.iconDependencies);Ui.length?j.send("getImages",{icons:Ui,source:this.source,tileID:this.tileID,type:"icons"},function(Oe,Yt){Y||(Y=Oe,St=Yt,xi.call(it))}):St={};var Fe=Object.keys(It.patternDependencies);function xi(){if(Y)return W(Y);if(ut&&St&&At){var Oe=new Vt(ut),Yt=new u.ImageAtlas(St,At);for(var se in gt){var ir=gt[se];ir instanceof u.SymbolBucket?(Ct(ir.layers,this.zoom,O),u.performSymbolLayout(ir,ut,Oe.positions,St,Yt.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):ir.hasPattern&&(ir instanceof u.LineBucket||ir instanceof u.FillBucket||ir instanceof u.FillExtrusionBucket)&&(Ct(ir.layers,this.zoom,O),ir.addFeatures(It,this.tileID.canonical,Yt.patternPositions))}this.status="done",W(null,{buckets:u.values(gt).filter(function(An){return!An.isEmpty()}),featureIndex:V,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Oe.image,imageAtlas:Yt,glyphMap:this.returnDependencies?ut:null,iconMap:this.returnDependencies?St:null,glyphPositions:this.returnDependencies?Oe.positions:null})}}Fe.length?j.send("getImages",{icons:Fe,source:this.source,tileID:this.tileID,type:"patterns"},function(Oe,Yt){Y||(Y=Oe,At=Yt,xi.call(it))}):At={},xi.call(this)};var oi=function(C,D,O,j){this.actor=C,this.layerIndex=D,this.availableImages=O,this.loadVectorData=j||sr,this.loading={},this.loaded={}};oi.prototype.loadTile=function(C,D){var O=this,j=C.uid;this.loading||(this.loading={});var W=!!(C&&C.request&&C.request.collectResourceTiming)&&new u.RequestPerformance(C.request),it=this.loading[j]=new fe(C);it.abort=this.loadVectorData(C,function(at,V){if(delete O.loading[j],at||!V)return it.status="done",O.loaded[j]=it,D(at);var Y=V.rawData,ut={};V.expires&&(ut.expires=V.expires),V.cacheControl&&(ut.cacheControl=V.cacheControl);var St={};if(W){var At=W.finish();At&&(St.resourceTiming=JSON.parse(JSON.stringify(At)))}it.vectorTile=V.vectorTile,it.parse(V.vectorTile,O.layerIndex,O.availableImages,O.actor,function(gt,It){if(gt||!It)return D(gt);D(null,u.extend({rawTileData:Y.slice(0)},It,ut,St))}),O.loaded=O.loaded||{},O.loaded[j]=it})},oi.prototype.reloadTile=function(C,D){var O=this,j=this.loaded,W=C.uid,it=this;if(j&&j[W]){var at=j[W];at.showCollisionBoxes=C.showCollisionBoxes;var V=function(Y,ut){var St=at.reloadCallback;St&&(delete at.reloadCallback,at.parse(at.vectorTile,it.layerIndex,O.availableImages,it.actor,St)),D(Y,ut)};at.status==="parsing"?at.reloadCallback=V:at.status==="done"&&(at.vectorTile?at.parse(at.vectorTile,this.layerIndex,this.availableImages,this.actor,V):V())}},oi.prototype.abortTile=function(C,D){var O=this.loading,j=C.uid;O&&O[j]&&O[j].abort&&(O[j].abort(),delete O[j]),D()},oi.prototype.removeTile=function(C,D){var O=this.loaded,j=C.uid;O&&O[j]&&delete O[j],D()};var Je=u.window.ImageBitmap,lr=function(){this.loaded={}};function bo(C,D){if(C.length!==0){ki(C[0],D);for(var O=1;O<C.length;O++)ki(C[O],!D)}}function ki(C,D){for(var O=0,j=0,W=C.length,it=W-1;j<W;it=j++)O+=(C[j][0]-C[it][0])*(C[it][1]+C[j][1]);O>=0!=!!D&&C.reverse()}lr.prototype.loadTile=function(C,D){var O=C.uid,j=C.encoding,W=C.rawImageData,it=Je&&W instanceof Je?this.getImageData(W):W,at=new u.DEMData(O,it,j);this.loaded=this.loaded||{},this.loaded[O]=at,D(null,at)},lr.prototype.getImageData=function(C){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(C.width,C.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=C.width,this.offscreenCanvas.height=C.height,this.offscreenCanvasContext.drawImage(C,0,0,C.width,C.height);var D=this.offscreenCanvasContext.getImageData(-1,-1,C.width+2,C.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new u.RGBAImage({width:D.width,height:D.height},D.data)},lr.prototype.removeTile=function(C){var D=this.loaded,O=C.uid;D&&D[O]&&delete D[O]};var Gr=u.vectorTile.VectorTileFeature.prototype.toGeoJSON,wo=function(C){this._feature=C,this.extent=u.EXTENT,this.type=C.type,this.properties=C.tags,"id"in C&&!isNaN(C.id)&&(this.id=parseInt(C.id,10))};wo.prototype.loadGeometry=function(){if(this._feature.type===1){for(var C=[],D=0,O=this._feature.geometry;D<O.length;D+=1){var j=O[D];C.push([new u.Point$1(j[0],j[1])])}return C}for(var W=[],it=0,at=this._feature.geometry;it<at.length;it+=1){for(var V=[],Y=0,ut=at[it];Y<ut.length;Y+=1){var St=ut[Y];V.push(new u.Point$1(St[0],St[1]))}W.push(V)}return W},wo.prototype.toGeoJSON=function(C,D,O){return Gr.call(this,C,D,O)};var an=function(C){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.EXTENT,this.length=C.length,this._features=C};an.prototype.feature=function(C){return new wo(this._features[C])};var Hn=u.vectorTile.VectorTileFeature,To=Xn;function Xn(C,D){this.options=D||{},this.features=C,this.length=C.length}function Qi(C,D){this.id=typeof C.id=="number"?C.id:void 0,this.type=C.type,this.rawGeometry=C.type===1?[C.geometry]:C.geometry,this.properties=C.tags,this.extent=D||4096}Xn.prototype.feature=function(C){return new Qi(this.features[C],this.options.extent)},Qi.prototype.loadGeometry=function(){var C=this.rawGeometry;this.geometry=[];for(var D=0;D<C.length;D++){for(var O=C[D],j=[],W=0;W<O.length;W++)j.push(new u.Point$1(O[W][0],O[W][1]));this.geometry.push(j)}return this.geometry},Qi.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var C=this.geometry,D=1/0,O=-1/0,j=1/0,W=-1/0,it=0;it<C.length;it++)for(var at=C[it],V=0;V<at.length;V++){var Y=at[V];D=Math.min(D,Y.x),O=Math.max(O,Y.x),j=Math.min(j,Y.y),W=Math.max(W,Y.y)}return[D,j,O,W]},Qi.prototype.toGeoJSON=Hn.prototype.toGeoJSON;var Tn=ji,li=To;function ji(C){var D=new u.pbf;return function(O,j){for(var W in O.layers)j.writeMessage(3,_i,O.layers[W])}(C,D),D.finish()}function _i(C,D){var O;D.writeVarintField(15,C.version||1),D.writeStringField(1,C.name||""),D.writeVarintField(5,C.extent||4096);var j={keys:[],values:[],keycache:{},valuecache:{}};for(O=0;O<C.length;O++)j.feature=C.feature(O),D.writeMessage(2,Ei,j);var W=j.keys;for(O=0;O<W.length;O++)D.writeStringField(3,W[O]);var it=j.values;for(O=0;O<it.length;O++)D.writeMessage(4,xa,it[O])}function Ei(C,D){var O=C.feature;O.id!==void 0&&D.writeVarintField(1,O.id),D.writeMessage(2,ja,C),D.writeVarintField(3,O.type),D.writeMessage(4,de,O)}function ja(C,D){var O=C.feature,j=C.keys,W=C.values,it=C.keycache,at=C.valuecache;for(var V in O.properties){var Y=it[V];Y===void 0&&(j.push(V),it[V]=Y=j.length-1),D.writeVarint(Y);var ut=O.properties[V],St=typeof ut;St!=="string"&&St!=="boolean"&&St!=="number"&&(ut=JSON.stringify(ut));var At=St+":"+ut,gt=at[At];gt===void 0&&(W.push(ut),at[At]=gt=W.length-1),D.writeVarint(gt)}}function Ti(C,D){return(D<<3)+(7&C)}function Sn(C){return C<<1^C>>31}function de(C,D){for(var O=C.loadGeometry(),j=C.type,W=0,it=0,at=O.length,V=0;V<at;V++){var Y=O[V],ut=1;j===1&&(ut=Y.length),D.writeVarint(Ti(1,ut));for(var St=j===3?Y.length-1:Y.length,At=0;At<St;At++){At===1&&j!==1&&D.writeVarint(Ti(2,St-1));var gt=Y[At].x-W,It=Y[At].y-it;D.writeVarint(Sn(gt)),D.writeVarint(Sn(It)),W+=gt,it+=It}j===3&&D.writeVarint(Ti(7,1))}}function xa(C,D){var O=typeof C;O==="string"?D.writeStringField(1,C):O==="boolean"?D.writeBooleanField(7,C):O==="number"&&(C%1!=0?D.writeDoubleField(3,C):C<0?D.writeSVarintField(6,C):D.writeVarintField(5,C))}function Ce(C,D,O,j){We(C,O,j),We(D,2*O,2*j),We(D,2*O+1,2*j+1)}function We(C,D,O){var j=C[D];C[D]=C[O],C[O]=j}function Oi(C,D,O,j){var W=C-O,it=D-j;return W*W+it*it}Tn.fromVectorTileJs=ji,Tn.fromGeojsonVt=function(C,D){D=D||{};var O={};for(var j in C)O[j]=new To(C[j].features,D),O[j].name=j,O[j].version=D.version,O[j].extent=D.extent;return ji({layers:O})},Tn.GeoJSONWrapper=li;var Fi=function(C){return C[0]},yi=function(C){return C[1]},Ve=function(C,D,O,j,W){D===void 0&&(D=Fi),O===void 0&&(O=yi),j===void 0&&(j=64),W===void 0&&(W=Float64Array),this.nodeSize=j,this.points=C;for(var it=C.length<65536?Uint16Array:Uint32Array,at=this.ids=new it(C.length),V=this.coords=new W(2*C.length),Y=0;Y<C.length;Y++)at[Y]=Y,V[2*Y]=D(C[Y]),V[2*Y+1]=O(C[Y]);(function ut(St,At,gt,It,Ht,qt){if(!(Ht-It<=gt)){var bt=It+Ht>>1;(function Ft(Mt,Rt,ge,Ot,be,Be){for(;be>Ot;){if(be-Ot>600){var we=be-Ot+1,Re=ge-Ot+1,Ie=Math.log(we),Ui=.5*Math.exp(2*Ie/3),Fe=.5*Math.sqrt(Ie*Ui*(we-Ui)/we)*(Re-we/2<0?-1:1);Ft(Mt,Rt,ge,Math.max(Ot,Math.floor(ge-Re*Ui/we+Fe)),Math.min(be,Math.floor(ge+(we-Re)*Ui/we+Fe)),Be)}var xi=Rt[2*ge+Be],Oe=Ot,Yt=be;for(Ce(Mt,Rt,Ot,ge),Rt[2*be+Be]>xi&&Ce(Mt,Rt,Ot,be);Oe<Yt;){for(Ce(Mt,Rt,Oe,Yt),Oe++,Yt--;Rt[2*Oe+Be]<xi;)Oe++;for(;Rt[2*Yt+Be]>xi;)Yt--}Rt[2*Ot+Be]===xi?Ce(Mt,Rt,Ot,Yt):Ce(Mt,Rt,++Yt,be),Yt<=ge&&(Ot=Yt+1),ge<=Yt&&(be=Yt-1)}})(St,At,bt,It,Ht,qt%2),ut(St,At,gt,It,bt-1,qt+1),ut(St,At,gt,bt+1,Ht,qt+1)}})(at,V,j,0,at.length-1,0)};Ve.prototype.range=function(C,D,O,j){return function(W,it,at,V,Y,ut,St){for(var At,gt,It=[0,W.length-1,0],Ht=[];It.length;){var qt=It.pop(),bt=It.pop(),Ft=It.pop();if(bt-Ft<=St)for(var Mt=Ft;Mt<=bt;Mt++)gt=it[2*Mt+1],(At=it[2*Mt])>=at&&At<=Y&&gt>=V&&gt<=ut&&Ht.push(W[Mt]);else{var Rt=Math.floor((Ft+bt)/2);gt=it[2*Rt+1],(At=it[2*Rt])>=at&&At<=Y&&gt>=V&&gt<=ut&&Ht.push(W[Rt]);var ge=(qt+1)%2;(qt===0?at<=At:V<=gt)&&(It.push(Ft),It.push(Rt-1),It.push(ge)),(qt===0?Y>=At:ut>=gt)&&(It.push(Rt+1),It.push(bt),It.push(ge))}}return Ht}(this.ids,this.coords,C,D,O,j,this.nodeSize)},Ve.prototype.within=function(C,D,O){return function(j,W,it,at,V,Y){for(var ut=[0,j.length-1,0],St=[],At=V*V;ut.length;){var gt=ut.pop(),It=ut.pop(),Ht=ut.pop();if(It-Ht<=Y)for(var qt=Ht;qt<=It;qt++)Oi(W[2*qt],W[2*qt+1],it,at)<=At&&St.push(j[qt]);else{var bt=Math.floor((Ht+It)/2),Ft=W[2*bt],Mt=W[2*bt+1];Oi(Ft,Mt,it,at)<=At&&St.push(j[bt]);var Rt=(gt+1)%2;(gt===0?it-V<=Ft:at-V<=Mt)&&(ut.push(Ht),ut.push(bt-1),ut.push(Rt)),(gt===0?it+V>=Ft:at+V>=Mt)&&(ut.push(bt+1),ut.push(It),ut.push(Rt))}}return St}(this.ids,this.coords,C,D,O,this.nodeSize)};var gi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(C){return C}},vi=function(C){this.options=Jn(Object.create(gi),C),this.trees=new Array(this.options.maxZoom+1)};function _r(C,D,O,j,W){return{x:C,y:D,zoom:1/0,id:O,parentId:-1,numPoints:j,properties:W}}function Ke(C,D){var O=C.geometry.coordinates,j=O[1];return{x:Pr(O[0]),y:Te(j),zoom:1/0,index:D,parentId:-1}}function sn(C){return{type:"Feature",id:C.id,properties:Kn(C),geometry:{type:"Point",coordinates:[(j=C.x,360*(j-.5)),(D=C.y,O=(180-360*D)*Math.PI/180,360*Math.atan(Math.exp(O))/Math.PI-90)]}};var D,O,j}function Kn(C){var D=C.numPoints,O=D>=1e4?Math.round(D/1e3)+"k":D>=1e3?Math.round(D/100)/10+"k":D;return Jn(Jn({},C.properties),{cluster:!0,cluster_id:C.id,point_count:D,point_count_abbreviated:O})}function Pr(C){return C/360+.5}function Te(C){var D=Math.sin(C*Math.PI/180),O=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return O<0?0:O>1?1:O}function Jn(C,D){for(var O in D)C[O]=D[O];return C}function yr(C){return C.x}function Wr(C){return C.y}function ba(C,D,O,j,W,it){var at=W-O,V=it-j;if(at!==0||V!==0){var Y=((C-O)*at+(D-j)*V)/(at*at+V*V);Y>1?(O=W,j=it):Y>0&&(O+=at*Y,j+=V*Y)}return(at=C-O)*at+(V=D-j)*V}function Br(C,D,O,j){var W={id:C===void 0?null:C,type:D,geometry:O,tags:j,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(it){var at=it.geometry,V=it.type;if(V==="Point"||V==="MultiPoint"||V==="LineString")Pn(it,at);else if(V==="Polygon"||V==="MultiLineString")for(var Y=0;Y<at.length;Y++)Pn(it,at[Y]);else if(V==="MultiPolygon")for(Y=0;Y<at.length;Y++)for(var ut=0;ut<at[Y].length;ut++)Pn(it,at[Y][ut])}(W),W}function Pn(C,D){for(var O=0;O<D.length;O+=3)C.minX=Math.min(C.minX,D[O]),C.minY=Math.min(C.minY,D[O+1]),C.maxX=Math.max(C.maxX,D[O]),C.maxY=Math.max(C.maxY,D[O+1])}function Ir(C,D,O,j){if(D.geometry){var W=D.geometry.coordinates,it=D.geometry.type,at=Math.pow(O.tolerance/((1<<O.maxZoom)*O.extent),2),V=[],Y=D.id;if(O.promoteId?Y=D.properties[O.promoteId]:O.generateId&&(Y=j||0),it==="Point")On(W,V);else if(it==="MultiPoint")for(var ut=0;ut<W.length;ut++)On(W[ut],V);else if(it==="LineString")In(W,V,at,!1);else if(it==="MultiLineString"){if(O.lineMetrics){for(ut=0;ut<W.length;ut++)In(W[ut],V=[],at,!1),C.push(Br(Y,"LineString",V,D.properties));return}gr(W,V,at,!1)}else if(it==="Polygon")gr(W,V,at,!0);else{if(it!=="MultiPolygon"){if(it==="GeometryCollection"){for(ut=0;ut<D.geometry.geometries.length;ut++)Ir(C,{id:Y,geometry:D.geometry.geometries[ut],properties:D.properties},O,j);return}throw new Error("Input data is not a valid GeoJSON object.")}for(ut=0;ut<W.length;ut++){var St=[];gr(W[ut],St,at,!0),V.push(St)}}C.push(Br(Y,it,V,D.properties))}}function On(C,D){D.push(ln(C[0])),D.push(Yn(C[1])),D.push(0)}function In(C,D,O,j){for(var W,it,at=0,V=0;V<C.length;V++){var Y=ln(C[V][0]),ut=Yn(C[V][1]);D.push(Y),D.push(ut),D.push(0),V>0&&(at+=j?(W*ut-Y*it)/2:Math.sqrt(Math.pow(Y-W,2)+Math.pow(ut-it,2))),W=Y,it=ut}var St=D.length-3;D[2]=1,function At(gt,It,Ht,qt){for(var bt,Ft=qt,Mt=Ht-It>>1,Rt=Ht-It,ge=gt[It],Ot=gt[It+1],be=gt[Ht],Be=gt[Ht+1],we=It+3;we<Ht;we+=3){var Re=ba(gt[we],gt[we+1],ge,Ot,be,Be);if(Re>Ft)bt=we,Ft=Re;else if(Re===Ft){var Ie=Math.abs(we-Mt);Ie<Rt&&(bt=we,Rt=Ie)}}Ft>qt&&(bt-It>3&&At(gt,It,bt,qt),gt[bt+2]=Ft,Ht-bt>3&&At(gt,bt,Ht,qt))}(D,0,St,O),D[St+2]=1,D.size=Math.abs(at),D.start=0,D.end=D.size}function gr(C,D,O,j){for(var W=0;W<C.length;W++){var it=[];In(C[W],it,O,j),D.push(it)}}function ln(C){return C/360+.5}function Yn(C){var D=Math.sin(C*Math.PI/180),O=.5-.25*Math.log((1+D)/(1-D))/Math.PI;return O<0?0:O>1?1:O}function Hr(C,D,O,j,W,it,at,V){if(j/=D,it>=(O/=D)&&at<j)return C;if(at<O||it>=j)return null;for(var Y=[],ut=0;ut<C.length;ut++){var St=C[ut],At=St.geometry,gt=St.type,It=W===0?St.minX:St.minY,Ht=W===0?St.maxX:St.maxY;if(It>=O&&Ht<j)Y.push(St);else if(!(Ht<O||It>=j)){var qt=[];if(gt==="Point"||gt==="MultiPoint")qo(At,qt,O,j,W);else if(gt==="LineString")jo(At,qt,O,j,W,!1,V.lineMetrics);else if(gt==="MultiLineString")Go(At,qt,O,j,W,!1);else if(gt==="Polygon")Go(At,qt,O,j,W,!0);else if(gt==="MultiPolygon")for(var bt=0;bt<At.length;bt++){var Ft=[];Go(At[bt],Ft,O,j,W,!0),Ft.length&&qt.push(Ft)}if(qt.length){if(V.lineMetrics&&gt==="LineString"){for(bt=0;bt<qt.length;bt++)Y.push(Br(St.id,gt,qt[bt],St.tags));continue}gt!=="LineString"&&gt!=="MultiLineString"||(qt.length===1?(gt="LineString",qt=qt[0]):gt="MultiLineString"),gt!=="Point"&&gt!=="MultiPoint"||(gt=qt.length===3?"Point":"MultiPoint"),Y.push(Br(St.id,gt,qt,St.tags))}}}return Y.length?Y:null}function qo(C,D,O,j,W){for(var it=0;it<C.length;it+=3){var at=C[it+W];at>=O&&at<=j&&(D.push(C[it]),D.push(C[it+1]),D.push(C[it+2]))}}function jo(C,D,O,j,W,it,at){for(var V,Y,ut=$n(C),St=W===0?wa:Qn,At=C.start,gt=0;gt<C.length-3;gt+=3){var It=C[gt],Ht=C[gt+1],qt=C[gt+2],bt=C[gt+3],Ft=C[gt+4],Mt=W===0?It:Ht,Rt=W===0?bt:Ft,ge=!1;at&&(V=Math.sqrt(Math.pow(It-bt,2)+Math.pow(Ht-Ft,2))),Mt<O?Rt>O&&(Y=St(ut,It,Ht,bt,Ft,O),at&&(ut.start=At+V*Y)):Mt>j?Rt<j&&(Y=St(ut,It,Ht,bt,Ft,j),at&&(ut.start=At+V*Y)):So(ut,It,Ht,qt),Rt<O&&Mt>=O&&(Y=St(ut,It,Ht,bt,Ft,O),ge=!0),Rt>j&&Mt<=j&&(Y=St(ut,It,Ht,bt,Ft,j),ge=!0),!it&&ge&&(at&&(ut.end=At+V*Y),D.push(ut),ut=$n(C)),at&&(At+=V)}var Ot=C.length-3;It=C[Ot],Ht=C[Ot+1],qt=C[Ot+2],(Mt=W===0?It:Ht)>=O&&Mt<=j&&So(ut,It,Ht,qt),Ot=ut.length-3,it&&Ot>=3&&(ut[Ot]!==ut[0]||ut[Ot+1]!==ut[1])&&So(ut,ut[0],ut[1],ut[2]),ut.length&&D.push(ut)}function $n(C){var D=[];return D.size=C.size,D.start=C.start,D.end=C.end,D}function Go(C,D,O,j,W,it){for(var at=0;at<C.length;at++)jo(C[at],D,O,j,W,it,!1)}function So(C,D,O,j){C.push(D),C.push(O),C.push(j)}function wa(C,D,O,j,W,it){var at=(it-D)/(j-D);return C.push(it),C.push(O+(W-O)*at),C.push(1),at}function Qn(C,D,O,j,W,it){var at=(it-O)/(W-O);return C.push(D+(j-D)*at),C.push(it),C.push(1),at}function Po(C,D){for(var O=[],j=0;j<C.length;j++){var W,it=C[j],at=it.type;if(at==="Point"||at==="MultiPoint"||at==="LineString")W=to(it.geometry,D);else if(at==="MultiLineString"||at==="Polygon"){W=[];for(var V=0;V<it.geometry.length;V++)W.push(to(it.geometry[V],D))}else if(at==="MultiPolygon")for(W=[],V=0;V<it.geometry.length;V++){for(var Y=[],ut=0;ut<it.geometry[V].length;ut++)Y.push(to(it.geometry[V][ut],D));W.push(Y)}O.push(Br(it.id,at,W,it.tags))}return O}function to(C,D){var O=[];O.size=C.size,C.start!==void 0&&(O.start=C.start,O.end=C.end);for(var j=0;j<C.length;j+=3)O.push(C[j]+D,C[j+1],C[j+2]);return O}function vr(C,D){if(C.transformed)return C;var O,j,W,it=1<<C.z,at=C.x,V=C.y;for(O=0;O<C.features.length;O++){var Y=C.features[O],ut=Y.geometry,St=Y.type;if(Y.geometry=[],St===1)for(j=0;j<ut.length;j+=2)Y.geometry.push(En(ut[j],ut[j+1],D,it,at,V));else for(j=0;j<ut.length;j++){var At=[];for(W=0;W<ut[j].length;W+=2)At.push(En(ut[j][W],ut[j][W+1],D,it,at,V));Y.geometry.push(At)}}return C.transformed=!0,C}function En(C,D,O,j,W,it){return[Math.round(O*(C*j-W)),Math.round(O*(D*j-it))]}function Ga(C,D,O,j,W){for(var it=D===W.maxZoom?0:W.tolerance/((1<<D)*W.extent),at={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:O,y:j,z:D,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},V=0;V<C.length;V++){at.numFeatures++,Wa(at,C[V],it,W);var Y=C[V].minX,ut=C[V].minY,St=C[V].maxX,At=C[V].maxY;Y<at.minX&&(at.minX=Y),ut<at.minY&&(at.minY=ut),St>at.maxX&&(at.maxX=St),At>at.maxY&&(at.maxY=At)}return at}function Wa(C,D,O,j){var W=D.geometry,it=D.type,at=[];if(it==="Point"||it==="MultiPoint")for(var V=0;V<W.length;V+=3)at.push(W[V]),at.push(W[V+1]),C.numPoints++,C.numSimplified++;else if(it==="LineString")Rr(at,W,C,O,!1,!1);else if(it==="MultiLineString"||it==="Polygon")for(V=0;V<W.length;V++)Rr(at,W[V],C,O,it==="Polygon",V===0);else if(it==="MultiPolygon")for(var Y=0;Y<W.length;Y++){var ut=W[Y];for(V=0;V<ut.length;V++)Rr(at,ut[V],C,O,!0,V===0)}if(at.length){var St=D.tags||null;if(it==="LineString"&&j.lineMetrics){for(var At in St={},D.tags)St[At]=D.tags[At];St.mapbox_clip_start=W.start/W.size,St.mapbox_clip_end=W.end/W.size}var gt={geometry:at,type:it==="Polygon"||it==="MultiPolygon"?3:it==="LineString"||it==="MultiLineString"?2:1,tags:St};D.id!==null&&(gt.id=D.id),C.features.push(gt)}}function Rr(C,D,O,j,W,it){var at=j*j;if(j>0&&D.size<(W?at:j))O.numPoints+=D.length/3;else{for(var V=[],Y=0;Y<D.length;Y+=3)(j===0||D[Y+2]>at)&&(O.numSimplified++,V.push(D[Y]),V.push(D[Y+1])),O.numPoints++;W&&function(ut,St){for(var At=0,gt=0,It=ut.length,Ht=It-2;gt<It;Ht=gt,gt+=2)At+=(ut[gt]-ut[Ht])*(ut[gt+1]+ut[Ht+1]);if(At>0===St)for(gt=0,It=ut.length;gt<It/2;gt+=2){var qt=ut[gt],bt=ut[gt+1];ut[gt]=ut[It-2-gt],ut[gt+1]=ut[It-1-gt],ut[It-2-gt]=qt,ut[It-1-gt]=bt}}(V,it),C.push(V)}}function tr(C,D){var O=(D=this.options=function(W,it){for(var at in it)W[at]=it[at];return W}(Object.create(this.options),D)).debug;if(O&&console.time("preprocess data"),D.maxZoom<0||D.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(D.promoteId&&D.generateId)throw new Error("promoteId and generateId cannot be used together.");var j=function(W,it){var at=[];if(W.type==="FeatureCollection")for(var V=0;V<W.features.length;V++)Ir(at,W.features[V],it,V);else Ir(at,W.type==="Feature"?W:{geometry:W},it);return at}(C,D);this.tiles={},this.tileCoords=[],O&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",D.indexMaxZoom,D.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(j=function(W,it){var at=it.buffer/it.extent,V=W,Y=Hr(W,1,-1-at,at,0,-1,2,it),ut=Hr(W,1,1-at,2+at,0,-1,2,it);return(Y||ut)&&(V=Hr(W,1,-at,1+at,0,-1,2,it)||[],Y&&(V=Po(Y,1).concat(V)),ut&&(V=V.concat(Po(ut,-1)))),V}(j,D)).length&&this.splitTile(j,0,0,0),O&&(j.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function er(C,D,O){return 32*((1<<C)*O+D)+C}function Io(C,D){var O=C.tileID.canonical;if(!this._geoJSONIndex)return D(null,null);var j=this._geoJSONIndex.getTile(O.z,O.x,O.y);if(!j)return D(null,null);var W=new an(j.features),it=Tn(W);it.byteOffset===0&&it.byteLength===it.buffer.byteLength||(it=new Uint8Array(it)),D(null,{vectorTile:W,rawData:it.buffer})}vi.prototype.load=function(C){var D=this.options,O=D.log,j=D.minZoom,W=D.maxZoom,it=D.nodeSize;O&&console.time("total time");var at="prepare "+C.length+" points";O&&console.time(at),this.points=C;for(var V=[],Y=0;Y<C.length;Y++)C[Y].geometry&&V.push(Ke(C[Y],Y));this.trees[W+1]=new Ve(V,yr,Wr,it,Float32Array),O&&console.timeEnd(at);for(var ut=W;ut>=j;ut--){var St=+Date.now();V=this._cluster(V,ut),this.trees[ut]=new Ve(V,yr,Wr,it,Float32Array),O&&console.log("z%d: %d clusters in %dms",ut,V.length,+Date.now()-St)}return O&&console.timeEnd("total time"),this},vi.prototype.getClusters=function(C,D){var O=((C[0]+180)%360+360)%360-180,j=Math.max(-90,Math.min(90,C[1])),W=C[2]===180?180:((C[2]+180)%360+360)%360-180,it=Math.max(-90,Math.min(90,C[3]));if(C[2]-C[0]>=360)O=-180,W=180;else if(O>W){var at=this.getClusters([O,j,180,it],D),V=this.getClusters([-180,j,W,it],D);return at.concat(V)}for(var Y=this.trees[this._limitZoom(D)],ut=[],St=0,At=Y.range(Pr(O),Te(it),Pr(W),Te(j));St<At.length;St+=1){var gt=Y.points[At[St]];ut.push(gt.numPoints?sn(gt):this.points[gt.index])}return ut},vi.prototype.getChildren=function(C){var D=this._getOriginId(C),O=this._getOriginZoom(C),j="No cluster with the specified id.",W=this.trees[O];if(!W)throw new Error(j);var it=W.points[D];if(!it)throw new Error(j);for(var at=this.options.radius/(this.options.extent*Math.pow(2,O-1)),V=[],Y=0,ut=W.within(it.x,it.y,at);Y<ut.length;Y+=1){var St=W.points[ut[Y]];St.parentId===C&&V.push(St.numPoints?sn(St):this.points[St.index])}if(V.length===0)throw new Error(j);return V},vi.prototype.getLeaves=function(C,D,O){var j=[];return this._appendLeaves(j,C,D=D||10,O=O||0,0),j},vi.prototype.getTile=function(C,D,O){var j=this.trees[this._limitZoom(C)],W=Math.pow(2,C),it=this.options,at=it.radius/it.extent,V=(O-at)/W,Y=(O+1+at)/W,ut={features:[]};return this._addTileFeatures(j.range((D-at)/W,V,(D+1+at)/W,Y),j.points,D,O,W,ut),D===0&&this._addTileFeatures(j.range(1-at/W,V,1,Y),j.points,W,O,W,ut),D===W-1&&this._addTileFeatures(j.range(0,V,at/W,Y),j.points,-1,O,W,ut),ut.features.length?ut:null},vi.prototype.getClusterExpansionZoom=function(C){for(var D=this._getOriginZoom(C)-1;D<=this.options.maxZoom;){var O=this.getChildren(C);if(D++,O.length!==1)break;C=O[0].properties.cluster_id}return D},vi.prototype._appendLeaves=function(C,D,O,j,W){for(var it=0,at=this.getChildren(D);it<at.length;it+=1){var V=at[it],Y=V.properties;if(Y&&Y.cluster?W+Y.point_count<=j?W+=Y.point_count:W=this._appendLeaves(C,Y.cluster_id,O,j,W):W<j?W++:C.push(V),C.length===O)break}return W},vi.prototype._addTileFeatures=function(C,D,O,j,W,it){for(var at=0,V=C;at<V.length;at+=1){var Y=D[V[at]],ut=Y.numPoints,St={type:1,geometry:[[Math.round(this.options.extent*(Y.x*W-O)),Math.round(this.options.extent*(Y.y*W-j))]],tags:ut?Kn(Y):this.points[Y.index].properties},At=void 0;ut?At=Y.id:this.options.generateId?At=Y.index:this.points[Y.index].id&&(At=this.points[Y.index].id),At!==void 0&&(St.id=At),it.features.push(St)}},vi.prototype._limitZoom=function(C){return Math.max(this.options.minZoom,Math.min(+C,this.options.maxZoom+1))},vi.prototype._cluster=function(C,D){for(var O=[],j=this.options,W=j.reduce,it=j.minPoints,at=j.radius/(j.extent*Math.pow(2,D)),V=0;V<C.length;V++){var Y=C[V];if(!(Y.zoom<=D)){Y.zoom=D;for(var ut=this.trees[D+1],St=ut.within(Y.x,Y.y,at),At=Y.numPoints||1,gt=At,It=0,Ht=St;It<Ht.length;It+=1){var qt=ut.points[Ht[It]];qt.zoom>D&&(gt+=qt.numPoints||1)}if(gt>=it){for(var bt=Y.x*At,Ft=Y.y*At,Mt=W&&At>1?this._map(Y,!0):null,Rt=(V<<5)+(D+1)+this.points.length,ge=0,Ot=St;ge<Ot.length;ge+=1){var be=ut.points[Ot[ge]];if(!(be.zoom<=D)){be.zoom=D;var Be=be.numPoints||1;bt+=be.x*Be,Ft+=be.y*Be,be.parentId=Rt,W&&(Mt||(Mt=this._map(Y,!0)),W(Mt,this._map(be)))}}Y.parentId=Rt,O.push(_r(bt/gt,Ft/gt,Rt,gt,Mt))}else if(O.push(Y),gt>1)for(var we=0,Re=St;we<Re.length;we+=1){var Ie=ut.points[Re[we]];Ie.zoom<=D||(Ie.zoom=D,O.push(Ie))}}}return O},vi.prototype._getOriginId=function(C){return C-this.points.length>>5},vi.prototype._getOriginZoom=function(C){return(C-this.points.length)%32},vi.prototype._map=function(C,D){if(C.numPoints)return D?Jn({},C.properties):C.properties;var O=this.points[C.index].properties,j=this.options.map(O);return D&&j===O?Jn({},j):j},tr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},tr.prototype.splitTile=function(C,D,O,j,W,it,at){for(var V=[C,D,O,j],Y=this.options,ut=Y.debug;V.length;){j=V.pop(),O=V.pop(),D=V.pop(),C=V.pop();var St=1<<D,At=er(D,O,j),gt=this.tiles[At];if(!gt&&(ut>1&&console.time("creation"),gt=this.tiles[At]=Ga(C,D,O,j,Y),this.tileCoords.push({z:D,x:O,y:j}),ut)){ut>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",D,O,j,gt.numFeatures,gt.numPoints,gt.numSimplified),console.timeEnd("creation"));var It="z"+D;this.stats[It]=(this.stats[It]||0)+1,this.total++}if(gt.source=C,W){if(D===Y.maxZoom||D===W)continue;var Ht=1<<W-D;if(O!==Math.floor(it/Ht)||j!==Math.floor(at/Ht))continue}else if(D===Y.indexMaxZoom||gt.numPoints<=Y.indexMaxPoints)continue;if(gt.source=null,C.length!==0){ut>1&&console.time("clipping");var qt,bt,Ft,Mt,Rt,ge,Ot=.5*Y.buffer/Y.extent,be=.5-Ot,Be=.5+Ot,we=1+Ot;qt=bt=Ft=Mt=null,Rt=Hr(C,St,O-Ot,O+Be,0,gt.minX,gt.maxX,Y),ge=Hr(C,St,O+be,O+we,0,gt.minX,gt.maxX,Y),C=null,Rt&&(qt=Hr(Rt,St,j-Ot,j+Be,1,gt.minY,gt.maxY,Y),bt=Hr(Rt,St,j+be,j+we,1,gt.minY,gt.maxY,Y),Rt=null),ge&&(Ft=Hr(ge,St,j-Ot,j+Be,1,gt.minY,gt.maxY,Y),Mt=Hr(ge,St,j+be,j+we,1,gt.minY,gt.maxY,Y),ge=null),ut>1&&console.timeEnd("clipping"),V.push(qt||[],D+1,2*O,2*j),V.push(bt||[],D+1,2*O,2*j+1),V.push(Ft||[],D+1,2*O+1,2*j),V.push(Mt||[],D+1,2*O+1,2*j+1)}}},tr.prototype.getTile=function(C,D,O){var j=this.options,W=j.extent,it=j.debug;if(C<0||C>24)return null;var at=1<<C,V=er(C,D=(D%at+at)%at,O);if(this.tiles[V])return vr(this.tiles[V],W);it>1&&console.log("drilling down to z%d-%d-%d",C,D,O);for(var Y,ut=C,St=D,At=O;!Y&&ut>0;)ut--,St=Math.floor(St/2),At=Math.floor(At/2),Y=this.tiles[er(ut,St,At)];return Y&&Y.source?(it>1&&console.log("found parent tile z%d-%d-%d",ut,St,At),it>1&&console.time("drilling down"),this.splitTile(Y.source,ut,St,At,C,D,O),it>1&&console.timeEnd("drilling down"),this.tiles[V]?vr(this.tiles[V],W):null):null};var Ta=function(C){function D(O,j,W,it){C.call(this,O,j,W,Io),it&&(this.loadGeoJSON=it)}return C&&(D.__proto__=C),(D.prototype=Object.create(C&&C.prototype)).constructor=D,D.prototype.loadData=function(O,j){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=j,this._pendingLoadDataParams=O,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},D.prototype._loadData=function(){var O=this;if(this._pendingCallback&&this._pendingLoadDataParams){var j=this._pendingCallback,W=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var it=!!(W&&W.request&&W.request.collectResourceTiming)&&new u.RequestPerformance(W.request);this.loadGeoJSON(W,function(at,V){if(at||!V)return j(at);if(typeof V!="object")return j(new Error("Input data given to '"+W.source+"' is not a valid GeoJSON object."));(function gt(It,Ht){var qt,bt=It&&It.type;if(bt==="FeatureCollection")for(qt=0;qt<It.features.length;qt++)gt(It.features[qt],Ht);else if(bt==="GeometryCollection")for(qt=0;qt<It.geometries.length;qt++)gt(It.geometries[qt],Ht);else if(bt==="Feature")gt(It.geometry,Ht);else if(bt==="Polygon")bo(It.coordinates,Ht);else if(bt==="MultiPolygon")for(qt=0;qt<It.coordinates.length;qt++)bo(It.coordinates[qt],Ht);return It})(V,!0);try{if(W.filter){var Y=u.createExpression(W.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Y.result==="error")throw new Error(Y.value.map(function(gt){return gt.key+": "+gt.message}).join(", "));var ut=V.features.filter(function(gt){return Y.value.evaluate({zoom:0},gt)});V={type:"FeatureCollection",features:ut}}O._geoJSONIndex=W.cluster?new vi(function(gt){var It=gt.superclusterOptions,Ht=gt.clusterProperties;if(!Ht||!It)return It;for(var qt={},bt={},Ft={accumulated:null,zoom:0},Mt={properties:null},Rt=Object.keys(Ht),ge=0,Ot=Rt;ge<Ot.length;ge+=1){var be=Ot[ge],Be=Ht[be],we=Be[0],Re=u.createExpression(Be[1]),Ie=u.createExpression(typeof we=="string"?[we,["accumulated"],["get",be]]:we);qt[be]=Re.value,bt[be]=Ie.value}return It.map=function(Ui){Mt.properties=Ui;for(var Fe={},xi=0,Oe=Rt;xi<Oe.length;xi+=1){var Yt=Oe[xi];Fe[Yt]=qt[Yt].evaluate(Ft,Mt)}return Fe},It.reduce=function(Ui,Fe){Mt.properties=Fe;for(var xi=0,Oe=Rt;xi<Oe.length;xi+=1){var Yt=Oe[xi];Ft.accumulated=Ui[Yt],Ui[Yt]=bt[Yt].evaluate(Ft,Mt)}},It}(W)).load(V.features):function(gt,It){return new tr(gt,It)}(V,W.geojsonVtOptions)}catch(gt){return j(gt)}O.loaded={};var St={};if(it){var At=it.finish();At&&(St.resourceTiming={},St.resourceTiming[W.source]=JSON.parse(JSON.stringify(At)))}j(null,St)})}},D.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},D.prototype.reloadTile=function(O,j){var W=this.loaded;return W&&W[O.uid]?C.prototype.reloadTile.call(this,O,j):this.loadTile(O,j)},D.prototype.loadGeoJSON=function(O,j){if(O.request)u.getJSON(O.request,j);else{if(typeof O.data!="string")return j(new Error("Input data given to '"+O.source+"' is not a valid GeoJSON object."));try{return j(null,JSON.parse(O.data))}catch{return j(new Error("Input data given to '"+O.source+"' is not a valid GeoJSON object."))}}},D.prototype.removeSource=function(O,j){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),j()},D.prototype.getClusterExpansionZoom=function(O,j){try{j(null,this._geoJSONIndex.getClusterExpansionZoom(O.clusterId))}catch(W){j(W)}},D.prototype.getClusterChildren=function(O,j){try{j(null,this._geoJSONIndex.getChildren(O.clusterId))}catch(W){j(W)}},D.prototype.getClusterLeaves=function(O,j){try{j(null,this._geoJSONIndex.getLeaves(O.clusterId,O.limit,O.offset))}catch(W){j(W)}},D}(oi),$e=function(C){var D=this;this.self=C,this.actor=new u.Actor(C,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:oi,geojson:Ta},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(O,j){if(D.workerSourceTypes[O])throw new Error('Worker source with name "'+O+'" already registered.');D.workerSourceTypes[O]=j},this.self.registerRTLTextPlugin=function(O){if(u.plugin.isParsed())throw new Error("RTL text plugin already registered.");u.plugin.applyArabicShaping=O.applyArabicShaping,u.plugin.processBidirectionalText=O.processBidirectionalText,u.plugin.processStyledBidirectionalText=O.processStyledBidirectionalText}};return $e.prototype.setReferrer=function(C,D){this.referrer=D},$e.prototype.setImages=function(C,D,O){for(var j in this.availableImages[C]=D,this.workerSources[C]){var W=this.workerSources[C][j];for(var it in W)W[it].availableImages=D}O()},$e.prototype.setLayers=function(C,D,O){this.getLayerIndex(C).replace(D),O()},$e.prototype.updateLayers=function(C,D,O){this.getLayerIndex(C).update(D.layers,D.removedIds),O()},$e.prototype.loadTile=function(C,D,O){this.getWorkerSource(C,D.type,D.source).loadTile(D,O)},$e.prototype.loadDEMTile=function(C,D,O){this.getDEMWorkerSource(C,D.source).loadTile(D,O)},$e.prototype.reloadTile=function(C,D,O){this.getWorkerSource(C,D.type,D.source).reloadTile(D,O)},$e.prototype.abortTile=function(C,D,O){this.getWorkerSource(C,D.type,D.source).abortTile(D,O)},$e.prototype.removeTile=function(C,D,O){this.getWorkerSource(C,D.type,D.source).removeTile(D,O)},$e.prototype.removeDEMTile=function(C,D){this.getDEMWorkerSource(C,D.source).removeTile(D)},$e.prototype.removeSource=function(C,D,O){if(this.workerSources[C]&&this.workerSources[C][D.type]&&this.workerSources[C][D.type][D.source]){var j=this.workerSources[C][D.type][D.source];delete this.workerSources[C][D.type][D.source],j.removeSource!==void 0?j.removeSource(D,O):O()}},$e.prototype.loadWorkerSource=function(C,D,O){try{this.self.importScripts(D.url),O()}catch(j){O(j.toString())}},$e.prototype.syncRTLPluginState=function(C,D,O){try{u.plugin.setState(D);var j=u.plugin.getPluginURL();if(u.plugin.isLoaded()&&!u.plugin.isParsed()&&j!=null){this.self.importScripts(j);var W=u.plugin.isParsed();O(W?void 0:new Error("RTL Text Plugin failed to import scripts from "+j),W)}}catch(it){O(it.toString())}},$e.prototype.getAvailableImages=function(C){var D=this.availableImages[C];return D||(D=[]),D},$e.prototype.getLayerIndex=function(C){var D=this.layerIndexes[C];return D||(D=this.layerIndexes[C]=new Kt),D},$e.prototype.getWorkerSource=function(C,D,O){var j=this;return this.workerSources[C]||(this.workerSources[C]={}),this.workerSources[C][D]||(this.workerSources[C][D]={}),this.workerSources[C][D][O]||(this.workerSources[C][D][O]=new this.workerSourceTypes[D]({send:function(W,it,at){j.actor.send(W,it,at,C)}},this.getLayerIndex(C),this.getAvailableImages(C))),this.workerSources[C][D][O]},$e.prototype.getDEMWorkerSource=function(C,D){return this.demWorkerSources[C]||(this.demWorkerSources[C]={}),this.demWorkerSources[C][D]||(this.demWorkerSources[C][D]=new lr),this.demWorkerSources[C][D]},$e.prototype.enforceCacheSizeLimit=function(C,D){u.enforceCacheSizeLimit(D)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new $e(self)),$e}),nt(["./shared"],function(u){var Et=u.createCommonjsModule(function(n){function a(f){return!o(f)}function o(f){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var g,w,I=new Blob([""],{type:"text/javascript"}),k=URL.createObjectURL(I);try{w=new Worker(k),g=!0}catch{g=!1}return w&&w.terminate(),URL.revokeObjectURL(k),g}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var g=document.createElement("canvas");g.width=g.height=1;var w=g.getContext("2d");if(!w)return!1;var I=w.getImageData(0,0,1,1);return I&&I.width===g.width}()?(l[y=f&&f.failIfMajorPerformanceCaveat]===void 0&&(l[y]=function(g){var w=function(k){var U=document.createElement("canvas"),Z=Object.create(a.webGLContextAttributes);return Z.failIfMajorPerformanceCaveat=k,U.probablySupportsContext?U.probablySupportsContext("webgl",Z)||U.probablySupportsContext("experimental-webgl",Z):U.supportsContext?U.supportsContext("webgl",Z)||U.supportsContext("experimental-webgl",Z):U.getContext("webgl",Z)||U.getContext("experimental-webgl",Z)}(g);if(!w)return!1;var I=w.createShader(w.VERTEX_SHADER);return!(!I||w.isContextLost())&&(w.shaderSource(I,"void main() {}"),w.compileShader(I),w.getShaderParameter(I,w.COMPILE_STATUS)===!0)}(y)),l[y]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var y}n.exports?n.exports=a:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=a,window.mapboxgl.notSupportedReason=o);var l={};a.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),st={create:function(n,a,o){var l=u.window.document.createElement(n);return a!==void 0&&(l.className=a),o&&o.appendChild(l),l},createNS:function(n,a){return u.window.document.createElementNS(n,a)}},Kt=u.window.document&&u.window.document.documentElement.style;function Vt(n){if(!Kt)return n[0];for(var a=0;a<n.length;a++)if(n[a]in Kt)return n[a];return n[0]}var fe,Ct=Vt(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);st.disableDrag=function(){Kt&&Ct&&(fe=Kt[Ct],Kt[Ct]="none")},st.enableDrag=function(){Kt&&Ct&&(Kt[Ct]=fe)};var sr=Vt(["transform","WebkitTransform"]);st.setTransform=function(n,a){n.style[sr]=a};var oi=!1;try{var Je=Object.defineProperty({},"passive",{get:function(){oi=!0}});u.window.addEventListener("test",Je,Je),u.window.removeEventListener("test",Je,Je)}catch{oi=!1}st.addEventListener=function(n,a,o,l){l===void 0&&(l={}),n.addEventListener(a,o,"passive"in l&&oi?l:l.capture)},st.removeEventListener=function(n,a,o,l){l===void 0&&(l={}),n.removeEventListener(a,o,"passive"in l&&oi?l:l.capture)};var lr=function(n){n.preventDefault(),n.stopPropagation(),u.window.removeEventListener("click",lr,!0)};function bo(n){var a=n.userImage;return!!(a&&a.render&&a.render())&&(n.data.replace(new Uint8Array(a.data.buffer)),!0)}st.suppressClick=function(){u.window.addEventListener("click",lr,!0),u.window.setTimeout(function(){u.window.removeEventListener("click",lr,!0)},0)},st.mousePos=function(n,a){var o=n.getBoundingClientRect();return new u.Point(a.clientX-o.left-n.clientLeft,a.clientY-o.top-n.clientTop)},st.touchPos=function(n,a){for(var o=n.getBoundingClientRect(),l=[],f=0;f<a.length;f++)l.push(new u.Point(a[f].clientX-o.left-n.clientLeft,a[f].clientY-o.top-n.clientTop));return l},st.mouseButton=function(n){return u.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&u.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},st.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var ki=function(n){function a(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.isLoaded=function(){return this.loaded},a.prototype.setLoaded=function(o){if(this.loaded!==o&&(this.loaded=o,o)){for(var l=0,f=this.requestors;l<f.length;l+=1){var y=f[l];this._notify(y.ids,y.callback)}this.requestors=[]}},a.prototype.getImage=function(o){return this.images[o]},a.prototype.addImage=function(o,l){this._validate(o,l)&&(this.images[o]=l)},a.prototype._validate=function(o,l){var f=!0;return this._validateStretch(l.stretchX,l.data&&l.data.width)||(this.fire(new u.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchX" value'))),f=!1),this._validateStretch(l.stretchY,l.data&&l.data.height)||(this.fire(new u.ErrorEvent(new Error('Image "'+o+'" has invalid "stretchY" value'))),f=!1),this._validateContent(l.content,l)||(this.fire(new u.ErrorEvent(new Error('Image "'+o+'" has invalid "content" value'))),f=!1),f},a.prototype._validateStretch=function(o,l){if(!o)return!0;for(var f=0,y=0,g=o;y<g.length;y+=1){var w=g[y];if(w[0]<f||w[1]<w[0]||l<w[1])return!1;f=w[1]}return!0},a.prototype._validateContent=function(o,l){return!(o&&(o.length!==4||o[0]<0||l.data.width<o[0]||o[1]<0||l.data.height<o[1]||o[2]<0||l.data.width<o[2]||o[3]<0||l.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))},a.prototype.updateImage=function(o,l){l.version=this.images[o].version+1,this.images[o]=l,this.updatedImages[o]=!0},a.prototype.removeImage=function(o){var l=this.images[o];delete this.images[o],delete this.patterns[o],l.userImage&&l.userImage.onRemove&&l.userImage.onRemove()},a.prototype.listImages=function(){return Object.keys(this.images)},a.prototype.getImages=function(o,l){var f=!0;if(!this.isLoaded())for(var y=0,g=o;y<g.length;y+=1)this.images[g[y]]||(f=!1);this.isLoaded()||f?this._notify(o,l):this.requestors.push({ids:o,callback:l})},a.prototype._notify=function(o,l){for(var f={},y=0,g=o;y<g.length;y+=1){var w=g[y];this.images[w]||this.fire(new u.Event("styleimagemissing",{id:w}));var I=this.images[w];I?f[w]={data:I.data.clone(),pixelRatio:I.pixelRatio,sdf:I.sdf,version:I.version,stretchX:I.stretchX,stretchY:I.stretchY,content:I.content,hasRenderCallback:Boolean(I.userImage&&I.userImage.render)}:u.warnOnce('Image "'+w+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}l(null,f)},a.prototype.getPixelSize=function(){var o=this.atlasImage;return{width:o.width,height:o.height}},a.prototype.getPattern=function(o){var l=this.patterns[o],f=this.getImage(o);if(!f)return null;if(l&&l.position.version===f.version)return l.position;if(l)l.position.version=f.version;else{var y={w:f.data.width+2,h:f.data.height+2,x:0,y:0},g=new u.ImagePosition(y,f);this.patterns[o]={bin:y,position:g}}return this._updatePatternAtlas(),this.patterns[o].position},a.prototype.bind=function(o){var l=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new u.Texture(o,this.atlasImage,l.RGBA),this.atlasTexture.bind(l.LINEAR,l.CLAMP_TO_EDGE)},a.prototype._updatePatternAtlas=function(){var o=[];for(var l in this.patterns)o.push(this.patterns[l].bin);var f=u.potpack(o),y=f.w,g=f.h,w=this.atlasImage;for(var I in w.resize({width:y||1,height:g||1}),this.patterns){var k=this.patterns[I].bin,U=k.x+1,Z=k.y+1,q=this.images[I].data,J=q.width,K=q.height;u.RGBAImage.copy(q,w,{x:0,y:0},{x:U,y:Z},{width:J,height:K}),u.RGBAImage.copy(q,w,{x:0,y:K-1},{x:U,y:Z-1},{width:J,height:1}),u.RGBAImage.copy(q,w,{x:0,y:0},{x:U,y:Z+K},{width:J,height:1}),u.RGBAImage.copy(q,w,{x:J-1,y:0},{x:U-1,y:Z},{width:1,height:K}),u.RGBAImage.copy(q,w,{x:0,y:0},{x:U+J,y:Z},{width:1,height:K})}this.dirty=!0},a.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},a.prototype.dispatchRenderCallbacks=function(o){for(var l=0,f=o;l<f.length;l+=1){var y=f[l];if(!this.callbackDispatchedThisFrame[y]){this.callbackDispatchedThisFrame[y]=!0;var g=this.images[y];bo(g)&&this.updateImage(y,g)}}},a}(u.Evented),Gr=Hn,wo=Hn,an=1e20;function Hn(n,a,o,l,f,y){this.fontSize=n||24,this.buffer=a===void 0?3:a,this.cutoff=l||.25,this.fontFamily=f||"sans-serif",this.fontWeight=y||"normal",this.radius=o||8;var g=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=g,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(g*g),this.gridInner=new Float64Array(g*g),this.f=new Float64Array(g),this.d=new Float64Array(g),this.z=new Float64Array(g+1),this.v=new Int16Array(g),this.middle=Math.round(g/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function To(n,a,o,l,f,y,g){for(var w=0;w<a;w++){for(var I=0;I<o;I++)l[I]=n[I*a+w];for(Xn(l,f,y,g,o),I=0;I<o;I++)n[I*a+w]=f[I]}for(I=0;I<o;I++){for(w=0;w<a;w++)l[w]=n[I*a+w];for(Xn(l,f,y,g,a),w=0;w<a;w++)n[I*a+w]=Math.sqrt(f[w])}}function Xn(n,a,o,l,f){o[0]=0,l[0]=-an,l[1]=+an;for(var y=1,g=0;y<f;y++){for(var w=(n[y]+y*y-(n[o[g]]+o[g]*o[g]))/(2*y-2*o[g]);w<=l[g];)g--,w=(n[y]+y*y-(n[o[g]]+o[g]*o[g]))/(2*y-2*o[g]);o[++g]=y,l[g]=w,l[g+1]=+an}for(y=0,g=0;y<f;y++){for(;l[g+1]<y;)g++;a[y]=(y-o[g])*(y-o[g])+n[o[g]]}}Hn.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var a=this.ctx.getImageData(0,0,this.size,this.size),o=new Uint8ClampedArray(this.size*this.size),l=0;l<this.size*this.size;l++){var f=a.data[4*l+3]/255;this.gridOuter[l]=f===1?0:f===0?an:Math.pow(Math.max(0,.5-f),2),this.gridInner[l]=f===1?an:f===0?0:Math.pow(Math.max(0,f-.5),2)}for(To(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),To(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),l=0;l<this.size*this.size;l++)o[l]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[l]-this.gridInner[l])/this.radius+this.cutoff))));return o},Gr.default=wo;var Qi=function(n,a){this.requestManager=n,this.localIdeographFontFamily=a,this.entries={}};Qi.prototype.setURL=function(n){this.url=n},Qi.prototype.getGlyphs=function(n,a){var o=this,l=[];for(var f in n)for(var y=0,g=n[f];y<g.length;y+=1)l.push({stack:f,id:g[y]});u.asyncAll(l,function(w,I){var k=w.stack,U=w.id,Z=o.entries[k];Z||(Z=o.entries[k]={glyphs:{},requests:{},ranges:{}});var q=Z.glyphs[U];if(q===void 0){if(q=o._tinySDF(Z,k,U))return Z.glyphs[U]=q,void I(null,{stack:k,id:U,glyph:q});var J=Math.floor(U/256);if(256*J>65535)I(new Error("glyphs > 65535 not supported"));else if(Z.ranges[J])I(null,{stack:k,id:U,glyph:q});else{var K=Z.requests[J];K||(K=Z.requests[J]=[],Qi.loadGlyphRange(k,J,o.url,o.requestManager,function(tt,G){if(G){for(var Q in G)o._doesCharSupportLocalGlyph(+Q)||(Z.glyphs[+Q]=G[+Q]);Z.ranges[J]=!0}for(var ot=0,ht=K;ot<ht.length;ot+=1)(0,ht[ot])(tt,G);delete Z.requests[J]})),K.push(function(tt,G){tt?I(tt):G&&I(null,{stack:k,id:U,glyph:G[U]||null})})}}else I(null,{stack:k,id:U,glyph:q})},function(w,I){if(w)a(w);else if(I){for(var k={},U=0,Z=I;U<Z.length;U+=1){var q=Z[U],J=q.stack,K=q.id,tt=q.glyph;(k[J]||(k[J]={}))[K]=tt&&{id:tt.id,bitmap:tt.bitmap.clone(),metrics:tt.metrics}}a(null,k)}})},Qi.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(u.isChar["CJK Unified Ideographs"](n)||u.isChar["Hangul Syllables"](n)||u.isChar.Hiragana(n)||u.isChar.Katakana(n))},Qi.prototype._tinySDF=function(n,a,o){var l=this.localIdeographFontFamily;if(l&&this._doesCharSupportLocalGlyph(o)){var f=n.tinySDF;if(!f){var y="400";/bold/i.test(a)?y="900":/medium/i.test(a)?y="500":/light/i.test(a)&&(y="200"),f=n.tinySDF=new Qi.TinySDF(24,3,8,.25,l,y)}return{id:o,bitmap:new u.AlphaImage({width:30,height:30},f.draw(String.fromCharCode(o))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},Qi.loadGlyphRange=function(n,a,o,l,f){var y=256*a,g=y+255,w=l.transformRequest(l.normalizeGlyphsURL(o).replace("{fontstack}",n).replace("{range}",y+"-"+g),u.ResourceType.Glyphs);u.getArrayBuffer(w,function(I,k){if(I)f(I);else if(k){for(var U={},Z=0,q=u.parseGlyphPBF(k);Z<q.length;Z+=1){var J=q[Z];U[J.id]=J}f(null,U)}})},Qi.TinySDF=Gr;var Tn=function(){this.specification=u.styleSpec.light.position};Tn.prototype.possiblyEvaluate=function(n,a){return u.sphericalToCartesian(n.expression.evaluate(a))},Tn.prototype.interpolate=function(n,a,o){return{x:u.number(n.x,a.x,o),y:u.number(n.y,a.y,o),z:u.number(n.z,a.z,o)}};var li=new u.Properties({anchor:new u.DataConstantProperty(u.styleSpec.light.anchor),position:new Tn,color:new u.DataConstantProperty(u.styleSpec.light.color),intensity:new u.DataConstantProperty(u.styleSpec.light.intensity)}),ji=function(n){function a(o){n.call(this),this._transitionable=new u.Transitionable(li),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getLight=function(){return this._transitionable.serialize()},a.prototype.setLight=function(o,l){if(l===void 0&&(l={}),!this._validate(u.validateLight,o,l))for(var f in o){var y=o[f];u.endsWith(f,"-transition")?this._transitionable.setTransition(f.slice(0,-11),y):this._transitionable.setValue(f,y)}},a.prototype.updateTransitions=function(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)},a.prototype.hasTransition=function(){return this._transitioning.hasTransition()},a.prototype.recalculate=function(o){this.properties=this._transitioning.possiblyEvaluate(o)},a.prototype._validate=function(o,l,f){return(!f||f.validate!==!1)&&u.emitValidationErrors(this,o.call(u.validateStyle,u.extend({value:l,style:{glyphs:!0,sprite:!0},styleSpec:u.styleSpec})))},a}(u.Evented),_i=function(n,a){this.width=n,this.height=a,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};_i.prototype.getDash=function(n,a){var o=n.join(",")+String(a);return this.dashEntry[o]||(this.dashEntry[o]=this.addDash(n,a)),this.dashEntry[o]},_i.prototype.getDashRanges=function(n,a,o){var l=[],f=n.length%2==1?-n[n.length-1]*o:0,y=n[0]*o,g=!0;l.push({left:f,right:y,isDash:g,zeroLength:n[0]===0});for(var w=n[0],I=1;I<n.length;I++){var k=n[I];l.push({left:f=w*o,right:y=(w+=k)*o,isDash:g=!g,zeroLength:k===0})}return l},_i.prototype.addRoundDash=function(n,a,o){for(var l=a/2,f=-o;f<=o;f++)for(var y=this.width*(this.nextRow+o+f),g=0,w=n[g],I=0;I<this.width;I++){I/w.right>1&&(w=n[++g]);var k=Math.abs(I-w.left),U=Math.abs(I-w.right),Z=Math.min(k,U),q=void 0,J=f/o*(l+1);if(w.isDash){var K=l-Math.abs(J);q=Math.sqrt(Z*Z+K*K)}else q=l-Math.sqrt(Z*Z+J*J);this.data[y+I]=Math.max(0,Math.min(255,q+128))}},_i.prototype.addRegularDash=function(n){for(var a=n.length-1;a>=0;--a){var o=n[a],l=n[a+1];o.zeroLength?n.splice(a,1):l&&l.isDash===o.isDash&&(l.left=o.left,n.splice(a,1))}var f=n[0],y=n[n.length-1];f.isDash===y.isDash&&(f.left=y.left-this.width,y.right=f.right+this.width);for(var g=this.width*this.nextRow,w=0,I=n[w],k=0;k<this.width;k++){k/I.right>1&&(I=n[++w]);var U=Math.abs(k-I.left),Z=Math.abs(k-I.right),q=Math.min(U,Z);this.data[g+k]=Math.max(0,Math.min(255,(I.isDash?q:-q)+128))}},_i.prototype.addDash=function(n,a){var o=a?7:0,l=2*o+1;if(this.nextRow+l>this.height)return u.warnOnce("LineAtlas out of space"),null;for(var f=0,y=0;y<n.length;y++)f+=n[y];if(f!==0){var g=this.width/f,w=this.getDashRanges(n,this.width,g);a?this.addRoundDash(w,g,o):this.addRegularDash(w)}var I={y:(this.nextRow+o+.5)/this.height,height:2*o/this.height,width:f};return this.nextRow+=l,this.dirty=!0,I},_i.prototype.bind=function(n){var a=n.gl;this.texture?(a.bindTexture(a.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,a.texSubImage2D(a.TEXTURE_2D,0,0,0,this.width,this.height,a.ALPHA,a.UNSIGNED_BYTE,this.data))):(this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.REPEAT),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texImage2D(a.TEXTURE_2D,0,a.ALPHA,this.width,this.height,0,a.ALPHA,a.UNSIGNED_BYTE,this.data))};var Ei=function n(a,o){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=u.uniqueId();for(var l=this.workerPool.acquire(this.id),f=0;f<l.length;f++){var y=new n.Actor(l[f],o,this.id);y.name="Worker "+f,this.actors.push(y)}};function ja(n,a,o){var l=function(f,y){if(f)return o(f);if(y){var g=u.pick(u.extend(y,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);y.vector_layers&&(g.vectorLayers=y.vector_layers,g.vectorLayerIds=g.vectorLayers.map(function(w){return w.id})),g.tiles=a.canonicalizeTileset(g,n.url),o(null,g)}};return n.url?u.getJSON(a.transformRequest(a.normalizeSourceURL(n.url),u.ResourceType.Source),l):u.browser.frame(function(){return l(null,n)})}Ei.prototype.broadcast=function(n,a,o){u.asyncAll(this.actors,function(l,f){l.send(n,a,f)},o=o||function(){})},Ei.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},Ei.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},Ei.Actor=u.Actor;var Ti=function(n,a,o){this.bounds=u.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=a||0,this.maxzoom=o||24};Ti.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},Ti.prototype.contains=function(n){var a=Math.pow(2,n.z),o=Math.floor(u.mercatorXfromLng(this.bounds.getWest())*a),l=Math.floor(u.mercatorYfromLat(this.bounds.getNorth())*a),f=Math.ceil(u.mercatorXfromLng(this.bounds.getEast())*a),y=Math.ceil(u.mercatorYfromLat(this.bounds.getSouth())*a);return n.x>=o&&n.x<f&&n.y>=l&&n.y<y};var Sn=function(n){function a(o,l,f,y){if(n.call(this),this.id=o,this.dispatcher=f,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.extend(this,u.pick(l,["url","scheme","tileSize","promoteId"])),this._options=u.extend({type:"vector"},l),this._collectResourceTiming=l.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ja(this._options,this.map._requestManager,function(l,f){o._tileJSONRequest=null,o._loaded=!0,l?o.fire(new u.ErrorEvent(l)):f&&(u.extend(o,f),f.bounds&&(o.tileBounds=new Ti(f.bounds,o.minzoom,o.maxzoom)),u.postTurnstileEvent(f.tiles,o.map._requestManager._customAccessToken),u.postMapLoadEvent(f.tiles,o.map._getMapId(),o.map._requestManager._skuToken,o.map._requestManager._customAccessToken),o.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setSourceProperty=function(o){this._tileJSONRequest&&this._tileJSONRequest.cancel(),o(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},a.prototype.setTiles=function(o){var l=this;return this.setSourceProperty(function(){l._options.tiles=o}),this},a.prototype.setUrl=function(o){var l=this;return this.setSourceProperty(function(){l.url=o,l._options.url=o}),this},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return u.extend({},this._options)},a.prototype.loadTile=function(o,l){var f=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(f,u.ResourceType.Tile),uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:u.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function g(w,I){return delete o.request,o.aborted?l(null):w&&w.status!==404?l(w):(I&&I.resourceTiming&&(o.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&o.setExpiryData(I),o.loadVectorData(I,this.map.painter),u.cacheEntryPossiblyAdded(this.dispatcher),l(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}y.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired"?o.state==="loading"?o.reloadCallback=l:o.request=o.actor.send("reloadTile",y,g.bind(this)):(o.actor=this.dispatcher.getActor(),o.request=o.actor.send("loadTile",y,g.bind(this)))},a.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id},void 0)},a.prototype.unloadTile=function(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id},void 0)},a.prototype.hasTransition=function(){return!1},a}(u.Evented),de=function(n){function a(o,l,f,y){n.call(this),this.id=o,this.dispatcher=f,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.extend({type:"raster"},l),u.extend(this,u.pick(l,["url","scheme","tileSize"]))}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ja(this._options,this.map._requestManager,function(l,f){o._tileJSONRequest=null,o._loaded=!0,l?o.fire(new u.ErrorEvent(l)):f&&(u.extend(o,f),f.bounds&&(o.tileBounds=new Ti(f.bounds,o.minzoom,o.maxzoom)),u.postTurnstileEvent(f.tiles),u.postMapLoadEvent(f.tiles,o.map._getMapId(),o.map._requestManager._skuToken),o.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),o.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})},a.prototype.loaded=function(){return this._loaded},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},a.prototype.serialize=function(){return u.extend({},this._options)},a.prototype.hasTile=function(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)},a.prototype.loadTile=function(o,l){var f=this,y=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);o.request=u.getImage(this.map._requestManager.transformRequest(y,u.ResourceType.Tile),function(g,w){if(delete o.request,o.aborted)o.state="unloaded",l(null);else if(g)o.state="errored",l(g);else if(w){f.map._refreshExpiredTiles&&o.setExpiryData(w),delete w.cacheControl,delete w.expires;var I=f.map.painter.context,k=I.gl;o.texture=f.map.painter.getTileTexture(w.width),o.texture?o.texture.update(w,{useMipmap:!0}):(o.texture=new u.Texture(I,w,k.RGBA,{useMipmap:!0}),o.texture.bind(k.LINEAR,k.CLAMP_TO_EDGE,k.LINEAR_MIPMAP_NEAREST),I.extTextureFilterAnisotropic&&k.texParameterf(k.TEXTURE_2D,I.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,I.extTextureFilterAnisotropicMax)),o.state="loaded",u.cacheEntryPossiblyAdded(f.dispatcher),l(null)}})},a.prototype.abortTile=function(o,l){o.request&&(o.request.cancel(),delete o.request),l()},a.prototype.unloadTile=function(o,l){o.texture&&this.map.painter.saveTileTexture(o.texture),l()},a.prototype.hasTransition=function(){return!1},a}(u.Evented),xa=function(n){function a(o,l,f,y){n.call(this,o,l,f,y),this.type="raster-dem",this.maxzoom=22,this._options=u.extend({type:"raster-dem"},l),this.encoding=l.encoding||"mapbox"}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},a.prototype.loadTile=function(o,l){var f=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function y(g,w){g&&(o.state="errored",l(g)),w&&(o.dem=w,o.needsHillshadePrepare=!0,o.state="loaded",l(null))}o.request=u.getImage(this.map._requestManager.transformRequest(f,u.ResourceType.Tile),function(g,w){if(delete o.request,o.aborted)o.state="unloaded",l(null);else if(g)o.state="errored",l(g);else if(w){this.map._refreshExpiredTiles&&o.setExpiryData(w),delete w.cacheControl,delete w.expires;var I=u.window.ImageBitmap&&w instanceof u.window.ImageBitmap&&u.offscreenCanvasSupported()?w:u.browser.getImageData(w,1),k={uid:o.uid,coord:o.tileID,source:this.id,rawImageData:I,encoding:this.encoding};o.actor&&o.state!=="expired"||(o.actor=this.dispatcher.getActor(),o.actor.send("loadDEMTile",k,y.bind(this)))}}.bind(this)),o.neighboringTiles=this._getNeighboringTiles(o.tileID)},a.prototype._getNeighboringTiles=function(o){var l=o.canonical,f=Math.pow(2,l.z),y=(l.x-1+f)%f,g=l.x===0?o.wrap-1:o.wrap,w=(l.x+1+f)%f,I=l.x+1===f?o.wrap+1:o.wrap,k={};return k[new u.OverscaledTileID(o.overscaledZ,g,l.z,y,l.y).key]={backfilled:!1},k[new u.OverscaledTileID(o.overscaledZ,I,l.z,w,l.y).key]={backfilled:!1},l.y>0&&(k[new u.OverscaledTileID(o.overscaledZ,g,l.z,y,l.y-1).key]={backfilled:!1},k[new u.OverscaledTileID(o.overscaledZ,o.wrap,l.z,l.x,l.y-1).key]={backfilled:!1},k[new u.OverscaledTileID(o.overscaledZ,I,l.z,w,l.y-1).key]={backfilled:!1}),l.y+1<f&&(k[new u.OverscaledTileID(o.overscaledZ,g,l.z,y,l.y+1).key]={backfilled:!1},k[new u.OverscaledTileID(o.overscaledZ,o.wrap,l.z,l.x,l.y+1).key]={backfilled:!1},k[new u.OverscaledTileID(o.overscaledZ,I,l.z,w,l.y+1).key]={backfilled:!1}),k},a.prototype.unloadTile=function(o){o.demTexture&&this.map.painter.saveTileTexture(o.demTexture),o.fbo&&(o.fbo.destroy(),delete o.fbo),o.dem&&delete o.dem,delete o.neighboringTiles,o.state="unloaded",o.actor&&o.actor.send("removeDEMTile",{uid:o.uid,source:this.id})},a}(de),Ce=function(n){function a(o,l,f,y){n.call(this),this.id=o,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(y),this._data=l.data,this._options=u.extend({},l),this._collectResourceTiming=l.collectResourceTiming,this._resourceTiming=[],l.maxzoom!==void 0&&(this.maxzoom=l.maxzoom),l.type&&(this.type=l.type),l.attribution&&(this.attribution=l.attribution),this.promoteId=l.promoteId;var g=u.EXTENT/this.tileSize;this.workerOptions=u.extend({source:this.id,cluster:l.cluster||!1,geojsonVtOptions:{buffer:(l.buffer!==void 0?l.buffer:128)*g,tolerance:(l.tolerance!==void 0?l.tolerance:.375)*g,extent:u.EXTENT,maxZoom:this.maxzoom,lineMetrics:l.lineMetrics||!1,generateId:l.generateId||!1},superclusterOptions:{maxZoom:l.clusterMaxZoom!==void 0?Math.min(l.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,l.clusterMinPoints||2),extent:u.EXTENT,radius:(l.clusterRadius||50)*g,log:!1,generateId:l.generateId||!1},clusterProperties:l.clusterProperties,filter:l.filter},l.workerOptions)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this.fire(new u.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(l){if(l)o.fire(new u.ErrorEvent(l));else{var f={dataType:"source",sourceDataType:"metadata"};o._collectResourceTiming&&o._resourceTiming&&o._resourceTiming.length>0&&(f.resourceTiming=o._resourceTiming,o._resourceTiming=[]),o.fire(new u.Event("data",f))}})},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setData=function(o){var l=this;return this._data=o,this.fire(new u.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(f){if(f)l.fire(new u.ErrorEvent(f));else{var y={dataType:"source",sourceDataType:"content"};l._collectResourceTiming&&l._resourceTiming&&l._resourceTiming.length>0&&(y.resourceTiming=l._resourceTiming,l._resourceTiming=[]),l.fire(new u.Event("data",y))}}),this},a.prototype.getClusterExpansionZoom=function(o,l){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:o,source:this.id},l),this},a.prototype.getClusterChildren=function(o,l){return this.actor.send("geojson.getClusterChildren",{clusterId:o,source:this.id},l),this},a.prototype.getClusterLeaves=function(o,l,f,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:o,limit:l,offset:f},y),this},a.prototype._updateWorkerData=function(o){var l=this;this._loaded=!1;var f=u.extend({},this.workerOptions),y=this._data;typeof y=="string"?(f.request=this.map._requestManager.transformRequest(u.browser.resolveURL(y),u.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(y),this.actor.send(this.type+".loadData",f,function(g,w){l._removed||w&&w.abandoned||(l._loaded=!0,w&&w.resourceTiming&&w.resourceTiming[l.id]&&(l._resourceTiming=w.resourceTiming[l.id].slice(0)),l.actor.send(l.type+".coalesce",{source:f.source},null),o(g))})},a.prototype.loaded=function(){return this._loaded},a.prototype.loadTile=function(o,l){var f=this,y=o.actor?"reloadTile":"loadTile";o.actor=this.actor,o.request=this.actor.send(y,{type:this.type,uid:o.uid,tileID:o.tileID,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:u.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(g,w){return delete o.request,o.unloadVectorData(),o.aborted?l(null):g?l(g):(o.loadVectorData(w,f.map.painter,y==="reloadTile"),l(null))})},a.prototype.abortTile=function(o){o.request&&(o.request.cancel(),delete o.request),o.aborted=!0},a.prototype.unloadTile=function(o){o.unloadVectorData(),this.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})},a.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},a.prototype.serialize=function(){return u.extend({},this._options,{type:this.type,data:this._data})},a.prototype.hasTransition=function(){return!1},a}(u.Evented),We=u.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Oi=function(n){function a(o,l,f,y){n.call(this),this.id=o,this.dispatcher=f,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=l}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(o,l){var f=this;this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this.url=this.options.url,u.getImage(this.map._requestManager.transformRequest(this.url,u.ResourceType.Image),function(y,g){f._loaded=!0,y?f.fire(new u.ErrorEvent(y)):g&&(f.image=g,o&&(f.coordinates=o),l&&l(),f._finishLoading())})},a.prototype.loaded=function(){return this._loaded},a.prototype.updateImage=function(o){var l=this;return this.image&&o.url?(this.options.url=o.url,this.load(o.coordinates,function(){l.texture=null}),this):this},a.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})))},a.prototype.onAdd=function(o){this.map=o,this.load()},a.prototype.setCoordinates=function(o){var l=this;this.coordinates=o;var f=o.map(u.MercatorCoordinate.fromLngLat);this.tileID=function(g){for(var w=1/0,I=1/0,k=-1/0,U=-1/0,Z=0,q=g;Z<q.length;Z+=1){var J=q[Z];w=Math.min(w,J.x),I=Math.min(I,J.y),k=Math.max(k,J.x),U=Math.max(U,J.y)}var K=Math.max(k-w,U-I),tt=Math.max(0,Math.floor(-Math.log(K)/Math.LN2)),G=Math.pow(2,tt);return new u.CanonicalTileID(tt,Math.floor((w+k)/2*G),Math.floor((I+U)/2*G))}(f),this.minzoom=this.maxzoom=this.tileID.z;var y=f.map(function(g){return l.tileID.getTilePoint(g)._round()});return this._boundsArray=new u.StructArrayLayout4i8,this._boundsArray.emplaceBack(y[0].x,y[0].y,0,0),this._boundsArray.emplaceBack(y[1].x,y[1].y,u.EXTENT,0),this._boundsArray.emplaceBack(y[3].x,y[3].y,0,u.EXTENT),this._boundsArray.emplaceBack(y[2].x,y[2].y,u.EXTENT,u.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})),this},a.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var o=this.map.painter.context,l=o.gl;for(var f in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,We.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new u.Texture(o,this.image,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture)}}},a.prototype.loadTile=function(o,l){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},l(null)):(o.state="errored",l(null))},a.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return!1},a}(u.Evented),Fi=function(n){function a(o,l,f,y){n.call(this,o,l,f,y),this.roundZoom=!0,this.type="video",this.options=l}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){var o=this;this._loaded=!1;var l=this.options;this.urls=[];for(var f=0,y=l.urls;f<y.length;f+=1)this.urls.push(this.map._requestManager.transformRequest(y[f],u.ResourceType.Source).url);u.getVideo(this.urls,function(g,w){o._loaded=!0,g?o.fire(new u.ErrorEvent(g)):w&&(o.video=w,o.video.loop=!0,o.video.addEventListener("playing",function(){o.map.triggerRepaint()}),o.map&&o.video.play(),o._finishLoading())})},a.prototype.pause=function(){this.video&&this.video.pause()},a.prototype.play=function(){this.video&&this.video.play()},a.prototype.seek=function(o){if(this.video){var l=this.video.seekable;o<l.start(0)||o>l.end(0)?this.fire(new u.ErrorEvent(new u.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+l.start(0)+" and "+l.end(0)+"-second mark."))):this.video.currentTime=o}},a.prototype.getVideo=function(){return this.video},a.prototype.onAdd=function(o){this.map||(this.map=o,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},a.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var o=this.map.painter.context,l=o.gl;for(var f in this.boundsBuffer||(this.boundsBuffer=o.createVertexBuffer(this._boundsArray,We.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE),l.texSubImage2D(l.TEXTURE_2D,0,0,0,l.RGBA,l.UNSIGNED_BYTE,this.video)):(this.texture=new u.Texture(o,this.video,l.RGBA),this.texture.bind(l.LINEAR,l.CLAMP_TO_EDGE)),this.tiles){var y=this.tiles[f];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this.video&&!this.video.paused},a}(Oi),yi=function(n){function a(o,l,f,y){n.call(this,o,l,f,y),l.coordinates?Array.isArray(l.coordinates)&&l.coordinates.length===4&&!l.coordinates.some(function(g){return!Array.isArray(g)||g.length!==2||g.some(function(w){return typeof w!="number"})})||this.fire(new u.ErrorEvent(new u.ValidationError("sources."+o,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.ErrorEvent(new u.ValidationError("sources."+o,null,'missing required property "coordinates"'))),l.animate&&typeof l.animate!="boolean"&&this.fire(new u.ErrorEvent(new u.ValidationError("sources."+o,null,'optional "animate" property must be a boolean value'))),l.canvas?typeof l.canvas=="string"||l.canvas instanceof u.window.HTMLCanvasElement||this.fire(new u.ErrorEvent(new u.ValidationError("sources."+o,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.ErrorEvent(new u.ValidationError("sources."+o,null,'missing required property "canvas"'))),this.options=l,this.animate=l.animate===void 0||l.animate}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof u.window.HTMLCanvasElement?this.options.canvas:u.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},a.prototype.getCanvas=function(){return this.canvas},a.prototype.onAdd=function(o){this.map=o,this.load(),this.canvas&&this.animate&&this.play()},a.prototype.onRemove=function(){this.pause()},a.prototype.prepare=function(){var o=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,o=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,o=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var l=this.map.painter.context,f=l.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=l.createVertexBuffer(this._boundsArray,We.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(o||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new u.Texture(l,this.canvas,f.RGBA,{premultiply:!0}),this.tiles){var g=this.tiles[y];g.state!=="loaded"&&(g.state="loaded",g.texture=this.texture)}}},a.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},a.prototype.hasTransition=function(){return this._playing},a.prototype._hasInvalidDimensions=function(){for(var o=0,l=[this.canvas.width,this.canvas.height];o<l.length;o+=1){var f=l[o];if(isNaN(f)||f<=0)return!0}return!1},a}(Oi),Ve={vector:Sn,raster:de,"raster-dem":xa,geojson:Ce,video:Fi,image:Oi,canvas:yi};function gi(n,a){var o=u.identity([]);return u.translate(o,o,[1,1,0]),u.scale(o,o,[.5*n.width,.5*n.height,1]),u.multiply(o,o,n.calculatePosMatrix(a.toUnwrapped()))}function vi(n,a,o,l,f,y){var g=function(tt,G,Q){if(tt)for(var ot=0,ht=tt;ot<ht.length;ot+=1){var _t=G[ht[ot]];if(_t&&_t.source===Q&&_t.type==="fill-extrusion")return!0}else for(var dt in G){var vt=G[dt];if(vt.source===Q&&vt.type==="fill-extrusion")return!0}return!1}(f&&f.layers,a,n.id),w=y.maxPitchScaleFactor(),I=n.tilesIn(l,w,g);I.sort(_r);for(var k=[],U=0,Z=I;U<Z.length;U+=1){var q=Z[U];k.push({wrappedTileID:q.tileID.wrapped().key,queryResults:q.tile.queryRenderedFeatures(a,o,n._state,q.queryGeometry,q.cameraQueryGeometry,q.scale,f,y,w,gi(n.transform,q.tileID))})}var J=function(tt){for(var G={},Q={},ot=0,ht=tt;ot<ht.length;ot+=1){var _t=ht[ot],dt=_t.queryResults,vt=_t.wrappedTileID,Pt=Q[vt]=Q[vt]||{};for(var kt in dt)for(var zt=dt[kt],Zt=Pt[kt]=Pt[kt]||{},te=G[kt]=G[kt]||[],oe=0,ne=zt;oe<ne.length;oe+=1){var Me=ne[oe];Zt[Me.featureIndex]||(Zt[Me.featureIndex]=!0,te.push(Me))}}return G}(k);for(var K in J)J[K].forEach(function(tt){var G=tt.feature,Q=n.getFeatureState(G.layer["source-layer"],G.id);G.source=G.layer.source,G.layer["source-layer"]&&(G.sourceLayer=G.layer["source-layer"]),G.state=Q});return J}function _r(n,a){var o=n.tileID,l=a.tileID;return o.overscaledZ-l.overscaledZ||o.canonical.y-l.canonical.y||o.wrap-l.wrap||o.canonical.x-l.canonical.x}var Ke=function(n,a){this.max=n,this.onRemove=a,this.reset()};Ke.prototype.reset=function(){for(var n in this.data)for(var a=0,o=this.data[n];a<o.length;a+=1){var l=o[a];l.timeout&&clearTimeout(l.timeout),this.onRemove(l.value)}return this.data={},this.order=[],this},Ke.prototype.add=function(n,a,o){var l=this,f=n.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);var y={value:a,timeout:void 0};if(o!==void 0&&(y.timeout=setTimeout(function(){l.remove(n,y)},o)),this.data[f].push(y),this.order.push(f),this.order.length>this.max){var g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this},Ke.prototype.has=function(n){return n.wrapped().key in this.data},Ke.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},Ke.prototype._getAndRemoveByKey=function(n){var a=this.data[n].shift();return a.timeout&&clearTimeout(a.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),a.value},Ke.prototype.getByKey=function(n){var a=this.data[n];return a?a[0].value:null},Ke.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},Ke.prototype.remove=function(n,a){if(!this.has(n))return this;var o=n.wrapped().key,l=a===void 0?0:this.data[o].indexOf(a),f=this.data[o][l];return this.data[o].splice(l,1),f.timeout&&clearTimeout(f.timeout),this.data[o].length===0&&delete this.data[o],this.onRemove(f.value),this.order.splice(this.order.indexOf(o),1),this},Ke.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var a=this._getAndRemoveByKey(this.order[0]);a&&this.onRemove(a)}return this},Ke.prototype.filter=function(n){var a=[];for(var o in this.data)for(var l=0,f=this.data[o];l<f.length;l+=1){var y=f[l];n(y.value)||a.push(y)}for(var g=0,w=a;g<w.length;g+=1){var I=w[g];this.remove(I.value.tileID,I)}};var sn=function(n,a,o){this.context=n;var l=n.gl;this.buffer=l.createBuffer(),this.dynamicDraw=Boolean(o),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),l.bufferData(l.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?l.DYNAMIC_DRAW:l.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};sn.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},sn.prototype.updateData=function(n){var a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},sn.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Kn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},Pr=function(n,a,o,l){this.length=a.length,this.attributes=o,this.itemSize=a.bytesPerElement,this.dynamicDraw=l,this.context=n;var f=n.gl;this.buffer=f.createBuffer(),n.bindVertexBuffer.set(this.buffer),f.bufferData(f.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?f.DYNAMIC_DRAW:f.STATIC_DRAW),this.dynamicDraw||delete a.arrayBuffer};Pr.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},Pr.prototype.updateData=function(n){var a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,n.arrayBuffer)},Pr.prototype.enableAttributes=function(n,a){for(var o=0;o<this.attributes.length;o++){var l=a.attributes[this.attributes[o].name];l!==void 0&&n.enableVertexAttribArray(l)}},Pr.prototype.setVertexAttribPointers=function(n,a,o){for(var l=0;l<this.attributes.length;l++){var f=this.attributes[l],y=a.attributes[f.name];y!==void 0&&n.vertexAttribPointer(y,f.components,n[Kn[f.type]],!1,this.itemSize,f.offset+this.itemSize*(o||0))}},Pr.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Te=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Te.prototype.get=function(){return this.current},Te.prototype.set=function(n){},Te.prototype.getDefault=function(){return this.default},Te.prototype.setDefault=function(){this.set(this.default)};var Jn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return u.Color.transparent},a.prototype.set=function(o){var l=this.current;(o.r!==l.r||o.g!==l.g||o.b!==l.b||o.a!==l.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},a}(Te),yr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 1},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)},a}(Te),Wr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)},a}(Te),ba=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return[!0,!0,!0,!0]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||o[3]!==l[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},a}(Te),Br=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)},a}(Te),Pn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 255},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)},a}(Te),Ir=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},a.prototype.set=function(o){var l=this.current;(o.func!==l.func||o.ref!==l.ref||o.mask!==l.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)},a}(Te),On=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)},a}(Te),In=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;o?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST),this.current=o,this.dirty=!1}},a}(Te),gr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return[0,1]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)},a}(Te),ln=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;o?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST),this.current=o,this.dirty=!1}},a}(Te),Yn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.LESS},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)},a}(Te),Hr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;o?l.enable(l.BLEND):l.disable(l.BLEND),this.current=o,this.dirty=!1}},a}(Te),qo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[o.ONE,o.ZERO]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)},a}(Te),jo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return u.Color.transparent},a.prototype.set=function(o){var l=this.current;(o.r!==l.r||o.g!==l.g||o.b!==l.b||o.a!==l.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)},a}(Te),$n=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.FUNC_ADD},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)},a}(Te),Go=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;o?l.enable(l.CULL_FACE):l.disable(l.CULL_FACE),this.current=o,this.dirty=!1}},a}(Te),So=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.BACK},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)},a}(Te),wa=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.CCW},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)},a}(Te),Qn=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.useProgram(o),this.current=o,this.dirty=!1)},a}(Te),Po=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return this.gl.TEXTURE0},a.prototype.set=function(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)},a}(Te),to=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){var o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]},a.prototype.set=function(o){var l=this.current;(o[0]!==l[0]||o[1]!==l[1]||o[2]!==l[2]||o[3]!==l[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)},a}(Te),vr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.bindFramebuffer(l.FRAMEBUFFER,o),this.current=o,this.dirty=!1}},a}(Te),En=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.bindRenderbuffer(l.RENDERBUFFER,o),this.current=o,this.dirty=!1}},a}(Te),Ga=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.bindTexture(l.TEXTURE_2D,o),this.current=o,this.dirty=!1}},a}(Te),Wa=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.bindBuffer(l.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}},a}(Te),Rr=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){var l=this.gl;l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1},a}(Te),tr=function(n){function a(o){n.call(this,o),this.vao=o.extVertexArrayObject}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a.prototype.set=function(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)},a}(Te),er=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return 4},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}},a}(Te),Io=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}},a}(Te),Ta=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return!1},a.prototype.set=function(o){if(o!==this.current||this.dirty){var l=this.gl;l.pixelStorei(l.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}},a}(Te),$e=function(n){function a(o,l){n.call(this,o),this.context=o,this.parent=l}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getDefault=function(){return null},a}(Te),C=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.setDirty=function(){this.dirty=!0},a.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}},a}($e),D=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.set=function(o){if(o!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var l=this.gl;l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_ATTACHMENT,l.RENDERBUFFER,o),this.current=o,this.dirty=!1}},a}($e),O=function(n,a,o,l){this.context=n,this.width=a,this.height=o;var f=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new C(n,f),l&&(this.depthAttachment=new D(n,f))};O.prototype.destroy=function(){var n=this.context.gl,a=this.colorAttachment.get();if(a&&n.deleteTexture(a),this.depthAttachment){var o=this.depthAttachment.get();o&&n.deleteRenderbuffer(o)}n.deleteFramebuffer(this.framebuffer)};var j=function(n,a,o){this.func=n,this.mask=a,this.range=o};j.ReadOnly=!1,j.ReadWrite=!0,j.disabled=new j(519,j.ReadOnly,[0,1]);var W=function(n,a,o,l,f,y){this.test=n,this.ref=a,this.mask=o,this.fail=l,this.depthFail=f,this.pass=y};W.disabled=new W({func:519,mask:0},0,0,7680,7680,7680);var it=function(n,a,o){this.blendFunction=n,this.blendColor=a,this.mask=o};it.disabled=new it(it.Replace=[1,0],u.Color.transparent,[!1,!1,!1,!1]),it.unblended=new it(it.Replace,u.Color.transparent,[!0,!0,!0,!0]),it.alphaBlended=new it([1,771],u.Color.transparent,[!0,!0,!0,!0]);var at=function(n,a,o){this.enable=n,this.mode=a,this.frontFace=o};at.disabled=new at(!1,1029,2305),at.backCCW=new at(!0,1029,2305);var V=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Jn(this),this.clearDepth=new yr(this),this.clearStencil=new Wr(this),this.colorMask=new ba(this),this.depthMask=new Br(this),this.stencilMask=new Pn(this),this.stencilFunc=new Ir(this),this.stencilOp=new On(this),this.stencilTest=new In(this),this.depthRange=new gr(this),this.depthTest=new ln(this),this.depthFunc=new Yn(this),this.blend=new Hr(this),this.blendFunc=new qo(this),this.blendColor=new jo(this),this.blendEquation=new $n(this),this.cullFace=new Go(this),this.cullFaceSide=new So(this),this.frontFace=new wa(this),this.program=new Qn(this),this.activeTexture=new Po(this),this.viewport=new to(this),this.bindFramebuffer=new vr(this),this.bindRenderbuffer=new En(this),this.bindTexture=new Ga(this),this.bindVertexBuffer=new Wa(this),this.bindElementBuffer=new Rr(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new tr(this),this.pixelStoreUnpack=new er(this),this.pixelStoreUnpackPremultiplyAlpha=new Io(this),this.pixelStoreUnpackFlipY=new Ta(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};V.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},V.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},V.prototype.createIndexBuffer=function(n,a){return new sn(this,n,a)},V.prototype.createVertexBuffer=function(n,a,o){return new Pr(this,n,a,o)},V.prototype.createRenderbuffer=function(n,a,o){var l=this.gl,f=l.createRenderbuffer();return this.bindRenderbuffer.set(f),l.renderbufferStorage(l.RENDERBUFFER,n,a,o),this.bindRenderbuffer.set(null),f},V.prototype.createFramebuffer=function(n,a,o){return new O(this,n,a,o)},V.prototype.clear=function(n){var a=n.color,o=n.depth,l=this.gl,f=0;a&&(f|=l.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(f|=l.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),l.clear(f)},V.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},V.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},V.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},V.prototype.setColorMode=function(n){u.deepEqual(n.blendFunction,it.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},V.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Y=function(n){function a(o,l,f){var y=this;n.call(this),this.id=o,this.dispatcher=f,this.on("data",function(g){g.dataType==="source"&&g.sourceDataType==="metadata"&&(y._sourceLoaded=!0),y._sourceLoaded&&!y._paused&&g.dataType==="source"&&g.sourceDataType==="content"&&(y.reload(),y.transform&&y.update(y.transform))}),this.on("error",function(){y._sourceErrored=!0}),this._source=function(g,w,I,k){var U=new Ve[w.type](g,w,I,k);if(U.id!==g)throw new Error("Expected Source id to be "+g+" instead of "+U.id);return u.bindAll(["load","abort","unload","serialize","prepare"],U),U}(o,l,f,this),this._tiles={},this._cache=new Ke(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new u.SourceFeatureState}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.onAdd=function(o){this.map=o,this._maxTileCacheSize=o?o._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(o)},a.prototype.onRemove=function(o){this._source&&this._source.onRemove&&this._source.onRemove(o)},a.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var o in this._tiles){var l=this._tiles[o];if(l.state!=="loaded"&&l.state!=="errored")return!1}return!0},a.prototype.getSource=function(){return this._source},a.prototype.pause=function(){this._paused=!0},a.prototype.resume=function(){if(this._paused){var o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}},a.prototype._loadTile=function(o,l){return this._source.loadTile(o,l)},a.prototype._unloadTile=function(o){if(this._source.unloadTile)return this._source.unloadTile(o,function(){})},a.prototype._abortTile=function(o){if(this._source.abortTile)return this._source.abortTile(o,function(){})},a.prototype.serialize=function(){return this._source.serialize()},a.prototype.prepare=function(o){for(var l in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var f=this._tiles[l];f.upload(o),f.prepare(this.map.style.imageManager)}},a.prototype.getIds=function(){return u.values(this._tiles).map(function(o){return o.tileID}).sort(ut).map(function(o){return o.key})},a.prototype.getRenderableIds=function(o){var l=this,f=[];for(var y in this._tiles)this._isIdRenderable(y,o)&&f.push(this._tiles[y]);return o?f.sort(function(g,w){var I=g.tileID,k=w.tileID,U=new u.Point(I.canonical.x,I.canonical.y)._rotate(l.transform.angle),Z=new u.Point(k.canonical.x,k.canonical.y)._rotate(l.transform.angle);return I.overscaledZ-k.overscaledZ||Z.y-U.y||Z.x-U.x}).map(function(g){return g.tileID.key}):f.map(function(g){return g.tileID}).sort(ut).map(function(g){return g.key})},a.prototype.hasRenderableParent=function(o){var l=this.findLoadedParent(o,0);return!!l&&this._isIdRenderable(l.tileID.key)},a.prototype._isIdRenderable=function(o,l){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(l||!this._tiles[o].holdingForFade())},a.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var o in this._cache.reset(),this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(o,"reloading")},a.prototype._reloadTile=function(o,l){var f=this._tiles[o];f&&(f.state!=="loading"&&(f.state=l),this._loadTile(f,this._tileLoaded.bind(this,f,o,l)))},a.prototype._tileLoaded=function(o,l,f,y){if(y)return o.state="errored",void(y.status!==404?this._source.fire(new u.ErrorEvent(y,{tile:o})):this.update(this.transform));o.timeAdded=u.browser.now(),f==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(l,o),this.getSource().type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new u.Event("data",{dataType:"source",tile:o,coord:o.tileID}))},a.prototype._backfillDEM=function(o){for(var l=this.getRenderableIds(),f=0;f<l.length;f++){var y=l[f];if(o.neighboringTiles&&o.neighboringTiles[y]){var g=this.getTileByID(y);w(o,g),w(g,o)}}function w(I,k){I.needsHillshadePrepare=!0;var U=k.tileID.canonical.x-I.tileID.canonical.x,Z=k.tileID.canonical.y-I.tileID.canonical.y,q=Math.pow(2,I.tileID.canonical.z),J=k.tileID.key;U===0&&Z===0||Math.abs(Z)>1||(Math.abs(U)>1&&(Math.abs(U+q)===1?U+=q:Math.abs(U-q)===1&&(U-=q)),k.dem&&I.dem&&(I.dem.backfillBorder(k.dem,U,Z),I.neighboringTiles&&I.neighboringTiles[J]&&(I.neighboringTiles[J].backfilled=!0)))}},a.prototype.getTile=function(o){return this.getTileByID(o.key)},a.prototype.getTileByID=function(o){return this._tiles[o]},a.prototype._retainLoadedChildren=function(o,l,f,y){for(var g in this._tiles){var w=this._tiles[g];if(!(y[g]||!w.hasData()||w.tileID.overscaledZ<=l||w.tileID.overscaledZ>f)){for(var I=w.tileID;w&&w.tileID.overscaledZ>l+1;){var k=w.tileID.scaledTo(w.tileID.overscaledZ-1);(w=this._tiles[k.key])&&w.hasData()&&(I=k)}for(var U=I;U.overscaledZ>l;)if(o[(U=U.scaledTo(U.overscaledZ-1)).key]){y[I.key]=I;break}}}},a.prototype.findLoadedParent=function(o,l){if(o.key in this._loadedParentTiles){var f=this._loadedParentTiles[o.key];return f&&f.tileID.overscaledZ>=l?f:null}for(var y=o.overscaledZ-1;y>=l;y--){var g=o.scaledTo(y),w=this._getLoadedTile(g);if(w)return w}},a.prototype._getLoadedTile=function(o){var l=this._tiles[o.key];return l&&l.hasData()?l:this._cache.getByKey(o.wrapped().key)},a.prototype.updateCacheSize=function(o){var l=Math.ceil(o.width/this._source.tileSize)+1,f=Math.ceil(o.height/this._source.tileSize)+1,y=Math.floor(l*f*5),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(g)},a.prototype.handleWrapJump=function(o){var l=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,l){var f={};for(var y in this._tiles){var g=this._tiles[y];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+l),f[g.tileID.key]=g}for(var w in this._tiles=f,this._timers)clearTimeout(this._timers[w]),delete this._timers[w];for(var I in this._tiles)this._setTileReloadTimer(I,this._tiles[I])}},a.prototype.update=function(o){var l=this;if(this.transform=o,this._sourceLoaded&&!this._paused){var f;this.updateCacheSize(o),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?f=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(Pt){return new u.OverscaledTileID(Pt.canonical.z,Pt.wrap,Pt.canonical.z,Pt.canonical.x,Pt.canonical.y)}):(f=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(f=f.filter(function(Pt){return l._source.hasTile(Pt)}))):f=[];var y=o.coveringZoomLevel(this._source),g=Math.max(y-a.maxOverzooming,this._source.minzoom),w=Math.max(y+a.maxUnderzooming,this._source.minzoom),I=this._updateRetainedTiles(f,y);if(St(this._source.type)){for(var k={},U={},Z=0,q=Object.keys(I);Z<q.length;Z+=1){var J=q[Z],K=I[J],tt=this._tiles[J];if(tt&&!(tt.fadeEndTime&&tt.fadeEndTime<=u.browser.now())){var G=this.findLoadedParent(K,g);G&&(this._addTile(G.tileID),k[G.tileID.key]=G.tileID),U[J]=K}}for(var Q in this._retainLoadedChildren(U,y,w,I),k)I[Q]||(this._coveredTiles[Q]=!0,I[Q]=k[Q])}for(var ot in I)this._tiles[ot].clearFadeHold();for(var ht=0,_t=u.keysDifference(this._tiles,I);ht<_t.length;ht+=1){var dt=_t[ht],vt=this._tiles[dt];vt.hasSymbolBuckets&&!vt.holdingForFade()?vt.setHoldDuration(this.map._fadeDuration):vt.hasSymbolBuckets&&!vt.symbolFadeFinished()||this._removeTile(dt)}this._updateLoadedParentTileCache()}},a.prototype.releaseSymbolFadeTiles=function(){for(var o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(o)},a.prototype._updateRetainedTiles=function(o,l){for(var f={},y={},g=Math.max(l-a.maxOverzooming,this._source.minzoom),w=Math.max(l+a.maxUnderzooming,this._source.minzoom),I={},k=0,U=o;k<U.length;k+=1){var Z=U[k],q=this._addTile(Z);f[Z.key]=Z,q.hasData()||l<this._source.maxzoom&&(I[Z.key]=Z)}this._retainLoadedChildren(I,l,w,f);for(var J=0,K=o;J<K.length;J+=1){var tt=K[J],G=this._tiles[tt.key];if(!G.hasData()){if(l+1>this._source.maxzoom){var Q=tt.children(this._source.maxzoom)[0],ot=this.getTile(Q);if(ot&&ot.hasData()){f[Q.key]=Q;continue}}else{var ht=tt.children(this._source.maxzoom);if(f[ht[0].key]&&f[ht[1].key]&&f[ht[2].key]&&f[ht[3].key])continue}for(var _t=G.wasRequested(),dt=tt.overscaledZ-1;dt>=g;--dt){var vt=tt.scaledTo(dt);if(y[vt.key]||(y[vt.key]=!0,!(G=this.getTile(vt))&&_t&&(G=this._addTile(vt)),G&&(f[vt.key]=vt,_t=G.wasRequested(),G.hasData())))break}}}return f},a.prototype._updateLoadedParentTileCache=function(){for(var o in this._loadedParentTiles={},this._tiles){for(var l=[],f=void 0,y=this._tiles[o].tileID;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){f=this._loadedParentTiles[y.key];break}l.push(y.key);var g=y.scaledTo(y.overscaledZ-1);if(f=this._getLoadedTile(g))break;y=g}for(var w=0,I=l;w<I.length;w+=1)this._loadedParentTiles[I[w]]=f}},a.prototype._addTile=function(o){var l=this._tiles[o.key];if(l)return l;(l=this._cache.getAndRemove(o))&&(this._setTileReloadTimer(o.key,l),l.tileID=o,this._state.initializeTileState(l,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,l)));var f=Boolean(l);return f||(l=new u.Tile(o,this._source.tileSize*o.overscaleFactor()),this._loadTile(l,this._tileLoaded.bind(this,l,o.key,l.state))),l?(l.uses++,this._tiles[o.key]=l,f||this._source.fire(new u.Event("dataloading",{tile:l,coord:l.tileID,dataType:"source"})),l):null},a.prototype._setTileReloadTimer=function(o,l){var f=this;o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);var y=l.getExpiryTimeout();y&&(this._timers[o]=setTimeout(function(){f._reloadTile(o,"expired"),delete f._timers[o]},y))},a.prototype._removeTile=function(o){var l=this._tiles[o];l&&(l.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),l.uses>0||(l.hasData()&&l.state!=="reloading"?this._cache.add(l.tileID,l,l.getExpiryTimeout()):(l.aborted=!0,this._abortTile(l),this._unloadTile(l))))},a.prototype.clearTiles=function(){for(var o in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(o);this._cache.reset()},a.prototype.tilesIn=function(o,l,f){var y=this,g=[],w=this.transform;if(!w)return g;for(var I=f?w.getCameraQueryGeometry(o):o,k=o.map(function(dt){return w.pointCoordinate(dt)}),U=I.map(function(dt){return w.pointCoordinate(dt)}),Z=this.getIds(),q=1/0,J=1/0,K=-1/0,tt=-1/0,G=0,Q=U;G<Q.length;G+=1){var ot=Q[G];q=Math.min(q,ot.x),J=Math.min(J,ot.y),K=Math.max(K,ot.x),tt=Math.max(tt,ot.y)}for(var ht=function(dt){var vt=y._tiles[Z[dt]];if(!vt.holdingForFade()){var Pt=vt.tileID,kt=Math.pow(2,w.zoom-vt.tileID.overscaledZ),zt=l*vt.queryPadding*u.EXTENT/vt.tileSize/kt,Zt=[Pt.getTilePoint(new u.MercatorCoordinate(q,J)),Pt.getTilePoint(new u.MercatorCoordinate(K,tt))];if(Zt[0].x-zt<u.EXTENT&&Zt[0].y-zt<u.EXTENT&&Zt[1].x+zt>=0&&Zt[1].y+zt>=0){var te=k.map(function(ne){return Pt.getTilePoint(ne)}),oe=U.map(function(ne){return Pt.getTilePoint(ne)});g.push({tile:vt,tileID:Pt,queryGeometry:te,cameraQueryGeometry:oe,scale:kt})}}},_t=0;_t<Z.length;_t++)ht(_t);return g},a.prototype.getVisibleCoordinates=function(o){for(var l=this,f=this.getRenderableIds(o).map(function(I){return l._tiles[I].tileID}),y=0,g=f;y<g.length;y+=1){var w=g[y];w.posMatrix=this.transform.calculatePosMatrix(w.toUnwrapped())}return f},a.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(St(this._source.type))for(var o in this._tiles){var l=this._tiles[o];if(l.fadeEndTime!==void 0&&l.fadeEndTime>=u.browser.now())return!0}return!1},a.prototype.setFeatureState=function(o,l,f){this._state.updateState(o=o||"_geojsonTileLayer",l,f)},a.prototype.removeFeatureState=function(o,l,f){this._state.removeFeatureState(o=o||"_geojsonTileLayer",l,f)},a.prototype.getFeatureState=function(o,l){return this._state.getState(o=o||"_geojsonTileLayer",l)},a.prototype.setDependencies=function(o,l,f){var y=this._tiles[o];y&&y.setDependencies(l,f)},a.prototype.reloadTilesForDependencies=function(o,l){for(var f in this._tiles)this._tiles[f].hasDependency(o,l)&&this._reloadTile(f,"reloading");this._cache.filter(function(y){return!y.hasDependency(o,l)})},a}(u.Evented);function ut(n,a){var o=Math.abs(2*n.wrap)-+(n.wrap<0),l=Math.abs(2*a.wrap)-+(a.wrap<0);return n.overscaledZ-a.overscaledZ||l-o||a.canonical.y-n.canonical.y||a.canonical.x-n.canonical.x}function St(n){return n==="raster"||n==="image"||n==="video"}function At(){return new u.window.Worker(cl.workerUrl)}Y.maxOverzooming=10,Y.maxUnderzooming=3;var gt="mapboxgl_preloaded_worker_pool",It=function(){this.active={}};It.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<It.workerCount;)this.workers.push(new At);return this.active[n]=!0,this.workers.slice()},It.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(a){a.terminate()}),this.workers=null)},It.prototype.isPreloaded=function(){return!!this.active[gt]},It.prototype.numActive=function(){return Object.keys(this.active).length};var Ht,qt=Math.floor(u.browser.hardwareConcurrency/2);function bt(){return Ht||(Ht=new It),Ht}function Ft(n,a){var o={};for(var l in n)l!=="ref"&&(o[l]=n[l]);return u.refProperties.forEach(function(f){f in a&&(o[f]=a[f])}),o}function Mt(n){n=n.slice();for(var a=Object.create(null),o=0;o<n.length;o++)a[n[o].id]=n[o];for(var l=0;l<n.length;l++)"ref"in n[l]&&(n[l]=Ft(n[l],a[n[l].ref]));return n}It.workerCount=Math.max(Math.min(qt,6),1);var Rt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ge(n,a,o){o.push({command:Rt.addSource,args:[n,a[n]]})}function Ot(n,a,o){a.push({command:Rt.removeSource,args:[n]}),o[n]=!0}function be(n,a,o,l){Ot(n,o,l),ge(n,a,o)}function Be(n,a,o){var l;for(l in n[o])if(n[o].hasOwnProperty(l)&&l!=="data"&&!u.deepEqual(n[o][l],a[o][l]))return!1;for(l in a[o])if(a[o].hasOwnProperty(l)&&l!=="data"&&!u.deepEqual(n[o][l],a[o][l]))return!1;return!0}function we(n,a,o,l,f,y){var g;for(g in a=a||{},n=n||{})n.hasOwnProperty(g)&&(u.deepEqual(n[g],a[g])||o.push({command:y,args:[l,g,a[g],f]}));for(g in a)a.hasOwnProperty(g)&&!n.hasOwnProperty(g)&&(u.deepEqual(n[g],a[g])||o.push({command:y,args:[l,g,a[g],f]}))}function Re(n){return n.id}function Ie(n,a){return n[a.id]=a,n}var Ui=function(n,a){this.reset(n,a)};Ui.prototype.reset=function(n,a){this.points=n||[],this._distances=[0];for(var o=1;o<this.points.length;o++)this._distances[o]=this._distances[o-1]+this.points[o].dist(this.points[o-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Ui.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=u.clamp(n,0,1);for(var a=1,o=this._distances[a],l=n*this.paddedLength+this.padding;o<l&&a<this._distances.length;)o=this._distances[++a];var f=a-1,y=this._distances[f],g=o-y,w=g>0?(l-y)/g:0;return this.points[f].mult(1-w).add(this.points[a].mult(w))};var Fe=function(n,a,o){var l=this.boxCells=[],f=this.circleCells=[];this.xCellCount=Math.ceil(n/o),this.yCellCount=Math.ceil(a/o);for(var y=0;y<this.xCellCount*this.yCellCount;y++)l.push([]),f.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=a,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0};function xi(n,a,o,l,f){var y=u.create();return a?(u.scale(y,y,[1/f,1/f,1]),o||u.rotateZ(y,y,l.angle)):u.multiply(y,l.labelPlaneMatrix,n),y}function Oe(n,a,o,l,f){if(a){var y=u.clone(n);return u.scale(y,y,[f,f,1]),o||u.rotateZ(y,y,-l.angle),y}return l.glCoordMatrix}function Yt(n,a){var o=[n.x,n.y,0,1];Gi(o,o,a);var l=o[3];return{point:new u.Point(o[0]/l,o[1]/l),signedDistanceFromCamera:l}}function se(n,a){return .5+n/a*.5}function ir(n,a){var o=n[0]/n[3],l=n[1]/n[3];return o>=-a[0]&&o<=a[0]&&l>=-a[1]&&l<=a[1]}function An(n,a,o,l,f,y,g,w){var I=l?n.textSizeData:n.iconSizeData,k=u.evaluateSizeForZoom(I,o.transform.zoom),U=[256/o.width*2+1,256/o.height*2+1],Z=l?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;Z.clear();for(var q=n.lineVertexArray,J=l?n.text.placedSymbolArray:n.icon.placedSymbolArray,K=o.transform.width/o.transform.height,tt=!1,G=0;G<J.length;G++){var Q=J.get(G);if(Q.hidden||Q.writingMode===u.WritingMode.vertical&&!tt)ai(Q.numGlyphs,Z);else{tt=!1;var ot=[Q.anchorX,Q.anchorY,0,1];if(u.transformMat4(ot,ot,a),ir(ot,U)){var ht=se(o.transform.cameraToCenterDistance,ot[3]),_t=u.evaluateSizeForFeature(I,k,Q),dt=g?_t/ht:_t*ht,vt=new u.Point(Q.anchorX,Q.anchorY),Pt=Yt(vt,f).point,kt={},zt=Se(Q,dt,!1,w,a,f,y,n.glyphOffsetArray,q,Z,Pt,vt,kt,K);tt=zt.useVertical,(zt.notEnoughRoom||tt||zt.needsFlipping&&Se(Q,dt,!0,w,a,f,y,n.glyphOffsetArray,q,Z,Pt,vt,kt,K).notEnoughRoom)&&ai(Q.numGlyphs,Z)}else ai(Q.numGlyphs,Z)}}l?n.text.dynamicLayoutVertexBuffer.updateData(Z):n.icon.dynamicLayoutVertexBuffer.updateData(Z)}function bi(n,a,o,l,f,y,g,w,I,k,U){var Z=w.glyphStartIndex+w.numGlyphs,q=w.lineStartIndex,J=w.lineStartIndex+w.lineLength,K=a.getoffsetX(w.glyphStartIndex),tt=a.getoffsetX(Z-1),G=pi(n*K,o,l,f,y,g,w.segment,q,J,I,k,U);if(!G)return null;var Q=pi(n*tt,o,l,f,y,g,w.segment,q,J,I,k,U);return Q?{first:G,last:Q}:null}function ur(n,a,o,l){return n===u.WritingMode.horizontal&&Math.abs(o.y-a.y)>Math.abs(o.x-a.x)*l?{useVertical:!0}:(n===u.WritingMode.vertical?a.y<o.y:a.x>o.x)?{needsFlipping:!0}:null}function Se(n,a,o,l,f,y,g,w,I,k,U,Z,q,J){var K,tt=a/24,G=n.lineOffsetX*tt,Q=n.lineOffsetY*tt;if(n.numGlyphs>1){var ot=n.glyphStartIndex+n.numGlyphs,ht=n.lineStartIndex,_t=n.lineStartIndex+n.lineLength,dt=bi(tt,w,G,Q,o,U,Z,n,I,y,q);if(!dt)return{notEnoughRoom:!0};var vt=Yt(dt.first.point,g).point,Pt=Yt(dt.last.point,g).point;if(l&&!o){var kt=ur(n.writingMode,vt,Pt,J);if(kt)return kt}K=[dt.first];for(var zt=n.glyphStartIndex+1;zt<ot-1;zt++)K.push(pi(tt*w.getoffsetX(zt),G,Q,o,U,Z,n.segment,ht,_t,I,y,q));K.push(dt.last)}else{if(l&&!o){var Zt=Yt(Z,f).point,te=n.lineStartIndex+n.segment+1,oe=new u.Point(I.getx(te),I.gety(te)),ne=Yt(oe,f),Me=ne.signedDistanceFromCamera>0?ne.point:ui(Z,oe,Zt,1,f),Gt=ur(n.writingMode,Zt,Me,J);if(Gt)return Gt}var pe=pi(tt*w.getoffsetX(n.glyphStartIndex),G,Q,o,U,Z,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,I,y,q);if(!pe)return{notEnoughRoom:!0};K=[pe]}for(var ve=0,ce=K;ve<ce.length;ve+=1){var he=ce[ve];u.addDynamicAttributes(k,he.point,he.angle)}return{}}function ui(n,a,o,l,f){var y=Yt(n.add(n.sub(a)._unit()),f).point,g=o.sub(y);return o.add(g._mult(l/g.mag()))}function pi(n,a,o,l,f,y,g,w,I,k,U,Z){var q=l?n-a:n+a,J=q>0?1:-1,K=0;l&&(J*=-1,K=Math.PI),J<0&&(K+=Math.PI);for(var tt=J>0?w+g:w+g+1,G=f,Q=f,ot=0,ht=0,_t=Math.abs(q),dt=[];ot+ht<=_t;){if((tt+=J)<w||tt>=I)return null;if(Q=G,dt.push(G),(G=Z[tt])===void 0){var vt=new u.Point(k.getx(tt),k.gety(tt)),Pt=Yt(vt,U);if(Pt.signedDistanceFromCamera>0)G=Z[tt]=Pt.point;else{var kt=tt-J;G=ui(ot===0?y:new u.Point(k.getx(kt),k.gety(kt)),vt,Q,_t-ot+1,U)}}ot+=ht,ht=Q.dist(G)}var zt=(_t-ot)/ht,Zt=G.sub(Q),te=Zt.mult(zt)._add(Q);te._add(Zt._unit()._perp()._mult(o*J));var oe=K+Math.atan2(G.y-Q.y,G.x-Q.x);return dt.push(te),{point:te,angle:oe,path:dt}}Fe.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Fe.prototype.insert=function(n,a,o,l,f){this._forEachCell(a,o,l,f,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(a),this.bboxes.push(o),this.bboxes.push(l),this.bboxes.push(f)},Fe.prototype.insertCircle=function(n,a,o,l){this._forEachCell(a-l,o-l,a+l,o+l,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(a),this.circles.push(o),this.circles.push(l)},Fe.prototype._insertBoxCell=function(n,a,o,l,f,y){this.boxCells[f].push(y)},Fe.prototype._insertCircleCell=function(n,a,o,l,f,y){this.circleCells[f].push(y)},Fe.prototype._query=function(n,a,o,l,f,y){if(o<0||n>this.width||l<0||a>this.height)return!f&&[];var g=[];if(n<=0&&a<=0&&this.width<=o&&this.height<=l){if(f)return!0;for(var w=0;w<this.boxKeys.length;w++)g.push({key:this.boxKeys[w],x1:this.bboxes[4*w],y1:this.bboxes[4*w+1],x2:this.bboxes[4*w+2],y2:this.bboxes[4*w+3]});for(var I=0;I<this.circleKeys.length;I++){var k=this.circles[3*I],U=this.circles[3*I+1],Z=this.circles[3*I+2];g.push({key:this.circleKeys[I],x1:k-Z,y1:U-Z,x2:k+Z,y2:U+Z})}return y?g.filter(y):g}return this._forEachCell(n,a,o,l,this._queryCell,g,{hitTest:f,seenUids:{box:{},circle:{}}},y),f?g.length>0:g},Fe.prototype._queryCircle=function(n,a,o,l,f){var y=n-o,g=n+o,w=a-o,I=a+o;if(g<0||y>this.width||I<0||w>this.height)return!l&&[];var k=[];return this._forEachCell(y,w,g,I,this._queryCellCircle,k,{hitTest:l,circle:{x:n,y:a,radius:o},seenUids:{box:{},circle:{}}},f),l?k.length>0:k},Fe.prototype.query=function(n,a,o,l,f){return this._query(n,a,o,l,!1,f)},Fe.prototype.hitTest=function(n,a,o,l,f){return this._query(n,a,o,l,!0,f)},Fe.prototype.hitTestCircle=function(n,a,o,l){return this._queryCircle(n,a,o,!0,l)},Fe.prototype._queryCell=function(n,a,o,l,f,y,g,w){var I=g.seenUids,k=this.boxCells[f];if(k!==null)for(var U=this.bboxes,Z=0,q=k;Z<q.length;Z+=1){var J=q[Z];if(!I.box[J]){I.box[J]=!0;var K=4*J;if(n<=U[K+2]&&a<=U[K+3]&&o>=U[K+0]&&l>=U[K+1]&&(!w||w(this.boxKeys[J]))){if(g.hitTest)return y.push(!0),!0;y.push({key:this.boxKeys[J],x1:U[K],y1:U[K+1],x2:U[K+2],y2:U[K+3]})}}}var tt=this.circleCells[f];if(tt!==null)for(var G=this.circles,Q=0,ot=tt;Q<ot.length;Q+=1){var ht=ot[Q];if(!I.circle[ht]){I.circle[ht]=!0;var _t=3*ht;if(this._circleAndRectCollide(G[_t],G[_t+1],G[_t+2],n,a,o,l)&&(!w||w(this.circleKeys[ht]))){if(g.hitTest)return y.push(!0),!0;var dt=G[_t],vt=G[_t+1],Pt=G[_t+2];y.push({key:this.circleKeys[ht],x1:dt-Pt,y1:vt-Pt,x2:dt+Pt,y2:vt+Pt})}}}},Fe.prototype._queryCellCircle=function(n,a,o,l,f,y,g,w){var I=g.circle,k=g.seenUids,U=this.boxCells[f];if(U!==null)for(var Z=this.bboxes,q=0,J=U;q<J.length;q+=1){var K=J[q];if(!k.box[K]){k.box[K]=!0;var tt=4*K;if(this._circleAndRectCollide(I.x,I.y,I.radius,Z[tt+0],Z[tt+1],Z[tt+2],Z[tt+3])&&(!w||w(this.boxKeys[K])))return y.push(!0),!0}}var G=this.circleCells[f];if(G!==null)for(var Q=this.circles,ot=0,ht=G;ot<ht.length;ot+=1){var _t=ht[ot];if(!k.circle[_t]){k.circle[_t]=!0;var dt=3*_t;if(this._circlesCollide(Q[dt],Q[dt+1],Q[dt+2],I.x,I.y,I.radius)&&(!w||w(this.circleKeys[_t])))return y.push(!0),!0}}},Fe.prototype._forEachCell=function(n,a,o,l,f,y,g,w){for(var I=this._convertToXCellCoord(n),k=this._convertToYCellCoord(a),U=this._convertToXCellCoord(o),Z=this._convertToYCellCoord(l),q=I;q<=U;q++)for(var J=k;J<=Z;J++)if(f.call(this,n,a,o,l,this.xCellCount*J+q,y,g,w))return},Fe.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},Fe.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},Fe.prototype._circlesCollide=function(n,a,o,l,f,y){var g=l-n,w=f-a,I=o+y;return I*I>g*g+w*w},Fe.prototype._circleAndRectCollide=function(n,a,o,l,f,y,g){var w=(y-l)/2,I=Math.abs(n-(l+w));if(I>w+o)return!1;var k=(g-f)/2,U=Math.abs(a-(f+k));if(U>k+o)return!1;if(I<=w||U<=k)return!0;var Z=I-w,q=U-k;return Z*Z+q*q<=o*o};var eo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ai(n,a){for(var o=0;o<n;o++){var l=a.length;a.resize(l+4),a.float32.set(eo,3*l)}}function Gi(n,a,o){var l=a[0],f=a[1];return n[0]=o[0]*l+o[4]*f+o[12],n[1]=o[1]*l+o[5]*f+o[13],n[3]=o[3]*l+o[7]*f+o[15],n}var Er=function(n,a,o){a===void 0&&(a=new Fe(n.width+200,n.height+200,25)),o===void 0&&(o=new Fe(n.width+200,n.height+200,25)),this.transform=n,this.grid=a,this.ignoredGrid=o,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function He(n,a,o){return a*(u.EXTENT/(n.tileSize*Math.pow(2,o-n.tileID.overscaledZ)))}Er.prototype.placeCollisionBox=function(n,a,o,l,f){var y=this.projectAndGetPerspectiveRatio(l,n.anchorPointX,n.anchorPointY),g=o*y.perspectiveRatio,w=n.x1*g+y.point.x,I=n.y1*g+y.point.y,k=n.x2*g+y.point.x,U=n.y2*g+y.point.y;return!this.isInsideGrid(w,I,k,U)||!a&&this.grid.hitTest(w,I,k,U,f)?{box:[],offscreen:!1}:{box:[w,I,k,U],offscreen:this.isOffscreen(w,I,k,U)}},Er.prototype.placeCollisionCircles=function(n,a,o,l,f,y,g,w,I,k,U,Z,q){var J=[],K=new u.Point(a.anchorX,a.anchorY),tt=Yt(K,y),G=se(this.transform.cameraToCenterDistance,tt.signedDistanceFromCamera),Q=(k?f/G:f*G)/u.ONE_EM,ot=Yt(K,g).point,ht=bi(Q,l,a.lineOffsetX*Q,a.lineOffsetY*Q,!1,ot,K,a,o,g,{}),_t=!1,dt=!1,vt=!0;if(ht){for(var Pt=.5*Z*G+q,kt=new u.Point(-100,-100),zt=new u.Point(this.screenRightBoundary,this.screenBottomBoundary),Zt=new Ui,te=ht.first,oe=ht.last,ne=[],Me=te.path.length-1;Me>=1;Me--)ne.push(te.path[Me]);for(var Gt=1;Gt<oe.path.length;Gt++)ne.push(oe.path[Gt]);var pe=2.5*Pt;if(w){var ve=ne.map(function(Mn){return Yt(Mn,w)});ne=ve.some(function(Mn){return Mn.signedDistanceFromCamera<=0})?[]:ve.map(function(Mn){return Mn.point})}var ce=[];if(ne.length>0){for(var he=ne[0].clone(),ye=ne[0].clone(),ue=1;ue<ne.length;ue++)he.x=Math.min(he.x,ne[ue].x),he.y=Math.min(he.y,ne[ue].y),ye.x=Math.max(ye.x,ne[ue].x),ye.y=Math.max(ye.y,ne[ue].y);ce=he.x>=kt.x&&ye.x<=zt.x&&he.y>=kt.y&&ye.y<=zt.y?[ne]:ye.x<kt.x||he.x>zt.x||ye.y<kt.y||he.y>zt.y?[]:u.clipLine([ne],kt.x,kt.y,zt.x,zt.y)}for(var ae=0,rr=ce;ae<rr.length;ae+=1){var Ci;Zt.reset(rr[ae],.25*Pt),Ci=Zt.length<=.5*Pt?1:Math.ceil(Zt.paddedLength/pe)+1;for(var kr=0;kr<Ci;kr++){var pr=kr/Math.max(Ci-1,1),Pi=Zt.lerp(pr),Mi=Pi.x+100,mn=Pi.y+100;J.push(Mi,mn,Pt,0);var Zr=Mi-Pt,ca=mn-Pt,en=Mi+Pt,Wn=mn+Pt;if(vt=vt&&this.isOffscreen(Zr,ca,en,Wn),dt=dt||this.isInsideGrid(Zr,ca,en,Wn),!n&&this.grid.hitTestCircle(Mi,mn,Pt,U)&&(_t=!0,!I))return{circles:[],offscreen:!1,collisionDetected:_t}}}}return{circles:!I&&_t||!dt?[]:J,offscreen:vt,collisionDetected:_t}},Er.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var a=[],o=1/0,l=1/0,f=-1/0,y=-1/0,g=0,w=n;g<w.length;g+=1){var I=w[g],k=new u.Point(I.x+100,I.y+100);o=Math.min(o,k.x),l=Math.min(l,k.y),f=Math.max(f,k.x),y=Math.max(y,k.y),a.push(k)}for(var U={},Z={},q=0,J=this.grid.query(o,l,f,y).concat(this.ignoredGrid.query(o,l,f,y));q<J.length;q+=1){var K=J[q],tt=K.key;if(U[tt.bucketInstanceId]===void 0&&(U[tt.bucketInstanceId]={}),!U[tt.bucketInstanceId][tt.featureIndex]){var G=[new u.Point(K.x1,K.y1),new u.Point(K.x2,K.y1),new u.Point(K.x2,K.y2),new u.Point(K.x1,K.y2)];u.polygonIntersectsPolygon(a,G)&&(U[tt.bucketInstanceId][tt.featureIndex]=!0,Z[tt.bucketInstanceId]===void 0&&(Z[tt.bucketInstanceId]=[]),Z[tt.bucketInstanceId].push(tt.featureIndex))}}return Z},Er.prototype.insertCollisionBox=function(n,a,o,l,f){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:o,featureIndex:l,collisionGroupID:f},n[0],n[1],n[2],n[3])},Er.prototype.insertCollisionCircles=function(n,a,o,l,f){for(var y=a?this.ignoredGrid:this.grid,g={bucketInstanceId:o,featureIndex:l,collisionGroupID:f},w=0;w<n.length;w+=4)y.insertCircle(g,n[w],n[w+1],n[w+2])},Er.prototype.projectAndGetPerspectiveRatio=function(n,a,o){var l=[a,o,0,1];return Gi(l,l,n),{point:new u.Point((l[0]/l[3]+1)/2*this.transform.width+100,(-l[1]/l[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/l[3]*.5}},Er.prototype.isOffscreen=function(n,a,o,l){return o<100||n>=this.screenRightBoundary||l<100||a>this.screenBottomBoundary},Er.prototype.isInsideGrid=function(n,a,o,l){return o>=0&&n<this.gridRightBoundary&&l>=0&&a<this.gridBottomBoundary},Er.prototype.getViewportMatrix=function(){var n=u.identity([]);return u.translate(n,n,[-100,-100,0]),n};var Qe=function(n,a,o,l){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?a:-a))):l&&o?1:0,this.placed=o};Qe.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var Ni=function(n,a,o,l,f){this.text=new Qe(n?n.text:null,a,o,f),this.icon=new Qe(n?n.icon:null,a,l,f)};Ni.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Wo=function(n,a,o){this.text=n,this.icon=a,this.skipFade=o},xr=function(){this.invProjMatrix=u.create(),this.viewportMatrix=u.create(),this.circles=[]},ws=function(n,a,o,l,f){this.bucketInstanceId=n,this.featureIndex=a,this.sourceLayerIndex=o,this.bucketIndex=l,this.tileID=f},Xr=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function Zi(n,a,o,l,f){var y=u.getAnchorAlignment(n),g=-(y.horizontalAlign-.5)*a,w=-(y.verticalAlign-.5)*o,I=u.evaluateVariableOffset(n,l);return new u.Point(g+I[0]*f,w+I[1]*f)}function un(n,a,o,l,f,y){var g=n.x1,w=n.x2,I=n.y1,k=n.y2,U=n.anchorPointX,Z=n.anchorPointY,q=new u.Point(a,o);return l&&q._rotate(f?y:-y),{x1:g+q.x,y1:I+q.y,x2:w+q.x,y2:k+q.y,anchorPointX:U,anchorPointY:Z}}Xr.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var a=++this.maxGroupID;this.collisionGroups[n]={ID:a,predicate:function(o){return o.collisionGroupID===a}}}return this.collisionGroups[n]};var Wi=function(n,a,o,l){this.transform=n.clone(),this.collisionIndex=new Er(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=a,this.retainedQueryData={},this.collisionGroups=new Xr(o),this.collisionCircleArrays={},this.prevPlacement=l,l&&(l.prevPlacement=void 0),this.placedOrientations={}};function Fn(n,a,o,l,f){n.emplaceBack(a?1:0,o?1:0,l||0,f||0),n.emplaceBack(a?1:0,o?1:0,l||0,f||0),n.emplaceBack(a?1:0,o?1:0,l||0,f||0),n.emplaceBack(a?1:0,o?1:0,l||0,f||0)}Wi.prototype.getBucketParts=function(n,a,o,l){var f=o.getBucket(a),y=o.latestFeatureIndex;if(f&&y&&a.id===f.layerIds[0]){var g=o.collisionBoxArray,w=f.layers[0].layout,I=Math.pow(2,this.transform.zoom-o.tileID.overscaledZ),k=o.tileSize/u.EXTENT,U=this.transform.calculatePosMatrix(o.tileID.toUnwrapped()),Z=w.get("text-pitch-alignment")==="map",q=w.get("text-rotation-alignment")==="map",J=He(o,1,this.transform.zoom),K=xi(U,Z,q,this.transform,J),tt=null;if(Z){var G=Oe(U,Z,q,this.transform,J);tt=u.multiply([],this.transform.labelPlaneMatrix,G)}this.retainedQueryData[f.bucketInstanceId]=new ws(f.bucketInstanceId,y,f.sourceLayerIndex,f.index,o.tileID);var Q={bucket:f,layout:w,posMatrix:U,textLabelPlaneMatrix:K,labelToScreenMatrix:tt,scale:I,textPixelRatio:k,holdingForFade:o.holdingForFade(),collisionBoxArray:g,partiallyEvaluatedTextSize:u.evaluateSizeForZoom(f.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(f.sourceID)};if(l)for(var ot=0,ht=f.sortKeyRanges;ot<ht.length;ot+=1){var _t=ht[ot];n.push({sortKey:_t.sortKey,symbolInstanceStart:_t.symbolInstanceStart,symbolInstanceEnd:_t.symbolInstanceEnd,parameters:Q})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:f.symbolInstances.length,parameters:Q})}},Wi.prototype.attemptAnchorPlacement=function(n,a,o,l,f,y,g,w,I,k,U,Z,q,J,K){var tt,G=[Z.textOffset0,Z.textOffset1],Q=Zi(n,o,l,G,f),ot=this.collisionIndex.placeCollisionBox(un(a,Q.x,Q.y,y,g,this.transform.angle),U,w,I,k.predicate);if(!K||this.collisionIndex.placeCollisionBox(un(K,Q.x,Q.y,y,g,this.transform.angle),U,w,I,k.predicate).box.length!==0)return ot.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID]&&this.prevPlacement.placements[Z.crossTileID].text&&(tt=this.prevPlacement.variableOffsets[Z.crossTileID].anchor),this.variableOffsets[Z.crossTileID]={textOffset:G,width:o,height:l,anchor:n,textBoxScale:f,prevAnchor:tt},this.markUsedJustification(q,n,Z,J),q.allowVerticalPlacement&&(this.markUsedOrientation(q,J,Z),this.placedOrientations[Z.crossTileID]=J),{shift:Q,placedGlyphBoxes:ot}):void 0},Wi.prototype.placeLayerBucketPart=function(n,a,o){var l=this,f=n.parameters,y=f.bucket,g=f.layout,w=f.posMatrix,I=f.textLabelPlaneMatrix,k=f.labelToScreenMatrix,U=f.textPixelRatio,Z=f.holdingForFade,q=f.collisionBoxArray,J=f.partiallyEvaluatedTextSize,K=f.collisionGroup,tt=g.get("text-optional"),G=g.get("icon-optional"),Q=g.get("text-allow-overlap"),ot=g.get("icon-allow-overlap"),ht=g.get("text-rotation-alignment")==="map",_t=g.get("text-pitch-alignment")==="map",dt=g.get("icon-text-fit")!=="none",vt=g.get("symbol-z-order")==="viewport-y",Pt=Q&&(ot||!y.hasIconData()||G),kt=ot&&(Q||!y.hasTextData()||tt);!y.collisionArrays&&q&&y.deserializeCollisionBoxes(q);var zt=function(Gt,pe){if(!a[Gt.crossTileID])if(Z)l.placements[Gt.crossTileID]=new Wo(!1,!1,!1);else{var ve,ce=!1,he=!1,ye=!0,ue=null,ae={box:null,offscreen:null},rr={box:null,offscreen:null},Ci=null,kr=null,pr=0,Pi=0,Mi=0;pe.textFeatureIndex?pr=pe.textFeatureIndex:Gt.useRuntimeCollisionCircles&&(pr=Gt.featureIndex),pe.verticalTextFeatureIndex&&(Pi=pe.verticalTextFeatureIndex);var mn=pe.textBox;if(mn){var Zr=function(Ge){var bn=u.WritingMode.horizontal;if(y.allowVerticalPlacement&&!Ge&&l.prevPlacement){var rn=l.prevPlacement.placedOrientations[Gt.crossTileID];rn&&(l.placedOrientations[Gt.crossTileID]=rn,l.markUsedOrientation(y,bn=rn,Gt))}return bn},ca=function(Ge,bn){if(y.allowVerticalPlacement&&Gt.numVerticalGlyphVertices>0&&pe.verticalTextBox)for(var rn=0,Ra=y.writingModes;rn<Ra.length&&(Ra[rn]===u.WritingMode.vertical?(ae=bn(),rr=ae):ae=Ge(),!(ae&&ae.box&&ae.box.length));rn+=1);else ae=Ge()};if(g.get("text-variable-anchor")){var en=g.get("text-variable-anchor");if(l.prevPlacement&&l.prevPlacement.variableOffsets[Gt.crossTileID]){var Wn=l.prevPlacement.variableOffsets[Gt.crossTileID];en.indexOf(Wn.anchor)>0&&(en=en.filter(function(Ge){return Ge!==Wn.anchor})).unshift(Wn.anchor)}var Mn=function(Ge,bn,rn){for(var Ra=Ge.x2-Ge.x1,gh=Ge.y2-Ge.y1,pl=Gt.textBoxScale,vh=dt&&!ot?bn:null,Vs={box:[],offscreen:!1},Au=Q?2*en.length:en.length,ds=0;ds<Au;++ds){var fl=l.attemptAnchorPlacement(en[ds%en.length],Ge,Ra,gh,pl,ht,_t,U,w,K,ds>=en.length,Gt,y,rn,vh);if(fl&&(Vs=fl.placedGlyphBoxes)&&Vs.box&&Vs.box.length){ce=!0,ue=fl.shift;break}}return Vs};ca(function(){return Mn(mn,pe.iconBox,u.WritingMode.horizontal)},function(){var Ge=pe.verticalTextBox;return y.allowVerticalPlacement&&!(ae&&ae.box&&ae.box.length)&&Gt.numVerticalGlyphVertices>0&&Ge?Mn(Ge,pe.verticalIconBox,u.WritingMode.vertical):{box:null,offscreen:null}}),ae&&(ce=ae.box,ye=ae.offscreen);var Us=Zr(ae&&ae.box);if(!ce&&l.prevPlacement){var ps=l.prevPlacement.variableOffsets[Gt.crossTileID];ps&&(l.variableOffsets[Gt.crossTileID]=ps,l.markUsedJustification(y,ps.anchor,Gt,Us))}}else{var pa=function(Ge,bn){var rn=l.collisionIndex.placeCollisionBox(Ge,Q,U,w,K.predicate);return rn&&rn.box&&rn.box.length&&(l.markUsedOrientation(y,bn,Gt),l.placedOrientations[Gt.crossTileID]=bn),rn};ca(function(){return pa(mn,u.WritingMode.horizontal)},function(){var Ge=pe.verticalTextBox;return y.allowVerticalPlacement&&Gt.numVerticalGlyphVertices>0&&Ge?pa(Ge,u.WritingMode.vertical):{box:null,offscreen:null}}),Zr(ae&&ae.box&&ae.box.length)}}if(ce=(ve=ae)&&ve.box&&ve.box.length>0,ye=ve&&ve.offscreen,Gt.useRuntimeCollisionCircles){var fs=y.text.placedSymbolArray.get(Gt.centerJustifiedTextSymbolIndex),Ns=u.evaluateSizeForFeature(y.textSizeData,J,fs),go=g.get("text-padding");Ci=l.collisionIndex.placeCollisionCircles(Q,fs,y.lineVertexArray,y.glyphOffsetArray,Ns,w,I,k,o,_t,K.predicate,Gt.collisionCircleDiameter,go),ce=Q||Ci.circles.length>0&&!Ci.collisionDetected,ye=ye&&Ci.offscreen}if(pe.iconFeatureIndex&&(Mi=pe.iconFeatureIndex),pe.iconBox){var Zs=function(Ge){var bn=dt&&ue?un(Ge,ue.x,ue.y,ht,_t,l.transform.angle):Ge;return l.collisionIndex.placeCollisionBox(bn,ot,U,w,K.predicate)};he=rr&&rr.box&&rr.box.length&&pe.verticalIconBox?(kr=Zs(pe.verticalIconBox)).box.length>0:(kr=Zs(pe.iconBox)).box.length>0,ye=ye&&kr.offscreen}var vo=tt||Gt.numHorizontalGlyphVertices===0&&Gt.numVerticalGlyphVertices===0,nr=G||Gt.numIconVertices===0;if(vo||nr?nr?vo||(he=he&&ce):ce=he&&ce:he=ce=he&&ce,ce&&ve&&ve.box&&l.collisionIndex.insertCollisionBox(ve.box,g.get("text-ignore-placement"),y.bucketInstanceId,rr&&rr.box&&Pi?Pi:pr,K.ID),he&&kr&&l.collisionIndex.insertCollisionBox(kr.box,g.get("icon-ignore-placement"),y.bucketInstanceId,Mi,K.ID),Ci&&(ce&&l.collisionIndex.insertCollisionCircles(Ci.circles,g.get("text-ignore-placement"),y.bucketInstanceId,pr,K.ID),o)){var Uo=y.bucketInstanceId,fa=l.collisionCircleArrays[Uo];fa===void 0&&(fa=l.collisionCircleArrays[Uo]=new xr);for(var Ba=0;Ba<Ci.circles.length;Ba+=4)fa.circles.push(Ci.circles[Ba+0]),fa.circles.push(Ci.circles[Ba+1]),fa.circles.push(Ci.circles[Ba+2]),fa.circles.push(Ci.collisionDetected?1:0)}l.placements[Gt.crossTileID]=new Wo(ce||Pt,he||kt,ye||y.justReloaded),a[Gt.crossTileID]=!0}};if(vt)for(var Zt=y.getSortedSymbolIndexes(this.transform.angle),te=Zt.length-1;te>=0;--te){var oe=Zt[te];zt(y.symbolInstances.get(oe),y.collisionArrays[oe])}else for(var ne=n.symbolInstanceStart;ne<n.symbolInstanceEnd;ne++)zt(y.symbolInstances.get(ne),y.collisionArrays[ne]);if(o&&y.bucketInstanceId in this.collisionCircleArrays){var Me=this.collisionCircleArrays[y.bucketInstanceId];u.invert(Me.invProjMatrix,w),Me.viewportMatrix=this.collisionIndex.getViewportMatrix()}y.justReloaded=!1},Wi.prototype.markUsedJustification=function(n,a,o,l){var f;f=l===u.WritingMode.vertical?o.verticalPlacedTextSymbolIndex:{left:o.leftJustifiedTextSymbolIndex,center:o.centerJustifiedTextSymbolIndex,right:o.rightJustifiedTextSymbolIndex}[u.getAnchorJustification(a)];for(var y=0,g=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex,o.verticalPlacedTextSymbolIndex];y<g.length;y+=1){var w=g[y];w>=0&&(n.text.placedSymbolArray.get(w).crossTileID=f>=0&&w!==f?0:o.crossTileID)}},Wi.prototype.markUsedOrientation=function(n,a,o){for(var l=a===u.WritingMode.horizontal||a===u.WritingMode.horizontalOnly?a:0,f=a===u.WritingMode.vertical?a:0,y=0,g=[o.leftJustifiedTextSymbolIndex,o.centerJustifiedTextSymbolIndex,o.rightJustifiedTextSymbolIndex];y<g.length;y+=1)n.text.placedSymbolArray.get(g[y]).placedOrientation=l;o.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(o.verticalPlacedTextSymbolIndex).placedOrientation=f)},Wi.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var a=this.prevPlacement,o=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;var l=a?a.symbolFadeChange(n):1,f=a?a.opacities:{},y=a?a.variableOffsets:{},g=a?a.placedOrientations:{};for(var w in this.placements){var I=this.placements[w],k=f[w];k?(this.opacities[w]=new Ni(k,l,I.text,I.icon),o=o||I.text!==k.text.placed||I.icon!==k.icon.placed):(this.opacities[w]=new Ni(null,l,I.text,I.icon,I.skipFade),o=o||I.text||I.icon)}for(var U in f){var Z=f[U];if(!this.opacities[U]){var q=new Ni(Z,l,!1,!1);q.isHidden()||(this.opacities[U]=q,o=o||Z.text.placed||Z.icon.placed)}}for(var J in y)this.variableOffsets[J]||!this.opacities[J]||this.opacities[J].isHidden()||(this.variableOffsets[J]=y[J]);for(var K in g)this.placedOrientations[K]||!this.opacities[K]||this.opacities[K].isHidden()||(this.placedOrientations[K]=g[K]);o?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:n)},Wi.prototype.updateLayerOpacities=function(n,a){for(var o={},l=0,f=a;l<f.length;l+=1){var y=f[l],g=y.getBucket(n);g&&y.latestFeatureIndex&&n.id===g.layerIds[0]&&this.updateBucketOpacities(g,o,y.collisionBoxArray)}},Wi.prototype.updateBucketOpacities=function(n,a,o){var l=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var f=n.layers[0].layout,y=new Ni(null,0,!1,!1,!0),g=f.get("text-allow-overlap"),w=f.get("icon-allow-overlap"),I=f.get("text-variable-anchor"),k=f.get("text-rotation-alignment")==="map",U=f.get("text-pitch-alignment")==="map",Z=f.get("icon-text-fit")!=="none",q=new Ni(null,0,g&&(w||!n.hasIconData()||f.get("icon-optional")),w&&(g||!n.hasTextData()||f.get("text-optional")),!0);!n.collisionArrays&&o&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(o);for(var J=function(Q,ot,ht){for(var _t=0;_t<ot/4;_t++)Q.opacityVertexArray.emplaceBack(ht)},K=function(Q){var ot=n.symbolInstances.get(Q),ht=ot.numHorizontalGlyphVertices,_t=ot.numVerticalGlyphVertices,dt=ot.crossTileID,vt=l.opacities[dt];a[dt]?vt=y:vt||(l.opacities[dt]=vt=q),a[dt]=!0;var Pt=ot.numIconVertices>0,kt=l.placedOrientations[ot.crossTileID],zt=kt===u.WritingMode.vertical,Zt=kt===u.WritingMode.horizontal||kt===u.WritingMode.horizontalOnly;if(ht>0||_t>0){var te=Ai(vt.text);J(n.text,ht,zt?Eo:te),J(n.text,_t,Zt?Eo:te);var oe=vt.text.isHidden();[ot.rightJustifiedTextSymbolIndex,ot.centerJustifiedTextSymbolIndex,ot.leftJustifiedTextSymbolIndex].forEach(function(ae){ae>=0&&(n.text.placedSymbolArray.get(ae).hidden=oe||zt?1:0)}),ot.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(ot.verticalPlacedTextSymbolIndex).hidden=oe||Zt?1:0);var ne=l.variableOffsets[ot.crossTileID];ne&&l.markUsedJustification(n,ne.anchor,ot,kt);var Me=l.placedOrientations[ot.crossTileID];Me&&(l.markUsedJustification(n,"left",ot,Me),l.markUsedOrientation(n,Me,ot))}if(Pt){var Gt=Ai(vt.icon),pe=!(Z&&ot.verticalPlacedIconSymbolIndex&&zt);ot.placedIconSymbolIndex>=0&&(J(n.icon,ot.numIconVertices,pe?Gt:Eo),n.icon.placedSymbolArray.get(ot.placedIconSymbolIndex).hidden=vt.icon.isHidden()),ot.verticalPlacedIconSymbolIndex>=0&&(J(n.icon,ot.numVerticalIconVertices,pe?Eo:Gt),n.icon.placedSymbolArray.get(ot.verticalPlacedIconSymbolIndex).hidden=vt.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var ve=n.collisionArrays[Q];if(ve){var ce=new u.Point(0,0);if(ve.textBox||ve.verticalTextBox){var he=!0;if(I){var ye=l.variableOffsets[dt];ye?(ce=Zi(ye.anchor,ye.width,ye.height,ye.textOffset,ye.textBoxScale),k&&ce._rotate(U?l.transform.angle:-l.transform.angle)):he=!1}ve.textBox&&Fn(n.textCollisionBox.collisionVertexArray,vt.text.placed,!he||zt,ce.x,ce.y),ve.verticalTextBox&&Fn(n.textCollisionBox.collisionVertexArray,vt.text.placed,!he||Zt,ce.x,ce.y)}var ue=Boolean(!Zt&&ve.verticalIconBox);ve.iconBox&&Fn(n.iconCollisionBox.collisionVertexArray,vt.icon.placed,ue,Z?ce.x:0,Z?ce.y:0),ve.verticalIconBox&&Fn(n.iconCollisionBox.collisionVertexArray,vt.icon.placed,!ue,Z?ce.x:0,Z?ce.y:0)}}},tt=0;tt<n.symbolInstances.length;tt++)K(tt);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var G=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=G.invProjMatrix,n.placementViewportMatrix=G.viewportMatrix,n.collisionCircleArray=G.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},Wi.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},Wi.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},Wi.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},Wi.prototype.stillRecent=function(n,a){var o=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*o>n},Wi.prototype.setStale=function(){this.stale=!0};var Ts=Math.pow(2,25),Ha=Math.pow(2,24),Xa=Math.pow(2,17),Ss=Math.pow(2,16),Ys=Math.pow(2,9),ke=Math.pow(2,8),hn=Math.pow(2,1);function Ai(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var a=n.placed?1:0,o=Math.floor(127*n.opacity);return o*Ts+a*Ha+o*Xa+a*Ss+o*Ys+a*ke+o*hn+a}var Eo=0,Sa=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Sa.prototype.continuePlacement=function(n,a,o,l,f){for(var y=this._bucketParts;this._currentTileIndex<n.length;)if(a.getBucketParts(y,l,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,f())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,y.sort(function(g,w){return g.sortKey-w.sortKey}));this._currentPartIndex<y.length;)if(a.placeLayerBucketPart(y[this._currentPartIndex],this._seenCrossTileIDs,o),this._currentPartIndex++,f())return!0;return!1};var io=function(n,a,o,l,f,y,g){this.placement=new Wi(n,f,y,g),this._currentPlacementIndex=a.length-1,this._forceFullPlacement=o,this._showCollisionBoxes=l,this._done=!1};io.prototype.isDone=function(){return this._done},io.prototype.continuePlacement=function(n,a,o){for(var l=this,f=u.browser.now(),y=function(){var I=u.browser.now()-f;return!l._forceFullPlacement&&I>2};this._currentPlacementIndex>=0;){var g=a[n[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(g.type==="symbol"&&(!g.minzoom||g.minzoom<=w)&&(!g.maxzoom||g.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new Sa(g)),this._inProgressLayer.continuePlacement(o[g.source],this.placement,this._showCollisionBoxes,g,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},io.prototype.commit=function(n){return this.placement.commit(n),this.placement};var Ka=512/u.EXTENT/2,Cn=function(n,a,o){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=o;for(var l=0;l<a.length;l++){var f=a.get(l),y=f.key;this.indexedSymbolInstances[y]||(this.indexedSymbolInstances[y]=[]),this.indexedSymbolInstances[y].push({crossTileID:f.crossTileID,coord:this.getScaledCoordinates(f,n)})}};Cn.prototype.getScaledCoordinates=function(n,a){var o=Ka/Math.pow(2,a.canonical.z-this.tileID.canonical.z);return{x:Math.floor((a.canonical.x*u.EXTENT+n.anchorX)*o),y:Math.floor((a.canonical.y*u.EXTENT+n.anchorY)*o)}},Cn.prototype.findMatches=function(n,a,o){for(var l=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),f=0;f<n.length;f++){var y=n.get(f);if(!y.crossTileID){var g=this.indexedSymbolInstances[y.key];if(g)for(var w=this.getScaledCoordinates(y,a),I=0,k=g;I<k.length;I+=1){var U=k[I];if(Math.abs(U.coord.x-w.x)<=l&&Math.abs(U.coord.y-w.y)<=l&&!o[U.crossTileID]){o[U.crossTileID]=!0,y.crossTileID=U.crossTileID;break}}}}};var Or=function(){this.maxCrossTileID=0};Or.prototype.generate=function(){return++this.maxCrossTileID};var cn=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};cn.prototype.handleWrapJump=function(n){var a=Math.round((n-this.lng)/360);if(a!==0)for(var o in this.indexes){var l=this.indexes[o],f={};for(var y in l){var g=l[y];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+a),f[g.tileID.key]=g}this.indexes[o]=f}this.lng=n},cn.prototype.addBucket=function(n,a,o){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var l=0;l<a.symbolInstances.length;l++)a.symbolInstances.get(l).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var f=this.usedCrossTileIDs[n.overscaledZ];for(var y in this.indexes){var g=this.indexes[y];if(Number(y)>n.overscaledZ)for(var w in g){var I=g[w];I.tileID.isChildOf(n)&&I.findMatches(a.symbolInstances,n,f)}else{var k=g[n.scaledTo(Number(y)).key];k&&k.findMatches(a.symbolInstances,n,f)}}for(var U=0;U<a.symbolInstances.length;U++){var Z=a.symbolInstances.get(U);Z.crossTileID||(Z.crossTileID=o.generate(),f[Z.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Cn(n,a.symbolInstances,a.bucketInstanceId),!0},cn.prototype.removeBucketCrossTileIDs=function(n,a){for(var o in a.indexedSymbolInstances)for(var l=0,f=a.indexedSymbolInstances[o];l<f.length;l+=1)delete this.usedCrossTileIDs[n][f[l].crossTileID]},cn.prototype.removeStaleBuckets=function(n){var a=!1;for(var o in this.indexes){var l=this.indexes[o];for(var f in l)n[l[f].bucketInstanceId]||(this.removeBucketCrossTileIDs(o,l[f]),delete l[f],a=!0)}return a};var Hi=function(){this.layerIndexes={},this.crossTileIDs=new Or,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Hi.prototype.addLayer=function(n,a,o){var l=this.layerIndexes[n.id];l===void 0&&(l=this.layerIndexes[n.id]=new cn);var f=!1,y={};l.handleWrapJump(o);for(var g=0,w=a;g<w.length;g+=1){var I=w[g],k=I.getBucket(n);k&&n.id===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),l.addBucket(I.tileID,k,this.crossTileIDs)&&(f=!0),y[k.bucketInstanceId]=!0)}return l.removeStaleBuckets(y)&&(f=!0),f},Hi.prototype.pruneUnusedLayers=function(n){var a={};for(var o in n.forEach(function(l){a[l]=!0}),this.layerIndexes)a[o]||delete this.layerIndexes[o]};var Ar=function(n,a){return u.emitValidationErrors(n,a&&a.filter(function(o){return o.identifier!=="source.canvas"}))},Un=u.pick(Rt,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),ro=u.pick(Rt,["setCenter","setZoom","setBearing","setPitch"]),Pa=function(){var n={},a=u.styleSpec.$version;for(var o in u.styleSpec.$root){var l,f=u.styleSpec.$root[o];f.required&&(l=o==="version"?a:f.type==="array"?[]:{})!=null&&(n[o]=l)}return n}(),br=function(n){function a(o,l){var f=this;l===void 0&&(l={}),n.call(this),this.map=o,this.dispatcher=new Ei(bt(),this),this.imageManager=new ki,this.imageManager.setEventedParent(this),this.glyphManager=new Qi(o._requestManager,l.localIdeographFontFamily),this.lineAtlas=new _i(256,512),this.crossTileSymbolIndex=new Hi,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",u.getReferrer());var y=this;this._rtlTextPluginCallback=a.registerForPluginStateChange(function(g){y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:g.pluginStatus,pluginURL:g.pluginURL},function(w,I){if(u.triggerPluginCompletionEvent(w),I&&I.every(function(U){return U}))for(var k in y.sourceCaches)y.sourceCaches[k].reload()})}),this.on("data",function(g){if(g.dataType==="source"&&g.sourceDataType==="metadata"){var w=f.sourceCaches[g.sourceId];if(w){var I=w.getSource();if(I&&I.vectorLayerIds)for(var k in f._layers){var U=f._layers[k];U.source===I.id&&f._validateLayer(U)}}}})}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.loadURL=function(o,l){var f=this;l===void 0&&(l={}),this.fire(new u.Event("dataloading",{dataType:"style"}));var y=typeof l.validate=="boolean"?l.validate:!u.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,l.accessToken);var g=this.map._requestManager.transformRequest(o,u.ResourceType.Style);this._request=u.getJSON(g,function(w,I){f._request=null,w?f.fire(new u.ErrorEvent(w)):I&&f._load(I,y)})},a.prototype.loadJSON=function(o,l){var f=this;l===void 0&&(l={}),this.fire(new u.Event("dataloading",{dataType:"style"})),this._request=u.browser.frame(function(){f._request=null,f._load(o,l.validate!==!1)})},a.prototype.loadEmpty=function(){this.fire(new u.Event("dataloading",{dataType:"style"})),this._load(Pa,!1)},a.prototype._load=function(o,l){if(!l||!Ar(this,u.validateStyle(o))){for(var f in this._loaded=!0,this.stylesheet=o,o.sources)this.addSource(f,o.sources[f],{validate:!1});o.sprite?this._loadSprite(o.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(o.glyphs);var y=Mt(this.stylesheet.layers);this._order=y.map(function(k){return k.id}),this._layers={},this._serializedLayers={};for(var g=0,w=y;g<w.length;g+=1){var I=w[g];(I=u.createStyleLayer(I)).setEventedParent(this,{layer:{id:I.id}}),this._layers[I.id]=I,this._serializedLayers[I.id]=I.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ji(this.stylesheet.light),this.fire(new u.Event("data",{dataType:"style"})),this.fire(new u.Event("style.load"))}},a.prototype._loadSprite=function(o){var l=this;this._spriteRequest=function(f,y,g){var w,I,k,U=u.browser.devicePixelRatio>1?"@2x":"",Z=u.getJSON(y.transformRequest(y.normalizeSpriteURL(f,U,".json"),u.ResourceType.SpriteJSON),function(K,tt){Z=null,k||(k=K,w=tt,J())}),q=u.getImage(y.transformRequest(y.normalizeSpriteURL(f,U,".png"),u.ResourceType.SpriteImage),function(K,tt){q=null,k||(k=K,I=tt,J())});function J(){if(k)g(k);else if(w&&I){var K=u.browser.getImageData(I),tt={};for(var G in w){var Q=w[G],ot=Q.width,ht=Q.height,_t=Q.x,dt=Q.y,vt=Q.sdf,Pt=Q.pixelRatio,kt=Q.stretchX,zt=Q.stretchY,Zt=Q.content,te=new u.RGBAImage({width:ot,height:ht});u.RGBAImage.copy(K,te,{x:_t,y:dt},{x:0,y:0},{width:ot,height:ht}),tt[G]={data:te,pixelRatio:Pt,sdf:vt,stretchX:kt,stretchY:zt,content:Zt}}g(null,tt)}}return{cancel:function(){Z&&(Z.cancel(),Z=null),q&&(q.cancel(),q=null)}}}(o,this.map._requestManager,function(f,y){if(l._spriteRequest=null,f)l.fire(new u.ErrorEvent(f));else if(y)for(var g in y)l.imageManager.addImage(g,y[g]);l.imageManager.setLoaded(!0),l._availableImages=l.imageManager.listImages(),l.dispatcher.broadcast("setImages",l._availableImages),l.fire(new u.Event("data",{dataType:"style"}))})},a.prototype._validateLayer=function(o){var l=this.sourceCaches[o.source];if(l){var f=o.sourceLayer;if(f){var y=l.getSource();(y.type==="geojson"||y.vectorLayerIds&&y.vectorLayerIds.indexOf(f)===-1)&&this.fire(new u.ErrorEvent(new Error('Source layer "'+f+'" does not exist on source "'+y.id+'" as specified by style layer "'+o.id+'"')))}}},a.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var o in this.sourceCaches)if(!this.sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()},a.prototype._serializeLayers=function(o){for(var l=[],f=0,y=o;f<y.length;f+=1){var g=this._layers[y[f]];g.type!=="custom"&&l.push(g.serialize())}return l},a.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var o in this.sourceCaches)if(this.sourceCaches[o].hasTransition())return!0;for(var l in this._layers)if(this._layers[l].hasTransition())return!0;return!1},a.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},a.prototype.update=function(o){if(this._loaded){var l=this._changed;if(this._changed){var f=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);for(var g in(f.length||y.length)&&this._updateWorkerLayers(f,y),this._updatedSources){var w=this._updatedSources[g];w==="reload"?this._reloadSource(g):w==="clear"&&this._clearSource(g)}for(var I in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[I].updateTransitions(o);this.light.updateTransitions(o),this._resetUpdates()}var k={};for(var U in this.sourceCaches){var Z=this.sourceCaches[U];k[U]=Z.used,Z.used=!1}for(var q=0,J=this._order;q<J.length;q+=1){var K=this._layers[J[q]];K.recalculate(o,this._availableImages),!K.isHidden(o.zoom)&&K.source&&(this.sourceCaches[K.source].used=!0)}for(var tt in k){var G=this.sourceCaches[tt];k[tt]!==G.used&&G.fire(new u.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:tt}))}this.light.recalculate(o),this.z=o.zoom,l&&this.fire(new u.Event("data",{dataType:"style"}))}},a.prototype._updateTilesForChangedImages=function(){var o=Object.keys(this._changedImages);if(o.length){for(var l in this.sourceCaches)this.sourceCaches[l].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}},a.prototype._updateWorkerLayers=function(o,l){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:l})},a.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},a.prototype.setState=function(o){var l=this;if(this._checkLoaded(),Ar(this,u.validateStyle(o)))return!1;(o=u.clone$1(o)).layers=Mt(o.layers);var f=function(g,w){if(!g)return[{command:Rt.setStyle,args:[w]}];var I=[];try{if(!u.deepEqual(g.version,w.version))return[{command:Rt.setStyle,args:[w]}];u.deepEqual(g.center,w.center)||I.push({command:Rt.setCenter,args:[w.center]}),u.deepEqual(g.zoom,w.zoom)||I.push({command:Rt.setZoom,args:[w.zoom]}),u.deepEqual(g.bearing,w.bearing)||I.push({command:Rt.setBearing,args:[w.bearing]}),u.deepEqual(g.pitch,w.pitch)||I.push({command:Rt.setPitch,args:[w.pitch]}),u.deepEqual(g.sprite,w.sprite)||I.push({command:Rt.setSprite,args:[w.sprite]}),u.deepEqual(g.glyphs,w.glyphs)||I.push({command:Rt.setGlyphs,args:[w.glyphs]}),u.deepEqual(g.transition,w.transition)||I.push({command:Rt.setTransition,args:[w.transition]}),u.deepEqual(g.light,w.light)||I.push({command:Rt.setLight,args:[w.light]});var k={},U=[];(function(q,J,K,tt){var G;for(G in J=J||{},q=q||{})q.hasOwnProperty(G)&&(J.hasOwnProperty(G)||Ot(G,K,tt));for(G in J)J.hasOwnProperty(G)&&(q.hasOwnProperty(G)?u.deepEqual(q[G],J[G])||(q[G].type==="geojson"&&J[G].type==="geojson"&&Be(q,J,G)?K.push({command:Rt.setGeoJSONSourceData,args:[G,J[G].data]}):be(G,J,K,tt)):ge(G,J,K))})(g.sources,w.sources,U,k);var Z=[];g.layers&&g.layers.forEach(function(q){k[q.source]?I.push({command:Rt.removeLayer,args:[q.id]}):Z.push(q)}),I=I.concat(U),function(q,J,K){J=J||[];var tt,G,Q,ot,ht,_t,dt,vt=(q=q||[]).map(Re),Pt=J.map(Re),kt=q.reduce(Ie,{}),zt=J.reduce(Ie,{}),Zt=vt.slice(),te=Object.create(null);for(tt=0,G=0;tt<vt.length;tt++)zt.hasOwnProperty(Q=vt[tt])?G++:(K.push({command:Rt.removeLayer,args:[Q]}),Zt.splice(Zt.indexOf(Q,G),1));for(tt=0,G=0;tt<Pt.length;tt++)Zt[Zt.length-1-tt]!==(Q=Pt[Pt.length-1-tt])&&(kt.hasOwnProperty(Q)?(K.push({command:Rt.removeLayer,args:[Q]}),Zt.splice(Zt.lastIndexOf(Q,Zt.length-G),1)):G++,K.push({command:Rt.addLayer,args:[zt[Q],_t=Zt[Zt.length-tt]]}),Zt.splice(Zt.length-tt,0,Q),te[Q]=!0);for(tt=0;tt<Pt.length;tt++)if(ot=kt[Q=Pt[tt]],ht=zt[Q],!te[Q]&&!u.deepEqual(ot,ht))if(u.deepEqual(ot.source,ht.source)&&u.deepEqual(ot["source-layer"],ht["source-layer"])&&u.deepEqual(ot.type,ht.type)){for(dt in we(ot.layout,ht.layout,K,Q,null,Rt.setLayoutProperty),we(ot.paint,ht.paint,K,Q,null,Rt.setPaintProperty),u.deepEqual(ot.filter,ht.filter)||K.push({command:Rt.setFilter,args:[Q,ht.filter]}),u.deepEqual(ot.minzoom,ht.minzoom)&&u.deepEqual(ot.maxzoom,ht.maxzoom)||K.push({command:Rt.setLayerZoomRange,args:[Q,ht.minzoom,ht.maxzoom]}),ot)ot.hasOwnProperty(dt)&&dt!=="layout"&&dt!=="paint"&&dt!=="filter"&&dt!=="metadata"&&dt!=="minzoom"&&dt!=="maxzoom"&&(dt.indexOf("paint.")===0?we(ot[dt],ht[dt],K,Q,dt.slice(6),Rt.setPaintProperty):u.deepEqual(ot[dt],ht[dt])||K.push({command:Rt.setLayerProperty,args:[Q,dt,ht[dt]]}));for(dt in ht)ht.hasOwnProperty(dt)&&!ot.hasOwnProperty(dt)&&dt!=="layout"&&dt!=="paint"&&dt!=="filter"&&dt!=="metadata"&&dt!=="minzoom"&&dt!=="maxzoom"&&(dt.indexOf("paint.")===0?we(ot[dt],ht[dt],K,Q,dt.slice(6),Rt.setPaintProperty):u.deepEqual(ot[dt],ht[dt])||K.push({command:Rt.setLayerProperty,args:[Q,dt,ht[dt]]}))}else K.push({command:Rt.removeLayer,args:[Q]}),_t=Zt[Zt.lastIndexOf(Q)+1],K.push({command:Rt.addLayer,args:[ht,_t]})}(Z,w.layers,I)}catch(q){console.warn("Unable to compute style diff:",q),I=[{command:Rt.setStyle,args:[w]}]}return I}(this.serialize(),o).filter(function(g){return!(g.command in ro)});if(f.length===0)return!1;var y=f.filter(function(g){return!(g.command in Un)});if(y.length>0)throw new Error("Unimplemented: "+y.map(function(g){return g.command}).join(", ")+".");return f.forEach(function(g){g.command!=="setTransition"&&l[g.command].apply(l,g.args)}),this.stylesheet=o,!0},a.prototype.addImage=function(o,l){if(this.getImage(o))return this.fire(new u.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(o,l),this._afterImageUpdated(o)},a.prototype.updateImage=function(o,l){this.imageManager.updateImage(o,l)},a.prototype.getImage=function(o){return this.imageManager.getImage(o)},a.prototype.removeImage=function(o){if(!this.getImage(o))return this.fire(new u.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(o),this._afterImageUpdated(o)},a.prototype._afterImageUpdated=function(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))},a.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},a.prototype.addSource=function(o,l,f){var y=this;if(f===void 0&&(f={}),this._checkLoaded(),this.sourceCaches[o]!==void 0)throw new Error("There is already a source with this ID");if(!l.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(l).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(l.type)>=0&&this._validate(u.validateStyle.source,"sources."+o,l,null,f))){this.map&&this.map._collectResourceTiming&&(l.collectResourceTiming=!0);var g=this.sourceCaches[o]=new Y(o,l,this.dispatcher);g.style=this,g.setEventedParent(this,function(){return{isSourceLoaded:y.loaded(),source:g.serialize(),sourceId:o}}),g.onAdd(this.map),this._changed=!0}},a.prototype.removeSource=function(o){if(this._checkLoaded(),this.sourceCaches[o]===void 0)throw new Error("There is no source with this ID");for(var l in this._layers)if(this._layers[l].source===o)return this.fire(new u.ErrorEvent(new Error('Source "'+o+'" cannot be removed while layer "'+l+'" is using it.')));var f=this.sourceCaches[o];delete this.sourceCaches[o],delete this._updatedSources[o],f.fire(new u.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:o})),f.setEventedParent(null),f.clearTiles(),f.onRemove&&f.onRemove(this.map),this._changed=!0},a.prototype.setGeoJSONSourceData=function(o,l){this._checkLoaded(),this.sourceCaches[o].getSource().setData(l),this._changed=!0},a.prototype.getSource=function(o){return this.sourceCaches[o]&&this.sourceCaches[o].getSource()},a.prototype.addLayer=function(o,l,f){f===void 0&&(f={}),this._checkLoaded();var y=o.id;if(this.getLayer(y))this.fire(new u.ErrorEvent(new Error('Layer with id "'+y+'" already exists on this map')));else{var g;if(o.type==="custom"){if(Ar(this,u.validateCustomStyleLayer(o)))return;g=u.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(y,o.source),o=u.clone$1(o),o=u.extend(o,{source:y})),this._validate(u.validateStyle.layer,"layers."+y,o,{arrayIndex:-1},f))return;g=u.createStyleLayer(o),this._validateLayer(g),g.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[g.id]=g.serialize()}var w=l?this._order.indexOf(l):this._order.length;if(l&&w===-1)this.fire(new u.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.')));else{if(this._order.splice(w,0,y),this._layerOrderChanged=!0,this._layers[y]=g,this._removedLayers[y]&&g.source&&g.type!=="custom"){var I=this._removedLayers[y];delete this._removedLayers[y],I.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}},a.prototype.moveLayer=function(o,l){if(this._checkLoaded(),this._changed=!0,this._layers[o]){if(o!==l){var f=this._order.indexOf(o);this._order.splice(f,1);var y=l?this._order.indexOf(l):this._order.length;l&&y===-1?this.fire(new u.ErrorEvent(new Error('Layer with id "'+l+'" does not exist on this map.'))):(this._order.splice(y,0,o),this._layerOrderChanged=!0)}}else this.fire(new u.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be moved.")))},a.prototype.removeLayer=function(o){this._checkLoaded();var l=this._layers[o];if(l){l.setEventedParent(null);var f=this._order.indexOf(o);this._order.splice(f,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=l,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],l.onRemove&&l.onRemove(this.map)}else this.fire(new u.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be removed.")))},a.prototype.getLayer=function(o){return this._layers[o]},a.prototype.hasLayer=function(o){return o in this._layers},a.prototype.setLayerZoomRange=function(o,l,f){this._checkLoaded();var y=this.getLayer(o);y?y.minzoom===l&&y.maxzoom===f||(l!=null&&(y.minzoom=l),f!=null&&(y.maxzoom=f),this._updateLayer(y)):this.fire(new u.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot have zoom extent.")))},a.prototype.setFilter=function(o,l,f){f===void 0&&(f={}),this._checkLoaded();var y=this.getLayer(o);if(y){if(!u.deepEqual(y.filter,l))return l==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(u.validateStyle.filter,"layers."+y.id+".filter",l,null,f)||(y.filter=u.clone$1(l),this._updateLayer(y)))}else this.fire(new u.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be filtered.")))},a.prototype.getFilter=function(o){return u.clone$1(this.getLayer(o).filter)},a.prototype.setLayoutProperty=function(o,l,f,y){y===void 0&&(y={}),this._checkLoaded();var g=this.getLayer(o);g?u.deepEqual(g.getLayoutProperty(l),f)||(g.setLayoutProperty(l,f,y),this._updateLayer(g)):this.fire(new u.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getLayoutProperty=function(o,l){var f=this.getLayer(o);if(f)return f.getLayoutProperty(l);this.fire(new u.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style.")))},a.prototype.setPaintProperty=function(o,l,f,y){y===void 0&&(y={}),this._checkLoaded();var g=this.getLayer(o);g?u.deepEqual(g.getPaintProperty(l),f)||(g.setPaintProperty(l,f,y)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new u.ErrorEvent(new Error("The layer '"+o+"' does not exist in the map's style and cannot be styled.")))},a.prototype.getPaintProperty=function(o,l){return this.getLayer(o).getPaintProperty(l)},a.prototype.setFeatureState=function(o,l){this._checkLoaded();var f=o.source,y=o.sourceLayer,g=this.sourceCaches[f];if(g!==void 0){var w=g.getSource().type;w==="geojson"&&y?this.fire(new u.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):w!=="vector"||y?(o.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),g.setFeatureState(y,o.id,l)):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new u.ErrorEvent(new Error("The source '"+f+"' does not exist in the map's style.")))},a.prototype.removeFeatureState=function(o,l){this._checkLoaded();var f=o.source,y=this.sourceCaches[f];if(y!==void 0){var g=y.getSource().type,w=g==="vector"?o.sourceLayer:void 0;g!=="vector"||w?l&&typeof o.id!="string"&&typeof o.id!="number"?this.fire(new u.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):y.removeFeatureState(w,o.id,l):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new u.ErrorEvent(new Error("The source '"+f+"' does not exist in the map's style.")))},a.prototype.getFeatureState=function(o){this._checkLoaded();var l=o.source,f=o.sourceLayer,y=this.sourceCaches[l];if(y!==void 0){if(y.getSource().type!=="vector"||f)return o.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),y.getFeatureState(f,o.id);this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new u.ErrorEvent(new Error("The source '"+l+"' does not exist in the map's style.")))},a.prototype.getTransition=function(){return u.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},a.prototype.serialize=function(){return u.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:u.mapObject(this.sourceCaches,function(o){return o.serialize()}),layers:this._serializeLayers(this._order)},function(o){return o!==void 0})},a.prototype._updateLayer=function(o){this._updatedLayers[o.id]=!0,o.source&&!this._updatedSources[o.source]&&this.sourceCaches[o.source].getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",this.sourceCaches[o.source].pause()),this._changed=!0},a.prototype._flattenAndSortRenderedFeatures=function(o){for(var l=this,f=function(kt){return l._layers[kt].type==="fill-extrusion"},y={},g=[],w=this._order.length-1;w>=0;w--){var I=this._order[w];if(f(I)){y[I]=w;for(var k=0,U=o;k<U.length;k+=1){var Z=U[k][I];if(Z)for(var q=0,J=Z;q<J.length;q+=1)g.push(J[q])}}}g.sort(function(kt,zt){return zt.intersectionZ-kt.intersectionZ});for(var K=[],tt=this._order.length-1;tt>=0;tt--){var G=this._order[tt];if(f(G))for(var Q=g.length-1;Q>=0;Q--){var ot=g[Q].feature;if(y[ot.layer.id]<tt)break;K.push(ot),g.pop()}else for(var ht=0,_t=o;ht<_t.length;ht+=1){var dt=_t[ht][G];if(dt)for(var vt=0,Pt=dt;vt<Pt.length;vt+=1)K.push(Pt[vt].feature)}}return K},a.prototype.queryRenderedFeatures=function(o,l,f){l&&l.filter&&this._validate(u.validateStyle.filter,"queryRenderedFeatures.filter",l.filter,null,l);var y={};if(l&&l.layers){if(!Array.isArray(l.layers))return this.fire(new u.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var g=0,w=l.layers;g<w.length;g+=1){var I=w[g],k=this._layers[I];if(!k)return this.fire(new u.ErrorEvent(new Error("The layer '"+I+"' does not exist in the map's style and cannot be queried for features."))),[];y[k.source]=!0}}var U=[];for(var Z in l.availableImages=this._availableImages,this.sourceCaches)l.layers&&!y[Z]||U.push(vi(this.sourceCaches[Z],this._layers,this._serializedLayers,o,l,f));return this.placement&&U.push(function(q,J,K,tt,G,Q,ot){for(var ht={},_t=Q.queryRenderedSymbols(tt),dt=[],vt=0,Pt=Object.keys(_t).map(Number);vt<Pt.length;vt+=1)dt.push(ot[Pt[vt]]);dt.sort(_r);for(var kt=function(){var ne=Zt[zt],Me=ne.featureIndex.lookupSymbolFeatures(_t[ne.bucketInstanceId],J,ne.bucketIndex,ne.sourceLayerIndex,G.filter,G.layers,G.availableImages,q);for(var Gt in Me){var pe=ht[Gt]=ht[Gt]||[],ve=Me[Gt];ve.sort(function(ye,ue){var ae=ne.featureSortOrder;if(ae){var rr=ae.indexOf(ye.featureIndex);return ae.indexOf(ue.featureIndex)-rr}return ue.featureIndex-ye.featureIndex});for(var ce=0,he=ve;ce<he.length;ce+=1)pe.push(he[ce])}},zt=0,Zt=dt;zt<Zt.length;zt+=1)kt();var te=function(ne){ht[ne].forEach(function(Me){var Gt=Me.feature,pe=K[q[ne].source].getFeatureState(Gt.layer["source-layer"],Gt.id);Gt.source=Gt.layer.source,Gt.layer["source-layer"]&&(Gt.sourceLayer=Gt.layer["source-layer"]),Gt.state=pe})};for(var oe in ht)te(oe);return ht}(this._layers,this._serializedLayers,this.sourceCaches,o,l,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(U)},a.prototype.querySourceFeatures=function(o,l){l&&l.filter&&this._validate(u.validateStyle.filter,"querySourceFeatures.filter",l.filter,null,l);var f=this.sourceCaches[o];return f?function(y,g){for(var w=y.getRenderableIds().map(function(J){return y.getTileByID(J)}),I=[],k={},U=0;U<w.length;U++){var Z=w[U],q=Z.tileID.canonical.key;k[q]||(k[q]=!0,Z.querySourceFeatures(I,g))}return I}(f,l):[]},a.prototype.addSourceType=function(o,l,f){return a.getSourceType(o)?f(new Error('A source type called "'+o+'" already exists.')):(a.setSourceType(o,l),l.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:l.workerSourceURL},f):f(null,null))},a.prototype.getLight=function(){return this.light.getLight()},a.prototype.setLight=function(o,l){l===void 0&&(l={}),this._checkLoaded();var f=this.light.getLight(),y=!1;for(var g in o)if(!u.deepEqual(o[g],f[g])){y=!0;break}if(y){var w={now:u.browser.now(),transition:u.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(o,l),this.light.updateTransitions(w)}},a.prototype._validate=function(o,l,f,y,g){return g===void 0&&(g={}),(!g||g.validate!==!1)&&Ar(this,o.call(u.validateStyle,u.extend({key:l,style:this.serialize(),value:f,styleSpec:u.styleSpec},y)))},a.prototype._remove=function(){for(var o in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),u.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[o].setEventedParent(null);for(var l in this.sourceCaches)this.sourceCaches[l].clearTiles(),this.sourceCaches[l].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},a.prototype._clearSource=function(o){this.sourceCaches[o].clearTiles()},a.prototype._reloadSource=function(o){this.sourceCaches[o].resume(),this.sourceCaches[o].reload()},a.prototype._updateSources=function(o){for(var l in this.sourceCaches)this.sourceCaches[l].update(o)},a.prototype._generateCollisionBoxes=function(){for(var o in this.sourceCaches)this._reloadSource(o)},a.prototype._updatePlacement=function(o,l,f,y,g){g===void 0&&(g=!1);for(var w=!1,I=!1,k={},U=0,Z=this._order;U<Z.length;U+=1){var q=this._layers[Z[U]];if(q.type==="symbol"){if(!k[q.source]){var J=this.sourceCaches[q.source];k[q.source]=J.getRenderableIds(!0).map(function(ot){return J.getTileByID(ot)}).sort(function(ot,ht){return ht.tileID.overscaledZ-ot.tileID.overscaledZ||(ot.tileID.isLessThan(ht.tileID)?-1:1)})}var K=this.crossTileSymbolIndex.addLayer(q,k[q.source],o.center.lng);w=w||K}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||f===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(u.browser.now(),o.zoom))&&(this.pauseablePlacement=new io(o,this._order,g,l,f,y,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(u.browser.now()),I=!0),w&&this.pauseablePlacement.placement.setStale()),I||w)for(var tt=0,G=this._order;tt<G.length;tt+=1){var Q=this._layers[G[tt]];Q.type==="symbol"&&this.placement.updateLayerOpacities(Q,k[Q.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(u.browser.now())},a.prototype._releaseSymbolFadeTiles=function(){for(var o in this.sourceCaches)this.sourceCaches[o].releaseSymbolFadeTiles()},a.prototype.getImages=function(o,l,f){this.imageManager.getImages(l.icons,f),this._updateTilesForChangedImages();var y=this.sourceCaches[l.source];y&&y.setDependencies(l.tileID.key,l.type,l.icons)},a.prototype.getGlyphs=function(o,l,f){this.glyphManager.getGlyphs(l.stacks,f)},a.prototype.getResource=function(o,l,f){return u.makeRequest(l,f)},a}(u.Evented);br.getSourceType=function(n){return Ve[n]},br.setSourceType=function(n,a){Ve[n]=a},br.registerForPluginStateChange=u.registerForPluginStateChange;var wi=u.createLayout([{name:"a_pos",type:"Int16",components:2}]),no=Xe(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),Ia=Xe(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Zl=Xe(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),$s=Xe(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),Ue=Xe("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Ps=Xe(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),Kr=Xe(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),Ao=Xe("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Is=Xe("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Qs=Xe("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Es=Xe(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Ea=Xe(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ho=Xe(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),tl=Xe(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),Vi=Xe(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),As=Xe(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hr=Xe(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),oo=Xe(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),ao=Xe(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),so=Xe(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Ln=Xe(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Jr=Xe(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),lo=Xe(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),Nn=Xe(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),el=Xe(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),il=Xe(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function Xe(n,a){var o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,l=a.match(/attribute ([\w]+) ([\w]+)/g),f=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=a.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=y?y.concat(f):f,w={};return{fragmentSource:n=n.replace(o,function(I,k,U,Z,q){return w[q]=!0,k==="define"?`
#ifndef HAS_UNIFORM_u_`+q+`
varying `+U+" "+Z+" "+q+`;
#else
uniform `+U+" "+Z+" u_"+q+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+q+`
    `+U+" "+Z+" "+q+" = u_"+q+`;
#endif
`}),vertexSource:a=a.replace(o,function(I,k,U,Z,q){var J=Z==="float"?"vec2":"vec4",K=q.match(/color/)?"color":J;return w[q]?k==="define"?`
#ifndef HAS_UNIFORM_u_`+q+`
uniform lowp float u_`+q+`_t;
attribute `+U+" "+J+" a_"+q+`;
varying `+U+" "+Z+" "+q+`;
#else
uniform `+U+" "+Z+" u_"+q+`;
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_`+q+`
    `+q+" = a_"+q+`;
#else
    `+U+" "+Z+" "+q+" = u_"+q+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+q+`
    `+q+" = unpack_mix_"+K+"(a_"+q+", u_"+q+`_t);
#else
    `+U+" "+Z+" "+q+" = u_"+q+`;
#endif
`:k==="define"?`
#ifndef HAS_UNIFORM_u_`+q+`
uniform lowp float u_`+q+`_t;
attribute `+U+" "+J+" a_"+q+`;
#else
uniform `+U+" "+Z+" u_"+q+`;
#endif
`:K==="vec4"?`
#ifndef HAS_UNIFORM_u_`+q+`
    `+U+" "+Z+" "+q+" = a_"+q+`;
#else
    `+U+" "+Z+" "+q+" = u_"+q+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+q+`
    `+U+" "+Z+" "+q+" = unpack_mix_"+K+"(a_"+q+", u_"+q+`_t);
#else
    `+U+" "+Z+" "+q+" = u_"+q+`;
#endif
`}),staticAttributes:l,staticUniforms:g}}var Vl=Object.freeze({__proto__:null,prelude:no,background:Ia,backgroundPattern:Zl,circle:$s,clippingMask:Ue,heatmap:Ps,heatmapTexture:Kr,collisionBox:Ao,collisionCircle:Is,debug:Qs,fill:Es,fillOutline:Ea,fillOutlinePattern:Ho,fillPattern:tl,fillExtrusion:Vi,fillExtrusionPattern:As,hillshadePrepare:hr,hillshade:oo,line:ao,lineGradient:so,linePattern:Ln,lineSDF:Jr,raster:lo,symbolIcon:Nn,symbolSDF:el,symbolTextAndIcon:il}),Aa=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function Cs(n){for(var a=[],o=0;o<n.length;o++)if(n[o]!==null){var l=n[o].split(" ");a.push(l.pop())}return a}Aa.prototype.bind=function(n,a,o,l,f,y,g,w){this.context=n;for(var I=this.boundPaintVertexBuffers.length!==l.length,k=0;!I&&k<l.length;k++)this.boundPaintVertexBuffers[k]!==l[k]&&(I=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===a&&this.boundLayoutVertexBuffer===o&&!I&&this.boundIndexBuffer===f&&this.boundVertexOffset===y&&this.boundDynamicVertexBuffer===g&&this.boundDynamicVertexBuffer2===w?(n.bindVertexArrayOES.set(this.vao),g&&g.bind(),f&&f.dynamicDraw&&f.bind(),w&&w.bind()):this.freshBind(a,o,l,f,y,g,w)},Aa.prototype.freshBind=function(n,a,o,l,f,y,g){var w,I=n.numAttributes,k=this.context,U=k.gl;if(k.extVertexArrayObject)this.vao&&this.destroy(),this.vao=k.extVertexArrayObject.createVertexArrayOES(),k.bindVertexArrayOES.set(this.vao),w=0,this.boundProgram=n,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=o,this.boundIndexBuffer=l,this.boundVertexOffset=f,this.boundDynamicVertexBuffer=y,this.boundDynamicVertexBuffer2=g;else{w=k.currentNumAttributes||0;for(var Z=I;Z<w;Z++)U.disableVertexAttribArray(Z)}a.enableAttributes(U,n);for(var q=0,J=o;q<J.length;q+=1)J[q].enableAttributes(U,n);y&&y.enableAttributes(U,n),g&&g.enableAttributes(U,n),a.bind(),a.setVertexAttribPointers(U,n,f);for(var K=0,tt=o;K<tt.length;K+=1){var G=tt[K];G.bind(),G.setVertexAttribPointers(U,n,f)}y&&(y.bind(),y.setVertexAttribPointers(U,n,f)),l&&l.bind(),g&&(g.bind(),g.setVertexAttribPointers(U,n,f)),k.currentNumAttributes=I},Aa.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var Ca=function(n,a,o,l,f,y){var g=n.gl;this.program=g.createProgram();for(var w=Cs(o.staticAttributes),I=l?l.getBinderAttributes():[],k=w.concat(I),U=o.staticUniforms?Cs(o.staticUniforms):[],Z=l?l.getBinderUniforms():[],q=[],J=0,K=U.concat(Z);J<K.length;J+=1){var tt=K[J];q.indexOf(tt)<0&&q.push(tt)}var G=l?l.defines():[];y&&G.push("#define OVERDRAW_INSPECTOR;");var Q=G.concat(no.fragmentSource,o.fragmentSource).join(`
`),ot=G.concat(no.vertexSource,o.vertexSource).join(`
`),ht=g.createShader(g.FRAGMENT_SHADER);if(g.isContextLost())this.failedToCreate=!0;else{g.shaderSource(ht,Q),g.compileShader(ht),g.attachShader(this.program,ht);var _t=g.createShader(g.VERTEX_SHADER);if(g.isContextLost())this.failedToCreate=!0;else{g.shaderSource(_t,ot),g.compileShader(_t),g.attachShader(this.program,_t),this.attributes={};var dt={};this.numAttributes=k.length;for(var vt=0;vt<this.numAttributes;vt++)k[vt]&&(g.bindAttribLocation(this.program,vt,k[vt]),this.attributes[k[vt]]=vt);g.linkProgram(this.program),g.deleteShader(_t),g.deleteShader(ht);for(var Pt=0;Pt<q.length;Pt++){var kt=q[Pt];if(kt&&!dt[kt]){var zt=g.getUniformLocation(this.program,kt);zt&&(dt[kt]=zt)}}this.fixedUniforms=f(n,dt),this.binderUniforms=l?l.getUniforms(n,dt):[]}}};function uo(n,a,o){var l=1/He(o,1,a.transform.tileZoom),f=Math.pow(2,o.tileID.overscaledZ),y=o.tileSize*Math.pow(2,a.transform.tileZoom)/f,g=y*(o.tileID.canonical.x+o.tileID.wrap*f),w=y*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[l,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[g>>16,w>>16],u_pixel_coord_lower:[65535&g,65535&w]}}Ca.prototype.draw=function(n,a,o,l,f,y,g,w,I,k,U,Z,q,J,K,tt){var G,Q=n.gl;if(!this.failedToCreate){for(var ot in n.program.set(this.program),n.setDepthMode(o),n.setStencilMode(l),n.setColorMode(f),n.setCullFace(y),this.fixedUniforms)this.fixedUniforms[ot].set(g[ot]);J&&J.setUniforms(n,this.binderUniforms,Z,{zoom:q});for(var ht=(G={},G[Q.LINES]=2,G[Q.TRIANGLES]=3,G[Q.LINE_STRIP]=1,G)[a],_t=0,dt=U.get();_t<dt.length;_t+=1){var vt=dt[_t],Pt=vt.vaos||(vt.vaos={});(Pt[w]||(Pt[w]=new Aa)).bind(n,this,I,J?J.getPaintVertexBuffers():[],k,vt.vertexOffset,K,tt),Q.drawElements(a,vt.primitiveLength*ht,Q.UNSIGNED_SHORT,vt.primitiveOffset*ht*2)}}};var rl=function(n,a,o,l){var f=a.style.light,y=f.properties.get("position"),g=[y.x,y.y,y.z],w=u.create$1();f.properties.get("anchor")==="viewport"&&u.fromRotation(w,-a.transform.angle),u.transformMat3(g,g,w);var I=f.properties.get("color");return{u_matrix:n,u_lightpos:g,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[I.r,I.g,I.b],u_vertical_gradient:+o,u_opacity:l}},yn=function(n,a,o,l,f,y,g){return u.extend(rl(n,a,o,l),uo(y,a,g),{u_height_factor:-Math.pow(2,f.overscaledZ)/g.tileSize/8})},wr=function(n){return{u_matrix:n}},ho=function(n,a,o,l){return u.extend(wr(n),uo(o,a,l))},nl=function(n,a){return{u_matrix:n,u_world:a}},Ls=function(n,a,o,l,f){return u.extend(ho(n,a,o,l),{u_world:f})},zs=function(n,a,o,l){var f,y,g=n.transform;if(l.paint.get("circle-pitch-alignment")==="map"){var w=He(o,1,g.zoom);f=!0,y=[w,w]}else f=!1,y=g.pixelsToGLUnits;return{u_camera_to_center_distance:g.cameraToCenterDistance,u_scale_with_map:+(l.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(a.posMatrix,o,l.paint.get("circle-translate"),l.paint.get("circle-translate-anchor")),u_pitch_with_map:+f,u_device_pixel_ratio:u.browser.devicePixelRatio,u_extrude_scale:y}},Zn=function(n,a,o){var l=He(o,1,a.zoom),f=Math.pow(2,a.zoom-o.tileID.overscaledZ),y=o.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:a.cameraToCenterDistance,u_pixels_to_tile_units:l,u_extrude_scale:[a.pixelsToGLUnits[0]/(l*f),a.pixelsToGLUnits[1]/(l*f)],u_overscale_factor:y}},Ja=function(n,a,o){return{u_matrix:n,u_inv_matrix:a,u_camera_to_center_distance:o.cameraToCenterDistance,u_viewport_size:[o.width,o.height]}},Co=function(n,a,o){return o===void 0&&(o=1),{u_matrix:n,u_color:a,u_overlay:0,u_overlay_scale:o}},Lo=function(n){return{u_matrix:n}},ks=function(n,a,o,l){return{u_matrix:n,u_extrude_scale:He(a,1,o),u_intensity:l}},La=function(n,a,o){var l=n.transform;return{u_matrix:ol(n,a,o),u_ratio:1/He(a,1,l.zoom),u_device_pixel_ratio:u.browser.devicePixelRatio,u_units_to_pixels:[1/l.pixelsToGLUnits[0],1/l.pixelsToGLUnits[1]]}},Le=function(n,a,o,l){return u.extend(La(n,a,o),{u_image:0,u_image_height:l})},Vn=function(n,a,o,l){var f=n.transform,y=gn(a,f);return{u_matrix:ol(n,a,o),u_texsize:a.imageAtlasTexture.size,u_ratio:1/He(a,1,f.zoom),u_device_pixel_ratio:u.browser.devicePixelRatio,u_image:0,u_scale:[y,l.fromScale,l.toScale],u_fade:l.t,u_units_to_pixels:[1/f.pixelsToGLUnits[0],1/f.pixelsToGLUnits[1]]}},ql=function(n,a,o,l,f){var y=n.lineAtlas,g=gn(a,n.transform),w=o.layout.get("line-cap")==="round",I=y.getDash(l.from,w),k=y.getDash(l.to,w),U=I.width*f.fromScale,Z=k.width*f.toScale;return u.extend(La(n,a,o),{u_patternscale_a:[g/U,-I.height/2],u_patternscale_b:[g/Z,-k.height/2],u_sdfgamma:y.width/(256*Math.min(U,Z)*u.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:I.y,u_tex_y_b:k.y,u_mix:f.t})};function gn(n,a){return 1/He(n,1,a.tileZoom)}function ol(n,a,o){return n.translatePosMatrix(a.tileID.posMatrix,a,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}var Xo=function(n,a,o,l,f){return{u_matrix:n,u_tl_parent:a,u_scale_parent:o,u_buffer_scale:1,u_fade_t:l.mix,u_opacity:l.opacity*f.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:f.paint.get("raster-brightness-min"),u_brightness_high:f.paint.get("raster-brightness-max"),u_saturation_factor:(g=f.paint.get("raster-saturation"),g>0?1-1/(1.001-g):-g),u_contrast_factor:(y=f.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:al(f.paint.get("raster-hue-rotate"))};var y,g};function al(n){n*=Math.PI/180;var a=Math.sin(n),o=Math.cos(n);return[(2*o+1)/3,(-Math.sqrt(3)*a-o+1)/3,(Math.sqrt(3)*a-o+1)/3]}var co,zo=function(n,a,o,l,f,y,g,w,I,k){var U=f.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:U.cameraToCenterDistance,u_pitch:U.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:U.width/U.height,u_fade_change:f.options.fadeDuration?f.symbolFadeChange:1,u_matrix:y,u_label_plane_matrix:g,u_coord_matrix:w,u_is_text:+I,u_pitch_with_map:+l,u_texsize:k,u_texture:0}},po=function(n,a,o,l,f,y,g,w,I,k,U){var Z=f.transform;return u.extend(zo(n,a,o,l,f,y,g,w,I,k),{u_gamma_scale:l?Math.cos(Z._pitch)*Z.cameraToCenterDistance:1,u_device_pixel_ratio:u.browser.devicePixelRatio,u_is_halo:+U})},Ya=function(n,a,o,l,f,y,g,w,I,k){return u.extend(po(n,a,o,l,f,y,g,w,!0,I,!0),{u_texsize_icon:k,u_texture_icon:1})},pn=function(n,a,o){return{u_matrix:n,u_opacity:a,u_color:o}},qn=function(n,a,o,l,f,y){return u.extend(function(g,w,I,k){var U=I.imageManager.getPattern(g.from.toString()),Z=I.imageManager.getPattern(g.to.toString()),q=I.imageManager.getPixelSize(),J=q.width,K=q.height,tt=Math.pow(2,k.tileID.overscaledZ),G=k.tileSize*Math.pow(2,I.transform.tileZoom)/tt,Q=G*(k.tileID.canonical.x+k.tileID.wrap*tt),ot=G*k.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:U.tl,u_pattern_br_a:U.br,u_pattern_tl_b:Z.tl,u_pattern_br_b:Z.br,u_texsize:[J,K],u_mix:w.t,u_pattern_size_a:U.displaySize,u_pattern_size_b:Z.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/He(k,1,I.transform.tileZoom),u_pixel_coord_upper:[Q>>16,ot>>16],u_pixel_coord_lower:[65535&Q,65535&ot]}}(l,y,o,f),{u_matrix:n,u_opacity:a})},sl={fillExtrusion:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_lightpos:new u.Uniform3f(n,a.u_lightpos),u_lightintensity:new u.Uniform1f(n,a.u_lightintensity),u_lightcolor:new u.Uniform3f(n,a.u_lightcolor),u_vertical_gradient:new u.Uniform1f(n,a.u_vertical_gradient),u_opacity:new u.Uniform1f(n,a.u_opacity)}},fillExtrusionPattern:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_lightpos:new u.Uniform3f(n,a.u_lightpos),u_lightintensity:new u.Uniform1f(n,a.u_lightintensity),u_lightcolor:new u.Uniform3f(n,a.u_lightcolor),u_vertical_gradient:new u.Uniform1f(n,a.u_vertical_gradient),u_height_factor:new u.Uniform1f(n,a.u_height_factor),u_image:new u.Uniform1i(n,a.u_image),u_texsize:new u.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new u.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new u.Uniform3f(n,a.u_scale),u_fade:new u.Uniform1f(n,a.u_fade),u_opacity:new u.Uniform1f(n,a.u_opacity)}},fill:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix)}},fillPattern:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_image:new u.Uniform1i(n,a.u_image),u_texsize:new u.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new u.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new u.Uniform3f(n,a.u_scale),u_fade:new u.Uniform1f(n,a.u_fade)}},fillOutline:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_world:new u.Uniform2f(n,a.u_world)}},fillOutlinePattern:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_world:new u.Uniform2f(n,a.u_world),u_image:new u.Uniform1i(n,a.u_image),u_texsize:new u.Uniform2f(n,a.u_texsize),u_pixel_coord_upper:new u.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(n,a.u_pixel_coord_lower),u_scale:new u.Uniform3f(n,a.u_scale),u_fade:new u.Uniform1f(n,a.u_fade)}},circle:function(n,a){return{u_camera_to_center_distance:new u.Uniform1f(n,a.u_camera_to_center_distance),u_scale_with_map:new u.Uniform1i(n,a.u_scale_with_map),u_pitch_with_map:new u.Uniform1i(n,a.u_pitch_with_map),u_extrude_scale:new u.Uniform2f(n,a.u_extrude_scale),u_device_pixel_ratio:new u.Uniform1f(n,a.u_device_pixel_ratio),u_matrix:new u.UniformMatrix4f(n,a.u_matrix)}},collisionBox:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_camera_to_center_distance:new u.Uniform1f(n,a.u_camera_to_center_distance),u_pixels_to_tile_units:new u.Uniform1f(n,a.u_pixels_to_tile_units),u_extrude_scale:new u.Uniform2f(n,a.u_extrude_scale),u_overscale_factor:new u.Uniform1f(n,a.u_overscale_factor)}},collisionCircle:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_inv_matrix:new u.UniformMatrix4f(n,a.u_inv_matrix),u_camera_to_center_distance:new u.Uniform1f(n,a.u_camera_to_center_distance),u_viewport_size:new u.Uniform2f(n,a.u_viewport_size)}},debug:function(n,a){return{u_color:new u.UniformColor(n,a.u_color),u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_overlay:new u.Uniform1i(n,a.u_overlay),u_overlay_scale:new u.Uniform1f(n,a.u_overlay_scale)}},clippingMask:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix)}},heatmap:function(n,a){return{u_extrude_scale:new u.Uniform1f(n,a.u_extrude_scale),u_intensity:new u.Uniform1f(n,a.u_intensity),u_matrix:new u.UniformMatrix4f(n,a.u_matrix)}},heatmapTexture:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_world:new u.Uniform2f(n,a.u_world),u_image:new u.Uniform1i(n,a.u_image),u_color_ramp:new u.Uniform1i(n,a.u_color_ramp),u_opacity:new u.Uniform1f(n,a.u_opacity)}},hillshade:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_image:new u.Uniform1i(n,a.u_image),u_latrange:new u.Uniform2f(n,a.u_latrange),u_light:new u.Uniform2f(n,a.u_light),u_shadow:new u.UniformColor(n,a.u_shadow),u_highlight:new u.UniformColor(n,a.u_highlight),u_accent:new u.UniformColor(n,a.u_accent)}},hillshadePrepare:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_image:new u.Uniform1i(n,a.u_image),u_dimension:new u.Uniform2f(n,a.u_dimension),u_zoom:new u.Uniform1f(n,a.u_zoom),u_unpack:new u.Uniform4f(n,a.u_unpack)}},line:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_ratio:new u.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new u.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(n,a.u_units_to_pixels)}},lineGradient:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_ratio:new u.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new u.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(n,a.u_units_to_pixels),u_image:new u.Uniform1i(n,a.u_image),u_image_height:new u.Uniform1f(n,a.u_image_height)}},linePattern:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_texsize:new u.Uniform2f(n,a.u_texsize),u_ratio:new u.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new u.Uniform1f(n,a.u_device_pixel_ratio),u_image:new u.Uniform1i(n,a.u_image),u_units_to_pixels:new u.Uniform2f(n,a.u_units_to_pixels),u_scale:new u.Uniform3f(n,a.u_scale),u_fade:new u.Uniform1f(n,a.u_fade)}},lineSDF:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_ratio:new u.Uniform1f(n,a.u_ratio),u_device_pixel_ratio:new u.Uniform1f(n,a.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(n,a.u_units_to_pixels),u_patternscale_a:new u.Uniform2f(n,a.u_patternscale_a),u_patternscale_b:new u.Uniform2f(n,a.u_patternscale_b),u_sdfgamma:new u.Uniform1f(n,a.u_sdfgamma),u_image:new u.Uniform1i(n,a.u_image),u_tex_y_a:new u.Uniform1f(n,a.u_tex_y_a),u_tex_y_b:new u.Uniform1f(n,a.u_tex_y_b),u_mix:new u.Uniform1f(n,a.u_mix)}},raster:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_tl_parent:new u.Uniform2f(n,a.u_tl_parent),u_scale_parent:new u.Uniform1f(n,a.u_scale_parent),u_buffer_scale:new u.Uniform1f(n,a.u_buffer_scale),u_fade_t:new u.Uniform1f(n,a.u_fade_t),u_opacity:new u.Uniform1f(n,a.u_opacity),u_image0:new u.Uniform1i(n,a.u_image0),u_image1:new u.Uniform1i(n,a.u_image1),u_brightness_low:new u.Uniform1f(n,a.u_brightness_low),u_brightness_high:new u.Uniform1f(n,a.u_brightness_high),u_saturation_factor:new u.Uniform1f(n,a.u_saturation_factor),u_contrast_factor:new u.Uniform1f(n,a.u_contrast_factor),u_spin_weights:new u.Uniform3f(n,a.u_spin_weights)}},symbolIcon:function(n,a){return{u_is_size_zoom_constant:new u.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new u.Uniform1f(n,a.u_size_t),u_size:new u.Uniform1f(n,a.u_size),u_camera_to_center_distance:new u.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new u.Uniform1f(n,a.u_pitch),u_rotate_symbol:new u.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new u.Uniform1f(n,a.u_fade_change),u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new u.Uniform1i(n,a.u_is_text),u_pitch_with_map:new u.Uniform1i(n,a.u_pitch_with_map),u_texsize:new u.Uniform2f(n,a.u_texsize),u_texture:new u.Uniform1i(n,a.u_texture)}},symbolSDF:function(n,a){return{u_is_size_zoom_constant:new u.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new u.Uniform1f(n,a.u_size_t),u_size:new u.Uniform1f(n,a.u_size),u_camera_to_center_distance:new u.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new u.Uniform1f(n,a.u_pitch),u_rotate_symbol:new u.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new u.Uniform1f(n,a.u_fade_change),u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new u.Uniform1i(n,a.u_is_text),u_pitch_with_map:new u.Uniform1i(n,a.u_pitch_with_map),u_texsize:new u.Uniform2f(n,a.u_texsize),u_texture:new u.Uniform1i(n,a.u_texture),u_gamma_scale:new u.Uniform1f(n,a.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(n,a.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(n,a.u_is_halo)}},symbolTextAndIcon:function(n,a){return{u_is_size_zoom_constant:new u.Uniform1i(n,a.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(n,a.u_is_size_feature_constant),u_size_t:new u.Uniform1f(n,a.u_size_t),u_size:new u.Uniform1f(n,a.u_size),u_camera_to_center_distance:new u.Uniform1f(n,a.u_camera_to_center_distance),u_pitch:new u.Uniform1f(n,a.u_pitch),u_rotate_symbol:new u.Uniform1i(n,a.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(n,a.u_aspect_ratio),u_fade_change:new u.Uniform1f(n,a.u_fade_change),u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(n,a.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(n,a.u_coord_matrix),u_is_text:new u.Uniform1i(n,a.u_is_text),u_pitch_with_map:new u.Uniform1i(n,a.u_pitch_with_map),u_texsize:new u.Uniform2f(n,a.u_texsize),u_texsize_icon:new u.Uniform2f(n,a.u_texsize_icon),u_texture:new u.Uniform1i(n,a.u_texture),u_texture_icon:new u.Uniform1i(n,a.u_texture_icon),u_gamma_scale:new u.Uniform1f(n,a.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(n,a.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(n,a.u_is_halo)}},background:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_opacity:new u.Uniform1f(n,a.u_opacity),u_color:new u.UniformColor(n,a.u_color)}},backgroundPattern:function(n,a){return{u_matrix:new u.UniformMatrix4f(n,a.u_matrix),u_opacity:new u.Uniform1f(n,a.u_opacity),u_image:new u.Uniform1i(n,a.u_image),u_pattern_tl_a:new u.Uniform2f(n,a.u_pattern_tl_a),u_pattern_br_a:new u.Uniform2f(n,a.u_pattern_br_a),u_pattern_tl_b:new u.Uniform2f(n,a.u_pattern_tl_b),u_pattern_br_b:new u.Uniform2f(n,a.u_pattern_br_b),u_texsize:new u.Uniform2f(n,a.u_texsize),u_mix:new u.Uniform1f(n,a.u_mix),u_pattern_size_a:new u.Uniform2f(n,a.u_pattern_size_a),u_pattern_size_b:new u.Uniform2f(n,a.u_pattern_size_b),u_scale_a:new u.Uniform1f(n,a.u_scale_a),u_scale_b:new u.Uniform1f(n,a.u_scale_b),u_pixel_coord_upper:new u.Uniform2f(n,a.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(n,a.u_pixel_coord_lower),u_tile_units_to_pixels:new u.Uniform1f(n,a.u_tile_units_to_pixels)}}};function fo(n,a,o,l,f,y,g){for(var w=n.context,I=w.gl,k=n.useProgram("collisionBox"),U=[],Z=0,q=0,J=0;J<l.length;J++){var K=l[J],tt=a.getTile(K),G=tt.getBucket(o);if(G){var Q=K.posMatrix;f[0]===0&&f[1]===0||(Q=n.translatePosMatrix(K.posMatrix,tt,f,y));var ot=g?G.textCollisionBox:G.iconCollisionBox,ht=G.collisionCircleArray;if(ht.length>0){var _t=u.create(),dt=Q;u.mul(_t,G.placementInvProjMatrix,n.transform.glCoordMatrix),u.mul(_t,_t,G.placementViewportMatrix),U.push({circleArray:ht,circleOffset:q,transform:dt,invTransform:_t}),q=Z+=ht.length/4}ot&&k.draw(w,I.LINES,j.disabled,W.disabled,n.colorModeForRenderPass(),at.disabled,Zn(Q,n.transform,tt),o.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,null,n.transform.zoom,null,null,ot.collisionVertexBuffer)}}if(g&&U.length){var vt=n.useProgram("collisionCircle"),Pt=new u.StructArrayLayout2f1f2i16;Pt.resize(4*Z),Pt._trim();for(var kt=0,zt=0,Zt=U;zt<Zt.length;zt+=1)for(var te=Zt[zt],oe=0;oe<te.circleArray.length/4;oe++){var ne=4*oe,Me=te.circleArray[ne+0],Gt=te.circleArray[ne+1],pe=te.circleArray[ne+2],ve=te.circleArray[ne+3];Pt.emplace(kt++,Me,Gt,pe,ve,0),Pt.emplace(kt++,Me,Gt,pe,ve,1),Pt.emplace(kt++,Me,Gt,pe,ve,2),Pt.emplace(kt++,Me,Gt,pe,ve,3)}(!co||co.length<2*Z)&&(co=function(Ci){var kr=2*Ci,pr=new u.StructArrayLayout3ui6;pr.resize(kr),pr._trim();for(var Pi=0;Pi<kr;Pi++){var Mi=6*Pi;pr.uint16[Mi+0]=4*Pi+0,pr.uint16[Mi+1]=4*Pi+1,pr.uint16[Mi+2]=4*Pi+2,pr.uint16[Mi+3]=4*Pi+2,pr.uint16[Mi+4]=4*Pi+3,pr.uint16[Mi+5]=4*Pi+0}return pr}(Z));for(var ce=w.createIndexBuffer(co,!0),he=w.createVertexBuffer(Pt,u.collisionCircleLayout.members,!0),ye=0,ue=U;ye<ue.length;ye+=1){var ae=ue[ye],rr=Ja(ae.transform,ae.invTransform,n.transform);vt.draw(w,I.TRIANGLES,j.disabled,W.disabled,n.colorModeForRenderPass(),at.disabled,rr,o.id,he,ce,u.SegmentVector.simpleSegment(0,2*ae.circleOffset,ae.circleArray.length,ae.circleArray.length/2),null,n.transform.zoom,null,null,null)}he.destroy(),ce.destroy()}}var vn=u.identity(new Float32Array(16));function zn(n,a,o,l,f,y){var g=u.getAnchorAlignment(n),w=-(g.horizontalAlign-.5)*a,I=-(g.verticalAlign-.5)*o,k=u.evaluateVariableOffset(n,l);return new u.Point((w/f+k[0])*y,(I/f+k[1])*y)}function ll(n,a,o,l,f,y,g,w,I,k,U){var Z=n.text.placedSymbolArray,q=n.text.dynamicLayoutVertexArray,J=n.icon.dynamicLayoutVertexArray,K={};q.clear();for(var tt=0;tt<Z.length;tt++){var G=Z.get(tt),Q=G.hidden||!G.crossTileID||n.allowVerticalPlacement&&!G.placedOrientation?null:l[G.crossTileID];if(Q){var ot=new u.Point(G.anchorX,G.anchorY),ht=Yt(ot,o?w:g),_t=se(y.cameraToCenterDistance,ht.signedDistanceFromCamera),dt=f.evaluateSizeForFeature(n.textSizeData,k,G)*_t/u.ONE_EM;o&&(dt*=n.tilePixelRatio/I);for(var vt=zn(Q.anchor,Q.width,Q.height,Q.textOffset,Q.textBoxScale,dt),Pt=o?Yt(ot.add(vt),g).point:ht.point.add(a?vt.rotate(-y.angle):vt),kt=n.allowVerticalPlacement&&G.placedOrientation===u.WritingMode.vertical?Math.PI/2:0,zt=0;zt<G.numGlyphs;zt++)u.addDynamicAttributes(q,Pt,kt);U&&G.associatedIconIndex>=0&&(K[G.associatedIconIndex]={shiftedAnchor:Pt,angle:kt})}else ai(G.numGlyphs,q)}if(U){J.clear();for(var Zt=n.icon.placedSymbolArray,te=0;te<Zt.length;te++){var oe=Zt.get(te);if(oe.hidden)ai(oe.numGlyphs,J);else{var ne=K[te];if(ne)for(var Me=0;Me<oe.numGlyphs;Me++)u.addDynamicAttributes(J,ne.shiftedAnchor,ne.angle);else ai(oe.numGlyphs,J)}}n.icon.dynamicLayoutVertexBuffer.updateData(J)}n.text.dynamicLayoutVertexBuffer.updateData(q)}function ko(n,a,o){return o.iconsInText&&a?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function Mo(n,a,o,l,f,y,g,w,I,k,U,Z){for(var q=n.context,J=q.gl,K=n.transform,tt=w==="map",G=I==="map",Q=tt&&o.layout.get("symbol-placement")!=="point",ot=tt&&!G&&!Q,ht=o.layout.get("symbol-sort-key").constantOr(1)!==void 0,_t=!1,dt=n.depthModeForSublayer(0,j.ReadOnly),vt=o.layout.get("text-variable-anchor"),Pt=[],kt=0,zt=l;kt<zt.length;kt+=1){var Zt=zt[kt],te=a.getTile(Zt),oe=te.getBucket(o);if(oe){var ne=f?oe.text:oe.icon;if(ne&&ne.segments.get().length){var Me=ne.programConfigurations.get(o.id),Gt=f||oe.sdfIcons,pe=f?oe.textSizeData:oe.iconSizeData,ve=G||K.pitch!==0,ce=n.useProgram(ko(Gt,f,oe),Me),he=u.evaluateSizeForZoom(pe,K.zoom),ye=void 0,ue=[0,0],ae=void 0,rr=void 0,Ci=null,kr=void 0;if(f)ae=te.glyphAtlasTexture,rr=J.LINEAR,ye=te.glyphAtlasTexture.size,oe.iconsInText&&(ue=te.imageAtlasTexture.size,Ci=te.imageAtlasTexture,kr=ve||n.options.rotating||n.options.zooming||pe.kind==="composite"||pe.kind==="camera"?J.LINEAR:J.NEAREST);else{var pr=o.layout.get("icon-size").constantOr(0)!==1||oe.iconsNeedLinear;ae=te.imageAtlasTexture,rr=Gt||n.options.rotating||n.options.zooming||pr||ve?J.LINEAR:J.NEAREST,ye=te.imageAtlasTexture.size}var Pi=He(te,1,n.transform.zoom),Mi=xi(Zt.posMatrix,G,tt,n.transform,Pi),mn=Oe(Zt.posMatrix,G,tt,n.transform,Pi),Zr=vt&&oe.hasTextData(),ca=o.layout.get("icon-text-fit")!=="none"&&Zr&&oe.hasIconData();Q&&An(oe,Zt.posMatrix,n,f,Mi,mn,G,k);var en=n.translatePosMatrix(Zt.posMatrix,te,y,g),Wn=Q||f&&vt||ca?vn:Mi,Mn=n.translatePosMatrix(mn,te,y,g,!0),Us=Gt&&o.paint.get(f?"text-halo-width":"icon-halo-width").constantOr(1)!==0,ps={program:ce,buffers:ne,uniformValues:Gt?oe.iconsInText?Ya(pe.kind,he,ot,G,n,en,Wn,Mn,ye,ue):po(pe.kind,he,ot,G,n,en,Wn,Mn,f,ye,!0):zo(pe.kind,he,ot,G,n,en,Wn,Mn,f,ye),atlasTexture:ae,atlasTextureIcon:Ci,atlasInterpolation:rr,atlasInterpolationIcon:kr,isSDF:Gt,hasHalo:Us};if(ht&&oe.canOverlap){_t=!0;for(var pa=0,fs=ne.segments.get();pa<fs.length;pa+=1){var Ns=fs[pa];Pt.push({segments:new u.SegmentVector([Ns]),sortKey:Ns.sortKey,state:ps})}}else Pt.push({segments:ne.segments,sortKey:0,state:ps})}}}_t&&Pt.sort(function(fa,Ba){return fa.sortKey-Ba.sortKey});for(var go=0,Zs=Pt;go<Zs.length;go+=1){var vo=Zs[go],nr=vo.state;if(q.activeTexture.set(J.TEXTURE0),nr.atlasTexture.bind(nr.atlasInterpolation,J.CLAMP_TO_EDGE),nr.atlasTextureIcon&&(q.activeTexture.set(J.TEXTURE1),nr.atlasTextureIcon&&nr.atlasTextureIcon.bind(nr.atlasInterpolationIcon,J.CLAMP_TO_EDGE)),nr.isSDF){var Uo=nr.uniformValues;nr.hasHalo&&(Uo.u_is_halo=1,Yr(nr.buffers,vo.segments,o,n,nr.program,dt,U,Z,Uo)),Uo.u_is_halo=0}Yr(nr.buffers,vo.segments,o,n,nr.program,dt,U,Z,nr.uniformValues)}}function Yr(n,a,o,l,f,y,g,w,I){var k=l.context;f.draw(k,k.gl.TRIANGLES,y,g,w,at.disabled,I,o.id,n.layoutVertexBuffer,n.indexBuffer,a,o.paint,l.transform.zoom,n.programConfigurations.get(o.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function Ko(n,a,o,l,f,y,g){var w,I,k,U,Z,q=n.context.gl,J=o.paint.get("fill-pattern"),K=J&&J.constantOr(1),tt=o.getCrossfadeParameters();g?(I=K&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",w=q.LINES):(I=K?"fillPattern":"fill",w=q.TRIANGLES);for(var G=0,Q=l;G<Q.length;G+=1){var ot=Q[G],ht=a.getTile(ot);if(!K||ht.patternsLoaded()){var _t=ht.getBucket(o);if(_t){var dt=_t.programConfigurations.get(o.id),vt=n.useProgram(I,dt);K&&(n.context.activeTexture.set(q.TEXTURE0),ht.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),dt.updatePaintBuffers(tt));var Pt=J.constantOr(null);if(Pt&&ht.imageAtlas){var kt=ht.imageAtlas,zt=kt.patternPositions[Pt.to.toString()],Zt=kt.patternPositions[Pt.from.toString()];zt&&Zt&&dt.setConstantPatternPositions(zt,Zt)}var te=n.translatePosMatrix(ot.posMatrix,ht,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(g){U=_t.indexBuffer2,Z=_t.segments2;var oe=[q.drawingBufferWidth,q.drawingBufferHeight];k=I==="fillOutlinePattern"&&K?Ls(te,n,tt,ht,oe):nl(te,oe)}else U=_t.indexBuffer,Z=_t.segments,k=K?ho(te,n,tt,ht):wr(te);vt.draw(n.context,w,f,n.stencilModeForClipping(ot),y,at.disabled,k,o.id,_t.layoutVertexBuffer,U,Z,o.paint,n.transform.zoom,dt)}}}}function $a(n,a,o,l,f,y,g){for(var w=n.context,I=w.gl,k=o.paint.get("fill-extrusion-pattern"),U=k.constantOr(1),Z=o.getCrossfadeParameters(),q=o.paint.get("fill-extrusion-opacity"),J=0,K=l;J<K.length;J+=1){var tt=K[J],G=a.getTile(tt),Q=G.getBucket(o);if(Q){var ot=Q.programConfigurations.get(o.id),ht=n.useProgram(U?"fillExtrusionPattern":"fillExtrusion",ot);U&&(n.context.activeTexture.set(I.TEXTURE0),G.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),ot.updatePaintBuffers(Z));var _t=k.constantOr(null);if(_t&&G.imageAtlas){var dt=G.imageAtlas,vt=dt.patternPositions[_t.to.toString()],Pt=dt.patternPositions[_t.from.toString()];vt&&Pt&&ot.setConstantPatternPositions(vt,Pt)}var kt=n.translatePosMatrix(tt.posMatrix,G,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),zt=o.paint.get("fill-extrusion-vertical-gradient"),Zt=U?yn(kt,n,zt,q,tt,Z,G):rl(kt,n,zt,q);ht.draw(w,w.gl.TRIANGLES,f,y,g,at.backCCW,Zt,o.id,Q.layoutVertexBuffer,Q.indexBuffer,Q.segments,o.paint,n.transform.zoom,ot)}}}function Jo(n,a,o,l,f,y){var g=n.context,w=g.gl,I=a.fbo;if(I){var k=n.useProgram("hillshade");g.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,I.colorAttachment.get());var U=function(Z,q,J){var K=J.paint.get("hillshade-shadow-color"),tt=J.paint.get("hillshade-highlight-color"),G=J.paint.get("hillshade-accent-color"),Q=J.paint.get("hillshade-illumination-direction")*(Math.PI/180);J.paint.get("hillshade-illumination-anchor")==="viewport"&&(Q-=Z.transform.angle);var ot,ht,_t,dt=!Z.options.moving;return{u_matrix:Z.transform.calculatePosMatrix(q.tileID.toUnwrapped(),dt),u_image:0,u_latrange:(ot=q.tileID,ht=Math.pow(2,ot.canonical.z),_t=ot.canonical.y,[new u.MercatorCoordinate(0,_t/ht).toLngLat().lat,new u.MercatorCoordinate(0,(_t+1)/ht).toLngLat().lat]),u_light:[J.paint.get("hillshade-exaggeration"),Q],u_shadow:K,u_highlight:tt,u_accent:G}}(n,a,o);k.draw(g,w.TRIANGLES,l,f,y,at.disabled,U,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function Qa(n,a,o,l,f,y){var g=n.context,w=g.gl,I=a.dem;if(I&&I.data){var k=I.dim,U=I.stride,Z=I.getPixels();if(g.activeTexture.set(w.TEXTURE1),g.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||n.getTileTexture(U),a.demTexture){var q=a.demTexture;q.update(Z,{premultiply:!1}),q.bind(w.NEAREST,w.CLAMP_TO_EDGE)}else a.demTexture=new u.Texture(g,Z,w.RGBA,{premultiply:!1}),a.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);g.activeTexture.set(w.TEXTURE0);var J=a.fbo;if(!J){var K=new u.Texture(g,{width:k,height:k,data:null},w.RGBA);K.bind(w.LINEAR,w.CLAMP_TO_EDGE),(J=a.fbo=g.createFramebuffer(k,k,!0)).colorAttachment.set(K.texture)}g.bindFramebuffer.set(J.framebuffer),g.viewport.set([0,0,k,k]),n.useProgram("hillshadePrepare").draw(g,w.TRIANGLES,l,f,y,at.disabled,function(tt,G){var Q=G.stride,ot=u.create();return u.ortho(ot,0,u.EXTENT,-u.EXTENT,0,0,1),u.translate(ot,ot,[0,-u.EXTENT,0]),{u_matrix:ot,u_image:1,u_dimension:[Q,Q],u_zoom:tt.overscaledZ,u_unpack:G.getUnpackVector()}}(a.tileID,I),o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),a.needsHillshadePrepare=!1}}function Yo(n,a,o,l,f){var y=l.paint.get("raster-fade-duration");if(y>0){var g=u.browser.now(),w=(g-n.timeAdded)/y,I=a?(g-a.timeAdded)/y:-1,k=o.getSource(),U=f.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),Z=!a||Math.abs(a.tileID.overscaledZ-U)>Math.abs(n.tileID.overscaledZ-U),q=Z&&n.refreshedUponExpiration?1:u.clamp(Z?w:1-I,0,1);return n.refreshedUponExpiration&&w>=1&&(n.refreshedUponExpiration=!1),a?{opacity:1,mix:1-q}:{opacity:q,mix:0}}return{opacity:1,mix:0}}var $o=new u.Color(1,0,0,1),Do=new u.Color(0,1,0,1),za=new u.Color(0,0,1,1),Qo=new u.Color(1,0,1,1),ts=new u.Color(0,1,1,1);function Ms(n,a,o,l){ka(n,0,a+o/2,n.transform.width,o,l)}function ta(n,a,o,l){ka(n,a-o/2,0,o,n.transform.height,l)}function ka(n,a,o,l,f,y){var g=n.context,w=g.gl;w.enable(w.SCISSOR_TEST),w.scissor(a*u.browser.devicePixelRatio,o*u.browser.devicePixelRatio,l*u.browser.devicePixelRatio,f*u.browser.devicePixelRatio),g.clear({color:y}),w.disable(w.SCISSOR_TEST)}function Ds(n,a,o){var l=n.context,f=l.gl,y=o.posMatrix,g=n.useProgram("debug"),w=j.disabled,I=W.disabled,k=n.colorModeForRenderPass();l.activeTexture.set(f.TEXTURE0),n.emptyTexture.bind(f.LINEAR,f.CLAMP_TO_EDGE),g.draw(l,f.LINE_STRIP,w,I,k,at.disabled,Co(y,u.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var U=a.getTileByID(o.key).latestRawTileData,Z=Math.floor((U&&U.byteLength||0)/1024),q=a.getTile(o).tileSize,J=512/Math.min(q,512)*(o.overscaledZ/n.transform.zoom)*.5,K=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(K+=" => "+o.overscaledZ),function(tt,G){tt.initDebugOverlayCanvas();var Q=tt.debugOverlayCanvas,ot=tt.context.gl,ht=tt.debugOverlayCanvas.getContext("2d");ht.clearRect(0,0,Q.width,Q.height),ht.shadowColor="white",ht.shadowBlur=2,ht.lineWidth=1.5,ht.strokeStyle="white",ht.textBaseline="top",ht.font="bold 36px Open Sans, sans-serif",ht.fillText(G,5,5),ht.strokeText(G,5,5),tt.debugOverlayTexture.update(Q),tt.debugOverlayTexture.bind(ot.LINEAR,ot.CLAMP_TO_EDGE)}(n,K+" "+Z+"kb"),g.draw(l,f.TRIANGLES,w,I,it.alphaBlended,at.disabled,Co(y,u.Color.transparent,J),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var Bo={symbol:function(n,a,o,l,f){if(n.renderPass==="translucent"){var y=W.disabled,g=n.colorModeForRenderPass();o.layout.get("text-variable-anchor")&&function(w,I,k,U,Z,q,J){for(var K=I.transform,tt=Z==="map",G=q==="map",Q=0,ot=w;Q<ot.length;Q+=1){var ht=ot[Q],_t=U.getTile(ht),dt=_t.getBucket(k);if(dt&&dt.text&&dt.text.segments.get().length){var vt=u.evaluateSizeForZoom(dt.textSizeData,K.zoom),Pt=He(_t,1,I.transform.zoom),kt=xi(ht.posMatrix,G,tt,I.transform,Pt),zt=k.layout.get("icon-text-fit")!=="none"&&dt.hasIconData();if(vt){var Zt=Math.pow(2,K.zoom-_t.tileID.overscaledZ);ll(dt,tt,G,J,u.symbolSize,K,kt,ht.posMatrix,Zt,vt,zt)}}}}(l,n,o,a,o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),f),o.paint.get("icon-opacity").constantOr(1)!==0&&Mo(n,a,o,l,!1,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),o.layout.get("icon-rotation-alignment"),o.layout.get("icon-pitch-alignment"),o.layout.get("icon-keep-upright"),y,g),o.paint.get("text-opacity").constantOr(1)!==0&&Mo(n,a,o,l,!0,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),o.layout.get("text-rotation-alignment"),o.layout.get("text-pitch-alignment"),o.layout.get("text-keep-upright"),y,g),a.map.showCollisionBoxes&&(fo(n,a,o,l,o.paint.get("text-translate"),o.paint.get("text-translate-anchor"),!0),fo(n,a,o,l,o.paint.get("icon-translate"),o.paint.get("icon-translate-anchor"),!1))}},circle:function(n,a,o,l){if(n.renderPass==="translucent"){var f=o.paint.get("circle-opacity"),y=o.paint.get("circle-stroke-width"),g=o.paint.get("circle-stroke-opacity"),w=o.layout.get("circle-sort-key").constantOr(1)!==void 0;if(f.constantOr(1)!==0||y.constantOr(1)!==0&&g.constantOr(1)!==0){for(var I=n.context,k=I.gl,U=n.depthModeForSublayer(0,j.ReadOnly),Z=W.disabled,q=n.colorModeForRenderPass(),J=[],K=0;K<l.length;K++){var tt=l[K],G=a.getTile(tt),Q=G.getBucket(o);if(Q){var ot=Q.programConfigurations.get(o.id),ht={programConfiguration:ot,program:n.useProgram("circle",ot),layoutVertexBuffer:Q.layoutVertexBuffer,indexBuffer:Q.indexBuffer,uniformValues:zs(n,tt,G,o)};if(w)for(var _t=0,dt=Q.segments.get();_t<dt.length;_t+=1){var vt=dt[_t];J.push({segments:new u.SegmentVector([vt]),sortKey:vt.sortKey,state:ht})}else J.push({segments:Q.segments,sortKey:0,state:ht})}}w&&J.sort(function(te,oe){return te.sortKey-oe.sortKey});for(var Pt=0,kt=J;Pt<kt.length;Pt+=1){var zt=kt[Pt],Zt=zt.state;Zt.program.draw(I,k.TRIANGLES,U,Z,q,at.disabled,Zt.uniformValues,o.id,Zt.layoutVertexBuffer,Zt.indexBuffer,zt.segments,o.paint,n.transform.zoom,Zt.programConfiguration)}}}},heatmap:function(n,a,o,l){if(o.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var f=n.context,y=f.gl,g=W.disabled,w=new it([y.ONE,y.ONE],u.Color.transparent,[!0,!0,!0,!0]);(function(J,K,tt){var G=J.gl;J.activeTexture.set(G.TEXTURE1),J.viewport.set([0,0,K.width/4,K.height/4]);var Q=tt.heatmapFbo;if(Q)G.bindTexture(G.TEXTURE_2D,Q.colorAttachment.get()),J.bindFramebuffer.set(Q.framebuffer);else{var ot=G.createTexture();G.bindTexture(G.TEXTURE_2D,ot),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MAG_FILTER,G.LINEAR),Q=tt.heatmapFbo=J.createFramebuffer(K.width/4,K.height/4,!1),function(ht,_t,dt,vt){var Pt=ht.gl;Pt.texImage2D(Pt.TEXTURE_2D,0,Pt.RGBA,_t.width/4,_t.height/4,0,Pt.RGBA,ht.extRenderToTextureHalfFloat?ht.extTextureHalfFloat.HALF_FLOAT_OES:Pt.UNSIGNED_BYTE,null),vt.colorAttachment.set(dt)}(J,K,ot,Q)}})(f,n,o),f.clear({color:u.Color.transparent});for(var I=0;I<l.length;I++){var k=l[I];if(!a.hasRenderableParent(k)){var U=a.getTile(k),Z=U.getBucket(o);if(Z){var q=Z.programConfigurations.get(o.id);n.useProgram("heatmap",q).draw(f,y.TRIANGLES,j.disabled,g,w,at.disabled,ks(k.posMatrix,U,n.transform.zoom,o.paint.get("heatmap-intensity")),o.id,Z.layoutVertexBuffer,Z.indexBuffer,Z.segments,o.paint,n.transform.zoom,q)}}}f.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(J,K){var tt=J.context,G=tt.gl,Q=K.heatmapFbo;if(Q){tt.activeTexture.set(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,Q.colorAttachment.get()),tt.activeTexture.set(G.TEXTURE1);var ot=K.colorRampTexture;ot||(ot=K.colorRampTexture=new u.Texture(tt,K.colorRamp,G.RGBA)),ot.bind(G.LINEAR,G.CLAMP_TO_EDGE),J.useProgram("heatmapTexture").draw(tt,G.TRIANGLES,j.disabled,W.disabled,J.colorModeForRenderPass(),at.disabled,function(ht,_t,dt,vt){var Pt=u.create();u.ortho(Pt,0,ht.width,ht.height,0,0,1);var kt=ht.context.gl;return{u_matrix:Pt,u_world:[kt.drawingBufferWidth,kt.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:_t.paint.get("heatmap-opacity")}}(J,K),K.id,J.viewportBuffer,J.quadTriangleIndexBuffer,J.viewportSegments,K.paint,J.transform.zoom)}}(n,o))},line:function(n,a,o,l){if(n.renderPass==="translucent"){var f=o.paint.get("line-opacity"),y=o.paint.get("line-width");if(f.constantOr(1)!==0&&y.constantOr(1)!==0)for(var g=n.depthModeForSublayer(0,j.ReadOnly),w=n.colorModeForRenderPass(),I=o.paint.get("line-dasharray"),k=o.paint.get("line-pattern"),U=k.constantOr(1),Z=o.paint.get("line-gradient"),q=o.getCrossfadeParameters(),J=U?"linePattern":I?"lineSDF":Z?"lineGradient":"line",K=n.context,tt=K.gl,G=!0,Q=0,ot=l;Q<ot.length;Q+=1){var ht=ot[Q],_t=a.getTile(ht);if(!U||_t.patternsLoaded()){var dt=_t.getBucket(o);if(dt){var vt=dt.programConfigurations.get(o.id),Pt=n.context.program.get(),kt=n.useProgram(J,vt),zt=G||kt.program!==Pt,Zt=k.constantOr(null);if(Zt&&_t.imageAtlas){var te=_t.imageAtlas,oe=te.patternPositions[Zt.to.toString()],ne=te.patternPositions[Zt.from.toString()];oe&&ne&&vt.setConstantPatternPositions(oe,ne)}var Me=U?Vn(n,_t,o,q):I?ql(n,_t,o,I,q):Z?Le(n,_t,o,dt.lineClipsArray.length):La(n,_t,o);if(U)K.activeTexture.set(tt.TEXTURE0),_t.imageAtlasTexture.bind(tt.LINEAR,tt.CLAMP_TO_EDGE),vt.updatePaintBuffers(q);else if(I&&(zt||n.lineAtlas.dirty))K.activeTexture.set(tt.TEXTURE0),n.lineAtlas.bind(K);else if(Z){var Gt=dt.gradients[o.id],pe=Gt.texture;if(o.gradientVersion!==Gt.version){var ve=256;if(o.stepInterpolant){var ce=a.getSource().maxzoom,he=ht.canonical.z===ce?Math.ceil(1<<n.transform.maxZoom-ht.canonical.z):1;ve=u.clamp(u.nextPowerOfTwo(dt.maxLineLength/u.EXTENT*1024*he),256,K.maxTextureSize)}Gt.gradient=u.renderColorRamp({expression:o.gradientExpression(),evaluationKey:"lineProgress",resolution:ve,image:Gt.gradient||void 0,clips:dt.lineClipsArray}),Gt.texture?Gt.texture.update(Gt.gradient):Gt.texture=new u.Texture(K,Gt.gradient,tt.RGBA),Gt.version=o.gradientVersion,pe=Gt.texture}K.activeTexture.set(tt.TEXTURE0),pe.bind(o.stepInterpolant?tt.NEAREST:tt.LINEAR,tt.CLAMP_TO_EDGE)}kt.draw(K,tt.TRIANGLES,g,n.stencilModeForClipping(ht),w,at.disabled,Me,o.id,dt.layoutVertexBuffer,dt.indexBuffer,dt.segments,o.paint,n.transform.zoom,vt,dt.layoutVertexBuffer2),G=!1}}}}},fill:function(n,a,o,l){var f=o.paint.get("fill-color"),y=o.paint.get("fill-opacity");if(y.constantOr(1)!==0){var g=n.colorModeForRenderPass(),w=o.paint.get("fill-pattern"),I=n.opaquePassEnabledForLayer()&&!w.constantOr(1)&&f.constantOr(u.Color.transparent).a===1&&y.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===I){var k=n.depthModeForSublayer(1,n.renderPass==="opaque"?j.ReadWrite:j.ReadOnly);Ko(n,a,o,l,k,g,!1)}if(n.renderPass==="translucent"&&o.paint.get("fill-antialias")){var U=n.depthModeForSublayer(o.getPaintProperty("fill-outline-color")?2:0,j.ReadOnly);Ko(n,a,o,l,U,g,!0)}}},"fill-extrusion":function(n,a,o,l){var f=o.paint.get("fill-extrusion-opacity");if(f!==0&&n.renderPass==="translucent"){var y=new j(n.context.gl.LEQUAL,j.ReadWrite,n.depthRangeFor3D);if(f!==1||o.paint.get("fill-extrusion-pattern").constantOr(1))$a(n,a,o,l,y,W.disabled,it.disabled),$a(n,a,o,l,y,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var g=n.colorModeForRenderPass();$a(n,a,o,l,y,W.disabled,g)}}},hillshade:function(n,a,o,l){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var f=n.context,y=n.depthModeForSublayer(0,j.ReadOnly),g=n.colorModeForRenderPass(),w=n.renderPass==="translucent"?n.stencilConfigForOverlap(l):[{},l],I=w[0],k=0,U=w[1];k<U.length;k+=1){var Z=U[k],q=a.getTile(Z);q.needsHillshadePrepare&&n.renderPass==="offscreen"?Qa(n,q,o,y,W.disabled,g):n.renderPass==="translucent"&&Jo(n,q,o,y,I[Z.overscaledZ],g)}f.viewport.set([0,0,n.width,n.height])}},raster:function(n,a,o,l){if(n.renderPass==="translucent"&&o.paint.get("raster-opacity")!==0&&l.length)for(var f=n.context,y=f.gl,g=a.getSource(),w=n.useProgram("raster"),I=n.colorModeForRenderPass(),k=g instanceof Oi?[{},l]:n.stencilConfigForOverlap(l),U=k[0],Z=k[1],q=Z[Z.length-1].overscaledZ,J=!n.options.moving,K=0,tt=Z;K<tt.length;K+=1){var G=tt[K],Q=n.depthModeForSublayer(G.overscaledZ-q,o.paint.get("raster-opacity")===1?j.ReadWrite:j.ReadOnly,y.LESS),ot=a.getTile(G),ht=n.transform.calculatePosMatrix(G.toUnwrapped(),J);ot.registerFadeDuration(o.paint.get("raster-fade-duration"));var _t=a.findLoadedParent(G,0),dt=Yo(ot,_t,a,o,n.transform),vt=void 0,Pt=void 0,kt=o.paint.get("raster-resampling")==="nearest"?y.NEAREST:y.LINEAR;f.activeTexture.set(y.TEXTURE0),ot.texture.bind(kt,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST),f.activeTexture.set(y.TEXTURE1),_t?(_t.texture.bind(kt,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST),vt=Math.pow(2,_t.tileID.overscaledZ-ot.tileID.overscaledZ),Pt=[ot.tileID.canonical.x*vt%1,ot.tileID.canonical.y*vt%1]):ot.texture.bind(kt,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST);var zt=Xo(ht,Pt||[0,0],vt||1,dt,o);g instanceof Oi?w.draw(f,y.TRIANGLES,Q,W.disabled,I,at.disabled,zt,o.id,g.boundsBuffer,n.quadTriangleIndexBuffer,g.boundsSegments):w.draw(f,y.TRIANGLES,Q,U[G.overscaledZ],I,at.disabled,zt,o.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,a,o){var l=o.paint.get("background-color"),f=o.paint.get("background-opacity");if(f!==0){var y=n.context,g=y.gl,w=n.transform,I=w.tileSize,k=o.paint.get("background-pattern");if(!n.isPatternMissing(k)){var U=!k&&l.a===1&&f===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===U){var Z=W.disabled,q=n.depthModeForSublayer(0,U==="opaque"?j.ReadWrite:j.ReadOnly),J=n.colorModeForRenderPass(),K=n.useProgram(k?"backgroundPattern":"background"),tt=w.coveringTiles({tileSize:I});k&&(y.activeTexture.set(g.TEXTURE0),n.imageManager.bind(n.context));for(var G=o.getCrossfadeParameters(),Q=0,ot=tt;Q<ot.length;Q+=1){var ht=ot[Q],_t=n.transform.calculatePosMatrix(ht.toUnwrapped()),dt=k?qn(_t,f,n,k,{tileID:ht,tileSize:I},G):pn(_t,f,l);K.draw(y,g.TRIANGLES,q,Z,J,at.disabled,dt,o.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,a,o){for(var l=0;l<o.length;l++)Ds(n,a,o[l])},custom:function(n,a,o){var l=n.context,f=o.implementation;if(n.renderPass==="offscreen"){var y=f.prerender;y&&(n.setCustomLayerDefaults(),l.setColorMode(n.colorModeForRenderPass()),y.call(f,l.gl,n.transform.customLayerMatrix()),l.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),l.setColorMode(n.colorModeForRenderPass()),l.setStencilMode(W.disabled);var g=f.renderingMode==="3d"?new j(n.context.gl.LEQUAL,j.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,j.ReadOnly);l.setDepthMode(g),f.render(l.gl,n.transform.customLayerMatrix()),l.setDirty(),n.setBaseState(),l.bindFramebuffer.set(null)}}},ni=function(n,a){this.context=new V(n),this.transform=a,this._tileTextures={},this.setup(),this.numSublayers=Y.maxUnderzooming+Y.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Hi,this.gpuTimers={}};ni.prototype.resize=function(n,a){if(this.width=n*u.browser.devicePixelRatio,this.height=a*u.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var o=0,l=this.style._order;o<l.length;o+=1)this.style._layers[l[o]].resize()},ni.prototype.setup=function(){var n=this.context,a=new u.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(u.EXTENT,0),a.emplaceBack(0,u.EXTENT),a.emplaceBack(u.EXTENT,u.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(a,wi.members),this.tileExtentSegments=u.SegmentVector.simpleSegment(0,0,4,2);var o=new u.StructArrayLayout2i4;o.emplaceBack(0,0),o.emplaceBack(u.EXTENT,0),o.emplaceBack(0,u.EXTENT),o.emplaceBack(u.EXTENT,u.EXTENT),this.debugBuffer=n.createVertexBuffer(o,wi.members),this.debugSegments=u.SegmentVector.simpleSegment(0,0,4,5);var l=new u.StructArrayLayout4i8;l.emplaceBack(0,0,0,0),l.emplaceBack(u.EXTENT,0,u.EXTENT,0),l.emplaceBack(0,u.EXTENT,0,u.EXTENT),l.emplaceBack(u.EXTENT,u.EXTENT,u.EXTENT,u.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(l,We.members),this.rasterBoundsSegments=u.SegmentVector.simpleSegment(0,0,4,2);var f=new u.StructArrayLayout2i4;f.emplaceBack(0,0),f.emplaceBack(1,0),f.emplaceBack(0,1),f.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(f,wi.members),this.viewportSegments=u.SegmentVector.simpleSegment(0,0,4,2);var y=new u.StructArrayLayout1ui2;y.emplaceBack(0),y.emplaceBack(1),y.emplaceBack(3),y.emplaceBack(2),y.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(y);var g=new u.StructArrayLayout3ui6;g.emplaceBack(0,1,2),g.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(g),this.emptyTexture=new u.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var w=this.context.gl;this.stencilClearMode=new W({func:w.ALWAYS,mask:0},0,255,w.ZERO,w.ZERO,w.ZERO)},ni.prototype.clearStencil=function(){var n=this.context,a=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var o=u.create();u.ortho(o,0,this.width,this.height,0,0,1),u.scale(o,o,[a.drawingBufferWidth,a.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,a.TRIANGLES,j.disabled,this.stencilClearMode,it.disabled,at.disabled,Lo(o),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},ni.prototype._renderTileClippingMasks=function(n,a){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&a&&a.length){this.currentStencilSource=n.source;var o=this.context,l=o.gl;this.nextStencilID+a.length>256&&this.clearStencil(),o.setColorMode(it.disabled),o.setDepthMode(j.disabled);var f=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var y=0,g=a;y<g.length;y+=1){var w=g[y],I=this._tileClippingMaskIDs[w.key]=this.nextStencilID++;f.draw(o,l.TRIANGLES,j.disabled,new W({func:l.ALWAYS,mask:0},I,255,l.KEEP,l.KEEP,l.REPLACE),it.disabled,at.disabled,Lo(w.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},ni.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,a=this.context.gl;return new W({func:a.NOTEQUAL,mask:255},n,255,a.KEEP,a.KEEP,a.REPLACE)},ni.prototype.stencilModeForClipping=function(n){var a=this.context.gl;return new W({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,a.KEEP,a.KEEP,a.REPLACE)},ni.prototype.stencilConfigForOverlap=function(n){var a,o=this.context.gl,l=n.sort(function(I,k){return k.overscaledZ-I.overscaledZ}),f=l[l.length-1].overscaledZ,y=l[0].overscaledZ-f+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();for(var g={},w=0;w<y;w++)g[w+f]=new W({func:o.GEQUAL,mask:255},w+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=y,[g,l]}return[(a={},a[f]=W.disabled,a),l]},ni.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new it([n.CONSTANT_COLOR,n.ONE],new u.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?it.unblended:it.alphaBlended},ni.prototype.depthModeForSublayer=function(n,a,o){if(!this.opaquePassEnabledForLayer())return j.disabled;var l=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new j(o||this.context.gl.LEQUAL,a,[l,l])},ni.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},ni.prototype.render=function(n,a){var o=this;this.style=n,this.options=a,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(u.browser.now()),this.imageManager.beginFrame();var l=this.style._order,f=this.style.sourceCaches;for(var y in f){var g=f[y];g.used&&g.prepare(this.context)}var w,I,k={},U={},Z={};for(var q in f){var J=f[q];k[q]=J.getVisibleCoordinates(),U[q]=k[q].slice().reverse(),Z[q]=J.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var K=0;K<l.length;K++)if(this.style._layers[l[K]].is3D()){this.opaquePassCutoff=K;break}this.renderPass="offscreen";for(var tt=0,G=l;tt<G.length;tt+=1){var Q=this.style._layers[G[tt]];if(Q.hasOffscreenPass()&&!Q.isHidden(this.transform.zoom)){var ot=U[Q.source];(Q.type==="custom"||ot.length)&&this.renderLayer(this,f[Q.source],Q,ot)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:a.showOverdrawInspector?u.Color.black:u.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=l.length-1;this.currentLayer>=0;this.currentLayer--){var ht=this.style._layers[l[this.currentLayer]],_t=f[ht.source],dt=k[ht.source];this._renderTileClippingMasks(ht,dt),this.renderLayer(this,_t,ht,dt)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<l.length;this.currentLayer++){var vt=this.style._layers[l[this.currentLayer]],Pt=f[vt.source],kt=(vt.type==="symbol"?Z:U)[vt.source];this._renderTileClippingMasks(vt,k[vt.source]),this.renderLayer(this,Pt,vt,kt)}this.options.showTileBoundaries&&(u.values(this.style._layers).forEach(function(zt){zt.source&&!zt.isHidden(o.transform.zoom)&&(zt.source!==(I&&I.id)&&(I=o.style.sourceCaches[zt.source]),(!w||w.getSource().maxzoom<I.getSource().maxzoom)&&(w=I))}),w&&Bo.debug(this,w,w.getVisibleCoordinates())),this.options.showPadding&&function(zt){var Zt=zt.transform.padding;Ms(zt,zt.transform.height-(Zt.top||0),3,$o),Ms(zt,Zt.bottom||0,3,Do),ta(zt,Zt.left||0,3,za),ta(zt,zt.transform.width-(Zt.right||0),3,Qo);var te=zt.transform.centerPoint;(function(oe,ne,Me,Gt){ka(oe,ne-1,Me-10,2,20,Gt),ka(oe,ne-10,Me-1,20,2,Gt)})(zt,te.x,zt.transform.height-te.y,ts)}(this),this.context.setDefault()},ni.prototype.renderLayer=function(n,a,o,l){o.isHidden(this.transform.zoom)||(o.type==="background"||o.type==="custom"||l.length)&&(this.id=o.id,this.gpuTimingStart(o),Bo[o.type](n,a,o,l,this.style.placement.variableOffsets),this.gpuTimingEnd())},ni.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var a=this.context.extTimerQuery,o=this.gpuTimers[n.id];o||(o=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),o.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,o.query)}},ni.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},ni.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},ni.prototype.queryGpuTimers=function(n){var a={};for(var o in n){var l=n[o],f=this.context.extTimerQuery,y=f.getQueryObjectEXT(l.query,f.QUERY_RESULT_EXT)/1e6;f.deleteQueryEXT(l.query),a[o]=y}return a},ni.prototype.translatePosMatrix=function(n,a,o,l,f){if(!o[0]&&!o[1])return n;var y=f?l==="map"?this.transform.angle:0:l==="viewport"?-this.transform.angle:0;if(y){var g=Math.sin(y),w=Math.cos(y);o=[o[0]*w-o[1]*g,o[0]*g+o[1]*w]}var I=[f?o[0]:He(a,o[0],this.transform.zoom),f?o[1]:He(a,o[1],this.transform.zoom),0],k=new Float32Array(16);return u.translate(k,n,I),k},ni.prototype.saveTileTexture=function(n){var a=this._tileTextures[n.size[0]];a?a.push(n):this._tileTextures[n.size[0]]=[n]},ni.prototype.getTileTexture=function(n){var a=this._tileTextures[n];return a&&a.length>0?a.pop():null},ni.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var a=this.imageManager.getPattern(n.from.toString()),o=this.imageManager.getPattern(n.to.toString());return!a||!o},ni.prototype.useProgram=function(n,a){this.cache=this.cache||{};var o=""+n+(a?a.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[o]||(this.cache[o]=new Ca(this.context,n,Vl[n],a,sl[n],this._showOverdrawInspector)),this.cache[o]},ni.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},ni.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},ni.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=u.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new u.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},ni.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var es=function(n,a){this.points=n,this.planes=a};es.fromInvProjectionMatrix=function(n,a,o){var l=Math.pow(2,o),f=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(g){return u.transformMat4([],g,n)}).map(function(g){return u.scale$1([],g,1/g[3]/a*l)}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(g){var w=u.sub([],f[g[0]],f[g[1]]),I=u.sub([],f[g[2]],f[g[1]]),k=u.normalize([],u.cross([],w,I)),U=-u.dot(k,f[g[1]]);return k.concat(U)});return new es(f,y)};var Cr=function(n,a){this.min=n,this.max=a,this.center=u.scale$2([],u.add([],this.min,this.max),.5)};Cr.prototype.quadrant=function(n){for(var a=[n%2==0,n<2],o=u.clone$2(this.min),l=u.clone$2(this.max),f=0;f<a.length;f++)o[f]=a[f]?this.min[f]:this.center[f],l[f]=a[f]?this.center[f]:this.max[f];return l[2]=this.max[2],new Cr(o,l)},Cr.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},Cr.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},Cr.prototype.intersects=function(n){for(var a=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],o=!0,l=0;l<n.planes.length;l++){for(var f=n.planes[l],y=0,g=0;g<a.length;g++)y+=u.dot$1(f,a[g])>=0;if(y===0)return 0;y!==a.length&&(o=!1)}if(o)return 2;for(var w=0;w<3;w++){for(var I=Number.MAX_VALUE,k=-Number.MAX_VALUE,U=0;U<n.points.length;U++){var Z=n.points[U][w]-this.min[w];I=Math.min(I,Z),k=Math.max(k,Z)}if(k<0||I>this.max[w]-this.min[w])return 0}return 1};var $r=function(n,a,o,l){if(n===void 0&&(n=0),a===void 0&&(a=0),o===void 0&&(o=0),l===void 0&&(l=0),isNaN(n)||n<0||isNaN(a)||a<0||isNaN(o)||o<0||isNaN(l)||l<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=a,this.left=o,this.right=l};$r.prototype.interpolate=function(n,a,o){return a.top!=null&&n.top!=null&&(this.top=u.number(n.top,a.top,o)),a.bottom!=null&&n.bottom!=null&&(this.bottom=u.number(n.bottom,a.bottom,o)),a.left!=null&&n.left!=null&&(this.left=u.number(n.left,a.left,o)),a.right!=null&&n.right!=null&&(this.right=u.number(n.right,a.right,o)),this},$r.prototype.getCenter=function(n,a){var o=u.clamp((this.left+n-this.right)/2,0,n),l=u.clamp((this.top+a-this.bottom)/2,0,a);return new u.Point(o,l)},$r.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},$r.prototype.clone=function(){return new $r(this.top,this.bottom,this.left,this.right)},$r.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var Ee=function(n,a,o,l,f){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=f===void 0||f,this._minZoom=n||0,this._maxZoom=a||22,this._minPitch=o==null?0:o,this._maxPitch=l==null?60:l,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new $r,this._posMatrixCache={},this._alignedPosMatrixCache={}},qe={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};Ee.prototype.clone=function(){var n=new Ee(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},qe.minZoom.get=function(){return this._minZoom},qe.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},qe.maxZoom.get=function(){return this._maxZoom},qe.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},qe.minPitch.get=function(){return this._minPitch},qe.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},qe.maxPitch.get=function(){return this._maxPitch},qe.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},qe.renderWorldCopies.get=function(){return this._renderWorldCopies},qe.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},qe.worldSize.get=function(){return this.tileSize*this.scale},qe.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},qe.size.get=function(){return new u.Point(this.width,this.height)},qe.bearing.get=function(){return-this.angle/Math.PI*180},qe.bearing.set=function(n){var a=-u.wrap(n,-180,180)*Math.PI/180;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=u.create$2(),u.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},qe.pitch.get=function(){return this._pitch/Math.PI*180},qe.pitch.set=function(n){var a=u.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())},qe.fov.get=function(){return this._fov/Math.PI*180},qe.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},qe.zoom.get=function(){return this._zoom},qe.zoom.set=function(n){var a=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom,this._constrain(),this._calcMatrices())},qe.center.get=function(){return this._center},qe.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},qe.padding.get=function(){return this._edgeInsets.toJSON()},qe.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},qe.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},Ee.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},Ee.prototype.interpolatePadding=function(n,a,o){this._unmodified=!1,this._edgeInsets.interpolate(n,a,o),this._constrain(),this._calcMatrices()},Ee.prototype.coveringZoomLevel=function(n){var a=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,a)},Ee.prototype.getVisibleUnwrappedCoordinates=function(n){var a=[new u.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var o=this.pointCoordinate(new u.Point(0,0)),l=this.pointCoordinate(new u.Point(this.width,0)),f=this.pointCoordinate(new u.Point(this.width,this.height)),y=this.pointCoordinate(new u.Point(0,this.height)),g=Math.floor(Math.min(o.x,l.x,f.x,y.x)),w=Math.floor(Math.max(o.x,l.x,f.x,y.x)),I=g-1;I<=w+1;I++)I!==0&&a.push(new u.UnwrappedTileID(I,n));return a},Ee.prototype.coveringTiles=function(n){var a=this.coveringZoomLevel(n),o=a;if(n.minzoom!==void 0&&a<n.minzoom)return[];n.maxzoom!==void 0&&a>n.maxzoom&&(a=n.maxzoom);var l=u.MercatorCoordinate.fromLngLat(this.center),f=Math.pow(2,a),y=[f*l.x,f*l.y,0],g=es.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a),w=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(w=a);var I=function(zt){return{aabb:new Cr([zt*f,0,0],[(zt+1)*f,f,0]),zoom:0,x:0,y:0,wrap:zt,fullyVisible:!1}},k=[],U=[],Z=a,q=n.reparseOverscaled?o:a;if(this._renderWorldCopies)for(var J=1;J<=3;J++)k.push(I(-J)),k.push(I(J));for(k.push(I(0));k.length>0;){var K=k.pop(),tt=K.x,G=K.y,Q=K.fullyVisible;if(!Q){var ot=K.aabb.intersects(g);if(ot===0)continue;Q=ot===2}var ht=K.aabb.distanceX(y),_t=K.aabb.distanceY(y),dt=Math.max(Math.abs(ht),Math.abs(_t));if(K.zoom===Z||dt>3+(1<<Z-K.zoom)-2&&K.zoom>=w)U.push({tileID:new u.OverscaledTileID(K.zoom===Z?q:K.zoom,K.wrap,K.zoom,tt,G),distanceSq:u.sqrLen([y[0]-.5-tt,y[1]-.5-G])});else for(var vt=0;vt<4;vt++){var Pt=(tt<<1)+vt%2,kt=(G<<1)+(vt>>1);k.push({aabb:K.aabb.quadrant(vt),zoom:K.zoom+1,x:Pt,y:kt,wrap:K.wrap,fullyVisible:Q})}}return U.sort(function(zt,Zt){return zt.distanceSq-Zt.distanceSq}).map(function(zt){return zt.tileID})},Ee.prototype.resize=function(n,a){this.width=n,this.height=a,this.pixelsToGLUnits=[2/n,-2/a],this._constrain(),this._calcMatrices()},qe.unmodified.get=function(){return this._unmodified},Ee.prototype.zoomScale=function(n){return Math.pow(2,n)},Ee.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},Ee.prototype.project=function(n){var a=u.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new u.Point(u.mercatorXfromLng(n.lng)*this.worldSize,u.mercatorYfromLat(a)*this.worldSize)},Ee.prototype.unproject=function(n){return new u.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},qe.point.get=function(){return this.project(this.center)},Ee.prototype.setLocationAtPoint=function(n,a){var o=this.pointCoordinate(a),l=this.pointCoordinate(this.centerPoint),f=this.locationCoordinate(n),y=new u.MercatorCoordinate(f.x-(o.x-l.x),f.y-(o.y-l.y));this.center=this.coordinateLocation(y),this._renderWorldCopies&&(this.center=this.center.wrap())},Ee.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},Ee.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},Ee.prototype.locationCoordinate=function(n){return u.MercatorCoordinate.fromLngLat(n)},Ee.prototype.coordinateLocation=function(n){return n.toLngLat()},Ee.prototype.pointCoordinate=function(n){var a=[n.x,n.y,0,1],o=[n.x,n.y,1,1];u.transformMat4(a,a,this.pixelMatrixInverse),u.transformMat4(o,o,this.pixelMatrixInverse);var l=a[3],f=o[3],y=a[1]/l,g=o[1]/f,w=a[2]/l,I=o[2]/f,k=w===I?0:(0-w)/(I-w);return new u.MercatorCoordinate(u.number(a[0]/l,o[0]/f,k)/this.worldSize,u.number(y,g,k)/this.worldSize)},Ee.prototype.coordinatePoint=function(n){var a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return u.transformMat4(a,a,this.pixelMatrix),new u.Point(a[0]/a[3],a[1]/a[3])},Ee.prototype.getBounds=function(){return new u.LngLatBounds().extend(this.pointLocation(new u.Point(0,0))).extend(this.pointLocation(new u.Point(this.width,0))).extend(this.pointLocation(new u.Point(this.width,this.height))).extend(this.pointLocation(new u.Point(0,this.height)))},Ee.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new u.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},Ee.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},Ee.prototype.calculatePosMatrix=function(n,a){a===void 0&&(a=!1);var o=n.key,l=a?this._alignedPosMatrixCache:this._posMatrixCache;if(l[o])return l[o];var f=n.canonical,y=this.worldSize/this.zoomScale(f.z),g=f.x+Math.pow(2,f.z)*n.wrap,w=u.identity(new Float64Array(16));return u.translate(w,w,[g*y,f.y*y,0]),u.scale(w,w,[y/u.EXTENT,y/u.EXTENT,1]),u.multiply(w,a?this.alignedProjMatrix:this.projMatrix,w),l[o]=new Float32Array(w),l[o]},Ee.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},Ee.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,a,o,l,f=-90,y=90,g=-180,w=180,I=this.size,k=this._unmodified;if(this.latRange){var U=this.latRange;f=u.mercatorYfromLat(U[1])*this.worldSize,n=(y=u.mercatorYfromLat(U[0])*this.worldSize)-f<I.y?I.y/(y-f):0}if(this.lngRange){var Z=this.lngRange;g=u.mercatorXfromLng(Z[0])*this.worldSize,a=(w=u.mercatorXfromLng(Z[1])*this.worldSize)-g<I.x?I.x/(w-g):0}var q=this.point,J=Math.max(a||0,n||0);if(J)return this.center=this.unproject(new u.Point(a?(w+g)/2:q.x,n?(y+f)/2:q.y)),this.zoom+=this.scaleZoom(J),this._unmodified=k,void(this._constraining=!1);if(this.latRange){var K=q.y,tt=I.y/2;K-tt<f&&(l=f+tt),K+tt>y&&(l=y-tt)}if(this.lngRange){var G=q.x,Q=I.x/2;G-Q<g&&(o=g+Q),G+Q>w&&(o=w-Q)}o===void 0&&l===void 0||(this.center=this.unproject(new u.Point(o!==void 0?o:q.x,l!==void 0?l:q.y))),this._unmodified=k,this._constraining=!1}},Ee.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var a=Math.PI/2+this._pitch,o=this._fov*(.5+n.y/this.height),l=Math.sin(o)*this.cameraToCenterDistance/Math.sin(u.clamp(Math.PI-a-o,.01,Math.PI-.01)),f=this.point,y=f.x,g=f.y,w=1.01*(Math.cos(Math.PI/2-this._pitch)*l+this.cameraToCenterDistance),I=this.height/50,k=new Float64Array(16);u.perspective(k,this._fov,this.width/this.height,I,w),k[8]=2*-n.x/this.width,k[9]=2*n.y/this.height,u.scale(k,k,[1,-1,1]),u.translate(k,k,[0,0,-this.cameraToCenterDistance]),u.rotateX(k,k,this._pitch),u.rotateZ(k,k,this.angle),u.translate(k,k,[-y,-g,0]),this.mercatorMatrix=u.scale([],k,[this.worldSize,this.worldSize,this.worldSize]),u.scale(k,k,[1,1,u.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=k,this.invProjMatrix=u.invert([],this.projMatrix);var U=this.width%2/2,Z=this.height%2/2,q=Math.cos(this.angle),J=Math.sin(this.angle),K=y-Math.round(y)+q*U+J*Z,tt=g-Math.round(g)+q*Z+J*U,G=new Float64Array(k);if(u.translate(G,G,[K>.5?K-1:K,tt>.5?tt-1:tt,0]),this.alignedProjMatrix=G,k=u.create(),u.scale(k,k,[this.width/2,-this.height/2,1]),u.translate(k,k,[1,-1,0]),this.labelPlaneMatrix=k,k=u.create(),u.scale(k,k,[1,-1,1]),u.translate(k,k,[-1,-1,0]),u.scale(k,k,[2/this.width,2/this.height,1]),this.glCoordMatrix=k,this.pixelMatrix=u.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(k=u.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=k,this._posMatrixCache={},this._alignedPosMatrixCache={}}},Ee.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new u.Point(0,0)),a=[n.x*this.worldSize,n.y*this.worldSize,0,1];return u.transformMat4(a,a,this.pixelMatrix)[3]/this.cameraToCenterDistance},Ee.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.Point(0,n))},Ee.prototype.getCameraQueryGeometry=function(n){var a=this.getCameraPoint();if(n.length===1)return[n[0],a];for(var o=a.x,l=a.y,f=a.x,y=a.y,g=0,w=n;g<w.length;g+=1){var I=w[g];o=Math.min(o,I.x),l=Math.min(l,I.y),f=Math.max(f,I.x),y=Math.max(y,I.y)}return[new u.Point(o,l),new u.Point(f,l),new u.Point(f,y),new u.Point(o,y),new u.Point(o,l)]},Object.defineProperties(Ee.prototype,qe);var Qr=function(n){var a,o,l,f;this._hashName=n&&encodeURIComponent(n),u.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(a=this._updateHashUnthrottled.bind(this),o=!1,l=null,f=function(){l=null,o&&(a(),l=setTimeout(f,300),o=!1)},function(){return o=!0,l||f(),l})};Qr.prototype.addTo=function(n){return this._map=n,u.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Qr.prototype.remove=function(){return u.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Qr.prototype.getHashString=function(n){var a=this._map.getCenter(),o=Math.round(100*this._map.getZoom())/100,l=Math.ceil((o*Math.LN2+Math.log(512/360/.5))/Math.LN10),f=Math.pow(10,l),y=Math.round(a.lng*f)/f,g=Math.round(a.lat*f)/f,w=this._map.getBearing(),I=this._map.getPitch(),k="";if(k+=n?"/"+y+"/"+g+"/"+o:o+"/"+g+"/"+y,(w||I)&&(k+="/"+Math.round(10*w)/10),I&&(k+="/"+Math.round(I)),this._hashName){var U=this._hashName,Z=!1,q=u.window.location.hash.slice(1).split("&").map(function(J){var K=J.split("=")[0];return K===U?(Z=!0,K+"="+k):J}).filter(function(J){return J});return Z||q.push(U+"="+k),"#"+q.join("&")}return"#"+k},Qr.prototype._getCurrentHash=function(){var n,a=this,o=u.window.location.hash.replace("#","");return this._hashName?(o.split("&").map(function(l){return l.split("=")}).forEach(function(l){l[0]===a._hashName&&(n=l)}),(n&&n[1]||"").split("/")):o.split("/")},Qr.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(o){return isNaN(o)})){var a=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:a,pitch:+(n[4]||0)}),!0}return!1},Qr.prototype._updateHashUnthrottled=function(){var n=u.window.location.href.replace(/(#.+)?$/,this.getHashString());try{u.window.history.replaceState(u.window.history.state,null,n)}catch{}};var ea={linearity:.3,easing:u.bezier(0,0,.3,1)},ia=u.extend({deceleration:2500,maxSpeed:1400},ea),jn=u.extend({deceleration:20,maxSpeed:1400},ea),jl=u.extend({deceleration:1e3,maxSpeed:360},ea),ra=u.extend({deceleration:1e3,maxSpeed:90},ea),na=function(n){this._map=n,this.clear()};function oa(n,a){(!n.duration||n.duration<a.duration)&&(n.duration=a.duration,n.easing=a.easing)}function Gn(n,a,o){var l=o.maxSpeed,f=o.linearity,y=o.deceleration,g=u.clamp(n*f/(a/1e3),-l,l),w=Math.abs(g)/(y*f);return{easing:o.easing,duration:1e3*w,amount:g*(w/2)}}na.prototype.clear=function(){this._inertiaBuffer=[]},na.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:u.browser.now(),settings:n})},na.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,a=u.browser.now();n.length>0&&a-n[0].time>160;)n.shift()},na.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var a={zoom:0,bearing:0,pitch:0,pan:new u.Point(0,0),pinchAround:void 0,around:void 0},o=0,l=this._inertiaBuffer;o<l.length;o+=1){var f=l[o].settings;a.zoom+=f.zoomDelta||0,a.bearing+=f.bearingDelta||0,a.pitch+=f.pitchDelta||0,f.panDelta&&a.pan._add(f.panDelta),f.around&&(a.around=f.around),f.pinchAround&&(a.pinchAround=f.pinchAround)}var y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,g={};if(a.pan.mag()){var w=Gn(a.pan.mag(),y,u.extend({},ia,n||{}));g.offset=a.pan.mult(w.amount/a.pan.mag()),g.center=this._map.transform.center,oa(g,w)}if(a.zoom){var I=Gn(a.zoom,y,jn);g.zoom=this._map.transform.zoom+I.amount,oa(g,I)}if(a.bearing){var k=Gn(a.bearing,y,jl);g.bearing=this._map.transform.bearing+u.clamp(k.amount,-179,179),oa(g,k)}if(a.pitch){var U=Gn(a.pitch,y,ra);g.pitch=this._map.transform.pitch+U.amount,oa(g,U)}if(g.zoom||g.bearing){var Z=a.pinchAround===void 0?a.around:a.pinchAround;g.around=Z?this._map.unproject(Z):this._map.getCenter()}return this.clear(),u.extend(g,{noMoveStart:!0})}};var ti=function(n){function a(l,f,y,g){g===void 0&&(g={});var w=st.mousePos(f.getCanvasContainer(),y),I=f.unproject(w);n.call(this,l,u.extend({point:w,lngLat:I,originalEvent:y},g)),this._defaultPrevented=!1,this.target=f}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(u.Event),aa=function(n){function a(l,f,y){var g=l==="touchend"?y.changedTouches:y.touches,w=st.touchPos(f.getCanvasContainer(),g),I=w.map(function(Z){return f.unproject(Z)}),k=w.reduce(function(Z,q,J,K){return Z.add(q.div(K.length))},new u.Point(0,0)),U=f.unproject(k);n.call(this,l,{points:w,point:k,lngLats:I,lngLat:U,originalEvent:y}),this._defaultPrevented=!1}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(u.Event),Bs=function(n){function a(l,f,y){n.call(this,l,{originalEvent:y}),this._defaultPrevented=!1}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={defaultPrevented:{configurable:!0}};return a.prototype.preventDefault=function(){this._defaultPrevented=!0},o.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(a.prototype,o),a}(u.Event),hi=function(n,a){this._map=n,this._clickTolerance=a.clickTolerance};hi.prototype.reset=function(){delete this._mousedownPos},hi.prototype.wheel=function(n){return this._firePreventable(new Bs(n.type,this._map,n))},hi.prototype.mousedown=function(n,a){return this._mousedownPos=a,this._firePreventable(new ti(n.type,this._map,n))},hi.prototype.mouseup=function(n){this._map.fire(new ti(n.type,this._map,n))},hi.prototype.click=function(n,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||this._map.fire(new ti(n.type,this._map,n))},hi.prototype.dblclick=function(n){return this._firePreventable(new ti(n.type,this._map,n))},hi.prototype.mouseover=function(n){this._map.fire(new ti(n.type,this._map,n))},hi.prototype.mouseout=function(n){this._map.fire(new ti(n.type,this._map,n))},hi.prototype.touchstart=function(n){return this._firePreventable(new aa(n.type,this._map,n))},hi.prototype.touchmove=function(n){this._map.fire(new aa(n.type,this._map,n))},hi.prototype.touchend=function(n){this._map.fire(new aa(n.type,this._map,n))},hi.prototype.touchcancel=function(n){this._map.fire(new aa(n.type,this._map,n))},hi.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},hi.prototype.isEnabled=function(){return!0},hi.prototype.isActive=function(){return!1},hi.prototype.enable=function(){},hi.prototype.disable=function(){};var jt=function(n){this._map=n};jt.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},jt.prototype.mousemove=function(n){this._map.fire(new ti(n.type,this._map,n))},jt.prototype.mousedown=function(){this._delayContextMenu=!0},jt.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ti("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},jt.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new ti(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},jt.prototype.isEnabled=function(){return!0},jt.prototype.isActive=function(){return!1},jt.prototype.enable=function(){},jt.prototype.disable=function(){};var Tr=function(n,a){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=a.clickTolerance||1};function mo(n,a){for(var o={},l=0;l<n.length;l++)o[n[l].identifier]=a[l];return o}Tr.prototype.isEnabled=function(){return!!this._enabled},Tr.prototype.isActive=function(){return!!this._active},Tr.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Tr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Tr.prototype.mousedown=function(n,a){this.isEnabled()&&n.shiftKey&&n.button===0&&(st.disableDrag(),this._startPos=this._lastPos=a,this._active=!0)},Tr.prototype.mousemoveWindow=function(n,a){if(this._active){var o=a;if(!(this._lastPos.equals(o)||!this._box&&o.dist(this._startPos)<this._clickTolerance)){var l=this._startPos;this._lastPos=o,this._box||(this._box=st.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var f=Math.min(l.x,o.x),y=Math.max(l.x,o.x),g=Math.min(l.y,o.y),w=Math.max(l.y,o.y);st.setTransform(this._box,"translate("+f+"px,"+g+"px)"),this._box.style.width=y-f+"px",this._box.style.height=w-g+"px"}}},Tr.prototype.mouseupWindow=function(n,a){var o=this;if(this._active&&n.button===0){var l=this._startPos,f=a;if(this.reset(),st.suppressClick(),l.x!==f.x||l.y!==f.y)return this._map.fire(new u.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(y){return y.fitScreenCoordinates(l,f,o._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},Tr.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},Tr.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(st.remove(this._box),this._box=null),st.enableDrag(),delete this._startPos,delete this._lastPos},Tr.prototype._fireEvent=function(n,a){return this._map.fire(new u.Event(n,{originalEvent:a}))};var Ro=function(n){this.reset(),this.numTouches=n.numTouches};Ro.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Ro.prototype.touchstart=function(n,a,o){(this.centroid||o.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),o.length===this.numTouches&&(this.centroid=function(l){for(var f=new u.Point(0,0),y=0,g=l;y<g.length;y+=1)f._add(g[y]);return f.div(l.length)}(a),this.touches=mo(o,a)))},Ro.prototype.touchmove=function(n,a,o){if(!this.aborted&&this.centroid){var l=mo(o,a);for(var f in this.touches){var y=l[f];(!y||y.dist(this.touches[f])>30)&&(this.aborted=!0)}}},Ro.prototype.touchend=function(n,a,o){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),o.length===0){var l=!this.aborted&&this.centroid;if(this.reset(),l)return l}};var fn=function(n){this.singleTap=new Ro(n),this.numTaps=n.numTaps,this.reset()};fn.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},fn.prototype.touchstart=function(n,a,o){this.singleTap.touchstart(n,a,o)},fn.prototype.touchmove=function(n,a,o){this.singleTap.touchmove(n,a,o)},fn.prototype.touchend=function(n,a,o){var l=this.singleTap.touchend(n,a,o);if(l){var f=n.timeStamp-this.lastTime<500,y=!this.lastTap||this.lastTap.dist(l)<30;if(f&&y||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=l,this.count===this.numTaps)return this.reset(),l}};var Fr=function(){this._zoomIn=new fn({numTouches:1,numTaps:2}),this._zoomOut=new fn({numTouches:2,numTaps:1}),this.reset()};Fr.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},Fr.prototype.touchstart=function(n,a,o){this._zoomIn.touchstart(n,a,o),this._zoomOut.touchstart(n,a,o)},Fr.prototype.touchmove=function(n,a,o){this._zoomIn.touchmove(n,a,o),this._zoomOut.touchmove(n,a,o)},Fr.prototype.touchend=function(n,a,o){var l=this,f=this._zoomIn.touchend(n,a,o),y=this._zoomOut.touchend(n,a,o);return f?(this._active=!0,n.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(g){return g.easeTo({duration:300,zoom:g.getZoom()+1,around:g.unproject(f)},{originalEvent:n})}}):y?(this._active=!0,n.preventDefault(),setTimeout(function(){return l.reset()},0),{cameraAnimation:function(g){return g.easeTo({duration:300,zoom:g.getZoom()-1,around:g.unproject(y)},{originalEvent:n})}}):void 0},Fr.prototype.touchcancel=function(){this.reset()},Fr.prototype.enable=function(){this._enabled=!0},Fr.prototype.disable=function(){this._enabled=!1,this.reset()},Fr.prototype.isEnabled=function(){return this._enabled},Fr.prototype.isActive=function(){return this._active};var is={0:1,2:2},Bt=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};Bt.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},Bt.prototype._correctButton=function(n,a){return!1},Bt.prototype._move=function(n,a){return{}},Bt.prototype.mousedown=function(n,a){if(!this._lastPoint){var o=st.mouseButton(n);this._correctButton(n,o)&&(this._lastPoint=a,this._eventButton=o)}},Bt.prototype.mousemoveWindow=function(n,a){var o=this._lastPoint;if(o){if(n.preventDefault(),function(l,f){var y=is[f];return l.buttons===void 0||(l.buttons&y)!==y}(n,this._eventButton))this.reset();else if(this._moved||!(a.dist(o)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(o,a)}},Bt.prototype.mouseupWindow=function(n){this._lastPoint&&st.mouseButton(n)===this._eventButton&&(this._moved&&st.suppressClick(),this.reset())},Bt.prototype.enable=function(){this._enabled=!0},Bt.prototype.disable=function(){this._enabled=!1,this.reset()},Bt.prototype.isEnabled=function(){return this._enabled},Bt.prototype.isActive=function(){return this._active};var rs=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.mousedown=function(o,l){n.prototype.mousedown.call(this,o,l),this._lastPoint&&(this._active=!0)},a.prototype._correctButton=function(o,l){return l===0&&!o.ctrlKey},a.prototype._move=function(o,l){return{around:l,panDelta:l.sub(o)}},a}(Bt),Ma=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype._correctButton=function(o,l){return l===0&&o.ctrlKey||l===2},a.prototype._move=function(o,l){var f=.8*(l.x-o.x);if(f)return this._active=!0,{bearingDelta:f}},a.prototype.contextmenu=function(o){o.preventDefault()},a}(Bt),ns=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype._correctButton=function(o,l){return l===0&&o.ctrlKey||l===2},a.prototype._move=function(o,l){var f=-.5*(l.y-o.y);if(f)return this._active=!0,{pitchDelta:f}},a.prototype.contextmenu=function(o){o.preventDefault()},a}(Bt),tn=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};tn.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new u.Point(0,0)},tn.prototype.touchstart=function(n,a,o){return this._calculateTransform(n,a,o)},tn.prototype.touchmove=function(n,a,o){if(this._active&&!(o.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,a,o)},tn.prototype.touchend=function(n,a,o){this._calculateTransform(n,a,o),this._active&&o.length<this._minTouches&&this.reset()},tn.prototype.touchcancel=function(){this.reset()},tn.prototype._calculateTransform=function(n,a,o){o.length>0&&(this._active=!0);var l=mo(o,a),f=new u.Point(0,0),y=new u.Point(0,0),g=0;for(var w in l){var I=l[w],k=this._touches[w];k&&(f._add(I),y._add(I.sub(k)),g++,l[w]=I)}if(this._touches=l,!(g<this._minTouches)&&y.mag()){var U=y.div(g);if(this._sum._add(U),!(this._sum.mag()<this._clickTolerance))return{around:f.div(g),panDelta:U}}},tn.prototype.enable=function(){this._enabled=!0},tn.prototype.disable=function(){this._enabled=!1,this.reset()},tn.prototype.isEnabled=function(){return this._enabled},tn.prototype.isActive=function(){return this._active};var Lr=function(){this.reset()};function os(n,a,o){for(var l=0;l<n.length;l++)if(n[l].identifier===o)return a[l]}function r(n,a){return Math.log(n/a)/Math.LN2}Lr.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Lr.prototype._start=function(n){},Lr.prototype._move=function(n,a,o){return{}},Lr.prototype.touchstart=function(n,a,o){this._firstTwoTouches||o.length<2||(this._firstTwoTouches=[o[0].identifier,o[1].identifier],this._start([a[0],a[1]]))},Lr.prototype.touchmove=function(n,a,o){if(this._firstTwoTouches){n.preventDefault();var l=this._firstTwoTouches,f=l[1],y=os(o,a,l[0]),g=os(o,a,f);if(y&&g){var w=this._aroundCenter?null:y.add(g).div(2);return this._move([y,g],w,n)}}},Lr.prototype.touchend=function(n,a,o){if(this._firstTwoTouches){var l=this._firstTwoTouches,f=l[1],y=os(o,a,l[0]),g=os(o,a,f);y&&g||(this._active&&st.suppressClick(),this.reset())}},Lr.prototype.touchcancel=function(){this.reset()},Lr.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},Lr.prototype.disable=function(){this._enabled=!1,this.reset()},Lr.prototype.isEnabled=function(){return this._enabled},Lr.prototype.isActive=function(){return this._active};var h=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},a.prototype._start=function(o){this._startDistance=this._distance=o[0].dist(o[1])},a.prototype._move=function(o,l){var f=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(r(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:r(this._distance,f),pinchAround:l}},a}(Lr);function _(n,a){return 180*n.angleWith(a)/Math.PI}var b=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},a.prototype._start=function(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])},a.prototype._move=function(o,l){var f=this._vector;if(this._vector=o[0].sub(o[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:_(this._vector,f),pinchAround:l}},a.prototype._isBelowThreshold=function(o){this._minDiameter=Math.min(this._minDiameter,o.mag());var l=25/(Math.PI*this._minDiameter)*360,f=_(o,this._startVector);return Math.abs(f)<l},a}(Lr);function E(n){return Math.abs(n.y)>Math.abs(n.x)}var N=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},a.prototype._start=function(o){this._lastPoints=o,E(o[0].sub(o[1]))&&(this._valid=!1)},a.prototype._move=function(o,l,f){var y=o[0].sub(this._lastPoints[0]),g=o[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(y,g,f.timeStamp),this._valid)return this._lastPoints=o,this._active=!0,{pitchDelta:(y.y+g.y)/2*-.5}},a.prototype.gestureBeginsVertically=function(o,l,f){if(this._valid!==void 0)return this._valid;var y=o.mag()>=2,g=l.mag()>=2;if(y||g){if(!y||!g)return this._firstMove===void 0&&(this._firstMove=f),f-this._firstMove<100&&void 0;var w=o.y>0==l.y>0;return E(o)&&E(l)&&w}},a}(Lr),rt={panStep:100,bearingStep:15,pitchStep:10},pt=function(){var n=rt;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1};function wt(n){return n*(2-n)}pt.prototype.reset=function(){this._active=!1},pt.prototype.keydown=function(n){var a=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var o=0,l=0,f=0,y=0,g=0;switch(n.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:n.shiftKey?l=-1:(n.preventDefault(),y=-1);break;case 39:n.shiftKey?l=1:(n.preventDefault(),y=1);break;case 38:n.shiftKey?f=1:(n.preventDefault(),g=-1);break;case 40:n.shiftKey?f=-1:(n.preventDefault(),g=1);break;default:return}return this._rotationDisabled&&(l=0,f=0),{cameraAnimation:function(w){var I=w.getZoom();w.easeTo({duration:300,easeId:"keyboardHandler",easing:wt,zoom:o?Math.round(I)+o*(n.shiftKey?2:1):I,bearing:w.getBearing()+l*a._bearingStep,pitch:w.getPitch()+f*a._pitchStep,offset:[-y*a._panStep,-g*a._panStep],center:w.getCenter()},{originalEvent:n})}}}},pt.prototype.enable=function(){this._enabled=!0},pt.prototype.disable=function(){this._enabled=!1,this.reset()},pt.prototype.isEnabled=function(){return this._enabled},pt.prototype.isActive=function(){return this._active},pt.prototype.disableRotation=function(){this._rotationDisabled=!0},pt.prototype.enableRotation=function(){this._rotationDisabled=!1};var xt=function(n,a){this._map=n,this._el=n.getCanvasContainer(),this._handler=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,u.bindAll(["_onTimeout"],this)};xt.prototype.setZoomRate=function(n){this._defaultZoomRate=n},xt.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},xt.prototype.isEnabled=function(){return!!this._enabled},xt.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},xt.prototype.isZooming=function(){return!!this._zooming},xt.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},xt.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},xt.prototype.wheel=function(n){if(this.isEnabled()){var a=n.deltaMode===u.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,o=u.browser.now(),l=o-(this._lastWheelEventTime||0);this._lastWheelEventTime=o,a!==0&&a%4.000244140625==0?this._type="wheel":a!==0&&Math.abs(a)<4?this._type="trackpad":l>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(l*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),n.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=n,this._delta-=a,this._active||this._start(n)),n.preventDefault()}},xt.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},xt.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var a=st.mousePos(this._el,n);this._around=u.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(a)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},xt.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var a=this._map.transform;if(this._delta!==0){var o=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,l=2/(1+Math.exp(-Math.abs(this._delta*o)));this._delta<0&&l!==0&&(l=1/l);var f=typeof this._targetZoom=="number"?a.zoomScale(this._targetZoom):a.scale;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom(f*l))),this._type==="wheel"&&(this._startZoom=a.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var y,g=typeof this._targetZoom=="number"?this._targetZoom:a.zoom,w=this._startZoom,I=this._easing,k=!1;if(this._type==="wheel"&&w&&I){var U=Math.min((u.browser.now()-this._lastWheelEventTime)/200,1),Z=I(U);y=u.number(w,g,Z),U<1?this._frameId||(this._frameId=!0):k=!0}else y=g,k=!0;return this._active=!0,k&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!k,zoomDelta:y-a.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},xt.prototype._smoothOutEasing=function(n){var a=u.ease;if(this._prevEase){var o=this._prevEase,l=(u.browser.now()-o.start)/o.duration,f=o.easing(l+.01)-o.easing(l),y=.27/Math.sqrt(f*f+1e-4)*.01,g=Math.sqrt(.0729-y*y);a=u.bezier(y,g,.25,1)}return this._prevEase={start:u.browser.now(),duration:n,easing:a},a},xt.prototype.reset=function(){this._active=!1};var Wt=function(n,a){this._clickZoom=n,this._tapZoom=a};Wt.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},Wt.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},Wt.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},Wt.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var ie=function(){this.reset()};ie.prototype.reset=function(){this._active=!1},ie.prototype.dblclick=function(n,a){return n.preventDefault(),{cameraAnimation:function(o){o.easeTo({duration:300,zoom:o.getZoom()+(n.shiftKey?-1:1),around:o.unproject(a)},{originalEvent:n})}}},ie.prototype.enable=function(){this._enabled=!0},ie.prototype.disable=function(){this._enabled=!1,this.reset()},ie.prototype.isEnabled=function(){return this._enabled},ie.prototype.isActive=function(){return this._active};var me=function(){this._tap=new fn({numTouches:1,numTaps:1}),this.reset()};me.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},me.prototype.touchstart=function(n,a,o){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?o.length>0&&(this._swipePoint=a[0],this._swipeTouch=o[0].identifier):this._tap.touchstart(n,a,o))},me.prototype.touchmove=function(n,a,o){if(this._tapTime){if(this._swipePoint){if(o[0].identifier!==this._swipeTouch)return;var l=a[0],f=l.y-this._swipePoint.y;return this._swipePoint=l,n.preventDefault(),this._active=!0,{zoomDelta:f/128}}}else this._tap.touchmove(n,a,o)},me.prototype.touchend=function(n,a,o){this._tapTime?this._swipePoint&&o.length===0&&this.reset():this._tap.touchend(n,a,o)&&(this._tapTime=n.timeStamp)},me.prototype.touchcancel=function(){this.reset()},me.prototype.enable=function(){this._enabled=!0},me.prototype.disable=function(){this._enabled=!1,this.reset()},me.prototype.isEnabled=function(){return this._enabled},me.prototype.isActive=function(){return this._active};var zr=function(n,a,o){this._el=n,this._mousePan=a,this._touchPan=o};zr.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},zr.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},zr.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},zr.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Ur=function(n,a,o){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=a,this._mousePitch=o};Ur.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Ur.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Ur.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Ur.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var Nr=function(n,a,o,l){this._el=n,this._touchZoom=a,this._touchRotate=o,this._tapDragZoom=l,this._rotationDisabled=!1,this._enabled=!0};Nr.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},Nr.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},Nr.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},Nr.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},Nr.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},Nr.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var Si=function(n){return n.zoom||n.drag||n.pitch||n.rotate},Oo=function(n){function a(){n.apply(this,arguments)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a}(u.Event);function Qt(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var Xt=function(n,a){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new na(n),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(a),u.bindAll(["handleEvent","handleWindowEvent"],this);var o=this._el;this._listeners=[[o,"touchstart",{passive:!0}],[o,"touchmove",{passive:!1}],[o,"touchend",void 0],[o,"touchcancel",void 0],[o,"mousedown",void 0],[o,"mousemove",void 0],[o,"mouseup",void 0],[u.window.document,"mousemove",{capture:!0}],[u.window.document,"mouseup",void 0],[o,"mouseover",void 0],[o,"mouseout",void 0],[o,"dblclick",void 0],[o,"click",void 0],[o,"keydown",{capture:!1}],[o,"keyup",void 0],[o,"wheel",{passive:!1}],[o,"contextmenu",void 0],[u.window,"blur",void 0]];for(var l=0,f=this._listeners;l<f.length;l+=1){var y=f[l],g=y[0];st.addEventListener(g,y[1],g===u.window.document?this.handleWindowEvent:this.handleEvent,y[2])}};Xt.prototype.destroy=function(){for(var n=0,a=this._listeners;n<a.length;n+=1){var o=a[n],l=o[0];st.removeEventListener(l,o[1],l===u.window.document?this.handleWindowEvent:this.handleEvent,o[2])}},Xt.prototype._addDefaultHandlers=function(n){var a=this._map,o=a.getCanvasContainer();this._add("mapEvent",new hi(a,n));var l=a.boxZoom=new Tr(a,n);this._add("boxZoom",l);var f=new Fr,y=new ie;a.doubleClickZoom=new Wt(y,f),this._add("tapZoom",f),this._add("clickZoom",y);var g=new me;this._add("tapDragZoom",g);var w=a.touchPitch=new N;this._add("touchPitch",w);var I=new Ma(n),k=new ns(n);a.dragRotate=new Ur(n,I,k),this._add("mouseRotate",I,["mousePitch"]),this._add("mousePitch",k,["mouseRotate"]);var U=new rs(n),Z=new tn(n);a.dragPan=new zr(o,U,Z),this._add("mousePan",U),this._add("touchPan",Z,["touchZoom","touchRotate"]);var q=new b,J=new h;a.touchZoomRotate=new Nr(o,J,q,g),this._add("touchRotate",q,["touchPan","touchZoom"]),this._add("touchZoom",J,["touchPan","touchRotate"]);var K=a.scrollZoom=new xt(a,this);this._add("scrollZoom",K,["mousePan"]);var tt=a.keyboard=new pt;this._add("keyboard",tt),this._add("blockableMapEvent",new jt(a));for(var G=0,Q=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];G<Q.length;G+=1){var ot=Q[G];n.interactive&&n[ot]&&a[ot].enable(n[ot])}},Xt.prototype._add=function(n,a,o){this._handlers.push({handlerName:n,handler:a,allowed:o}),this._handlersById[n]=a},Xt.prototype.stop=function(n){if(!this._updatingCamera){for(var a=0,o=this._handlers;a<o.length;a+=1)o[a].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},Xt.prototype.isActive=function(){for(var n=0,a=this._handlers;n<a.length;n+=1)if(a[n].handler.isActive())return!0;return!1},Xt.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},Xt.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},Xt.prototype.isMoving=function(){return Boolean(Si(this._eventsInProgress))||this.isZooming()},Xt.prototype._blockedByActive=function(n,a,o){for(var l in n)if(l!==o&&(!a||a.indexOf(l)<0))return!0;return!1},Xt.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},Xt.prototype._getMapTouches=function(n){for(var a=[],o=0,l=n;o<l.length;o+=1){var f=l[o];this._el.contains(f.target)&&a.push(f)}return a},Xt.prototype.handleEvent=function(n,a){if(n.type!=="blur"){this._updatingCamera=!0;for(var o=n.type==="renderFrame"?void 0:n,l={needsRenderFrame:!1},f={},y={},g=n.touches?this._getMapTouches(n.touches):void 0,w=g?st.touchPos(this._el,g):st.mousePos(this._el,n),I=0,k=this._handlers;I<k.length;I+=1){var U=k[I],Z=U.handlerName,q=U.handler,J=U.allowed;if(q.isEnabled()){var K=void 0;this._blockedByActive(y,J,Z)?q.reset():q[a||n.type]&&(K=q[a||n.type](n,w,g),this.mergeHandlerResult(l,f,K,Z,o),K&&K.needsRenderFrame&&this._triggerRenderFrame()),(K||q.isActive())&&(y[Z]=q)}}var tt={};for(var G in this._previousActiveHandlers)y[G]||(tt[G]=o);this._previousActiveHandlers=y,(Object.keys(tt).length||Qt(l))&&(this._changes.push([l,f,tt]),this._triggerRenderFrame()),(Object.keys(y).length||Qt(l))&&this._map._stop(!0),this._updatingCamera=!1;var Q=l.cameraAnimation;Q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Q(this._map))}else this.stop(!0)},Xt.prototype.mergeHandlerResult=function(n,a,o,l,f){if(o){u.extend(n,o);var y={handlerName:l,originalEvent:o.originalEvent||f};o.zoomDelta!==void 0&&(a.zoom=y),o.panDelta!==void 0&&(a.drag=y),o.pitchDelta!==void 0&&(a.pitch=y),o.bearingDelta!==void 0&&(a.rotate=y)}},Xt.prototype._applyChanges=function(){for(var n={},a={},o={},l=0,f=this._changes;l<f.length;l+=1){var y=f[l],g=y[0],w=y[1],I=y[2];g.panDelta&&(n.panDelta=(n.panDelta||new u.Point(0,0))._add(g.panDelta)),g.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+g.zoomDelta),g.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+g.bearingDelta),g.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+g.pitchDelta),g.around!==void 0&&(n.around=g.around),g.pinchAround!==void 0&&(n.pinchAround=g.pinchAround),g.noInertia&&(n.noInertia=g.noInertia),u.extend(a,w),u.extend(o,I)}this._updateMapTransform(n,a,o),this._changes=[]},Xt.prototype._updateMapTransform=function(n,a,o){var l=this._map,f=l.transform;if(!Qt(n))return this._fireEvents(a,o,!0);var y=n.panDelta,g=n.zoomDelta,w=n.bearingDelta,I=n.pitchDelta,k=n.around,U=n.pinchAround;U!==void 0&&(k=U),l._stop(!0),k=k||l.transform.centerPoint;var Z=f.pointLocation(y?k.sub(y):k);w&&(f.bearing+=w),I&&(f.pitch+=I),g&&(f.zoom+=g),f.setLocationAtPoint(Z,k),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(a,o,!0)},Xt.prototype._fireEvents=function(n,a,o){var l=this,f=Si(this._eventsInProgress),y=Si(n),g={};for(var w in n)this._eventsInProgress[w]||(g[w+"start"]=n[w].originalEvent),this._eventsInProgress[w]=n[w];for(var I in!f&&y&&this._fireEvent("movestart",y.originalEvent),g)this._fireEvent(I,g[I]);for(var k in y&&this._fireEvent("move",y.originalEvent),n)this._fireEvent(k,n[k].originalEvent);var U,Z={};for(var q in this._eventsInProgress){var J=this._eventsInProgress[q],K=J.handlerName,tt=J.originalEvent;this._handlersById[K].isActive()||(delete this._eventsInProgress[q],Z[q+"end"]=U=a[K]||tt)}for(var G in Z)this._fireEvent(G,Z[G]);var Q=Si(this._eventsInProgress);if(o&&(f||y)&&!Q){this._updatingCamera=!0;var ot=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ht=function(_t){return _t!==0&&-l._bearingSnap<_t&&_t<l._bearingSnap};ot?(ht(ot.bearing||this._map.getBearing())&&(ot.bearing=0),this._map.easeTo(ot,{originalEvent:U})):(this._map.fire(new u.Event("moveend",{originalEvent:U})),ht(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},Xt.prototype._fireEvent=function(n,a){this._map.fire(new u.Event(n,a?{originalEvent:a}:{}))},Xt.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(a){delete n._frameId,n.handleEvent(new Oo("renderFrame",{timeStamp:a})),n._applyChanges()})},Xt.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var as=function(n){function a(o,l){n.call(this),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=l.bearingSnap,u.bindAll(["_renderFrameCallback"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.getCenter=function(){return new u.LngLat(this.transform.center.lng,this.transform.center.lat)},a.prototype.setCenter=function(o,l){return this.jumpTo({center:o},l)},a.prototype.panBy=function(o,l,f){return o=u.Point.convert(o).mult(-1),this.panTo(this.transform.center,u.extend({offset:o},l),f)},a.prototype.panTo=function(o,l,f){return this.easeTo(u.extend({center:o},l),f)},a.prototype.getZoom=function(){return this.transform.zoom},a.prototype.setZoom=function(o,l){return this.jumpTo({zoom:o},l),this},a.prototype.zoomTo=function(o,l,f){return this.easeTo(u.extend({zoom:o},l),f)},a.prototype.zoomIn=function(o,l){return this.zoomTo(this.getZoom()+1,o,l),this},a.prototype.zoomOut=function(o,l){return this.zoomTo(this.getZoom()-1,o,l),this},a.prototype.getBearing=function(){return this.transform.bearing},a.prototype.setBearing=function(o,l){return this.jumpTo({bearing:o},l),this},a.prototype.getPadding=function(){return this.transform.padding},a.prototype.setPadding=function(o,l){return this.jumpTo({padding:o},l),this},a.prototype.rotateTo=function(o,l,f){return this.easeTo(u.extend({bearing:o},l),f)},a.prototype.resetNorth=function(o,l){return this.rotateTo(0,u.extend({duration:1e3},o),l),this},a.prototype.resetNorthPitch=function(o,l){return this.easeTo(u.extend({bearing:0,pitch:0,duration:1e3},o),l),this},a.prototype.snapToNorth=function(o,l){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,l):this},a.prototype.getPitch=function(){return this.transform.pitch},a.prototype.setPitch=function(o,l){return this.jumpTo({pitch:o},l),this},a.prototype.cameraForBounds=function(o,l){o=u.LngLatBounds.convert(o);var f=l&&l.bearing||0;return this._cameraForBoxAndBearing(o.getNorthWest(),o.getSouthEast(),f,l)},a.prototype._cameraForBoxAndBearing=function(o,l,f,y){var g={top:0,bottom:0,right:0,left:0};if(typeof(y=u.extend({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},y)).padding=="number"){var w=y.padding;y.padding={top:w,bottom:w,right:w,left:w}}y.padding=u.extend(g,y.padding);var I=this.transform,k=I.padding,U=I.project(u.LngLat.convert(o)),Z=I.project(u.LngLat.convert(l)),q=U.rotate(-f*Math.PI/180),J=Z.rotate(-f*Math.PI/180),K=new u.Point(Math.max(q.x,J.x),Math.max(q.y,J.y)),tt=new u.Point(Math.min(q.x,J.x),Math.min(q.y,J.y)),G=K.sub(tt),Q=(I.width-(k.left+k.right+y.padding.left+y.padding.right))/G.x,ot=(I.height-(k.top+k.bottom+y.padding.top+y.padding.bottom))/G.y;if(!(ot<0||Q<0)){var ht=Math.min(I.scaleZoom(I.scale*Math.min(Q,ot)),y.maxZoom),_t=typeof y.offset.x=="number"?new u.Point(y.offset.x,y.offset.y):u.Point.convert(y.offset),dt=new u.Point((y.padding.left-y.padding.right)/2,(y.padding.top-y.padding.bottom)/2).rotate(f*Math.PI/180),vt=_t.add(dt).mult(I.scale/I.zoomScale(ht));return{center:I.unproject(U.add(Z).div(2).sub(vt)),zoom:ht,bearing:f}}u.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},a.prototype.fitBounds=function(o,l,f){return this._fitInternal(this.cameraForBounds(o,l),l,f)},a.prototype.fitScreenCoordinates=function(o,l,f,y,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.Point.convert(o)),this.transform.pointLocation(u.Point.convert(l)),f,y),y,g)},a.prototype._fitInternal=function(o,l,f){return o?(delete(l=u.extend(o,l)).padding,l.linear?this.easeTo(l,f):this.flyTo(l,f)):this},a.prototype.jumpTo=function(o,l){this.stop();var f=this.transform,y=!1,g=!1,w=!1;return"zoom"in o&&f.zoom!==+o.zoom&&(y=!0,f.zoom=+o.zoom),o.center!==void 0&&(f.center=u.LngLat.convert(o.center)),"bearing"in o&&f.bearing!==+o.bearing&&(g=!0,f.bearing=+o.bearing),"pitch"in o&&f.pitch!==+o.pitch&&(w=!0,f.pitch=+o.pitch),o.padding==null||f.isPaddingEqual(o.padding)||(f.padding=o.padding),this.fire(new u.Event("movestart",l)).fire(new u.Event("move",l)),y&&this.fire(new u.Event("zoomstart",l)).fire(new u.Event("zoom",l)).fire(new u.Event("zoomend",l)),g&&this.fire(new u.Event("rotatestart",l)).fire(new u.Event("rotate",l)).fire(new u.Event("rotateend",l)),w&&this.fire(new u.Event("pitchstart",l)).fire(new u.Event("pitch",l)).fire(new u.Event("pitchend",l)),this.fire(new u.Event("moveend",l))},a.prototype.easeTo=function(o,l){var f=this;this._stop(!1,o.easeId),((o=u.extend({offset:[0,0],duration:500,easing:u.ease},o)).animate===!1||!o.essential&&u.browser.prefersReducedMotion)&&(o.duration=0);var y=this.transform,g=this.getZoom(),w=this.getBearing(),I=this.getPitch(),k=this.getPadding(),U="zoom"in o?+o.zoom:g,Z="bearing"in o?this._normalizeBearing(o.bearing,w):w,q="pitch"in o?+o.pitch:I,J="padding"in o?o.padding:y.padding,K=u.Point.convert(o.offset),tt=y.centerPoint.add(K),G=y.pointLocation(tt),Q=u.LngLat.convert(o.center||G);this._normalizeCenter(Q);var ot,ht,_t=y.project(G),dt=y.project(Q).sub(_t),vt=y.zoomScale(U-g);o.around&&(ot=u.LngLat.convert(o.around),ht=y.locationPoint(ot));var Pt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||U!==g,this._rotating=this._rotating||w!==Z,this._pitching=this._pitching||q!==I,this._padding=!y.isPaddingEqual(J),this._easeId=o.easeId,this._prepareEase(l,o.noMoveStart,Pt),this._ease(function(kt){if(f._zooming&&(y.zoom=u.number(g,U,kt)),f._rotating&&(y.bearing=u.number(w,Z,kt)),f._pitching&&(y.pitch=u.number(I,q,kt)),f._padding&&(y.interpolatePadding(k,J,kt),tt=y.centerPoint.add(K)),ot)y.setLocationAtPoint(ot,ht);else{var zt=y.zoomScale(y.zoom-g),Zt=U>g?Math.min(2,vt):Math.max(.5,vt),te=Math.pow(Zt,1-kt),oe=y.unproject(_t.add(dt.mult(kt*te)).mult(zt));y.setLocationAtPoint(y.renderWorldCopies?oe.wrap():oe,tt)}f._fireMoveEvents(l)},function(kt){f._afterEase(l,kt)},o),this},a.prototype._prepareEase=function(o,l,f){f===void 0&&(f={}),this._moving=!0,l||f.moving||this.fire(new u.Event("movestart",o)),this._zooming&&!f.zooming&&this.fire(new u.Event("zoomstart",o)),this._rotating&&!f.rotating&&this.fire(new u.Event("rotatestart",o)),this._pitching&&!f.pitching&&this.fire(new u.Event("pitchstart",o))},a.prototype._fireMoveEvents=function(o){this.fire(new u.Event("move",o)),this._zooming&&this.fire(new u.Event("zoom",o)),this._rotating&&this.fire(new u.Event("rotate",o)),this._pitching&&this.fire(new u.Event("pitch",o))},a.prototype._afterEase=function(o,l){if(!this._easeId||!l||this._easeId!==l){delete this._easeId;var f=this._zooming,y=this._rotating,g=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,f&&this.fire(new u.Event("zoomend",o)),y&&this.fire(new u.Event("rotateend",o)),g&&this.fire(new u.Event("pitchend",o)),this.fire(new u.Event("moveend",o))}},a.prototype.flyTo=function(o,l){var f=this;if(!o.essential&&u.browser.prefersReducedMotion){var y=u.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(y,l)}this.stop(),o=u.extend({offset:[0,0],speed:1.2,curve:1.42,easing:u.ease},o);var g=this.transform,w=this.getZoom(),I=this.getBearing(),k=this.getPitch(),U=this.getPadding(),Z="zoom"in o?u.clamp(+o.zoom,g.minZoom,g.maxZoom):w,q="bearing"in o?this._normalizeBearing(o.bearing,I):I,J="pitch"in o?+o.pitch:k,K="padding"in o?o.padding:g.padding,tt=g.zoomScale(Z-w),G=u.Point.convert(o.offset),Q=g.centerPoint.add(G),ot=g.pointLocation(Q),ht=u.LngLat.convert(o.center||ot);this._normalizeCenter(ht);var _t=g.project(ot),dt=g.project(ht).sub(_t),vt=o.curve,Pt=Math.max(g.width,g.height),kt=Pt/tt,zt=dt.mag();if("minZoom"in o){var Zt=u.clamp(Math.min(o.minZoom,w,Z),g.minZoom,g.maxZoom),te=Pt/g.zoomScale(Zt-w);vt=Math.sqrt(te/zt*2)}var oe=vt*vt;function ne(ue){var ae=(kt*kt-Pt*Pt+(ue?-1:1)*oe*oe*zt*zt)/(2*(ue?kt:Pt)*oe*zt);return Math.log(Math.sqrt(ae*ae+1)-ae)}function Me(ue){return(Math.exp(ue)-Math.exp(-ue))/2}function Gt(ue){return(Math.exp(ue)+Math.exp(-ue))/2}var pe=ne(0),ve=function(ue){return Gt(pe)/Gt(pe+vt*ue)},ce=function(ue){return Pt*((Gt(pe)*(Me(ae=pe+vt*ue)/Gt(ae))-Me(pe))/oe)/zt;var ae},he=(ne(1)-pe)/vt;if(Math.abs(zt)<1e-6||!isFinite(he)){if(Math.abs(Pt-kt)<1e-6)return this.easeTo(o,l);var ye=kt<Pt?-1:1;he=Math.abs(Math.log(kt/Pt))/vt,ce=function(){return 0},ve=function(ue){return Math.exp(ye*vt*ue)}}return o.duration="duration"in o?+o.duration:1e3*he/("screenSpeed"in o?+o.screenSpeed/vt:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0),this._zooming=!0,this._rotating=I!==q,this._pitching=J!==k,this._padding=!g.isPaddingEqual(K),this._prepareEase(l,!1),this._ease(function(ue){var ae=ue*he,rr=1/ve(ae);g.zoom=ue===1?Z:w+g.scaleZoom(rr),f._rotating&&(g.bearing=u.number(I,q,ue)),f._pitching&&(g.pitch=u.number(k,J,ue)),f._padding&&(g.interpolatePadding(U,K,ue),Q=g.centerPoint.add(G));var Ci=ue===1?ht:g.unproject(_t.add(dt.mult(ce(ae))).mult(rr));g.setLocationAtPoint(g.renderWorldCopies?Ci.wrap():Ci,Q),f._fireMoveEvents(l)},function(){return f._afterEase(l)},o),this},a.prototype.isEasing=function(){return!!this._easeFrameId},a.prototype.stop=function(){return this._stop()},a.prototype._stop=function(o,l){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var f=this._onEaseEnd;delete this._onEaseEnd,f.call(this,l)}if(!o){var y=this.handlers;y&&y.stop(!1)}return this},a.prototype._ease=function(o,l,f){f.animate===!1||f.duration===0?(o(1),l()):(this._easeStart=u.browser.now(),this._easeOptions=f,this._onEaseFrame=o,this._onEaseEnd=l,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},a.prototype._renderFrameCallback=function(){var o=Math.min((u.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},a.prototype._normalizeBearing=function(o,l){o=u.wrap(o,-180,180);var f=Math.abs(o-l);return Math.abs(o-360-l)<f&&(o-=360),Math.abs(o+360-l)<f&&(o+=360),o},a.prototype._normalizeCenter=function(o){var l=this.transform;if(l.renderWorldCopies&&!l.lngRange){var f=o.lng-l.center.lng;o.lng+=f>180?-360:f<-180?360:0}},a}(u.Evented),cr=function(n){n===void 0&&(n={}),this.options=n,u.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)};cr.prototype.getDefaultPosition=function(){return"bottom-right"},cr.prototype.onAdd=function(n){var a=this.options&&this.options.compact;return this._map=n,this._container=st.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=st.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=st.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),a===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},cr.prototype.onRemove=function(){st.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},cr.prototype._setElementTitle=function(n,a){var o=this._map._getUIString("AttributionControl."+a);n.title=o,n.setAttribute("aria-label",o)},cr.prototype._toggleAttribution=function(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))},cr.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||u.config.ACCESS_TOKEN}];if(n){var o=a.reduce(function(l,f,y){return f.value&&(l+=f.key+"="+f.value+(y<a.length-1?"&":"")),l},"?");n.href=u.config.FEEDBACK_URL+"/"+o+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}},cr.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},cr.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(w){return typeof w!="string"?"":w})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}var o=this._map.style.sourceCaches;for(var l in o){var f=o[l];if(f.used){var y=f.getSource();y.attribution&&n.indexOf(y.attribution)<0&&n.push(y.attribution)}}n.sort(function(w,I){return w.length-I.length});var g=(n=n.filter(function(w,I){for(var k=I+1;k<n.length;k++)if(n[k].indexOf(w)>=0)return!1;return!0})).join(" | ");g!==this._attribHTML&&(this._attribHTML=g,n.length?(this._innerContainer.innerHTML=g,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},cr.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")};var xn=function(){u.bindAll(["_updateLogo"],this),u.bindAll(["_updateCompact"],this)};xn.prototype.onAdd=function(n){this._map=n,this._container=st.create("div","mapboxgl-ctrl");var a=st.create("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},xn.prototype.onRemove=function(){st.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},xn.prototype.getDefaultPosition=function(){return"bottom-left"},xn.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},xn.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var a in n)if(n[a].getSource().mapbox_logo)return!0;return!1}},xn.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var a=n[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}};var Xi=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};Xi.prototype.add=function(n){var a=++this._id;return this._queue.push({callback:n,id:a,cancelled:!1}),a},Xi.prototype.remove=function(n){for(var a=this._currentlyRunning,o=0,l=a?this._queue.concat(a):this._queue;o<l.length;o+=1){var f=l[o];if(f.id===n)return void(f.cancelled=!0)}},Xi.prototype.run=function(n){n===void 0&&(n=0);var a=this._currentlyRunning=this._queue;this._queue=[];for(var o=0,l=a;o<l.length;o+=1){var f=l[o];if(!f.cancelled&&(f.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},Xi.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var ii={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},sa=u.window.HTMLImageElement,ss=u.window.HTMLElement,je=u.window.ImageBitmap,Ki={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},ls=function(n){function a(l){var f=this;if((l=u.extend({},Ki,l)).minZoom!=null&&l.maxZoom!=null&&l.minZoom>l.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(l.minPitch!=null&&l.maxPitch!=null&&l.minPitch>l.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(l.minPitch!=null&&l.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(l.maxPitch!=null&&l.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var y=new Ee(l.minZoom,l.maxZoom,l.minPitch,l.maxPitch,l.renderWorldCopies);if(n.call(this,y,l),this._interactive=l.interactive,this._maxTileCacheSize=l.maxTileCacheSize,this._failIfMajorPerformanceCaveat=l.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=l.preserveDrawingBuffer,this._antialias=l.antialias,this._trackResize=l.trackResize,this._bearingSnap=l.bearingSnap,this._refreshExpiredTiles=l.refreshExpiredTiles,this._fadeDuration=l.fadeDuration,this._crossSourceCollisions=l.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=l.collectResourceTiming,this._renderTaskQueue=new Xi,this._controls=[],this._mapId=u.uniqueId(),this._locale=u.extend({},ii,l.locale),this._clickTolerance=l.clickTolerance,this._requestManager=new u.RequestManager(l.transformRequest,l.accessToken),typeof l.container=="string"){if(this._container=u.window.document.getElementById(l.container),!this._container)throw new Error("Container '"+l.container+"' not found.")}else{if(!(l.container instanceof ss))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=l.container}if(l.maxBounds&&this.setMaxBounds(l.maxBounds),u.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return f._update(!1)}),this.on("moveend",function(){return f._update(!1)}),this.on("zoom",function(){return f._update(!0)}),u.window!==void 0&&(u.window.addEventListener("online",this._onWindowOnline,!1),u.window.addEventListener("resize",this._onWindowResize,!1),u.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new Xt(this,l),this._hash=l.hash&&new Qr(typeof l.hash=="string"&&l.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:l.center,zoom:l.zoom,bearing:l.bearing,pitch:l.pitch}),l.bounds&&(this.resize(),this.fitBounds(l.bounds,u.extend({},l.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=l.localIdeographFontFamily,l.style&&this.setStyle(l.style,{localIdeographFontFamily:l.localIdeographFontFamily}),l.attributionControl&&this.addControl(new cr({customAttribution:l.customAttribution})),this.addControl(new xn,l.logoPosition),this.on("style.load",function(){f.transform.unmodified&&f.jumpTo(f.style.stylesheet)}),this.on("data",function(g){f._update(g.dataType==="style"),f.fire(new u.Event(g.dataType+"data",g))}),this.on("dataloading",function(g){f.fire(new u.Event(g.dataType+"dataloading",g))})}n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a;var o={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return a.prototype._getMapId=function(){return this._mapId},a.prototype.addControl=function(l,f){if(f===void 0&&(f=l.getDefaultPosition?l.getDefaultPosition():"top-right"),!l||!l.onAdd)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var y=l.onAdd(this);this._controls.push(l);var g=this._controlPositions[f];return f.indexOf("bottom")!==-1?g.insertBefore(y,g.firstChild):g.appendChild(y),this},a.prototype.removeControl=function(l){if(!l||!l.onRemove)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var f=this._controls.indexOf(l);return f>-1&&this._controls.splice(f,1),l.onRemove(this),this},a.prototype.hasControl=function(l){return this._controls.indexOf(l)>-1},a.prototype.resize=function(l){var f=this._containerDimensions(),y=f[0],g=f[1];this._resizeCanvas(y,g),this.transform.resize(y,g),this.painter.resize(y,g);var w=!this._moving;return w&&(this.stop(),this.fire(new u.Event("movestart",l)).fire(new u.Event("move",l))),this.fire(new u.Event("resize",l)),w&&this.fire(new u.Event("moveend",l)),this},a.prototype.getBounds=function(){return this.transform.getBounds()},a.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},a.prototype.setMaxBounds=function(l){return this.transform.setMaxBounds(u.LngLatBounds.convert(l)),this._update()},a.prototype.setMinZoom=function(l){if((l=l==null?-2:l)>=-2&&l<=this.transform.maxZoom)return this.transform.minZoom=l,this._update(),this.getZoom()<l&&this.setZoom(l),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},a.prototype.getMinZoom=function(){return this.transform.minZoom},a.prototype.setMaxZoom=function(l){if((l=l==null?22:l)>=this.transform.minZoom)return this.transform.maxZoom=l,this._update(),this.getZoom()>l&&this.setZoom(l),this;throw new Error("maxZoom must be greater than the current minZoom")},a.prototype.getMaxZoom=function(){return this.transform.maxZoom},a.prototype.setMinPitch=function(l){if((l=l==null?0:l)<0)throw new Error("minPitch must be greater than or equal to 0");if(l>=0&&l<=this.transform.maxPitch)return this.transform.minPitch=l,this._update(),this.getPitch()<l&&this.setPitch(l),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},a.prototype.getMinPitch=function(){return this.transform.minPitch},a.prototype.setMaxPitch=function(l){if((l=l==null?60:l)>60)throw new Error("maxPitch must be less than or equal to 60");if(l>=this.transform.minPitch)return this.transform.maxPitch=l,this._update(),this.getPitch()>l&&this.setPitch(l),this;throw new Error("maxPitch must be greater than the current minPitch")},a.prototype.getMaxPitch=function(){return this.transform.maxPitch},a.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},a.prototype.setRenderWorldCopies=function(l){return this.transform.renderWorldCopies=l,this._update()},a.prototype.project=function(l){return this.transform.locationPoint(u.LngLat.convert(l))},a.prototype.unproject=function(l){return this.transform.pointLocation(u.Point.convert(l))},a.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},a.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},a.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},a.prototype._createDelegatedListener=function(l,f,y){var g,w=this;if(l==="mouseenter"||l==="mouseover"){var I=!1;return{layer:f,listener:y,delegates:{mousemove:function(U){var Z=w.getLayer(f)?w.queryRenderedFeatures(U.point,{layers:[f]}):[];Z.length?I||(I=!0,y.call(w,new ti(l,w,U.originalEvent,{features:Z}))):I=!1},mouseout:function(){I=!1}}}}if(l==="mouseleave"||l==="mouseout"){var k=!1;return{layer:f,listener:y,delegates:{mousemove:function(U){(w.getLayer(f)?w.queryRenderedFeatures(U.point,{layers:[f]}):[]).length?k=!0:k&&(k=!1,y.call(w,new ti(l,w,U.originalEvent)))},mouseout:function(U){k&&(k=!1,y.call(w,new ti(l,w,U.originalEvent)))}}}}return{layer:f,listener:y,delegates:(g={},g[l]=function(U){var Z=w.getLayer(f)?w.queryRenderedFeatures(U.point,{layers:[f]}):[];Z.length&&(U.features=Z,y.call(w,U),delete U.features)},g)}},a.prototype.on=function(l,f,y){if(y===void 0)return n.prototype.on.call(this,l,f);var g=this._createDelegatedListener(l,f,y);for(var w in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[l]=this._delegatedListeners[l]||[],this._delegatedListeners[l].push(g),g.delegates)this.on(w,g.delegates[w]);return this},a.prototype.once=function(l,f,y){if(y===void 0)return n.prototype.once.call(this,l,f);var g=this._createDelegatedListener(l,f,y);for(var w in g.delegates)this.once(w,g.delegates[w]);return this},a.prototype.off=function(l,f,y){var g=this;return y===void 0?n.prototype.off.call(this,l,f):(this._delegatedListeners&&this._delegatedListeners[l]&&function(w){for(var I=w[l],k=0;k<I.length;k++){var U=I[k];if(U.layer===f&&U.listener===y){for(var Z in U.delegates)g.off(Z,U.delegates[Z]);return I.splice(k,1),g}}}(this._delegatedListeners),this)},a.prototype.queryRenderedFeatures=function(l,f){if(!this.style)return[];var y;if(f!==void 0||l===void 0||l instanceof u.Point||Array.isArray(l)||(f=l,l=void 0),f=f||{},(l=l||[[0,0],[this.transform.width,this.transform.height]])instanceof u.Point||typeof l[0]=="number")y=[u.Point.convert(l)];else{var g=u.Point.convert(l[0]),w=u.Point.convert(l[1]);y=[g,new u.Point(w.x,g.y),w,new u.Point(g.x,w.y),g]}return this.style.queryRenderedFeatures(y,f,this.transform)},a.prototype.querySourceFeatures=function(l,f){return this.style.querySourceFeatures(l,f)},a.prototype.setStyle=function(l,f){return(f=u.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},f)).diff!==!1&&f.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&l?(this._diffStyle(l,f),this):(this._localIdeographFontFamily=f.localIdeographFontFamily,this._updateStyle(l,f))},a.prototype._getUIString=function(l){var f=this._locale[l];if(f==null)throw new Error("Missing UI string '"+l+"'");return f},a.prototype._updateStyle=function(l,f){return this.style&&(this.style.setEventedParent(null),this.style._remove()),l?(this.style=new br(this,f||{}),this.style.setEventedParent(this,{style:this.style}),typeof l=="string"?this.style.loadURL(l):this.style.loadJSON(l),this):(delete this.style,this)},a.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new br(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},a.prototype._diffStyle=function(l,f){var y=this;if(typeof l=="string"){var g=this._requestManager.normalizeStyleURL(l),w=this._requestManager.transformRequest(g,u.ResourceType.Style);u.getJSON(w,function(I,k){I?y.fire(new u.ErrorEvent(I)):k&&y._updateDiff(k,f)})}else typeof l=="object"&&this._updateDiff(l,f)},a.prototype._updateDiff=function(l,f){try{this.style.setState(l)&&this._update(!0)}catch(y){u.warnOnce("Unable to perform style diff: "+(y.message||y.error||y)+".  Rebuilding the style from scratch."),this._updateStyle(l,f)}},a.prototype.getStyle=function(){if(this.style)return this.style.serialize()},a.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():u.warnOnce("There is no style added to the map.")},a.prototype.addSource=function(l,f){return this._lazyInitEmptyStyle(),this.style.addSource(l,f),this._update(!0)},a.prototype.isSourceLoaded=function(l){var f=this.style&&this.style.sourceCaches[l];if(f!==void 0)return f.loaded();this.fire(new u.ErrorEvent(new Error("There is no source with ID '"+l+"'")))},a.prototype.areTilesLoaded=function(){var l=this.style&&this.style.sourceCaches;for(var f in l){var y=l[f]._tiles;for(var g in y){var w=y[g];if(w.state!=="loaded"&&w.state!=="errored")return!1}}return!0},a.prototype.addSourceType=function(l,f,y){return this._lazyInitEmptyStyle(),this.style.addSourceType(l,f,y)},a.prototype.removeSource=function(l){return this.style.removeSource(l),this._update(!0)},a.prototype.getSource=function(l){return this.style.getSource(l)},a.prototype.addImage=function(l,f,y){y===void 0&&(y={});var g=y.pixelRatio;g===void 0&&(g=1);var w=y.sdf;w===void 0&&(w=!1);var I=y.stretchX,k=y.stretchY,U=y.content;if(this._lazyInitEmptyStyle(),f instanceof sa||je&&f instanceof je){var Z=u.browser.getImageData(f);this.style.addImage(l,{data:new u.RGBAImage({width:Z.width,height:Z.height},Z.data),pixelRatio:g,stretchX:I,stretchY:k,content:U,sdf:w,version:0})}else{if(f.width===void 0||f.height===void 0)return this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var q=f;this.style.addImage(l,{data:new u.RGBAImage({width:f.width,height:f.height},new Uint8Array(f.data)),pixelRatio:g,stretchX:I,stretchY:k,content:U,sdf:w,version:0,userImage:q}),q.onAdd&&q.onAdd(this,l)}},a.prototype.updateImage=function(l,f){var y=this.style.getImage(l);if(!y)return this.fire(new u.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var g=f instanceof sa||je&&f instanceof je?u.browser.getImageData(f):f,w=g.width,I=g.height,k=g.data;return w===void 0||I===void 0?this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):w!==y.data.width||I!==y.data.height?this.fire(new u.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(y.data.replace(k,!(f instanceof sa||je&&f instanceof je)),void this.style.updateImage(l,y))},a.prototype.hasImage=function(l){return l?!!this.style.getImage(l):(this.fire(new u.ErrorEvent(new Error("Missing required image id"))),!1)},a.prototype.removeImage=function(l){this.style.removeImage(l)},a.prototype.loadImage=function(l,f){u.getImage(this._requestManager.transformRequest(l,u.ResourceType.Image),f)},a.prototype.listImages=function(){return this.style.listImages()},a.prototype.addLayer=function(l,f){return this._lazyInitEmptyStyle(),this.style.addLayer(l,f),this._update(!0)},a.prototype.moveLayer=function(l,f){return this.style.moveLayer(l,f),this._update(!0)},a.prototype.removeLayer=function(l){return this.style.removeLayer(l),this._update(!0)},a.prototype.getLayer=function(l){return this.style.getLayer(l)},a.prototype.setLayerZoomRange=function(l,f,y){return this.style.setLayerZoomRange(l,f,y),this._update(!0)},a.prototype.setFilter=function(l,f,y){return y===void 0&&(y={}),this.style.setFilter(l,f,y),this._update(!0)},a.prototype.getFilter=function(l){return this.style.getFilter(l)},a.prototype.setPaintProperty=function(l,f,y,g){return g===void 0&&(g={}),this.style.setPaintProperty(l,f,y,g),this._update(!0)},a.prototype.getPaintProperty=function(l,f){return this.style.getPaintProperty(l,f)},a.prototype.setLayoutProperty=function(l,f,y,g){return g===void 0&&(g={}),this.style.setLayoutProperty(l,f,y,g),this._update(!0)},a.prototype.getLayoutProperty=function(l,f){return this.style.getLayoutProperty(l,f)},a.prototype.setLight=function(l,f){return f===void 0&&(f={}),this._lazyInitEmptyStyle(),this.style.setLight(l,f),this._update(!0)},a.prototype.getLight=function(){return this.style.getLight()},a.prototype.setFeatureState=function(l,f){return this.style.setFeatureState(l,f),this._update()},a.prototype.removeFeatureState=function(l,f){return this.style.removeFeatureState(l,f),this._update()},a.prototype.getFeatureState=function(l){return this.style.getFeatureState(l)},a.prototype.getContainer=function(){return this._container},a.prototype.getCanvasContainer=function(){return this._canvasContainer},a.prototype.getCanvas=function(){return this._canvas},a.prototype._containerDimensions=function(){var l=0,f=0;return this._container&&(l=this._container.clientWidth||400,f=this._container.clientHeight||300),[l,f]},a.prototype._detectMissingCSS=function(){u.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&u.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},a.prototype._setupContainer=function(){var l=this._container;l.classList.add("mapboxgl-map"),(this._missingCSSCanary=st.create("div","mapboxgl-canary",l)).style.visibility="hidden",this._detectMissingCSS();var f=this._canvasContainer=st.create("div","mapboxgl-canvas-container",l);this._interactive&&f.classList.add("mapboxgl-interactive"),this._canvas=st.create("canvas","mapboxgl-canvas",f),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");var y=this._containerDimensions();this._resizeCanvas(y[0],y[1]);var g=this._controlContainer=st.create("div","mapboxgl-control-container",l),w=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(I){w[I]=st.create("div","mapboxgl-ctrl-"+I,g)}),this._container.addEventListener("scroll",this._onMapScroll,!1)},a.prototype._resizeCanvas=function(l,f){var y=u.browser.devicePixelRatio||1;this._canvas.width=y*l,this._canvas.height=y*f,this._canvas.style.width=l+"px",this._canvas.style.height=f+"px"},a.prototype._setupPainter=function(){var l=u.extend({},Et.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),f=this._canvas.getContext("webgl",l)||this._canvas.getContext("experimental-webgl",l);f?(this.painter=new ni(f,this.transform),u.webpSupported.testSupport(f)):this.fire(new u.ErrorEvent(new Error("Failed to initialize WebGL")))},a.prototype._contextLost=function(l){l.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new u.Event("webglcontextlost",{originalEvent:l}))},a.prototype._contextRestored=function(l){this._setupPainter(),this.resize(),this._update(),this.fire(new u.Event("webglcontextrestored",{originalEvent:l}))},a.prototype._onMapScroll=function(l){if(l.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},a.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},a.prototype._update=function(l){return this.style?(this._styleDirty=this._styleDirty||l,this._sourcesDirty=!0,this.triggerRepaint(),this):this},a.prototype._requestRenderFrame=function(l){return this._update(),this._renderTaskQueue.add(l)},a.prototype._cancelRenderFrame=function(l){this._renderTaskQueue.remove(l)},a.prototype._render=function(l){var f,y=this,g=0,w=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(f=w.createQueryEXT(),w.beginQueryEXT(w.TIME_ELAPSED_EXT,f),g=u.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(l),!this._removed){var I=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var k=this.transform.zoom,U=u.browser.now();this.style.zoomHistory.update(k,U);var Z=new u.EvaluationParameters(k,{now:U,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),q=Z.crossFadingFactor();q===1&&q===this._crossFadingFactor||(I=!0,this._crossFadingFactor=q),this.style.update(Z)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new u.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new u.Event("load"))),this.style&&(this.style.hasTransitions()||I)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var J=u.browser.now()-g;w.endQueryEXT(w.TIME_ELAPSED_EXT,f),setTimeout(function(){var G=w.getQueryObjectEXT(f,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(f),y.fire(new u.Event("gpu-timing-frame",{cpuTime:J,gpuTime:G}))},50)}if(this.listens("gpu-timing-layer")){var K=this.painter.collectGpuTimers();setTimeout(function(){var G=y.painter.queryGpuTimers(K);y.fire(new u.Event("gpu-timing-layer",{layerTimes:G}))},50)}var tt=this._sourcesDirty||this._styleDirty||this._placementDirty;return tt||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.Event("idle")),!this._loaded||this._fullyLoaded||tt||(this._fullyLoaded=!0),this}},a.prototype.remove=function(){this._hash&&this._hash.remove();for(var l=0,f=this._controls;l<f.length;l+=1)f[l].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),u.window!==void 0&&(u.window.removeEventListener("resize",this._onWindowResize,!1),u.window.removeEventListener("orientationchange",this._onWindowResize,!1),u.window.removeEventListener("online",this._onWindowOnline,!1));var y=this.painter.context.gl.getExtension("WEBGL_lose_context");y&&y.loseContext(),_o(this._canvasContainer),_o(this._controlContainer),_o(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new u.Event("remove"))},a.prototype.triggerRepaint=function(){var l=this;this.style&&!this._frame&&(this._frame=u.browser.frame(function(f){l._frame=null,l._render(f)}))},a.prototype._onWindowOnline=function(){this._update()},a.prototype._onWindowResize=function(l){this._trackResize&&this.resize({originalEvent:l})._update()},o.showTileBoundaries.get=function(){return!!this._showTileBoundaries},o.showTileBoundaries.set=function(l){this._showTileBoundaries!==l&&(this._showTileBoundaries=l,this._update())},o.showPadding.get=function(){return!!this._showPadding},o.showPadding.set=function(l){this._showPadding!==l&&(this._showPadding=l,this._update())},o.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},o.showCollisionBoxes.set=function(l){this._showCollisionBoxes!==l&&(this._showCollisionBoxes=l,l?this.style._generateCollisionBoxes():this._update())},o.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},o.showOverdrawInspector.set=function(l){this._showOverdrawInspector!==l&&(this._showOverdrawInspector=l,this._update())},o.repaint.get=function(){return!!this._repaint},o.repaint.set=function(l){this._repaint!==l&&(this._repaint=l,this.triggerRepaint())},o.vertices.get=function(){return!!this._vertices},o.vertices.set=function(l){this._vertices=l,this._update()},a.prototype._setCacheLimits=function(l,f){u.setCacheLimits(l,f)},o.version.get=function(){return u.version},Object.defineProperties(a.prototype,o),a}(as);function _o(n){n.parentNode&&n.parentNode.removeChild(n)}var Rs={showCompass:!0,showZoom:!0,visualizePitch:!1},Fo=function(n){var a=this;this.options=u.extend({},Rs,n),this._container=st.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(o){return o.preventDefault()}),this.options.showZoom&&(u.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(o){return a._map.zoomIn({},{originalEvent:o})}),st.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(o){return a._map.zoomOut({},{originalEvent:o})}),st.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(u.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(o){a.options.visualizePitch?a._map.resetNorthPitch({},{originalEvent:o}):a._map.resetNorth({},{originalEvent:o})}),this._compassIcon=st.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Fo.prototype._updateZoomButtons=function(){var n=this._map.getZoom(),a=n===this._map.getMaxZoom(),o=n===this._map.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=o,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",o.toString())},Fo.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},Fo.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new dn(this._map,this._compass,this.options.visualizePitch)),this._container},Fo.prototype.onRemove=function(){st.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Fo.prototype._createButton=function(n,a){var o=st.create("button",n,this._container);return o.type="button",o.addEventListener("click",a),o},Fo.prototype._setButtonTitle=function(n,a){var o=this._map._getUIString("NavigationControl."+a);n.title=o,n.setAttribute("aria-label",o)};var dn=function(n,a,o){o===void 0&&(o=!1),this._clickTolerance=10,this.element=a,this.mouseRotate=new Ma({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,o&&(this.mousePitch=new ns({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),u.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),st.addEventListener(a,"mousedown",this.mousedown),st.addEventListener(a,"touchstart",this.touchstart,{passive:!1}),st.addEventListener(a,"touchmove",this.touchmove),st.addEventListener(a,"touchend",this.touchend),st.addEventListener(a,"touchcancel",this.reset)};function us(n,a,o){if(n=new u.LngLat(n.lng,n.lat),a){var l=new u.LngLat(n.lng-360,n.lat),f=new u.LngLat(n.lng+360,n.lat),y=o.locationPoint(n).distSqr(a);o.locationPoint(l).distSqr(a)<y?n=l:o.locationPoint(f).distSqr(a)<y&&(n=f)}for(;Math.abs(n.lng-o.center.lng)>180;){var g=o.locationPoint(n);if(g.x>=0&&g.y>=0&&g.x<=o.width&&g.y<=o.height)break;n.lng>o.center.lng?n.lng-=360:n.lng+=360}return n}dn.prototype.down=function(n,a){this.mouseRotate.mousedown(n,a),this.mousePitch&&this.mousePitch.mousedown(n,a),st.disableDrag()},dn.prototype.move=function(n,a){var o=this.map,l=this.mouseRotate.mousemoveWindow(n,a);if(l&&l.bearingDelta&&o.setBearing(o.getBearing()+l.bearingDelta),this.mousePitch){var f=this.mousePitch.mousemoveWindow(n,a);f&&f.pitchDelta&&o.setPitch(o.getPitch()+f.pitchDelta)}},dn.prototype.off=function(){var n=this.element;st.removeEventListener(n,"mousedown",this.mousedown),st.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),st.removeEventListener(n,"touchmove",this.touchmove),st.removeEventListener(n,"touchend",this.touchend),st.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},dn.prototype.offTemp=function(){st.enableDrag(),st.removeEventListener(u.window,"mousemove",this.mousemove),st.removeEventListener(u.window,"mouseup",this.mouseup)},dn.prototype.mousedown=function(n){this.down(u.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),st.mousePos(this.element,n)),st.addEventListener(u.window,"mousemove",this.mousemove),st.addEventListener(u.window,"mouseup",this.mouseup)},dn.prototype.mousemove=function(n){this.move(n,st.mousePos(this.element,n))},dn.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},dn.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=st.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},dn.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=st.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},dn.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},dn.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var yo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function ul(n,a,o){var l=n.classList;for(var f in yo)l.remove("mapboxgl-"+o+"-anchor-"+f);l.add("mapboxgl-"+o+"-anchor-"+a)}var hs,Os=function(n){function a(o,l){if(n.call(this),(o instanceof u.window.HTMLElement||l)&&(o=u.extend({element:o},l)),u.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment!=="auto"?o.pitchAlignment:this._rotationAlignment,o&&o.element)this._element=o.element,this._offset=u.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=st.create("div"),this._element.setAttribute("aria-label","Map marker");var f=st.createNS("http://www.w3.org/2000/svg","svg");f.setAttributeNS(null,"display","block"),f.setAttributeNS(null,"height","41px"),f.setAttributeNS(null,"width","27px"),f.setAttributeNS(null,"viewBox","0 0 27 41");var y=st.createNS("http://www.w3.org/2000/svg","g");y.setAttributeNS(null,"stroke","none"),y.setAttributeNS(null,"stroke-width","1"),y.setAttributeNS(null,"fill","none"),y.setAttributeNS(null,"fill-rule","evenodd");var g=st.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"fill-rule","nonzero");var w=st.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");for(var I=0,k=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];I<k.length;I+=1){var U=k[I],Z=st.createNS("http://www.w3.org/2000/svg","ellipse");Z.setAttributeNS(null,"opacity","0.04"),Z.setAttributeNS(null,"cx","10.5"),Z.setAttributeNS(null,"cy","5.80029008"),Z.setAttributeNS(null,"rx",U.rx),Z.setAttributeNS(null,"ry",U.ry),w.appendChild(Z)}var q=st.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"fill",this._color);var J=st.createNS("http://www.w3.org/2000/svg","path");J.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),q.appendChild(J);var K=st.createNS("http://www.w3.org/2000/svg","g");K.setAttributeNS(null,"opacity","0.25"),K.setAttributeNS(null,"fill","#000000");var tt=st.createNS("http://www.w3.org/2000/svg","path");tt.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),K.appendChild(tt);var G=st.createNS("http://www.w3.org/2000/svg","g");G.setAttributeNS(null,"transform","translate(6.0, 7.0)"),G.setAttributeNS(null,"fill","#FFFFFF");var Q=st.createNS("http://www.w3.org/2000/svg","g");Q.setAttributeNS(null,"transform","translate(8.0, 8.0)");var ot=st.createNS("http://www.w3.org/2000/svg","circle");ot.setAttributeNS(null,"fill","#000000"),ot.setAttributeNS(null,"opacity","0.25"),ot.setAttributeNS(null,"cx","5.5"),ot.setAttributeNS(null,"cy","5.5"),ot.setAttributeNS(null,"r","5.4999962");var ht=st.createNS("http://www.w3.org/2000/svg","circle");ht.setAttributeNS(null,"fill","#FFFFFF"),ht.setAttributeNS(null,"cx","5.5"),ht.setAttributeNS(null,"cy","5.5"),ht.setAttributeNS(null,"r","5.4999962"),Q.appendChild(ot),Q.appendChild(ht),g.appendChild(w),g.appendChild(q),g.appendChild(K),g.appendChild(G),g.appendChild(Q),f.appendChild(g),f.setAttributeNS(null,"height",41*this._scale+"px"),f.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(f),this._offset=u.Point.convert(o&&o.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(_t){_t.preventDefault()}),this._element.addEventListener("mousedown",function(_t){_t.preventDefault()}),ul(this._element,this._anchor,"marker"),this._popup=null}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.addTo=function(o){return this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._update),o.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},a.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),st.remove(this._element),this._popup&&this._popup.remove(),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(o){return this._lngLat=u.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},a.prototype.getElement=function(){return this._element},a.prototype.setPopup=function(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){var l=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[l,-1*(24.6+l)],"bottom-right":[-l,-1*(24.6+l)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},a.prototype._onKeyPress=function(o){var l=o.code,f=o.charCode||o.keyCode;l!=="Space"&&l!=="Enter"&&f!==32&&f!==13||this.togglePopup()},a.prototype._onMapClick=function(o){var l=o.originalEvent.target,f=this._element;this._popup&&(l===f||f.contains(l))&&this.togglePopup()},a.prototype.getPopup=function(){return this._popup},a.prototype.togglePopup=function(){var o=this._popup;return o?(o.isOpen()?o.remove():o.addTo(this._map),this):this},a.prototype._update=function(o){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=us(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var l="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?l="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(l="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var f="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?f="rotateX(0deg)":this._pitchAlignment==="map"&&(f="rotateX("+this._map.getPitch()+"deg)"),o&&o.type!=="moveend"||(this._pos=this._pos.round()),st.setTransform(this._element,yo[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+f+" "+l)}},a.prototype.getOffset=function(){return this._offset},a.prototype.setOffset=function(o){return this._offset=u.Point.convert(o),this._update(),this},a.prototype._onMove=function(o){if(!this._isDragging){var l=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=l}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.Event("dragstart"))),this.fire(new u.Event("drag")))},a.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.Event("dragend")),this._state="inactive"},a.prototype._addDragHandler=function(o){this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},a.prototype.setDraggable=function(o){return this._draggable=!!o,this._map&&(o?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},a.prototype.isDraggable=function(){return this._draggable},a.prototype.setRotation=function(o){return this._rotation=o||0,this._update(),this},a.prototype.getRotation=function(){return this._rotation},a.prototype.setRotationAlignment=function(o){return this._rotationAlignment=o||"auto",this._update(),this},a.prototype.getRotationAlignment=function(){return this._rotationAlignment},a.prototype.setPitchAlignment=function(o){return this._pitchAlignment=o&&o!=="auto"?o:this._rotationAlignment,this._update(),this},a.prototype.getPitchAlignment=function(){return this._pitchAlignment},a}(u.Evented),Gl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},cs=0,Da=!1,Wl=function(n){function a(o){n.call(this),this.options=u.extend({},Gl,o),u.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.onAdd=function(o){var l;return this._map=o,this._container=st.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),l=this._setupUI,hs!==void 0?l(hs):u.window.navigator.permissions!==void 0?u.window.navigator.permissions.query({name:"geolocation"}).then(function(f){l(hs=f.state!=="denied")}):l(hs=!!u.window.navigator.geolocation),this._container},a.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(u.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),st.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,cs=0,Da=!1},a.prototype._isOutOfMapMaxBounds=function(o){var l=this._map.getMaxBounds(),f=o.coords;return l&&(f.longitude<l.getWest()||f.longitude>l.getEast()||f.latitude<l.getSouth()||f.latitude>l.getNorth())},a.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},a.prototype._onSuccess=function(o){if(this._map){if(this._isOutOfMapMaxBounds(o))return this._setErrorState(),this.fire(new u.Event("outofmaxbounds",o)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=o,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(o),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(o),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new u.Event("geolocate",o)),this._finish()}},a.prototype._updateCamera=function(o){var l=new u.LngLat(o.coords.longitude,o.coords.latitude),f=o.coords.accuracy,y=this._map.getBearing(),g=u.extend({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(l.toBounds(f),g,{geolocateSource:!0})},a.prototype._updateMarker=function(o){if(o){var l=new u.LngLat(o.coords.longitude,o.coords.latitude);this._accuracyCircleMarker.setLngLat(l).addTo(this._map),this._userLocationDotMarker.setLngLat(l).addTo(this._map),this._accuracy=o.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},a.prototype._updateCircleRadius=function(){var o=this._map._container.clientHeight/2,l=this._map.unproject([0,o]),f=this._map.unproject([1,o]),y=l.distanceTo(f),g=Math.ceil(2*this._accuracy/y);this._circleElement.style.width=g+"px",this._circleElement.style.height=g+"px"},a.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},a.prototype._onError=function(o){if(this._map){if(this.options.trackUserLocation)if(o.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var l=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=l,this._geolocateButton.setAttribute("aria-label",l),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(o.code===3&&Da)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new u.Event("error",o)),this._finish()}},a.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},a.prototype._setupUI=function(o){var l=this;if(this._container.addEventListener("contextmenu",function(g){return g.preventDefault()}),this._geolocateButton=st.create("button","mapboxgl-ctrl-geolocate",this._container),st.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",o===!1){u.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var f=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=f,this._geolocateButton.setAttribute("aria-label",f)}else{var y=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=y,this._geolocateButton.setAttribute("aria-label",y)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=st.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Os(this._dotElement),this._circleElement=st.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Os({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(g){g.geolocateSource||l._watchState!=="ACTIVE_LOCK"||g.originalEvent&&g.originalEvent.type==="resize"||(l._watchState="BACKGROUND",l._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),l._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),l.fire(new u.Event("trackuserlocationend")))})},a.prototype.trigger=function(){if(!this._setup)return u.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":cs--,Da=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new u.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var o;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++cs>1?(o={maximumAge:6e5,timeout:0},Da=!0):(o=this.options.positionOptions,Da=!1),this._geolocationWatchID=u.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,o)}}else u.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},a.prototype._clearWatch=function(){u.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},a}(u.Evented),la={maxWidth:100,unit:"metric"},ua=function(n){this.options=u.extend({},la,n),u.bindAll(["_onMove","setUnit"],this)};function hl(n,a,o){var l=o&&o.maxWidth||100,f=n._container.clientHeight/2,y=n.unproject([0,f]),g=n.unproject([l,f]),w=y.distanceTo(g);if(o&&o.unit==="imperial"){var I=3.2808*w;I>5280?ha(a,l,I/5280,n._getUIString("ScaleControl.Miles")):ha(a,l,I,n._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?ha(a,l,w/1852,n._getUIString("ScaleControl.NauticalMiles")):w>=1e3?ha(a,l,w/1e3,n._getUIString("ScaleControl.Kilometers")):ha(a,l,w,n._getUIString("ScaleControl.Meters"))}function ha(n,a,o,l){var f,y,g,w=(f=o,(y=Math.pow(10,(""+Math.floor(f)).length-1))*(g=(g=f/y)>=10?10:g>=5?5:g>=3?3:g>=2?2:g>=1?1:function(I){var k=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*k)/k}(g)));n.style.width=a*(w/o)+"px",n.innerHTML=w+"&nbsp;"+l}ua.prototype.getDefaultPosition=function(){return"bottom-left"},ua.prototype._onMove=function(){hl(this._map,this._container,this.options)},ua.prototype.onAdd=function(n){return this._map=n,this._container=st.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},ua.prototype.onRemove=function(){st.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},ua.prototype.setUnit=function(n){this.options.unit=n,hl(this._map,this._container,this.options)};var kn=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof u.window.HTMLElement?this._container=n.container:u.warnOnce("Full screen control 'container' must be a DOM element.")),u.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in u.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in u.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in u.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in u.window.document&&(this._fullscreenchange="MSFullscreenChange")};kn.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=st.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",u.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},kn.prototype.onRemove=function(){st.remove(this._controlContainer),this._map=null,u.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},kn.prototype._checkFullscreenSupport=function(){return!!(u.window.document.fullscreenEnabled||u.window.document.mozFullScreenEnabled||u.window.document.msFullscreenEnabled||u.window.document.webkitFullscreenEnabled)},kn.prototype._setupUI=function(){var n=this._fullscreenButton=st.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);st.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),u.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},kn.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},kn.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},kn.prototype._isFullscreen=function(){return this._fullscreen},kn.prototype._changeIcon=function(){(u.window.document.fullscreenElement||u.window.document.mozFullScreenElement||u.window.document.webkitFullscreenElement||u.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},kn.prototype._onClickFullscreen=function(){this._isFullscreen()?u.window.document.exitFullscreen?u.window.document.exitFullscreen():u.window.document.mozCancelFullScreen?u.window.document.mozCancelFullScreen():u.window.document.msExitFullscreen?u.window.document.msExitFullscreen():u.window.document.webkitCancelFullScreen&&u.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Hl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Fs=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Xl=function(n){function a(o){n.call(this),this.options=u.extend(Object.create(Hl),o),u.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(a.__proto__=n),(a.prototype=Object.create(n&&n.prototype)).constructor=a,a.prototype.addTo=function(o){return this._map&&this.remove(),this._map=o,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new u.Event("open")),this},a.prototype.isOpen=function(){return!!this._map},a.prototype.remove=function(){return this._content&&st.remove(this._content),this._container&&(st.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new u.Event("close")),this},a.prototype.getLngLat=function(){return this._lngLat},a.prototype.setLngLat=function(o){return this._lngLat=u.LngLat.convert(o),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},a.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},a.prototype.getElement=function(){return this._container},a.prototype.setText=function(o){return this.setDOMContent(u.window.document.createTextNode(o))},a.prototype.setHTML=function(o){var l,f=u.window.document.createDocumentFragment(),y=u.window.document.createElement("body");for(y.innerHTML=o;l=y.firstChild;)f.appendChild(l);return this.setDOMContent(f)},a.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},a.prototype.setMaxWidth=function(o){return this.options.maxWidth=o,this._update(),this},a.prototype.setDOMContent=function(o){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=st.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(o),this._createCloseButton(),this._update(),this._focusFirstElement(),this},a.prototype.addClassName=function(o){this._container&&this._container.classList.add(o)},a.prototype.removeClassName=function(o){this._container&&this._container.classList.remove(o)},a.prototype.setOffset=function(o){return this.options.offset=o,this._update(),this},a.prototype.toggleClassName=function(o){if(this._container)return this._container.classList.toggle(o)},a.prototype._createCloseButton=function(){this.options.closeButton&&(this._closeButton=st.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},a.prototype._onMouseUp=function(o){this._update(o.point)},a.prototype._onMouseMove=function(o){this._update(o.point)},a.prototype._onDrag=function(o){this._update(o.point)},a.prototype._update=function(o){var l=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=st.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=st.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(Z){return l._container.classList.add(Z)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=us(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||o)){var f=this._pos=this._trackPointer&&o?o:this._map.project(this._lngLat),y=this.options.anchor,g=function Z(q){if(q){if(typeof q=="number"){var J=Math.round(Math.sqrt(.5*Math.pow(q,2)));return{center:new u.Point(0,0),top:new u.Point(0,q),"top-left":new u.Point(J,J),"top-right":new u.Point(-J,J),bottom:new u.Point(0,-q),"bottom-left":new u.Point(J,-J),"bottom-right":new u.Point(-J,-J),left:new u.Point(q,0),right:new u.Point(-q,0)}}if(q instanceof u.Point||Array.isArray(q)){var K=u.Point.convert(q);return{center:K,top:K,"top-left":K,"top-right":K,bottom:K,"bottom-left":K,"bottom-right":K,left:K,right:K}}return{center:u.Point.convert(q.center||[0,0]),top:u.Point.convert(q.top||[0,0]),"top-left":u.Point.convert(q["top-left"]||[0,0]),"top-right":u.Point.convert(q["top-right"]||[0,0]),bottom:u.Point.convert(q.bottom||[0,0]),"bottom-left":u.Point.convert(q["bottom-left"]||[0,0]),"bottom-right":u.Point.convert(q["bottom-right"]||[0,0]),left:u.Point.convert(q.left||[0,0]),right:u.Point.convert(q.right||[0,0])}}return Z(new u.Point(0,0))}(this.options.offset);if(!y){var w,I=this._container.offsetWidth,k=this._container.offsetHeight;w=f.y+g.bottom.y<k?["top"]:f.y>this._map.transform.height-k?["bottom"]:[],f.x<I/2?w.push("left"):f.x>this._map.transform.width-I/2&&w.push("right"),y=w.length===0?"bottom":w.join("-")}var U=f.add(g[y]).round();st.setTransform(this._container,yo[y]+" translate("+U.x+"px,"+U.y+"px)"),ul(this._container,y,"popup")}},a.prototype._focusFirstElement=function(){if(this.options.focusAfterOpen&&this._container){var o=this._container.querySelector(Fs);o&&o.focus()}},a.prototype._onClose=function(){this.remove()},a}(u.Evented),cl={version:u.version,supported:Et,setRTLTextPlugin:u.setRTLTextPlugin,getRTLTextPluginStatus:u.getRTLTextPluginStatus,Map:ls,NavigationControl:Fo,GeolocateControl:Wl,AttributionControl:cr,ScaleControl:ua,FullscreenControl:kn,Popup:Xl,Marker:Os,Style:br,LngLat:u.LngLat,LngLatBounds:u.LngLatBounds,Point:u.Point,MercatorCoordinate:u.MercatorCoordinate,Evented:u.Evented,config:u.config,prewarm:function(){bt().acquire(gt)},clearPrewarmedResources:function(){var n=Ht;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(gt),Ht=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return u.config.ACCESS_TOKEN},set accessToken(n){u.config.ACCESS_TOKEN=n},get baseApiUrl(){return u.config.API_URL},set baseApiUrl(n){u.config.API_URL=n},get workerCount(){return It.workerCount},set workerCount(n){It.workerCount=n},get maxParallelImageRequests(){return u.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){u.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){u.clearTileCache(n)},workerUrl:""};return cl}),R})})(hf);var Np=hf.exports,Dm=yt.exports.Layer.extend({options:{updateInterval:32,padding:.1,interactive:!1,opacity:1},initialize:function(m){yt.exports.setOptions(this,m),this._throttledUpdate=yt.exports.Util.throttle(this._update,this.options.updateInterval,this)},onAdd:function(m){this._container||this._initContainer(),this.getPane().appendChild(this._container),this._initGL(),this._offset=this._map.containerPointToLayerPoint([0,0]),m.options.zoomAnimation&&yt.exports.DomEvent.on(m._proxy,yt.exports.DomUtil.TRANSITION_END,this._transitionEnd,this)},onRemove:function(m){this._map._proxy&&this._map.options.zoomAnimation&&yt.exports.DomEvent.off(this._map._proxy,yt.exports.DomUtil.TRANSITION_END,this._transitionEnd,this),this.getPane().removeChild(this._container),this._glMap.remove(),this._glMap=null},getEvents:function(){return{move:this._throttledUpdate,zoomanim:this._animateZoom,zoom:this._pinchZoom,zoomstart:this._zoomStart,zoomend:this._zoomEnd}},getMapboxMap:function(){return this._glMap},getCanvas:function(){return this._glMap.getCanvas()},getSize:function(){return this._map.getSize().multiplyBy(1+this.options.padding*2)},getOpacity:function(){return this.options.opacity},setOpacity:function(m){this.options.opacity=m,this._container.style.opacity=m},getBounds:function(){var m=this.getSize().multiplyBy(.5),x=this._map.latLngToContainerPoint(this._map.getCenter());return yt.exports.latLngBounds(this._map.containerPointToLatLng(x.subtract(m)),this._map.containerPointToLatLng(x.add(m)))},getContainer:function(){return this._container},_initContainer:function(){var m=this._container=yt.exports.DomUtil.create("div","leaflet-gl-layer"),x=this.getSize(),S=this._map.getSize().multiplyBy(this.options.padding);m.style.width=x.x+"px",m.style.height=x.y+"px",m.style.position="absolute",m.style.opacity=this.options.opacity;var M=this._map.containerPointToLayerPoint([0,0]).subtract(S);yt.exports.DomUtil.setPosition(m,M)},_initGL:function(){var m=this._map.getCenter(),x=yt.exports.extend({},this.options,{container:this._container,center:[m.lng,m.lat],zoom:this._map.getZoom()-1,attributionControl:!1});this._glMap=new Np.Map(x),this._glMap.once("styledata",function(M){this.fire("styleLoaded")}.bind(this)),this._glMap.transform.latRange=null,this._glMap._canvas.canvas?this._glMap._actualCanvas=this._glMap._canvas.canvas:this._glMap._actualCanvas=this._glMap._canvas;var S=this._glMap._actualCanvas;yt.exports.DomUtil.addClass(S,"leaflet-image-layer"),yt.exports.DomUtil.addClass(S,"leaflet-zoom-animated"),this.options.interactive&&yt.exports.DomUtil.addClass(S,"leaflet-interactive"),this.options.className&&yt.exports.DomUtil.addClass(S,this.options.className)},_update:function(m){if(this._offset=this._map.containerPointToLayerPoint([0,0]),!this._zooming){var x=this.getSize(),S=this._container,M=this._glMap,R=this._map.getSize().multiplyBy(this.options.padding),nt=this._map.containerPointToLayerPoint([0,0]).subtract(R);yt.exports.DomUtil.setPosition(S,nt);var u=this._map.getCenter(),Et=M.transform;Et.center=Np.LngLat.convert([u.lng,u.lat]),Et.zoom=this._map.getZoom()-1,M.transform.width!==x.x||M.transform.height!==x.y?(S.style.width=x.x+"px",S.style.height=x.y+"px",M._resize!==null&&M._resize!==void 0?M._resize():M.resize()):M._update!==null&&M._update!==void 0?M._update():M.update()}},_pinchZoom:function(m){this._glMap.jumpTo({zoom:this._map.getZoom()-1,center:this._map.getCenter()})},_animateZoom:function(m){var x=this._map.getZoomScale(m.zoom),S=this._map.getSize().multiplyBy(this.options.padding*x),M=this.getSize()._divideBy(2),R=this._map.project(m.center,m.zoom)._subtract(M)._add(this._map._getMapPanePos().add(S))._round(),nt=this._map.project(this._map.getBounds().getNorthWest(),m.zoom)._subtract(R);yt.exports.DomUtil.setTransform(this._glMap._actualCanvas,nt.subtract(this._offset),x)},_zoomStart:function(m){this._zooming=!0},_zoomEnd:function(){var m=this._map.getZoomScale(this._map.getZoom()),x=this._map._latLngToNewLayerPoint(this._map.getBounds().getNorthWest(),this._map.getZoom(),this._map.getCenter());yt.exports.DomUtil.setTransform(this._glMap._actualCanvas,x.subtract(this._offset),m),this._zooming=!1,this._update()},_transitionEnd:function(m){yt.exports.Util.requestAnimFrame(function(){var x=this._map.getZoom(),S=this._map.getCenter(),M=this._map.latLngToContainerPoint(this._map.getBounds().getNorthWest());yt.exports.DomUtil.setTransform(this._glMap._actualCanvas,M,1),this._glMap.once("moveend",yt.exports.Util.bind(function(){this._zoomEnd()},this)),this._glMap.jumpTo({center:S,zoom:x-1})},this)}});function cf(m){return new Dm(m)}yt.exports.Layer.extend({options:{key:"ArcGIS:Streets"},initialize:function(m,x){if(x&&yt.exports.setOptions(this,x),this.options.apiKey&&(this.options.apikey=this.options.apiKey),this.options.token&&(this.options.apikey=this.options.token),!(this.options.apikey||this.options.token))throw new Error("API Key or token is required for vectorBasemapLayer.");m&&(this.options.key=m),this._createLayer()},_createLayer:function(){var m=Em(this.options.key,this.options.apikey);this._mapboxGL=cf({style:m,pane:this.options.pane,opacity:this.options.opacity}),this._ready=!0,this.fire("ready",{},!0),this._mapboxGL.on("styleLoaded",function(x){this._setupAttribution()}.bind(this))},_setupAttribution:function(){var m=this._map;if(this.options.key.length===32){var x=this._mapboxGL.getMapboxMap().style.stylesheet.sources,S=[];Object.keys(x).forEach(function(M){S.push(x[M].attribution),x[M].copyrightText&&x[M].copyrightText&&x[M].copyrightText!==""&&x[M].attribution!==x[M].copyrightText&&S.push(x[M].copyrightText)}),m.attributionControl.addAttribution('<span class="">'+S.join(", ")+"</span>")}else if(this.options.attributionUrls||(this.options.attributionUrls=this._getAttributionUrls(this.options.key)),this._map&&this.options.attributionUrls){if(bu.setEsriAttribution(m),this._map.attributionControl){for(let M=0;M<this.options.attributionUrls.length;M++){const R=this.options.attributionUrls[M];zm(R,m)}m.attributionControl.addAttribution('<span class="esri-dynamic-attribution"></span>')}bu._updateMapAttribution({target:this._map})}},_getAttributionUrls:function(m){return m.indexOf("OSM:")===0?["https://static.arcgis.com/attribution/Vector/OpenStreetMap_v2"]:m.indexOf("ArcGIS:Imagery")===0?["https://static.arcgis.com/attribution/World_Imagery","https://static.arcgis.com/attribution/Vector/World_Basemap_v2"]:["https://static.arcgis.com/attribution/Vector/World_Basemap_v2"]},onAdd:function(m){this._map=m,this._initPane(),this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},_initPane:function(){if(this.options.pane||(this.options.key.indexOf(":Labels")>-1?this.options.pane="esri-labels":this.options.pane="tilePane"),!this._map.getPane(this.options.pane)){var m=this._map.createPane(this.options.pane);m.style.pointerEvents="none",m.style.zIndex=this.options.pane==="esri-labels"?550:500}},onRemove:function(m){if(m.off("moveend",bu._updateMapAttribution),m.removeLayer(this._mapboxGL),m.attributionControl){var x=document.getElementsByClassName("esri-dynamic-attribution");if(x&&x.length>0){var S=x[0].outerHTML;m.attributionControl.removeAttribution(S)}}},_asyncAdd:function(){var m=this._map;m.on("moveend",bu._updateMapAttribution),this._mapboxGL.addTo(m,this)}});var Bm=yt.exports.Layer.extend({options:{pane:"overlayPane",portalUrl:"https://www.arcgis.com"},initialize:function(m,x){if(x&&yt.exports.setOptions(this,x),this.options.apiKey&&(this.options.apikey=this.options.apiKey),this.options.apikey&&(this.options.token=this.options.apikey),!m)throw new Error("An ITEM ID or SERVICE URL is required for vectorTileLayer.");m&&(this.options.key=m),this._createLayer()},_createLayer:function(){Am(this.options.key,this.options,function(m,x,S,M){if(m)throw new Error(m);if(Mm(M.tileInfo.spatialReference.wkid)||console.warn('This layer is not guaranteed to display properly because its service does not use the Web Mercator projection. The "tileInfo.spatialReference" property is:',M.tileInfo.spatialReference,`
More information is available at https://docs.mapbox.com/help/glossary/projection/ and https://github.com/Esri/esri-leaflet-vector/issues/94.`),x=Lm(x,S,M,this.options.token),!this.getAttribution()){var R=Object.keys(x.sources);this.options.attribution=x.sources[R[R.length-1]].attribution,this._map&&this._map.attributionControl&&this._map.attributionControl.addAttribution(this.getAttribution())}this.options.style&&typeof this.options.style=="function"&&(x=this.options.style(x)),this._mapboxGL=cf({style:x,pane:this.options.pane,opacity:this.options.opacity}),this._ready=!0,this.fire("ready",{},!0)}.bind(this))},onAdd:function(m){this._map=m,this._ready?this._asyncAdd():this.once("ready",function(){this._asyncAdd()},this)},onRemove:function(m){m.removeLayer(this._mapboxGL)},_asyncAdd:function(){var m=this._map;this._mapboxGL.addTo(m,this)}});function n_(m,x){return new Bm(m,x)}export{Km as A,Ym as B,$d as C,Jm as D,i_ as S,Vm as a,Gm as b,Um as c,Fm as d,Zm as e,Om as f,Wm as g,Gd as h,e_ as i,r_ as j,Xm as k,yt as l,jm as m,oc as n,Nm as o,Rp as p,Qm as q,qm as r,Rm as s,qp as t,Jd as u,n_ as v,$m as w,t_ as x,Hm as y,Yd as z};
